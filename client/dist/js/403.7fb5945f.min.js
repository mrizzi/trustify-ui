"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[403],{38914:(e,t,r)=>{r.d(t,{B:()=>l});var a=r(34629),s=r(63696),n=r(13364),i=r(62634);const l=e=>{var{hasGutter:t=!1,className:r="",children:l=null,component:o="div"}=e,u=(0,a.__rest)(e,["hasGutter","className","children","component"]);const c=o;return s.createElement(c,Object.assign({},u,{className:(0,i.A)(n.A.stack,t&&n.A.modifiers.gutter,r)}),l)};l.displayName="Stack"},57901:(e,t,r)=>{r.d(t,{a:()=>l});var a=r(34629),s=r(63696),n=r(13364),i=r(62634);const l=e=>{var{isFilled:t=!1,className:r="",children:l=null}=e,o=(0,a.__rest)(e,["isFilled","className","children"]);return s.createElement("div",Object.assign({},o,{className:(0,i.A)(n.A.stackItem,t&&n.A.modifiers.fill,r)}),l)};l.displayName="StackItem"},86361:(e,t,r)=>{r.d(t,{u:()=>a});const a={name:"--pf-v5-global--danger-color--100",value:"#c9190b",var:"var(--pf-v5-global--danger-color--100)"}},19174:(e,t,r)=>{r.d(t,{n:()=>a});const a={name:"--pf-v5-global--info-color--100",value:"#2b9af3",var:"var(--pf-v5-global--info-color--100)"}},29405:(e,t,r)=>{r.d(t,{G:()=>a});const a={name:"--pf-v5-global--palette--black-300",value:"#d2d2d2",var:"var(--pf-v5-global--palette--black-300)"}},44304:(e,t,r)=>{r.d(t,{p:()=>a});const a={name:"--pf-v5-global--palette--black-400",value:"#b8bbbe",var:"var(--pf-v5-global--palette--black-400)"}},53359:(e,t,r)=>{r.d(t,{c:()=>a});const a={name:"--pf-v5-global--palette--purple-400",value:"#8476d1",var:"var(--pf-v5-global--palette--purple-400)"}},53820:(e,t,r)=>{r.d(t,{H:()=>a});const a={name:"--pf-v5-global--warning-color--100",value:"#f0ab00",var:"var(--pf-v5-global--warning-color--100)"}},81230:(e,t,r)=>{r.d(t,{J4:()=>c,hP:()=>u});var a=r(64917),s=r(86820);r(63260);const n="/api",i=n+"/v2/advisory",l=n+"/v2/sbom",o=e=>{let t="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(t="application/json+bzip2"),t},u=(e,t)=>{const r=e.get(s.fs);return a.A.post(`${i}`,r,{...t,headers:{"Content-Type":o(r)}})},c=(e,t)=>{const r=e.get(s.fs);return a.A.post(`${l}`,r,{...t,headers:{"Content-Type":o(r)}})}},9366:(e,t,r)=>{r.d(t,{$:()=>u});var a=r(63696),s=r(37378),n=r(17993);const i=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,l={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:{...l},fixed:{...l},not_affected:{...l},known_not_affected:{...l}}},u=e=>{const{pkg:t,isFetching:r,fetchError:l}=(0,n.Si)(e);return{data:a.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>{const r=(0,s.U)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r},vulnerabilityStatus:t.status,advisory:e}})).reduce(((e,t)=>{const r=e.find((e=>i(e,t)));if(r)return[...e.filter((e=>!i(e,r))),{...r,relatedSboms:[...r.relatedSboms,{advisory:t.advisory}]}];{const r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};return[...e,r]}}),[]))),r=t.reduce(((e,t)=>{const r=t.vulnerabilityStatus,a=t.vulnerability.average_severity,s=e.vulnerabilityStatus[r];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:s.total+1,severities:{...s.severities,[a]:s.severities[a]+1}}}}}),o);return{vulnerabilities:t,summary:r}})(t?.advisories||[])),[t]),isFetching:r,fetchError:l}}},24808:(e,t,r)=>{r.d(t,{v:()=>o});var a=r(63696),s=r(64917),n=r(86820);const i="cancelled",l=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===i})};case"removeUpload":{const r=new Map(e.uploads);return r.delete(t.payload.file),{...e,uploads:r}}default:throw new Error}},o=({parallel:e,uploadFn:t,onSuccess:r,onError:o})=>{const[u,c]=a.useReducer(l,{uploads:new Map});return{uploads:u.uploads,handleUpload:a=>{const l=[];for(let e=0;e<a.length;e++){const t=a[e],u=new FormData;u.set(n.fs,t);const d=s.A.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const r=e.total??1,a=e.loaded/r*100;c({type:"updateUploadProgress",payload:{file:t,progress:Math.round(a)}})},cancelToken:d.token};c({type:"queueUpload",payload:{file:t,cancelFn:d}});const m={formData:u,config:p,thenFn:e=>{c({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),r&&r(e,t)},catchFn:e=>{c({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==i&&o&&o(e,t)}};l.push(m)}e?l.forEach((e=>{t(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):l.reduce((async(e,r)=>(await e,t(r.formData,r.config).then(r.thenFn).catch(r.catchFn))),Promise.resolve())},handleCancelUpload:e=>{u.uploads.get(e)?.cancelFn?.cancel(i)},handleRemoveUpload:e=>{c({type:"removeUpload",payload:{file:e}})}}}},40124:(e,t,r)=>{r.r(t),r.d(t,{default:()=>V});var a=r(63696),s=r(68430),n=r(38914),i=r(57901),l=r(1180),o=r(72785),u=r(28338),c=r(70045),d=r(16459),p=r(71592),m=r(40111),h=r(10015),b=r(80876),y=r(24417),f=r(16177),v=r(17993),g=r(34066),E=r(49348),S=r(20653),q=r(35048),P=r(4433),F=r(40319),k=r(16646),T=r(9425),w=r(77819),C=r(28516),R=r(3629),_=r(86820),K=r(87043),O=r(1349),M=r(62520),I=r(70611),U=r(5098),L=r(91728);const N=({purl:e})=>{const t=(0,I.MM)({tableName:"sboms",persistenceKeyPrefix:_.rt.sboms_by_package,columnNames:{name:"Name",version:"Version",supplier:"Supplier"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:K.RJ.search}]}),{result:{data:r,total:s},isFetching:n,fetchError:i}=(0,L.Qr)(e,(0,I.Ng)({...t,hubSortFieldKeys:{}})),l=(0,I.PB)({...t,idProperty:"id",currentPageItems:r,totalItemCount:s,isLoading:n,selectionState:(0,U.$)({items:r,isEqual:(e,t)=>e.id===t.id})}),{numRenderedColumns:o,currentPageItems:u,propHelpers:{toolbarProps:c,filterToolbarProps:d,paginationToolbarItemProps:p,paginationProps:m,tableProps:h,getThProps:b,getTrProps:y,getTdProps:f}}=l;return a.createElement(a.Fragment,null,a.createElement(S.M,{...c},a.createElement(q.P,null,a.createElement(P.T,{...p},a.createElement(O.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:m})))),a.createElement(F.X,{...h,"aria-label":"SBOM table"},a.createElement(k.d,null,a.createElement(T.Tr,null,a.createElement(M.Ze,{...l},a.createElement(w.Th,{...b({columnKey:"name"})}),a.createElement(w.Th,{...b({columnKey:"version"})}),a.createElement(w.Th,{...b({columnKey:"supplier"})})))),a.createElement(M.nJ,{isLoading:n,isError:!!i,isNoData:0===s,numRenderedColumns:o},u?.map((e=>a.createElement(C.N,{key:e.id},a.createElement(T.Tr,{...y({item:e})},a.createElement(R.Td,{width:35,...f({columnKey:"name"})},a.createElement(E.N_,{to:`/sboms/${e.id}`},e.name)),a.createElement(R.Td,{width:15,modifier:"truncate",...f({columnKey:"version"})},e.described_by.map((e=>e.version)).join(", ")),a.createElement(R.Td,{width:50,modifier:"truncate",...f({columnKey:"supplier"})},e.authors.join(", ")))))))),a.createElement(O.n,{idPrefix:"sbom-table",isTop:!1,isCompact:!0,paginationProps:m}))};var Q=r(95285),x=r.n(Q),j=r(55399),H=r(52302),A=r(23560),D=r(9366),$=r(15311);const B=({packageId:e})=>{const{data:{vulnerabilities:t,summary:r},isFetching:s,fetchError:n}=(0,D.$)(e),i=a.useMemo((()=>t.filter((e=>"affected"===e.vulnerabilityStatus))),[t]),l=(0,$.f)(i,(e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`)),o=(0,I.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:l,isLoading:s,columnNames:{identifier:"ID",description:"Description",severity:"CVSS",published:"Date published"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","severity","published"],getSortValues:e=>({identifier:e.vulnerability.identifier,severity:e.vulnerability?.average_severity?(0,j.YT)(e.vulnerability?.average_severity):0,published:e.vulnerability?.published?x()(e.vulnerability?.published).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:u,numRenderedColumns:c,propHelpers:{toolbarProps:d,filterToolbarProps:p,paginationToolbarItemProps:m,paginationProps:h,tableProps:b,getThProps:y,getTrProps:f,getTdProps:v},expansionDerivedState:{isCellExpanded:_}}=o;return a.createElement(a.Fragment,null,a.createElement(S.M,{...d},a.createElement(q.P,null,a.createElement(P.T,{...m},a.createElement(O.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})))),a.createElement(F.X,{...b,"aria-label":"vulnerability table"},a.createElement(k.d,null,a.createElement(T.Tr,null,a.createElement(M.Ze,{...o},a.createElement(w.Th,{...y({columnKey:"identifier"})}),a.createElement(w.Th,{...y({columnKey:"description"})}),a.createElement(w.Th,{...y({columnKey:"severity"})}),a.createElement(w.Th,{...y({columnKey:"published"})})))),a.createElement(M.nJ,{isLoading:s,isError:!!n,isNoData:0===l.length,numRenderedColumns:c},u?.map(((e,t)=>a.createElement(C.N,{key:e._ui_unique_id,isExpanded:_(e)},a.createElement(T.Tr,{...f({item:e})},a.createElement(M.Oi,{...o,item:e,rowIndex:t},a.createElement(R.Td,{width:15,...v({columnKey:"identifier"})},a.createElement(E.N_,{to:`/vulnerabilities/${e.vulnerability.identifier}`},e.vulnerability.identifier)),a.createElement(R.Td,{width:60,modifier:"truncate",...v({columnKey:"description"})},e.vulnerability&&a.createElement(A.j,{vulnerability:e.vulnerability})),a.createElement(R.Td,{width:15,...v({columnKey:"severity"})},e.vulnerability?.average_severity&&a.createElement(H.h,{value:e.vulnerability.average_severity})),a.createElement(R.Td,{width:10,modifier:"truncate",...v({columnKey:"published"})},(0,g.Yq)(e.vulnerability?.published))))))))),a.createElement(O.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:h}))},V=()=>{const e=(0,b.Lu)(b.vO.PACKAGE_ID),{pkg:t,isFetching:r,fetchError:E}=(0,v.Si)(e),S=a.useMemo((()=>t?(0,g.fe)(t.purl):void 0),[t]),[q,P]=a.useState(0),F=a.createRef(),k=a.createRef();return a.createElement(a.Fragment,null,a.createElement(s.d8,{variant:"light"},a.createElement(n.B,null,a.createElement(i.a,null,a.createElement(l.n,null,a.createElement(o.E,{component:"h1"},S?.name??e??""))),a.createElement(i.a,null,a.createElement(u.s,null,a.createElement(c.Z,{spacer:{default:"spacerSm"}},a.createElement("p",null,"version: ",S?.version)," "),a.createElement(c.Z,null,S?.qualifiers&&a.createElement(f.a,{value:S?.qualifiers})))))),a.createElement(s.d8,{type:"nav"},a.createElement(d.t,{mountOnEnter:!0,activeKey:q,onSelect:(e,t)=>{P(t)},"aria-label":"Tabs that contain the SBOM information",role:"region"},a.createElement(p.o,{eventKey:0,title:a.createElement(m.V,null,"Vulnerabilities"),tabContentId:"refTabVulnerabilitiesSection",tabContentRef:F}),a.createElement(p.o,{eventKey:1,title:a.createElement(m.V,null,"SBOMs using package"),tabContentId:"refTabSbomsSection",tabContentRef:k}))),a.createElement(s.d8,null,a.createElement(h.J,{eventKey:0,id:"refTabVulnerabilitiesSection",ref:F,"aria-label":"Vulnerabilities of the Package"},e&&a.createElement(B,{packageId:e})),a.createElement(h.J,{eventKey:1,id:"refTabSbomsSection",ref:k,"aria-label":"SBOMs using the Package",hidden:!0},a.createElement(y.a,{isFetching:r,fetchError:E},t?.purl&&a.createElement(N,{purl:t.purl})))))}},17993:(e,t,r)=>{r.d(t,{Lx:()=>o,Si:()=>u,sl:()=>c});var a=r(39155),s=r(77347),n=r(38595),i=r(70611);const l="packages",o=(e={},t=!1,r=!1)=>{const{data:o,isLoading:u,error:c,refetch:d}=(0,a.I)({queryKey:[l,e],queryFn:()=>(0,n.UD)({client:s.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3,enabled:!r});return{result:{data:o?.data?.items||[],total:o?.data?.total??0,params:e},isFetching:u,fetchError:c,refetch:d}},u=e=>{const{data:t,isLoading:r,error:i}=(0,a.I)({queryKey:[l,e],queryFn:()=>(0,n.Y0)({client:s.S,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:i}},c=(e,t={})=>{const{data:r,isLoading:o,error:u,refetch:c}=(0,a.I)({queryKey:[l,"by-sbom",e,t],queryFn:()=>(0,n.Ad)({client:s.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:o,fetchError:u,refetch:c}}},91728:(e,t,r)=>{r.d(t,{DH:()=>y,Qr:()=>b,i$:()=>p,rj:()=>m,sn:()=>h,zY:()=>f});var a=r(39155),s=r(3715),n=r(55037),i=r(77347),l=r(38595),o=r(24808),u=r(81230),c=r(70611);const d="sboms",p=(e={},t=!1,r=!1)=>{const{data:s,isLoading:n,error:o,refetch:u}=(0,a.I)({queryKey:[d,e],queryFn:()=>(0,l.z1)({client:i.S,query:{...(0,c.kd)(e)}}),refetchInterval:!t&&5e3,enabled:!r});return{result:{data:s?.data?.items||[],total:s?.data?.total??0,params:e??e},isFetching:n,fetchError:o,refetch:u}},m=e=>{const{data:t,isLoading:r,error:s}=(0,a.I)({queryKey:[d,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,l.a7)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:s}},h=()=>{const e=(0,s.jE)();return(0,o.v)({parallel:!0,uploadFn:(e,t)=>(0,u.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})},b=(e,t={})=>{const{data:r,isLoading:s,error:n,refetch:o}=(0,a.I)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,l.m9)({client:i.S,query:{purl:e,...(0,c.kd)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:s,fetchError:n,refetch:o}},y=e=>{const{data:t,isLoading:r,error:s}=(0,a.I)({queryKey:[d,e,"advisory"],queryFn:()=>(0,l.bj)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:s}},f=e=>{const t=(0,n.E)({queries:e.map((e=>({queryKey:[d,e,"advisory"],queryFn:()=>(0,l.bj)({client:i.S,path:{id:e}})})))});return{advisories:t.map((({data:e})=>e?.data||[])),isFetching:t.some((({isLoading:e})=>e)),fetchError:t.map((({error:e})=>e))}}},13364:(e,t,r)=>{r.d(t,{A:()=>a});const a={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v5-l-stack",stackItem:"pf-v5-l-stack__item"}},55037:(e,t,r)=>{r.d(t,{E:()=>y});var a=r(63696),s=r(13403),n=r(50653),i=r(47794),l=r(19106);function o(e,t){return e.filter((e=>!t.includes(e)))}var u=class extends i.Q{#e;#t;#r;#a;#s;#n;#i;#l;constructor(e,t,r){super(),this.#e=e,this.#a=r,this.#r=[],this.#s=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#s.forEach((e=>{e.subscribe((t=>{this.#o(e,t)}))}))}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#s.forEach((e=>{e.destroy()}))}setQueries(e,t,r){this.#r=e,this.#a=t,s.j.batch((()=>{const e=this.#s,t=this.#u(this.#r);t.forEach((e=>e.observer.setOptions(e.defaultedQueryOptions,r)));const a=t.map((e=>e.observer)),s=a.map((e=>e.getCurrentResult())),n=a.some(((t,r)=>t!==e[r]));(e.length!==a.length||n)&&(this.#s=a,this.#t=s,this.hasListeners()&&(o(e,a).forEach((e=>{e.destroy()})),o(a,e).forEach((e=>{e.subscribe((t=>{this.#o(e,t)}))})),this.#c()))}))}getCurrentResult(){return this.#t}getQueries(){return this.#s.map((e=>e.getCurrentQuery()))}getObservers(){return this.#s}getOptimisticResult(e,t){const r=this.#u(e).map((e=>e.observer.getOptimisticResult(e.defaultedQueryOptions)));return[r,e=>this.#d(e??r,t),()=>this.#p(r,e)]}#p(e,t){const r=this.#u(t);return r.map(((t,a)=>{const s=e[a];return t.defaultedQueryOptions.notifyOnChangeProps?s:t.observer.trackResult(s,(e=>{r.forEach((t=>{t.observer.trackProp(e)}))}))}))}#d(e,t){return t?(this.#n&&this.#t===this.#l&&t===this.#i||(this.#i=t,this.#l=this.#t,this.#n=(0,l.BH)(this.#n,t(e))),this.#n):e}#u(e){const t=new Map(this.#s.map((e=>[e.options.queryHash,e]))),r=[];return e.forEach((e=>{const a=this.#e.defaultQueryOptions(e),s=t.get(a.queryHash);if(s)r.push({defaultedQueryOptions:a,observer:s});else{const e=this.#s.find((e=>e.options.queryHash===a.queryHash));r.push({defaultedQueryOptions:a,observer:e??new n.$(this.#e,a)})}})),r.sort(((t,r)=>e.findIndex((e=>e.queryHash===t.defaultedQueryOptions.queryHash))-e.findIndex((e=>e.queryHash===r.defaultedQueryOptions.queryHash))))}#o(e,t){const r=this.#s.indexOf(e);-1!==r&&(this.#t=function(e,t,r){const a=e.slice(0);return a[t]=r,a}(this.#t,r,t),this.#c())}#c(){this.hasListeners()&&this.#n!==this.#d(this.#p(this.#t,this.#r),this.#a?.combine)&&s.j.batch((()=>{this.listeners.forEach((e=>{e(this.#t)}))}))}},c=r(3715),d=r(57860),p=r(57202),m=r(23500),h=r(26737),b=r(908);function y({queries:e,...t},r){const i=(0,c.jE)(r),l=(0,d.w)(),o=(0,p.h)(),y=a.useMemo((()=>e.map((e=>{const t=i.defaultQueryOptions(e);return t._optimisticResults=l?"isRestoring":"optimistic",t}))),[e,i,l]);y.forEach((e=>{(0,h.jv)(e),(0,m.LJ)(e,o)})),(0,m.wZ)(o);const[f]=a.useState((()=>new u(i,y,t))),[v,g,E]=f.getOptimisticResult(y,t.combine);a.useSyncExternalStore(a.useCallback((e=>l?b.l:f.subscribe(s.j.batchCalls(e))),[f,l]),(()=>f.getCurrentResult()),(()=>f.getCurrentResult())),a.useEffect((()=>{f.setQueries(y,t,{listeners:!1})}),[y,t,f]);const S=v.some(((e,t)=>(0,h.EU)(y[t],e)))?v.flatMap(((e,t)=>{const r=y[t];if(r){const t=new n.$(i,r);if((0,h.EU)(r,e))return(0,h.iL)(r,t,o);(0,h.nE)(e,l)&&(0,h.iL)(r,t,o)}return[]})):[];if(S.length>0)throw Promise.all(S);const q=v.find(((e,t)=>{const r=y[t];return r&&(0,m.$1)({result:e,errorResetBoundary:o,throwOnError:r.throwOnError,query:i.getQueryCache().get(r.queryHash)})}));if(q?.error)throw q.error;return g(E())}}}]);
//# sourceMappingURL=403.7fb5945f.min.js.map