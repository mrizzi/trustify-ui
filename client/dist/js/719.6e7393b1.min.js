"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[719],{16177:(e,t,r)=>{r.d(t,{a:()=>n});var a=r(63696),l=r(93962);const n=({value:e})=>a.createElement(a.Fragment,null,Object.entries(e).map((([e,t],r)=>a.createElement(l.J,{key:r,isCompact:!0},`${e}=${t}`))))},23560:(e,t,r)=>{r.d(t,{j:()=>l});var a=r(63696);const l=({vulnerability:e})=>a.createElement("p",null,e.withdrawn&&a.createElement("em",null,"Rejected:Â "),e.title||e.description)},68248:(e,t,r)=>{r.d(t,{f:()=>o});var a=r(63696),l=r(74932);const n=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,i={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},o=e=>{const{vulnerability:t,isFetching:r,fetchError:o}=(0,l.uN)(e);return{data:a.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.sboms??[]).flatMap((t=>Object.entries(t.purl_statuses||{}).map((([r,a])=>({sbom:{...t},sbomStatus:r,advisory:e,packages:a}))))).reduce(((e,t)=>{const r=e.find((e=>n(e,t)));if(r)return[...e.filter((e=>!n(e,r))),{...r,relatedPackages:[...r.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const r={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,r]}}),[]))),r=t.reduce(((e,t)=>{const r=t.sbomStatus;return{...e,total:e.total+1,sbomStatus:{...e.sbomStatus,[r]:e.sbomStatus[r]+1}}}),i);return{sboms:t,summary:r}})(t?.advisories||[])),[t]),isFetching:r,fetchError:o}}},9366:(e,t,r)=>{r.d(t,{$:()=>s});var a=r(63696),l=r(17993);const n=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,i={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:{...i},fixed:{...i},not_affected:{...i},known_not_affected:{...i}}},s=e=>{const{pkg:t,isFetching:r,fetchError:i}=(0,l.Si)(e);return{data:a.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:{...t.vulnerability,average_severity:t.average_severity},vulnerabilityStatus:t.status,advisory:e}))).reduce(((e,t)=>{const r=e.find((e=>n(e,t)));if(r)return[...e.filter((e=>!n(e,r))),{...r,relatedSboms:[...r.relatedSboms,{advisory:t.advisory}]}];{const r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};return[...e,r]}}),[]))),r=t.reduce(((e,t)=>{const r=t.vulnerabilityStatus,a=t.vulnerability.average_severity,l=e.vulnerabilityStatus[r];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:l.total+1,severities:{...l.severities,[a]:l.severities[a]+1}}}}}),o);return{vulnerabilities:t,summary:r}})(t?.advisories||[])),[t]),isFetching:r,fetchError:i}}},7602:(e,t,r)=>{r.d(t,{R:()=>c,r:()=>u});var a=r(63696),l=r(87043),n=r(86820),i=r(70611),o=r(5098),s=r(69935);const c=a.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"advisory",persistenceKeyPrefix:n.rt.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],isFilterEnabled:!0,filterCategories:[{categoryKey:n._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:l.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:r,total:u},isFetching:d,fetchError:m}=(0,s.VH)((0,i.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),y=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:r,totalItemCount:u,isLoading:d,selectionState:(0,o.$)({items:r,isEqual:(e,t)=>e.identifier===t.identifier})});return a.createElement(c.Provider,{value:{totalItemCount:u,isFetching:d,fetchError:m,tableControls:y}},e)}},7123:(e,t,r)=>{r.d(t,{q:()=>g});var a=r(63696),l=r(49348),n=r(40319),i=r(16646),o=r(9425),s=r(77819),c=r(28516),u=r(3629),d=r(62101),m=r(50705),y=r(1349),p=r(62520),E=r(91271),v=r(52302),h=r(28644),b=r(34066),f=r(7602);const g=({})=>{const{isFetching:e,fetchError:t,totalItemCount:r,tableControls:g}=a.useContext(f.R),{pushNotification:C}=a.useContext(m.K),{numRenderedColumns:P,currentPageItems:S,propHelpers:{paginationProps:T,tableProps:F,getThProps:k,getTrProps:K,getTdProps:x},expansionDerivedState:{isCellExpanded:w}}=g,{downloadAdvisory:R}=(0,E.m)();return a.createElement(a.Fragment,null,a.createElement(n.X,{...F,"aria-label":"advisory-table"},a.createElement(i.d,null,a.createElement(o.Tr,null,a.createElement(p.Ze,{...g},a.createElement(s.Th,{...k({columnKey:"identifier"})}),a.createElement(s.Th,{...k({columnKey:"title"})}),a.createElement(s.Th,{...k({columnKey:"severity"})}),a.createElement(s.Th,{...k({columnKey:"modified"})}),a.createElement(s.Th,{...k({columnKey:"vulnerabilities"})})))),a.createElement(p.nJ,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:P},S.map(((e,t)=>{const r=e.vulnerabilities.reduce(((e,t)=>({...e,[t.severity]:e[t.severity]+1})),{critical:0,high:0,medium:0,low:0,none:0});return a.createElement(c.N,{key:e.identifier,isExpanded:w(e)},a.createElement(o.Tr,{...K({item:e})},a.createElement(p.Oi,{...g,item:e,rowIndex:t},a.createElement(u.Td,{width:15,...x({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},a.createElement(l.k2,{to:`/advisories/${e.uuid}`},e.document_id)),a.createElement(u.Td,{width:40,modifier:"truncate",...x({columnKey:"title"})},e.title),a.createElement(u.Td,{width:15,modifier:"truncate",...x({columnKey:"severity"})},e.average_severity&&a.createElement(v.h,{value:e.average_severity})),a.createElement(u.Td,{width:10,...x({columnKey:"modified"})},(0,b.Yq)(e.modified)),a.createElement(u.Td,{width:20,...x({columnKey:"vulnerabilities"})},a.createElement(h.n,{severities:r})),a.createElement(u.Td,{isActionCell:!0},a.createElement(d.G,{items:[{title:"Download",onClick:()=>{R(e.uuid,`${e.identifier}.json`)}}]})))))})))),a.createElement(y.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:T}))}},30426:(e,t,r)=>{r.d(t,{Y:()=>u,a:()=>d});var a=r(63696),l=r(87043),n=r(86820),i=r(70611),o=r(5098),s=r(17993),c=r(34066);const u=a.createContext({}),d=({children:e})=>{const t=(0,i.MM)({tableName:"packages",persistenceKeyPrefix:n.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:n._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:l.RJ.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:l.RJ.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:r,total:d},isFetching:m,fetchError:y}=(0,s.Lx)((0,i.Ng)({...t,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),p=a.useMemo((()=>r.map((e=>({...e,decomposedPurl:(0,c.fe)(e.purl)})))),[r]),E=(0,i.PB)({...t,idProperty:"uuid",currentPageItems:p,totalItemCount:d,isLoading:m,selectionState:(0,o.$)({items:p,isEqual:(e,t)=>e.uuid===t.uuid})});return a.createElement(u.Provider,{value:{totalItemCount:d,isFetching:m,fetchError:y,tableControls:E}},e)}},17170:(e,t,r)=>{r.d(t,{N:()=>C});var a=r(63696),l=r(49348),n=r(40319),i=r(16646),o=r(9425),s=r(77819),c=r(28516),u=r(3629),d=r(16177),m=r(1349),y=r(62520),p=r(36509),E=r(93962),v=r(24417),h=r(28644),b=r(9366);const f=({packageId:e})=>{const{data:t,isFetching:r,fetchError:l}=(0,b.$)(e);return a.createElement(v.a,{isFetching:r,fetchError:l,isFetchingState:a.createElement(p.E,{screenreaderText:"Loading contents"}),fetchErrorState:a.createElement(E.J,{color:"red"},"Error")},a.createElement(h.n,{severities:t.summary.vulnerabilityStatus.affected.severities}))};var g=r(30426);const C=()=>{const{isFetching:e,fetchError:t,totalItemCount:r,tableControls:p}=a.useContext(g.Y),{numRenderedColumns:E,currentPageItems:v,propHelpers:{paginationProps:h,tableProps:b,getThProps:C,getTrProps:P,getTdProps:S},expansionDerivedState:{isCellExpanded:T}}=p;return a.createElement(a.Fragment,null,a.createElement(n.X,{...b,"aria-label":"Package table"},a.createElement(i.d,null,a.createElement(o.Tr,null,a.createElement(y.Ze,{...p},a.createElement(s.Th,{...C({columnKey:"name"})}),a.createElement(s.Th,{...C({columnKey:"namespace"})}),a.createElement(s.Th,{...C({columnKey:"version"})}),a.createElement(s.Th,{...C({columnKey:"type"})}),a.createElement(s.Th,{...C({columnKey:"path"})}),a.createElement(s.Th,{...C({columnKey:"qualifiers"})}),a.createElement(s.Th,{...C({columnKey:"vulnerabilities"})})))),a.createElement(y.nJ,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:E},v.map(((e,t)=>a.createElement(c.N,{key:e.uuid},a.createElement(o.Tr,{...P({item:e})},a.createElement(y.Oi,{...p,item:e,rowIndex:t},a.createElement(u.Td,{width:15,...S({columnKey:"name"})},a.createElement(l.k2,{to:`/packages/${e.uuid}`},e.decomposedPurl?e.decomposedPurl?.name:e.purl)),a.createElement(u.Td,{width:15,modifier:"truncate",...S({columnKey:"namespace"})},e.decomposedPurl?.namespace),a.createElement(u.Td,{width:10,modifier:"truncate",...S({columnKey:"version"})},e.decomposedPurl?.version),a.createElement(u.Td,{width:10,modifier:"truncate",...S({columnKey:"type"})},e.decomposedPurl?.type),a.createElement(u.Td,{width:10,modifier:"truncate",...S({columnKey:"path"})},e.decomposedPurl?.path),a.createElement(u.Td,{width:20,...S({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&a.createElement(d.a,{value:e.decomposedPurl?.qualifiers})),a.createElement(u.Td,{width:20,...S({columnKey:"vulnerabilities"})},a.createElement(f,{packageId:e.uuid}))))))))),a.createElement(m.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:h}))}},5209:(e,t,r)=>{r.r(t),r.d(t,{default:()=>be});var a=r(63696),l=r(68430),n=r(20653),i=r(35048),o=r(56918),s=r(1180),c=r(72785),u=r(4433),d=r(86820),m=r(49348),y=r(68792),p=r(93962),E=r(60876),v=r(51522),h=r(65841),b=r(99135),f=r(66174),g=r(66129),C=r(98851),P=r(36390),S=r(69935),T=r(17993),F=r(91728),k=r(74932);const K=e=>a.createElement(m.N_,{key:e.id,to:e.navLink,style:{textDecoration:"none"}},a.createElement(y.D,{itemId:e.id,description:e.description},e.title," ",a.createElement(p.J,{color:e.typeColor},e.type))),x=({onChangeSearch:e})=>{const{tableControls:t}=a.useContext(P.L),r=t.filterState.filterValues[d._G]?.[0]||"",[l,n]=a.useState(r),[i,o]=a.useState(!1),[s,c]=(0,C.Q3)(l,500);a.useEffect((()=>{c(l)}),[c,l]);const{isFetching:u,list:m}=function(e,t){const r={filters:[{field:d._G,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:a,result:{data:l}}=(0,S.VH)({...r},!0,t),{isFetching:n,result:{data:i}}=(0,T.Lx)({...r},!0,t),{isFetching:o,result:{data:s}}=(0,F.i$)({...r},!0,t),{isFetching:c,result:{data:u}}=(0,k.WJ)({...r},!0,t),m=l.map((e=>({id:`advisory-${e.uuid}`,title:e.document_id,description:e.title?.substring(0,75),navLink:`/advisories/${e.uuid}`,type:"Advisory",typeColor:"blue"}))),y=i.map((e=>({id:`package-${e.uuid}`,title:e.purl,navLink:`/packages/${e.uuid}`,type:"Package",typeColor:"cyan"}))),p=s.map((e=>({id:`sbom-${e.id}`,title:e.name,description:e.authors.join(", "),navLink:`/sboms/${e.id}`,type:"SBOM",typeColor:"purple"}))),E=u.map((e=>({id:`vulnerability-${e.identifier}`,title:e.identifier,description:e.description?.substring(0,75),navLink:`/vulnerabilities/${e.identifier}`,type:"Vulnerability",typeColor:"orange"}))),v=e.toLowerCase();return{isFetching:a||n||o||c,list:[...E,...p,...m,...y].sort(((e,t)=>e.title?.includes(v)?-1:t.title?.includes(v)?1:(e.description||"").toLowerCase().indexOf(v)-(t.description||"").toLowerCase().indexOf(v)))}}(s,!i),[p,x]=a.useState(!1),w=a.useRef(null),R=a.useRef(null);a.useEffect((()=>{const e=e=>{if(p&&w.current&&w.current===e.target)if("Escape"===e.key)x(!1),w.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){const t=R.current?.querySelector("li > button:not(:disabled)");t&&t?.focus(),e.preventDefault()}else"Tab"!==e.key&&"Enter"!==e.key&&"Space"!==e.key||(x(!1),"Enter"!==e.key&&"Space"!==e.key||e.preventDefault());else p&&R.current?.contains(e.target)&&"Tab"===e.key&&(e.preventDefault(),x(!1),w.current?.focus())},t=e=>{p&&R&&R.current&&!R.current.contains(e.target)&&x(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}}),[p]);const I=a.createElement(E.W,{ref:R,style:{maxWidth:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"}},a.createElement(v.r,null,a.createElement(h.c,null,u?a.createElement(y.D,{itemId:"loading"},a.createElement(b.y,{size:"sm"})):m.map(K)))),V=a.createElement(f.D,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:l,onChange:(e,t)=>{return""!==(r=t)&&w&&w.current&&w.current.contains(document.activeElement)?x(!0):x(!1),n(r),void o(!0);var r},onClear:()=>{n("")},onSearch:()=>{e(l)},onKeyDown:e=>{!e.key||e.key},ref:w,id:"autocomplete-search"});return a.createElement(g.N,{trigger:V,triggerRef:w,popper:I,popperRef:R,isVisible:p&&m.length>0||u,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var w=r(30426),R=r(14310),I=r(7602);function V(e,t){return{Component:e,props:t}}const D=[V(P.c,{}),V(w.a,{}),V(R.y,{}),V(I.r,{})],L=(_=D,({children:e})=>{const t=a.createElement(a.Fragment,null,e);return _.reduceRight(((e,{Component:t,props:r={}})=>a.createElement(t,{...r},e)),t)});var _,q=r(69673),N=r(54518),M=r(48281),$=r(17327),O=r(71603),J=r(16459),A=r(71592),Y=r(40111),B=r(96178),H=r(70414),G=r(38914),j=r(57901),W=r(77635),z=r(87043),X=r(58897),Z=r(71273),Q=r(51463);const U=({category:e,filterValue:t,setFilterValue:r,isNumeric:l,isDisabled:n=!1})=>{const[i,o]=a.useState(t?.[0]||"");a.useEffect((()=>{o(t?.[0]||"")}),[t]);const s=()=>{const e=i.trim();r(e?[e.replace(/\s+/g," ")]:[])},c=`${e.categoryKey}-input`;return a.createElement(X.M,null,a.createElement(Z.ks,{name:c,id:"search-input",type:l?"number":"search",onChange:(e,t)=>o(t),"aria-label":`${e.title} filter`,value:i,placeholder:e.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||s()},isDisabled:n}),a.createElement(W.$n,{variant:W.Ak.control,id:"search-button","aria-label":"search button for search input",onClick:s,isDisabled:n},a.createElement(Q.Ay,null)))};var ee=r(37847);const te=({category:e,filterValue:t,setFilterValue:r,isDisabled:l=!1})=>a.createElement(a.Fragment,null,e.selectOptions.map((({label:n,value:i,optionProps:o={}},s)=>{const c=t?.includes(i)||!1;return a.createElement(ee.s,{isDisabled:l,key:s,id:`radio-${s}`,name:"radio",isLabelWrapped:!0,label:n,isChecked:c,onChange:()=>{(t=>{const a=(l=t,e.selectOptions.find((({value:e})=>e===l)));var l;r(a?[t]:null)})(i)}})})));var re=r(58365);const ae=({category:e,filterValue:t,setFilterValue:r,isDisabled:l=!1})=>{const[n,i]=a.useState(Array.isArray(e.selectOptions)?e.selectOptions:[]);a.useEffect((()=>{i(Array.isArray(e.selectOptions)?e.selectOptions:[])}),[e.selectOptions]);const o=Array.isArray(n)?n:Object.values(n).flatMap((e=>e));return a.createElement(a.Fragment,null,o.map((({label:l,value:n,optionProps:i={}},o)=>a.createElement(re.S,{key:o,id:`checkbox-${o}-${e.categoryKey}`,isLabelWrapped:!0,label:l,isChecked:t?.includes(n),onChange:()=>{(e=>{if(e&&"No results"!==e){let a;a=t&&t.includes(e)?t.filter((t=>t!==e)):t?[...t,e]:[e],r(a)}})(n)}}))))};var le=r(46721),ne=r(40360),ie=r(23277),oe=r(78109),se=r(66341);const ce=({category:e,filterValue:t,setFilterValue:r,isDisabled:l=!1})=>{const n=t??[],[i,o]=(n?.filter((e=>(0,se.Ce)((0,se.P1)(e)))),(0,a.useState)()),[s,c]=(0,a.useState)();return a.useEffect((()=>{if(t?.[0]){const[e,r]=(0,se.P1)(t?.[0]);o(e.toDate()),c(r.toDate())}else o(void 0),c(void 0)}),[t]),a.createElement(le.l,null,a.createElement(ne.g,{role:"group",isInline:!0,label:"From"},a.createElement(ie.l,{value:i?(0,se.ak)(i):"",dateFormat:se.ak,dateParse:se.sy,onChange:(e,t)=>{(0,se.Fz)(t)&&(o((0,se.sy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:l})),a.createElement(ne.g,{role:"group",isInline:!0,label:"To"},a.createElement(ie.l,{value:s?(0,se.ak)(s):"",onChange:(e,t)=>{if((0,se.Fz)(t)){const e=(0,se.sy)(t);c(e);const a=(0,se.Kg)(i,e);a&&r([a])}},isDisabled:l||!(0,oe.v)(i),dateFormat:se.ak,dateParse:se.sy,invalidFormatText:"",rangeStart:i,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})))},ue=({category:e,...t})=>e.type===z.RJ.select?a.createElement(te,{category:e,...t}):e.type===z.RJ.search||e.type===z.RJ.numsearch?a.createElement(U,{category:e,isNumeric:e.type===z.RJ.numsearch,...t}):e.type===z.RJ.multiselect?a.createElement(ae,{category:e,...t}):e.type===z.RJ.dateRange?a.createElement(ce,{category:e,...t}):null,de=({filterCategories:e,filterValues:t,setFilterValues:r,isDisabled:l=!1,omitFilterCategoryKeys:n=[]})=>a.createElement(a.Fragment,null,a.createElement(G.B,{hasGutter:!0},a.createElement(j.a,null,a.createElement(W.$n,{variant:"link",isInline:!0,onClick:()=>{const a=e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).reduce(((e,t)=>({...e,[t.categoryKey]:void 0})),{});r({...t,...a})}},"Clear all filters")),e.filter((e=>void 0===n.find((t=>t===e.categoryKey)))).map((e=>a.createElement(j.a,{key:e.categoryKey},a.createElement(G.B,{hasGutter:!0},a.createElement(j.a,null,a.createElement(s.n,null,a.createElement(c.E,{component:"h4"},e.title))),a.createElement(j.a,null,a.createElement(ue,{category:e,filterValue:t[e.categoryKey],setFilterValue:a=>((e,a)=>r({...t,[e.categoryKey]:a}))(e,a),isDisabled:l,isSidebar:!0}))))))));var me=r(7123),ye=r(17170),pe=r(48989),Ee=r(86416),ve=r(8210);const he=({filterPanelProps:e,sbomTable:t,sbomTotalCount:r,packageTable:l,packageTotalCount:n,vulnerabilityTable:i,vulnerabilityTotalCount:o,advisoryTable:s,advisoryTotalCount:c})=>{const[u,d]=a.useState(0),{sbomFilterPanelProps:m,packageFilterPanelProps:y,vulnerabilityFilterPanelProps:p,advisoryFilterPanelProps:E}=e,v=a.createRef();return a.createElement(N.B,{hasGutter:!0},a.createElement(M.o,null,a.createElement($.Z,{isFullHeight:!0},a.createElement(O.b,{style:{width:241}},0===u?a.createElement(de,{omitFilterCategoryKeys:[""],...m}):1===u?a.createElement(de,{omitFilterCategoryKeys:[""],...y}):2===u?a.createElement(de,{omitFilterCategoryKeys:[""],...p}):3===u?a.createElement(de,{omitFilterCategoryKeys:[""],...E}):null))),a.createElement(M.o,{isFilled:!0},a.createElement(J.t,{mountOnEnter:!0,isBox:!0,activeKey:u,onSelect:(e,t)=>{d(t)},"aria-label":"Tabs",role:"region"},a.createElement(A.o,{eventKey:0,title:a.createElement(Y.V,null,"SBOMs","  ",a.createElement(B.E,{screenReaderText:"Search Result Count"},r)),actions:a.createElement(a.Fragment,null,a.createElement(H.o,{"aria-label":"SBOM help popover",ref:v},a.createElement(ve.Ay,null)),(h=v,a.createElement(q.A,{bodyContent:a.createElement("div",null,"Software Bill of Materials for Products and Containers."),position:"right",triggerRef:h})))},t??a.createElement(pe.Y,null)),a.createElement(A.o,{eventKey:1,title:a.createElement(Y.V,null,"Packages","  ",a.createElement(B.E,{screenReaderText:"Search Result Count"},n))},l??a.createElement(ye.N,null)),a.createElement(A.o,{eventKey:2,title:a.createElement(Y.V,null,"Vulnerabilities","  ",a.createElement(B.E,{screenReaderText:"Search Result Count"},o))},i??a.createElement(Ee.f,null)),a.createElement(A.o,{eventKey:3,title:a.createElement(Y.V,null,"Advisories","  ",a.createElement(B.E,{screenReaderText:"Advisory Result Count"},c))},s??a.createElement(me.q,null)))));var h},be=({searchBodyOverride:e})=>a.createElement(L,null,a.createElement(fe,{searchBodyOverride:e})),fe=({searchBodyOverride:e})=>{const{tableControls:t}=a.useContext(P.L),{tableControls:r}=a.useContext(w.Y),{tableControls:m}=a.useContext(R.u),{tableControls:y}=a.useContext(I.R),{totalItemCount:p,tableControls:{propHelpers:{filterPanelProps:E}}}=a.useContext(P.L),{totalItemCount:v,tableControls:{propHelpers:{filterPanelProps:h}}}=a.useContext(w.Y),{totalItemCount:b,tableControls:{propHelpers:{filterPanelProps:f}}}=a.useContext(R.u),{totalItemCount:g,tableControls:{propHelpers:{filterPanelProps:C}}}=a.useContext(I.R),S={advisoryFilterPanelProps:C,packageFilterPanelProps:h,sbomFilterPanelProps:E,vulnerabilityFilterPanelProps:f},T=a.createElement(he,{filterPanelProps:S,packageTotalCount:v,sbomTotalCount:p,vulnerabilityTotalCount:b,advisoryTotalCount:g});return a.createElement(a.Fragment,null,a.createElement(l.d8,{variant:l.zC.light},a.createElement(n.M,{isStatic:!0},a.createElement(i.P,null,a.createElement(o.$,{align:{default:"alignLeft"}},a.createElement(s.n,null,a.createElement(c.E,{component:"h1"},"Search Results"))),a.createElement(o.$,{variant:"icon-button-group",align:{default:"alignRight"}},a.createElement(o.$,{visibility:{default:"hidden",lg:"visible"}},a.createElement(u.T,{widths:{default:"500px"}},a.createElement(x,{onChangeSearch:e=>{null!=e&&(t.filterState.setFilterValues({...t.filterState.filterValues,[d._G]:[e]}),r.filterState.setFilterValues({...r.filterState.filterValues,[d._G]:[e]}),m.filterState.setFilterValues({...m.filterState.filterValues,[d._G]:[e]}),y.filterState.setFilterValues({...y.filterState.filterValues,[d._G]:[e]}))}}))))))),a.createElement(l.d8,null,e||T))}},14310:(e,t,r)=>{r.d(t,{u:()=>c,y:()=>u});var a=r(63696),l=r(87043),n=r(86820),i=r(70611),o=r(5098),s=r(74932);const c=a.createContext({}),u=({children:e})=>{const t=(0,i.MM)({tableName:"vulnerability",persistenceKeyPrefix:n.rt.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Related documents"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published","severity"],isFilterEnabled:!0,filterCategories:[{categoryKey:n._G,title:"Filter text",placeholderText:"Search",type:l.RJ.search},{categoryKey:"average_severity",title:"CVSS",placeholderText:"CVSS",type:l.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:l.RJ.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:r,total:u},isFetching:d,fetchError:m}=(0,s.WJ)((0,i.Ng)({...t,hubSortFieldKeys:{severity:"average_severity",published:"published"}})),y=(0,i.PB)({...t,idProperty:"identifier",currentPageItems:r,totalItemCount:u,isLoading:d,selectionState:(0,o.$)({items:r,isEqual:(e,t)=>e.identifier===t.identifier})});return a.createElement(c.Provider,{value:{totalItemCount:u,isFetching:d,fetchError:m,tableControls:y}},e)}},86416:(e,t,r)=>{r.d(t,{f:()=>P});var a=r(63696),l=r(49348),n=r(40319),i=r(16646),o=r(9425),s=r(77819),c=r(28516),u=r(3629),d=r(52302),m=r(1349),y=r(62520),p=r(23560),E=r(34066),v=r(36509),h=r(93962),b=r(24417),f=r(68248);const g=({vulnerabilityId:e})=>{const{data:t,isFetching:r,fetchError:l}=(0,f.f)(e);return a.createElement(b.a,{isFetching:r,fetchError:l,isFetchingState:a.createElement(v.E,{screenreaderText:"Loading contents"}),fetchErrorState:a.createElement(h.J,{color:"red"},"Error")},t.summary.sbomStatus.affected)};var C=r(14310);const P=()=>{const{isFetching:e,fetchError:t,totalItemCount:r,tableControls:v}=a.useContext(C.u),{numRenderedColumns:h,currentPageItems:b,propHelpers:{paginationProps:f,tableProps:P,getThProps:S,getTrProps:T,getTdProps:F}}=v;return a.createElement(a.Fragment,null,a.createElement(n.X,{...P,"aria-label":"Vulnerability table"},a.createElement(i.d,null,a.createElement(o.Tr,null,a.createElement(y.Ze,{...v},a.createElement(s.Th,{...S({columnKey:"identifier"})}),a.createElement(s.Th,{...S({columnKey:"title"})}),a.createElement(s.Th,{...S({columnKey:"severity"})}),a.createElement(s.Th,{...S({columnKey:"published"})}),a.createElement(s.Th,{...S({columnKey:"sboms"})})))),a.createElement(y.nJ,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:h},b.map(((e,t)=>a.createElement(c.N,{key:e.identifier},a.createElement(o.Tr,{...T({item:e})},a.createElement(y.Oi,{...v,item:e,rowIndex:t},a.createElement(u.Td,{width:15,...F({columnKey:"identifier",item:e,rowIndex:t})},a.createElement(l.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),a.createElement(u.Td,{width:45,modifier:"truncate",...F({columnKey:"title"})},a.createElement(p.j,{vulnerability:e})),a.createElement(u.Td,{width:10,...F({columnKey:"severity"})},e.average_severity&&a.createElement(d.h,{value:e.average_severity})),a.createElement(u.Td,{width:10,...F({columnKey:"published"})},(0,E.Yq)(e.published)),a.createElement(u.Td,{width:10,...F({columnKey:"sboms",item:e,rowIndex:t})},a.createElement(g,{vulnerabilityId:e.identifier}))))))))),a.createElement(m.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:f}))}},69935:(e,t,r)=>{r.d(t,{VH:()=>d,Yu:()=>y,vy:()=>m});var a=r(39155),l=r(3715),n=r(77347),i=r(40752),o=r(81230),s=r(70611),c=r(24808);const u="advisories",d=(e={},t=!1,r=!1)=>{const{data:l,isLoading:o,error:c,refetch:d}=(0,a.I)({queryKey:[u,e],queryFn:()=>(0,i.YM)({client:n.S,query:{...(0,s.kd)(e)}}),refetchInterval:!t&&5e3,enabled:!r});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e??e},isFetching:o,fetchError:c||null,refetch:d}},m=e=>{const{data:t,isLoading:r,error:l}=(0,a.I)({queryKey:[u,e],queryFn:()=>(0,i.ai)({client:n.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:r,fetchError:l}},y=()=>{const e=(0,l.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,t)=>(0,o.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[u]})}})}},17993:(e,t,r)=>{r.d(t,{Lx:()=>s,Si:()=>c,sl:()=>u});var a=r(39155),l=r(77347),n=r(40752),i=r(70611);const o="packages",s=(e={},t=!1,r=!1)=>{const{data:s,isLoading:c,error:u,refetch:d}=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.UD)({client:l.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3,enabled:!r});return{result:{data:s?.data?.items||[],total:s?.data?.total??0,params:e},isFetching:c,fetchError:u,refetch:d}},c=e=>{const{data:t,isLoading:r,error:i}=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.Y0)({client:l.S,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:i}},u=(e,t={})=>{const{data:r,isLoading:s,error:c,refetch:u}=(0,a.I)({queryKey:[o,"by-sbom",e,t],queryFn:()=>(0,n.Ad)({client:l.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:s,fetchError:c,refetch:u}}},74932:(e,t,r)=>{r.d(t,{WJ:()=>s,uN:()=>c});var a=r(39155),l=r(77347),n=r(40752),i=r(70611);const o="vulnerabilities",s=(e={},t=!1,r=!1)=>{const{data:s,isLoading:c,error:u,refetch:d}=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.NI)({client:l.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3,enabled:!r});return{result:{data:s?.data?.items||[],total:s?.data?.total??0,params:e},isFetching:c,fetchError:u,refetch:d}},c=e=>{const{data:t,isLoading:r,error:i}=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.wk)({client:l.S,path:{id:e}})});return{vulnerability:t?.data,isFetching:r,fetchError:i}}}}]);
//# sourceMappingURL=719.6e7393b1.min.js.map