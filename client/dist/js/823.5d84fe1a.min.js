(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[823],{93914:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>n});const n=(0,a(32791).w)({name:"ShieldAltIcon",height:512,width:512,svgPath:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z",yOffset:0,xOffset:0})},86361:(e,t,a)=>{"use strict";a.d(t,{u:()=>n});const n={name:"--pf-v5-global--danger-color--100",value:"#c9190b",var:"var(--pf-v5-global--danger-color--100)"}},19174:(e,t,a)=>{"use strict";a.d(t,{n:()=>n});const n={name:"--pf-v5-global--info-color--100",value:"#2b9af3",var:"var(--pf-v5-global--info-color--100)"}},29405:(e,t,a)=>{"use strict";a.d(t,{G:()=>n});const n={name:"--pf-v5-global--palette--black-300",value:"#d2d2d2",var:"var(--pf-v5-global--palette--black-300)"}},44304:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});const n={name:"--pf-v5-global--palette--black-400",value:"#b8bbbe",var:"var(--pf-v5-global--palette--black-400)"}},53359:(e,t,a)=>{"use strict";a.d(t,{c:()=>n});const n={name:"--pf-v5-global--palette--purple-400",value:"#8476d1",var:"var(--pf-v5-global--palette--purple-400)"}},53820:(e,t,a)=>{"use strict";a.d(t,{H:()=>n});const n={name:"--pf-v5-global--warning-color--100",value:"#f0ab00",var:"var(--pf-v5-global--warning-color--100)"}},22249:function(e,t,a){var n,r;void 0===(r="function"==typeof(n=function(){"use strict";function t(e,t,a){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){i(n.response,t,a)},n.onerror=function(){console.error("could not download file")},n.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,o=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,a,o){var i=l.URL||l.webkitURL,s=document.createElement("a");a=a||e.name||"download",s.download=a,s.rel="noopener","string"==typeof e?(s.href=e,s.origin===location.origin?r(s):n(s.href)?t(e,a,o):r(s,s.target="_blank")):(s.href=i.createObjectURL(e),setTimeout((function(){i.revokeObjectURL(s.href)}),4e4),setTimeout((function(){r(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,l){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,l),a);else if(n(e))t(e,a,l);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout((function(){r(o)}))}}:function(e,a,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return t(e,a,n);var i="application/octet-stream"===e.type,s=/constructor/i.test(l.HTMLElement)||l.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||i&&s||o)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},d.readAsDataURL(e)}else{var u=l.URL||l.webkitURL,p=u.createObjectURL(e);r?r.location=p:location.href=p,r=null,setTimeout((function(){u.revokeObjectURL(p)}),4e4)}});l.saveAs=i.saveAs=i,e.exports=i})?n.apply(t,[]):n)||(e.exports=r)},55399:(e,t,a)=>{"use strict";a.d(t,{Kb:()=>c,Sx:()=>u,YT:()=>d});var n=a(29405),r=a(44304),l=a(19174),o=a(53820),i=a(86361),s=a(53359);const c={unknown:{name:"Unknown",color:n.G,progressProps:{variant:void 0}},none:{name:"None",color:r.p,progressProps:{variant:void 0}},low:{name:"Low",color:l.n,progressProps:{variant:void 0}},medium:{name:"Medium",color:o.H,progressProps:{variant:"warning"}},high:{name:"High",color:i.u,progressProps:{variant:"danger"}},critical:{name:"Critical",color:s.c,progressProps:{variant:"danger"}}},d=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function u(e){return(t,a)=>d(e(t))-d(e(a))}},37378:(e,t,a)=>{"use strict";a.d(t,{U:()=>n});const n=e=>e??"unknown"},81230:(e,t,a)=>{"use strict";a.d(t,{J4:()=>d,hP:()=>c});var n=a(64917),r=a(86820);a(63260);const l="/api",o=l+"/v2/advisory",i=l+"/v2/sbom",s=e=>{let t="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(t="application/json+bzip2"),t},c=(e,t)=>{const a=e.get(r.fs);return n.A.post(`${o}`,a,{...t,headers:{"Content-Type":s(a)}})},d=(e,t)=>{const a=e.get(r.fs);return n.A.post(`${i}`,a,{...t,headers:{"Content-Type":s(a)}})}},52302:(e,t,a)=>{"use strict";a.d(t,{h:()=>c});var n=a(63696),r=a(28338),l=a(70045),o=a(26615),i=a(93914),s=a(55399);const c=({value:e,hideLabel:t})=>{const a=s.Kb[e],c=a.name;return n.createElement(r.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},n.createElement(l.Z,null,t?n.createElement(o.m,{content:c},n.createElement(i.Ay,{color:a.color.value})):n.createElement(i.Ay,{color:a.color.value})),!t&&n.createElement(l.Z,null,c))}},1349:(e,t,a)=>{"use strict";a.d(t,{n:()=>l});var n=a(63696),r=a(84348);const l=({paginationProps:e,isTop:t,isCompact:a=!1,noMargin:l=!1,idPrefix:o=""})=>n.createElement(r.d,{id:`${o?`${o}-`:""}pagination-${t?"top":"bottom"}`,variant:t?r.A.top:r.A.bottom,isCompact:a,...e,widgetId:"pagination-id"})},75855:(e,t,a)=>{"use strict";a.d(t,{q:()=>d});var n=a(63696),r=a(63863),l=a(97157),o=a(2408),i=a(92411),s=a(60087),c=a(45960);const d=()=>n.createElement(r.p,{variant:r.s.sm},n.createElement(l.q,{icon:s.Ay,color:c.D.value}),n.createElement(o.h,{headingLevel:"h2",size:"lg"},"Unable to connect"),n.createElement(i.h,null,"There was an error retrieving data. Check your connection and try again."))},62520:(e,t,a)=>{"use strict";a.d(t,{nJ:()=>y,Ze:()=>E,Oi:()=>b});var n=a(63696),r=a(59394),l=a(99135),o=a(28516),i=a(9425),s=a(3629),c=a(75855),d=a(63863),u=a(97157),p=a(2408),m=a(92411),f=a(28469);const v=({title:e,description:t})=>n.createElement(d.p,{variant:d.s.sm},n.createElement(u.q,{icon:f.Ay}),n.createElement(p.h,{headingLevel:"h2",size:"lg"},e),t&&n.createElement(m.h,null,t)),g=()=>n.createElement(v,{title:"No data available",description:"No data available to be shown here."}),y=({numRenderedColumns:e,isLoading:t=!1,isError:a=!1,isNoData:d=!1,errorEmptyState:u=null,noDataEmptyState:p=null,children:m})=>n.createElement(n.Fragment,null,t?n.createElement(o.N,null,n.createElement(i.Tr,null,n.createElement(s.Td,{colSpan:e},n.createElement(r.a,null,n.createElement(l.y,{size:"xl"}))))):a?n.createElement(o.N,{"aria-label":"Table error"},n.createElement(i.Tr,null,n.createElement(s.Td,{colSpan:e},n.createElement(r.a,null,u||n.createElement(c.q,null))))):d?n.createElement(o.N,{"aria-label":"Table error"},n.createElement(i.Tr,null,n.createElement(s.Td,{colSpan:e},n.createElement(r.a,null,p||n.createElement(g,null))))):m);var h=a(77819);const E=({numColumnsBeforeData:e,numColumnsAfterData:t,children:a})=>n.createElement(n.Fragment,null,Array(e).fill(null).map(((e,t)=>n.createElement(h.Th,{screenReaderText:`before-data-${t}`,key:t}))),a,Array(t).fill(null).map(((e,t)=>n.createElement(h.Th,{screenReaderText:`after-data-${t}`,key:t})))),b=({isExpansionEnabled:e=!1,expandableVariant:t,isSelectionEnabled:a=!1,propHelpers:{getSingleExpandButtonTdProps:r,getSelectCheckboxTdProps:l},item:o,rowIndex:i,children:c})=>n.createElement(n.Fragment,null,e&&"single"===t?n.createElement(s.Td,{...r({item:o,rowIndex:i})}):null,a?n.createElement(s.Td,{...l({item:o,rowIndex:i})}):null,c)},28644:(e,t,a)=>{"use strict";a.d(t,{n:()=>d});var n=a(63696),r=a(28338),l=a(70045),o=a(13867),i=a(86099),s=a(55399),c=a(52302);const d=({severities:e})=>{const t=Object.values(e).reduce(((e,t)=>e+t),0);return n.createElement(r.s,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},n.createElement(l.Z,{style:{minWidth:15,textAlign:i.pG}},t),n.createElement(o.c,{orientation:{default:"vertical"}}),n.createElement(l.Z,null,n.createElement(r.s,null,Object.entries(e).filter((([e,t])=>t>0)).sort((0,s.Sx)((([e,t])=>e))).reverse().map((([e,t],a)=>n.createElement(l.Z,{key:a,spacer:{default:"spacerXs"}},n.createElement(r.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"}},n.createElement(l.Z,null,n.createElement(c.h,{value:e,hideLabel:!0})),n.createElement(l.Z,null,t))))))))}},91271:(e,t,a)=>{"use strict";a.d(t,{m:()=>o});var n=a(22249),r=a(77347),l=a(38595);const o=()=>({downloadAdvisory:(e,t)=>{(0,l.Mu)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,l.K0)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))}})},24808:(e,t,a)=>{"use strict";a.d(t,{v:()=>s});var n=a(63696),r=a(64917),l=a(86820);const o="cancelled",i=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===o})};case"removeUpload":{const a=new Map(e.uploads);return a.delete(t.payload.file),{...e,uploads:a}}default:throw new Error}},s=({parallel:e,uploadFn:t,onSuccess:a,onError:s})=>{const[c,d]=n.useReducer(i,{uploads:new Map});return{uploads:c.uploads,handleUpload:n=>{const i=[];for(let e=0;e<n.length;e++){const t=n[e],c=new FormData;c.set(l.fs,t);const u=r.A.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const a=e.total??1,n=e.loaded/a*100;d({type:"updateUploadProgress",payload:{file:t,progress:Math.round(n)}})},cancelToken:u.token};d({type:"queueUpload",payload:{file:t,cancelFn:u}});const m={formData:c,config:p,thenFn:e=>{d({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),a&&a(e,t)},catchFn:e=>{d({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==o&&s&&s(e,t)}};i.push(m)}e?i.forEach((e=>{t(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):i.reduce((async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(o)},handleRemoveUpload:e=>{d({type:"removeUpload",payload:{file:e}})}}}},7602:(e,t,a)=>{"use strict";a.d(t,{R:()=>c,r:()=>d});var n=a(63696),r=a(87043),l=a(86820),o=a(70611),i=a(5098),s=a(69935);const c=n.createContext({}),d=({children:e})=>{const t=(0,o.MM)({tableName:"advisory",persistenceKeyPrefix:l.rt.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],initialSort:{columnKey:"modified",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:l._G,title:"Filter text",placeholderText:"Search",type:r.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:r.RJ.multiselect,selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:r.RJ.dateRange}],isExpansionEnabled:!1}),{result:{data:a,total:d},isFetching:u,fetchError:p}=(0,s.VH)((0,o.Ng)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),m=(0,o.PB)({...t,idProperty:"identifier",currentPageItems:a,totalItemCount:d,isLoading:u,selectionState:(0,i.$)({items:a,isEqual:(e,t)=>e.identifier===t.identifier})});return n.createElement(c.Provider,{value:{totalItemCount:d,isFetching:u,fetchError:p,tableControls:m}},e)}},7123:(e,t,a)=>{"use strict";a.d(t,{q:()=>w});var n=a(63696),r=a(49348),l=a(40319),o=a(16646),i=a(9425),s=a(77819),c=a(28516),d=a(3629),u=a(62101),p=a(50705),m=a(1349),f=a(62520),v=a(91271),g=a(52302),y=a(28644),h=a(34066),E=a(37378),b=a(7602);const w=({})=>{const{isFetching:e,fetchError:t,totalItemCount:a,tableControls:w}=n.useContext(b.R),{pushNotification:T}=n.useContext(p.K),{numRenderedColumns:C,currentPageItems:x,propHelpers:{paginationProps:k,tableProps:P,getThProps:S,getTrProps:A,getTdProps:F},expansionDerivedState:{isCellExpanded:R}}=w,{downloadAdvisory:U}=(0,v.m)();return n.createElement(n.Fragment,null,n.createElement(l.X,{...P,"aria-label":"advisory-table"},n.createElement(o.d,null,n.createElement(i.Tr,null,n.createElement(f.Ze,{...w},n.createElement(s.Th,{...S({columnKey:"identifier"})}),n.createElement(s.Th,{...S({columnKey:"title"})}),n.createElement(s.Th,{...S({columnKey:"severity"})}),n.createElement(s.Th,{...S({columnKey:"modified"})}),n.createElement(s.Th,{...S({columnKey:"vulnerabilities"})})))),n.createElement(f.nJ,{isLoading:e,isError:!!t,isNoData:0===a,numRenderedColumns:C},x.map(((e,t)=>{const a=e.vulnerabilities.reduce(((e,t)=>{const a=(0,E.U)(t.severity);return{...e,[a]:e[a]+1}}),{critical:0,high:0,medium:0,low:0,none:0,unknown:0});return n.createElement(c.N,{key:e.identifier,isExpanded:R(e)},n.createElement(i.Tr,{...A({item:e})},n.createElement(f.Oi,{...w,item:e,rowIndex:t},n.createElement(d.Td,{width:15,...F({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},n.createElement(r.k2,{to:`/advisories/${e.uuid}`},e.document_id)),n.createElement(d.Td,{width:40,modifier:"truncate",...F({columnKey:"title"})},e.title),n.createElement(d.Td,{width:15,modifier:"truncate",...F({columnKey:"severity"})},e.average_severity&&n.createElement(g.h,{value:e.average_severity})),n.createElement(d.Td,{width:10,...F({columnKey:"modified"})},(0,h.Yq)(e.modified)),n.createElement(d.Td,{width:20,...F({columnKey:"vulnerabilities"})},n.createElement(y.n,{severities:a})),n.createElement(d.Td,{isActionCell:!0},n.createElement(u.G,{items:[{title:"Download",onClick:()=>{U(e.uuid,`${e.identifier}.json`)}}]})))))})))),n.createElement(m.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:k}))}},3617:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var n=a(63696),r=a(68430),l=a(1180),o=a(72785),i=a(7602),s=a(7123),c=a(20653),d=a(35048),u=a(4433),p=a(87043),m=a(1349);const f=({})=>{const{tableControls:e}=n.useContext(i.R),{propHelpers:{toolbarProps:t,filterToolbarProps:a,paginationToolbarItemProps:r,paginationProps:l}}=e;return n.createElement(n.Fragment,null,n.createElement(c.M,{...t},n.createElement(d.P,null,n.createElement(p.Us,{...a}),n.createElement(u.T,{...r},n.createElement(m.n,{idPrefix:"advisory-table",isTop:!0,paginationProps:l})))))},v=()=>n.createElement(n.Fragment,null,n.createElement(r.d8,{variant:r.zC.light},n.createElement(l.n,null,n.createElement(o.E,{component:"h1"},"Advisories"))),n.createElement(r.d8,null,n.createElement("div",{style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"}},n.createElement(i.r,null,n.createElement(f,null),n.createElement(s.q,null)))))},69935:(e,t,a)=>{"use strict";a.d(t,{VH:()=>u,Yu:()=>m,vy:()=>p});var n=a(39155),r=a(3715),l=a(77347),o=a(38595),i=a(81230),s=a(70611),c=a(24808);const d="advisories",u=(e={},t=!1)=>{const{data:a,isLoading:r,error:i,refetch:c}=(0,n.I)({queryKey:[d,e],queryFn:()=>(0,o.YM)({client:l.S,query:{...(0,s.kd)(e)}}),enabled:!t});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:r,fetchError:i||null,refetch:c}},p=e=>{const{data:t,isLoading:a,error:r}=(0,n.I)({queryKey:[d,e],queryFn:()=>(0,o.ai)({client:l.S,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:a,fetchError:r}},m=()=>{const e=(0,r.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,t)=>(0,i.hP)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})}}}]);
//# sourceMappingURL=823.5d84fe1a.min.js.map