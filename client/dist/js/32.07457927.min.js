"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[32],{81230:(e,a,t)=>{t.d(a,{J4:()=>i,hP:()=>c});var r=t(64917),s=t(86820);t(63260);const o="/api",n=o+"/v2/advisory",l=o+"/v2/sbom",d=e=>{let a="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(a="application/json+bzip2"),a},c=(e,a)=>{const t=e.get(s.fs);return r.A.post(`${n}`,t,{...a,headers:{"Content-Type":d(t)}})},i=(e,a)=>{const t=e.get(s.fs);return r.A.post(`${l}`,t,{...a,headers:{"Content-Type":d(t)}})}},24808:(e,a,t)=>{t.d(a,{v:()=>d});var r=t(63696),s=t(64917),o=t(86820);const n="cancelled",l=(e,a)=>{switch(a.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:a.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:a.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",response:a.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file),status:"complete",error:a.payload.error,wasCancelled:a.payload.error?.message===n})};case"removeUpload":{const t=new Map(e.uploads);return t.delete(a.payload.file),{...e,uploads:t}}default:throw new Error}},d=({parallel:e,uploadFn:a,onSuccess:t,onError:d})=>{const[c,i]=r.useReducer(l,{uploads:new Map});return{uploads:c.uploads,handleUpload:r=>{const l=[];for(let e=0;e<r.length;e++){const a=r[e],c=new FormData;c.set(o.fs,a);const p=s.A.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const t=e.total??1,r=e.loaded/t*100;i({type:"updateUploadProgress",payload:{file:a,progress:Math.round(r)}})},cancelToken:p.token};i({type:"queueUpload",payload:{file:a,cancelFn:p}});const m={formData:c,config:u,thenFn:e=>{i({type:"finishUploadSuccessfully",payload:{file:a,response:e}}),t&&t(e,a)},catchFn:e=>{i({type:"finishUploadWithError",payload:{file:a,error:e}}),e.message!==n&&d&&d(e,a)}};l.push(m)}e?l.forEach((e=>{a(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):l.reduce((async(e,t)=>(await e,a(t.formData,t.config).then(t.thenFn).catch(t.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(n)},handleRemoveUpload:e=>{i({type:"removeUpload",payload:{file:e}})}}}},34023:(e,a,t)=>{t.r(a),t.d(a,{default:()=>P});var r=t(63696),s=t(68430),o=t(1180),n=t(72785),l=t(17327),d=t(71603),c=t(16459),i=t(71592),p=t(40111),u=t(10015),m=t(36227),y=t(69935),h=t(91728),g=t(77868),f=t(64335),v=t(93954),E=t(85773),F=t(99205),q=t(18381),U=t(99135),b=t(1865),w=t(94279),S=t(16172),M=t(56279),k=t(84608);const C=({uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:s,extractErrorMessage:o})=>{const[n,l]=r.useState(!1),[d,c]=r.useState("inProgress"),[i,p]=r.useState([]);!n&&e.size>0&&l(!0),r.useEffect((()=>{const a=Array.from(e.values());a.some((e=>"inProgress"===e.status))?c("inProgress"):a.every((e=>"complete"===e.status))?c("success"):c("danger")}),[e]);const u=Array.from(e.values()).filter((e=>e.response)).length;return r.createElement(r.Fragment,null,r.createElement(g.w,{onFileDrop:(e,t)=>{a(t)},dropzoneProps:{accept:{"application/xml":[".json",".bz2",".gz"]},onDropRejected:e=>{p(e)},useFsAccessApi:!1}},r.createElement(f.x,{titleIcon:r.createElement(k.Ay,null),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2, .gz"}),n&&r.createElement(v.y,{statusToggleText:`${u} of ${e.size} files uploaded`,statusToggleIcon:d},Array.from(e.entries()).map((([e,a],n)=>r.createElement(E.L,{className:a.progress<100||!a.response?"multiple-file-upload-status-item-force-blue":void 0,fileIcon:r.createElement(M.Ay,null),file:e,key:`${e.name}-${n}`,onClearClick:()=>{[e].forEach((e=>{t(e)}))},progressValue:a.progress,progressVariant:a.error?"danger":a.response?"success":void 0,progressHelperText:a.error?r.createElement(F.E,{isLiveRegion:!0},r.createElement(q.j,{variant:"error"},o(a.error))):100!==a.progress||a.response?a.response?r.createElement(F.E,{isLiveRegion:!0},r.createElement(q.j,{variant:"default"},s(a.response))):void 0:r.createElement(F.E,{isLiveRegion:!0},r.createElement(q.j,{variant:"warning"},r.createElement(U.y,{isInline:!0}),"File uploaded. Waiting for the server to process it."))})))),r.createElement(b.a,{isOpen:i.length>0,title:"Unsupported files",titleIconVariant:"warning",showClose:!0,"aria-label":"unsupported file upload attempted",onClose:()=>p([]),variant:"small"},r.createElement(w.B8,null,i.map(((e,a)=>r.createElement(S.c,{key:a},e.file.name)))))))},P=()=>{const{uploads:e,handleUpload:a,handleRemoveUpload:t}=(0,h.sn)(),{uploads:g,handleUpload:f,handleRemoveUpload:v}=(0,y.Yu)();return r.createElement(r.Fragment,null,r.createElement(s.d8,{variant:s.zC.light},r.createElement(o.n,null,r.createElement(n.E,{component:"h1"},"Upload"))),r.createElement(s.d8,null,r.createElement(l.Z,null,r.createElement(d.b,null,r.createElement(c.t,{defaultActiveKey:0},r.createElement(i.o,{eventKey:0,title:r.createElement(p.V,null,"SBOM")},r.createElement(u.J,{id:"upload-sbom-tab-content"},r.createElement(m.b,{hasPadding:!0},r.createElement(C,{uploads:e,handleUpload:a,handleRemoveUpload:t,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})))),r.createElement(i.o,{eventKey:1,title:r.createElement(p.V,null,"Advisory")},r.createElement(u.J,{id:"upload-advisory-tab-content"},r.createElement(m.b,{hasPadding:!0},r.createElement(C,{uploads:g,handleUpload:f,handleRemoveUpload:v,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})))))))))}},69935:(e,a,t)=>{t.d(a,{VH:()=>p,Yu:()=>m,vy:()=>u});var r=t(39155),s=t(3715),o=t(77347),n=t(40752),l=t(81230),d=t(70611),c=t(24808);const i="advisories",p=(e={},a=!1,t=!1)=>{const{data:s,isLoading:l,error:c,refetch:p}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,n.YM)({client:o.S,query:{...(0,d.kd)(e)}}),refetchInterval:!a&&5e3,enabled:!t});return{result:{data:s?.data?.items||[],total:s?.data?.total??0,params:e??e},isFetching:l,fetchError:c||null,refetch:p}},u=e=>{const{data:a,isLoading:t,error:s}=(0,r.I)({queryKey:[i,e],queryFn:()=>(0,n.ai)({client:o.S,path:{key:e}}),enabled:void 0!==e});return{advisory:a?.data,isFetching:t,fetchError:s}},m=()=>{const e=(0,s.jE)();return(0,c.v)({parallel:!0,uploadFn:(e,a)=>(0,l.hP)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[i]})}})}},91728:(e,a,t)=>{t.d(a,{DH:()=>g,Qr:()=>h,i$:()=>u,rj:()=>m,sn:()=>y,zY:()=>f});var r=t(39155),s=t(3715),o=t(55037),n=t(77347),l=t(40752),d=t(24808),c=t(81230),i=t(70611);const p="sboms",u=(e={},a=!1,t=!1)=>{const{data:s,isLoading:o,error:d,refetch:c}=(0,r.I)({queryKey:[p,e],queryFn:()=>(0,l.z1)({client:n.S,query:{...(0,i.kd)(e)}}),refetchInterval:!a&&5e3,enabled:!t});return{result:{data:s?.data?.items||[],total:s?.data?.total??0,params:e??e},isFetching:o,fetchError:d,refetch:c}},m=e=>{const{data:a,isLoading:t,error:s}=(0,r.I)({queryKey:[p,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,l.a7)({client:n.S,path:{id:e}}),enabled:void 0!==e});return{sbom:a?.data,isFetching:t,fetchError:s}},y=()=>{const e=(0,s.jE)();return(0,d.v)({parallel:!0,uploadFn:(e,a)=>(0,c.J4)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[p]})}})},h=(e,a={})=>{const{data:t,isLoading:s,error:o,refetch:d}=(0,r.I)({queryKey:["SBOMsQueryKeysss","by-package",e,a],queryFn:()=>(0,l.m9)({client:n.S,query:{purl:e,...(0,i.kd)(a)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:a??a},isFetching:s,fetchError:o,refetch:d}},g=e=>{const{data:a,isLoading:t,error:s}=(0,r.I)({queryKey:[p,e,"advisory"],queryFn:()=>(0,l.bj)({client:n.S,path:{id:e}})});return{advisories:a?.data||[],isFetching:t,fetchError:s}},f=e=>{const a=(0,o.E)({queries:e.map((e=>({queryKey:[p,e,"advisory"],queryFn:()=>(0,l.bj)({client:n.S,path:{id:e}})})))});return{advisories:a.map((({data:e})=>e?.data||[])),isFetching:a.some((({isLoading:e})=>e)),fetchError:a.map((({error:e})=>e))}}}}]);
//# sourceMappingURL=32.07457927.min.js.map