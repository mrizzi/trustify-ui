"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["765"],{97339:function(e,t,r){r.d(t,{a:()=>u});var i=r(59390),s=r(24246),n=r(27378),a=r(90633),l=r(15508),o=r(53315);let u=e=>{var{children:t=null,className:r="","aria-label":c="Breadcrumb",ouiaId:d,ouiaSafe:h=!0}=e,p=(0,i.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let b=(0,o.S$)(u.displayName,d,h);return(0,s.jsx)("nav",Object.assign({},p,{"aria-label":c,className:(0,l.i)(a.Z.breadcrumb,r)},b,{children:(0,s.jsx)("ol",{className:a.Z.breadcrumbList,role:"list",children:n.Children.map(t,(e,t)=>(0,n.isValidElement)(e)?(0,n.cloneElement)(e,{showDivider:t>0}):e)})}))};u.displayName="Breadcrumb"},18091:function(e,t,r){r.d(t,{g:()=>o});var i=r(59390),s=r(24246),n=r(91985),a=r(90633),l=r(15508);let o=e=>{var{children:t=null,className:r="",to:o,isActive:u=!1,isDropdown:c=!1,showDivider:d,target:h,component:p="a",render:b}=e,v=(0,i.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let m=u?"page":void 0,y=(0,l.i)(a.Z.breadcrumbLink,u&&a.Z.modifiers.current);return(0,s.jsxs)("li",Object.assign({},v,{className:(0,l.i)(a.Z.breadcrumbItem,r),children:[d&&(0,s.jsx)("span",{className:a.Z.breadcrumbItemDivider,children:(0,s.jsx)(n.ZP,{})}),"button"===p&&(0,s.jsx)("button",{className:y,"aria-current":m,type:"button",children:t}),c&&(0,s.jsx)("span",{className:(0,l.i)(a.Z.breadcrumbDropdown),children:t}),b&&b({className:y,ariaCurrent:m}),o&&!b&&(0,s.jsx)(p,{href:o,target:h,className:y,"aria-current":m,children:t}),!o&&"button"!==p&&!c&&t]}))};o.displayName="BreadcrumbItem"},32947:function(e,t,r){r.d(t,{A0:()=>y,V4:()=>v,W:()=>f,nE:()=>x});var i=r(91566),s=r(839),n=r(73657),a=r(20644),l=r(89502),o=r(7596),u=r(1811),c=r(24917),d=r(4720),h=r(54178),p=r(37106),b=r(34313);let v={unknown:{name:"Unknown",color:u.P,progressProps:{variant:void 0},icon:i.M$},none:{name:"None",color:c.E,progressProps:{variant:void 0},icon:s.f6},low:{name:"Low",color:d.c,progressProps:{variant:void 0},icon:n._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:a.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:l.E2},critical:{name:"Critical",color:b.J,progressProps:{variant:"danger"},icon:o.ki}},m=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function y(e){return(t,r)=>m(e(t))-m(e(r))}let f=e=>{let{key:t,value:r}=e;return"".concat(r?"".concat(t,"=").concat(r):"".concat(t))},x=e=>{let[t,r]=e.split("=");return{key:t,value:null!=r?r:""}}},7615:function(e,t,r){r.d(t,{g:()=>i});let i=e=>null!=e?e:"unknown"},87017:function(e,t,r){r.d(t,{Co:()=>p,Cu:()=>d,Hb:()=>h});var i=r(79192),s=r(53195),n=r(70233),a=r(74502);r(41947);let l="/api",o="".concat(l,"/v2/advisory"),u="".concat(l,"/v2/sbom"),c=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},d=(e,t)=>{let r=e.get(a.TB);return n.Z.post("".concat(o),r,(0,s._)((0,i._)({},t),{headers:{"Content-Type":c(r)}}))},h=(e,t)=>{let r=e.get(a.TB);return n.Z.post("".concat(u),r,(0,s._)((0,i._)({},t),{headers:{"Content-Type":c(r)}}))},p=e=>n.Z.get("".concat(u,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,r){r.d(t,{u:()=>l});var i=r(24246),s=r(8305),n=r(13754),a=r(39826);let l=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(s.b,{children:(0,i.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(a.y,{}):e.children},69876:function(e,t,r){r.d(t,{D:()=>n});var i=r(24246),s=r(70400);let n=e=>{let{value:t}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,i.jsx)(s._,{isCompact:!0,children:"".concat(t,"=").concat(r)},"".concat(t,"=").concat(r))})})}},57524:function(e,t,r){r.d(t,{o:()=>u});var i=r(24246),s=r(34747),n=r(46770),a=r(64766),l=r(2499),o=r(32947);let u=e=>{let{value:t,score:r,showScore:u,showLabel:c}=e,d=o.V4[t],h=d.name,p=d.icon;return(0,i.jsxs)(s.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(n.B,{children:c?(0,i.jsx)(a.J,{children:(0,i.jsx)(p,{color:d.color.value})}):(0,i.jsx)(l.u,{content:h,children:(0,i.jsx)(a.J,{children:(0,i.jsx)(p,{color:d.color.value})})})}),c&&(0,i.jsx)(n.B,{children:h}),u&&null!==r&&(0,i.jsxs)(n.B,{children:["(",Math.round(10*r)/10,")"]})]})}},3804:function(e,t,r){r.d(t,{p:()=>l});var i=r(79192),s=r(53195),n=r(24246),a=r(27230);let l=e=>{let{paginationProps:t,isTop:r,isCompact:l=!1,idPrefix:o=""}=e;return(0,n.jsx)(a.t,(0,s._)((0,i._)({id:"".concat(o?"".concat(o,"-"):"","pagination-").concat(r?"top":"bottom"),variant:r?a.a.top:a.a.bottom,isCompact:l},t),{widgetId:"pagination-id"}))}},39826:function(e,t,r){r.d(t,{y:()=>l});var i=r(24246),s=r(10707),n=r(16668),a=r(42160);let l=()=>(0,i.jsx)(s.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:a.ZP,variant:s.IQ.sm,children:(0,i.jsx)(n.B,{children:"There was an error retrieving data. Check your connection and try again."})})},31336:function(e,t,r){r.d(t,{hp:()=>v,qK:()=>y,Cx:()=>x});var i=r(24246),s=r(8305),n=r(13754),a=r(31423),l=r(11165),o=r(94154),u=r(39826),c=r(10707),d=r(16668),h=r(22119);let p=e=>{let{title:t,description:r}=e;return(0,i.jsx)(c.ub,{titleText:t,headingLevel:"h4",icon:h.ZP,variant:c.IQ.sm,children:r&&(0,i.jsx)(d.B,{children:r})})},b=()=>(0,i.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),v=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:c=!1,isNoData:d=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:v}=e;return(0,i.jsx)(i.Fragment,{children:r?(0,i.jsx)(a.p,{"aria-label":"Table loading",children:(0,i.jsx)(l.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(s.b,{children:(0,i.jsx)(n.$,{size:"xl"})})})})}):c?(0,i.jsx)(a.p,{"aria-label":"Table error",children:(0,i.jsx)(l.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(s.b,{children:h||(0,i.jsx)(u.y,{})})})})}):d?(0,i.jsx)(a.p,{"aria-label":"Table empty",children:(0,i.jsx)(l.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(s.b,{children:p||(0,i.jsx)(b,{})})})})}):v})};var m=r(89330);let y=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:s}=e;return(0,i.jsxs)(i.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,i.jsx)(m.Th,{screenReaderText:"before-data-".concat(t)},t)),s,Array(r).fill(null).map((e,t)=>(0,i.jsx)(m.Th,{screenReaderText:"after-data-".concat(t)},t))]})};var f=r(79192);let x=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,getSelectCheckboxTdProps:s,propHelpers:{getSingleExpandButtonTdProps:n},item:a,rowIndex:l,children:u}=e;return(0,i.jsxs)(i.Fragment,{children:[t&&"single"===r?(0,i.jsx)(o.Td,(0,f._)({},n({item:a,rowIndex:l}))):null,s?(0,i.jsx)(o.Td,(0,f._)({},s({item:a,rowIndex:l}))):null,u]})}},3586:function(e,t,r){r.d(t,{j:()=>n});var i=r(24246),s=r(27378);let n=e=>{let{children:t}=e,[r,n]=s.useState(!1);return(0,i.jsx)(i.Fragment,{children:t(r,n)})}},24200:function(e,t,r){r.d(t,{G:()=>s});var i=r(24246);let s=e=>{let{vulnerability:t}=e;return(0,i.jsxs)("p",{children:[t.withdrawn&&(0,i.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},31373:function(e,t,r){r.d(t,{H:()=>d});var i=r(79192),s=r(53195),n=r(27378),a=r(7615),l=r(59015);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,u={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,i._)({},u),fixed:(0,i._)({},u),not_affected:(0,i._)({},u),known_not_affected:(0,i._)({},u)}},d=e=>{let{pkg:t,isFetching:r,fetchError:u}=(0,l.ZA)(e);return{data:n.useMemo(()=>(e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>{let r=(0,a.g)(t.average_severity);return{vulnerability:(0,s._)((0,i._)({},t.vulnerability),{average_severity:r,average_score:t.average_score}),vulnerabilityStatus:t.status,advisory:e}})}).reduce((e,t)=>{let r,n=e.find(e=>o(e,t));if(n)r=[...e.filter(e=>!o(e,n)),(0,s._)((0,i._)({},n),{relatedSboms:[...n.relatedSboms,{advisory:t.advisory}]})];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,n=t.vulnerability.average_severity,a=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,s._)((0,i._)({},e.vulnerabilityStatus),{[r]:{total:a.total+1,severities:(0,s._)((0,i._)({},a.severities),{[n]:a.severities[n]+1})}})})},(0,i._)({},c));return{vulnerabilities:t,summary:r}})((null==t?void 0:t.advisories)||[]),[t]),isFetching:r,fetchError:u}}},95169:function(e,t,r){r.d(t,{V:()=>d});var i=r(79192),s=r(53195),n=r(27378),a=r(74502),l=r(70233);let o="cancelled",u=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,t)=>{switch(t.type){case"queueUpload":return(0,s._)((0,i._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,s._)((0,i._)({},e.uploads.get(t.payload.file)||u()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,s._)((0,i._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,s._)((0,i._)({},e.uploads.get(t.payload.file)||u()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,s._)((0,i._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,s._)((0,i._)({},e.uploads.get(t.payload.file)||u()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var r;return(0,s._)((0,i._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,s._)((0,i._)({},e.uploads.get(t.payload.file)||u()),{status:"complete",error:t.payload.error,wasCancelled:(null==(r=t.payload.error)?void 0:r.message)===o}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),(0,s._)((0,i._)({},e),{uploads:r})}default:throw Error()}},d=e=>{let{parallel:t,uploadFn:r,onSuccess:i,onError:s}=e,[u,d]=n.useReducer(c,{uploads:new Map});return{uploads:u.uploads,handleUpload:e=>{let n=[];for(let t=0;t<e.length;t++){let r=e[t],u=new FormData;u.set(a.TB,r);let c=l.Z.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let i=null!=(t=e.total)?t:1;d({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/i*100)}})},cancelToken:c.token};d({type:"queueUpload",payload:{file:r,cancelFn:c}});let p={formData:u,config:h,thenFn:e=>{d({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),i&&i(e,r)},catchFn:e=>{d({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==o&&s&&s(e,r)}};n.push(p)}if(t)for(let e of n)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,r;null==(r=u.uploads.get(e))||null==(t=r.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{d({type:"removeUpload",payload:{file:e}})}}}},47939:function(e,t,r){r.r(t),r.d(t,{default:()=>ee});var i=r(24246),s=r(27378),n=r(65783),a=r(45043),l=r(97339),o=r(18091),u=r(27317),c=r(93095),d=r(68802),h=r(34747),p=r(46770),b=r(2075),v=r(27090),m=r(75165),y=r(31762),f=r(99),x=r(59086),g=r(12621),j=r(9839),_=r(37818),S=r(69876),w=r(59015),E=r(63706),T=r(79192),q=r(53195),F=r(46403),R=r(70715),O=r(40982),C=r(89226),M=r(4835),K=r(14350),P=r(11165),k=r(89330),N=r(31423),L=r(94154),U=r(14629),B=r(3804),I=r(31336),D=r(74502),Q=r(49988),Z=r(43959);let V=e=>{let{purl:t}=e,r=(0,Q.vZ)({tableName:"sboms",persistenceKeyPrefix:D.yq.sboms_by_package,columnNames:{name:"Name",version:"Version",supplier:"Supplier"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:U.vA.search}]}),{result:{data:s,total:a},isFetching:l,fetchError:o}=(0,Z.Oh)(t,(0,Q.QO)((0,q._)((0,T._)({},r),{hubSortFieldKeys:{name:"name"}}))),u=(0,Q.KC)((0,q._)((0,T._)({},r),{idProperty:"id",currentPageItems:s,totalItemCount:a,isLoading:l})),{numRenderedColumns:c,currentPageItems:d,propHelpers:{toolbarProps:h,paginationToolbarItemProps:p,paginationProps:b,tableProps:v,getThProps:m,getTrProps:y,getTdProps:f}}=u;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.o,(0,q._)((0,T._)({},h),{"aria-label":"SBOM toolbar",children:(0,i.jsx)(O.c,{children:(0,i.jsx)(C.E,(0,q._)((0,T._)({},p),{children:(0,i.jsx)(B.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:b})}))})})),(0,i.jsxs)(M.i,(0,q._)((0,T._)({},v),{"aria-label":"SBOM table",children:[(0,i.jsx)(K.h,{children:(0,i.jsx)(P.Tr,{children:(0,i.jsxs)(I.qK,(0,q._)((0,T._)({},u),{children:[(0,i.jsx)(k.Th,(0,T._)({},m({columnKey:"name"}))),(0,i.jsx)(k.Th,(0,T._)({},m({columnKey:"version"}))),(0,i.jsx)(k.Th,(0,T._)({},m({columnKey:"supplier"})))]}))})}),(0,i.jsx)(I.hp,{isLoading:l,isError:!!o,isNoData:0===a,numRenderedColumns:c,children:null==d?void 0:d.map(e=>(0,i.jsx)(N.p,{children:(0,i.jsxs)(P.Tr,(0,q._)((0,T._)({},y({item:e})),{children:[(0,i.jsx)(L.Td,(0,q._)((0,T._)({width:35,modifier:"breakWord"},f({columnKey:"name"})),{children:(0,i.jsx)(n.rU,{to:(0,F.Gn)(j.nB.sbomDetails,{sbomId:e.id}),children:e.name})})),(0,i.jsx)(L.Td,(0,q._)((0,T._)({width:15,modifier:"truncate"},f({columnKey:"version"})),{children:e.described_by.map(e=>e.version).join(", ")})),(0,i.jsx)(L.Td,(0,q._)((0,T._)({width:50,modifier:"truncate"},f({columnKey:"supplier"})),{children:e.suppliers.join(", ")}))]}))},e.id))})]})),(0,i.jsx)(B.p,{idPrefix:"sbom-table",isTop:!1,paginationProps:b})]})};var A=r(27693),H=r.n(A),z=r(9905),W=r(57524),J=r(3586),$=r(24200),X=r(31373),G=r(41135);let Y=e=>{let{packageId:t}=e,{data:{vulnerabilities:r},isFetching:a,fetchError:l}=(0,X.H)(t),o=s.useMemo(()=>r.filter(e=>"affected"===e.vulnerabilityStatus),[r]),u=(0,G.T)(o,e=>"".concat(e.vulnerability.identifier,"-").concat(e.vulnerabilityStatus)),c=(0,Q.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:u,isLoading:a,columnNames:{identifier:"ID",description:"Description",severity:"CVSS",published:"Date published"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","severity","published"],getSortValues:e=>{var t,r,i;return{identifier:e.vulnerability.identifier,severity:(null==(t=e.vulnerability)?void 0:t.average_score)||0,published:(null==(r=e.vulnerability)?void 0:r.published)?H()(null==(i=e.vulnerability)?void 0:i.published).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:d,numRenderedColumns:h,propHelpers:{toolbarProps:p,paginationToolbarItemProps:b,paginationProps:v,tableProps:m,getThProps:y,getTrProps:f,getTdProps:x},expansionDerivedState:{isCellExpanded:g}}=c;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(R.o,(0,q._)((0,T._)({},p),{"aria-label":"vulnerability toolbar",children:(0,i.jsx)(O.c,{children:(0,i.jsx)(C.E,(0,q._)((0,T._)({},b),{children:(0,i.jsx)(B.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:v})}))})})),(0,i.jsxs)(M.i,(0,q._)((0,T._)({},m),{"aria-label":"vulnerability table",children:[(0,i.jsx)(K.h,{children:(0,i.jsx)(P.Tr,{children:(0,i.jsxs)(I.qK,(0,q._)((0,T._)({},c),{children:[(0,i.jsx)(k.Th,(0,T._)({},y({columnKey:"identifier"}))),(0,i.jsx)(k.Th,(0,T._)({},y({columnKey:"description"}))),(0,i.jsx)(k.Th,(0,T._)({},y({columnKey:"severity"}))),(0,i.jsx)(k.Th,(0,T._)({},y({columnKey:"published"})))]}))})}),(0,i.jsx)(I.hp,{isLoading:a,isError:!!l,isNoData:0===u.length,numRenderedColumns:h,children:null==d?void 0:d.map((e,t)=>{var r,s;return(0,i.jsx)(N.p,{isExpanded:g(e),children:(0,i.jsx)(P.Tr,(0,q._)((0,T._)({},f({item:e})),{children:(0,i.jsxs)(I.Cx,(0,q._)((0,T._)({},c),{item:e,rowIndex:t,children:[(0,i.jsx)(L.Td,(0,q._)((0,T._)({width:15,modifier:"breakWord"},x({columnKey:"identifier"})),{children:(0,i.jsx)(n.rU,{to:(0,F.Gn)(j.nB.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,i.jsx)(J.j,{children:(t,r)=>(0,i.jsx)(L.Td,(0,q._)((0,T._)({width:60,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0},x({columnKey:"description"})),{children:(0,i.jsx)(z.cE,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,i.jsx)($.G,{vulnerability:e.vulnerability})})}))}),(0,i.jsx)(L.Td,(0,q._)((0,T._)({width:15},x({columnKey:"severity"})),{children:(null==(r=e.vulnerability)?void 0:r.average_severity)&&(0,i.jsx)(W.o,{value:e.vulnerability.average_severity,score:e.vulnerability.average_score,showLabel:!0,showScore:!0})})),(0,i.jsx)(L.Td,(0,q._)((0,T._)({width:10,modifier:"truncate"},x({columnKey:"published"})),{children:(0,E.p6)(null==(s=e.vulnerability)?void 0:s.published)}))]}))}))},e._ui_unique_id)})})]})),(0,i.jsx)(B.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:v})]})},ee=()=>{var e,t;let r=(0,j.ZX)(j.Uo.PACKAGE_ID),{pkg:T,isFetching:q,fetchError:F}=(0,w.ZA)(r),R=s.useMemo(()=>T?(0,E.qX)(T.purl):void 0,[T]),[O,C]=s.useState(0),M=s.createRef(),K=s.createRef(),P=s.createRef();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.NP,{type:"breadcrumb",children:(0,i.jsxs)(l.a,{children:[(0,i.jsx)(o.g,{children:(0,i.jsx)(n.rU,{to:j.nB.packages,children:"Packages"})}),(0,i.jsx)(o.g,{isActive:!0,children:"Package details"})]})}),(0,i.jsx)(a.NP,{children:(0,i.jsxs)(u.K,{children:[(0,i.jsx)(c.v,{children:(0,i.jsx)(d.V,{children:(0,i.jsx)(d.V,{component:"h1",children:null!=(t=null!=(e=null==R?void 0:R.name)?e:r)?t:""})})}),(0,i.jsx)(c.v,{children:(0,i.jsxs)(h.k,{children:[(0,i.jsxs)(p.B,{spacer:{default:"spacerSm"},children:[(0,i.jsxs)("p",{children:["version: ",null==R?void 0:R.version]})," "]}),(0,i.jsx)(p.B,{children:(null==R?void 0:R.qualifiers)&&(0,i.jsx)(S.D,{value:null==R?void 0:R.qualifiers})})]})})]})}),(0,i.jsx)(a.NP,{children:(0,i.jsxs)(b.m,{mountOnEnter:!0,activeKey:O,onSelect:(e,t)=>{C(t)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,i.jsx)(v.O,{eventKey:0,title:(0,i.jsx)(m.T,{children:"Vulnerabilities"}),tabContentId:"refTabVulnerabilitiesSection",tabContentRef:M}),(0,i.jsx)(v.O,{eventKey:1,title:(0,i.jsx)(m.T,{children:"SBOMs using package"}),actions:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(y.b,{ref:P,children:(0,i.jsx)(g.ZP,{})}),(0,i.jsx)(f.J,{bodyContent:(0,i.jsx)("div",{children:"A list of SBOMs using this package."}),triggerRef:P})]}),tabContentId:"refTabSbomsSection",tabContentRef:K})]})}),(0,i.jsxs)(a.NP,{children:[(0,i.jsx)(x.I,{eventKey:0,id:"refTabVulnerabilitiesSection",ref:M,"aria-label":"Vulnerabilities of the Package",children:r&&(0,i.jsx)(Y,{packageId:r})}),(0,i.jsx)(x.I,{eventKey:1,id:"refTabSbomsSection",ref:K,"aria-label":"SBOMs using the Package",hidden:!0,children:(0,i.jsx)(_.u,{isFetching:q,fetchError:F,children:(null==T?void 0:T.purl)&&(0,i.jsx)(V,{purl:T.purl})})})]})]})}},59015:function(e,t,r){r.d(t,{D4:()=>d,ZA:()=>c,fF:()=>u});var i=r(79192),s=r(1183),n=r(50576),a=r(40371),l=r(49988);let o="packages",u=function(){var e,t,r;let u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:h,error:p,refetch:b}=(0,s.a)({queryKey:[o,u],queryFn:()=>(0,a.tj)({client:n.L,query:(0,i._)({},(0,l.rm)(u))}),enabled:!c});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(r=null==d||null==(t=d.data)?void 0:t.total)?r:0,params:u},isFetching:h,fetchError:p,refetch:b}},c=e=>{let{data:t,isLoading:r,error:i}=(0,s.a)({queryKey:[o,e],queryFn:()=>(0,a.BK)({client:n.L,path:{key:e}})});return{pkg:null==t?void 0:t.data,isFetching:r,fetchError:i}},d=function(e){var t,r,u;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d,isLoading:h,error:p,refetch:b}=(0,s.a)({queryKey:[o,"by-sbom",e,c],queryFn:()=>(0,a.Pg)({client:n.L,path:{id:e},query:(0,i._)({},(0,l.rm)(c))})});return{result:{data:(null==d||null==(t=d.data)?void 0:t.items)||[],total:null!=(u=null==d||null==(r=d.data)?void 0:r.total)?u:0,params:c},isFetching:h,fetchError:p,refetch:b}}},43959:function(e,t,r){r.d(t,{Fz:()=>f,KQ:()=>w,Oh:()=>S,i5:()=>y,km:()=>j,p4:()=>x,qi:()=>T,s5:()=>g,t9:()=>_,uz:()=>E});var i=r(79192),s=r(53195),n=r(70186),a=r(1183),l=r(24038),o=r(68e3),u=r(75503),c=r(16072),d=r(50576),h=r(40371),p=r(95169),b=r(87017),v=r(49988);let m="sboms",y=e=>{let{data:t,isLoading:r,error:i,refetch:s}=(0,a.a)({queryKey:[m,"labels",e],queryFn:()=>(0,h.mh)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:l.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i,refetch:s}},f=function(){var e,t,r;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,v.rm)(l),{q:p}=c,b=(0,n._)(c,["q"]),y=(0,v.Rb)(o),{data:f,isLoading:x,error:g,refetch:j}=(0,a.a)({queryKey:[m,l,y],queryFn:()=>(0,h.Wp)({client:d.L,query:(0,s._)((0,i._)({},b),{q:[p,y].filter(e=>e).join("&")})}),enabled:!u});return{result:{data:(null==f||null==(e=f.data)?void 0:e.items)||[],total:null!=(r=null==f||null==(t=f.data)?void 0:t.total)?r:0,params:l},isFetching:x,fetchError:g,refetch:j}},x=e=>{let{data:t,isLoading:r,error:i}=(0,a.a)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:d.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:r,fetchError:i}},g=(e,t)=>{let r=(0,o.NL)();return(0,u.D)({mutationFn:async e=>(await (0,h.WX)({client:d.L,path:{id:e}})).data,onSuccess:async(t,i)=>{e(t,i),await r.invalidateQueries({queryKey:[m]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[m]})}})},j=()=>{let e=(0,o.NL)();return(0,p.V)({parallel:!0,uploadFn:(e,t)=>(0,b.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},_=(e,t)=>{let r=(0,o.NL)();return(0,u.D)({mutationFn:e=>(0,h.zx)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:t})},S=function(e){var t,r,s;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:l,isLoading:o,error:u,refetch:c}=(0,a.a)({queryKey:[m,"by-package",e,n],queryFn:()=>(0,h.DU)({client:d.L,query:(0,i._)({purl:e},(0,v.rm)(n))})});return{result:{data:(null==l||null==(t=l.data)?void 0:t.items)||[],total:null!=(s=null==l||null==(r=l.data)?void 0:r.total)?s:0,params:n},isFetching:o,fetchError:u,refetch:c}},w=e=>{let{data:t,isLoading:r,error:i}=(0,a.a)({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:d.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i}},E=e=>{let t=(0,c.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:d.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},T=e=>{let{data:t,isLoading:r,error:i}=(0,a.a)({queryKey:[m,e,"license-ids"],queryFn:()=>(0,h.J4)({client:d.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i}}},41135:function(e,t,r){r.d(t,{T:()=>l});var i=r(79192),s=r(53195),n=r(27378),a=r(74502);let l=(e,t)=>(0,n.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,s._)((0,i._)({},e),{[a.nM]:t(e)})):[],[e,t])},75503:function(e,t,r){r.d(t,{D:()=>c});var i=r(27378),s=r(55699),n=r(83484),a=r(82418),l=r(24038),o=class extends a.l{#e;#t=void 0;#r;#i;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,l.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,l.Ym)(t.mutationKey)!==(0,l.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#s(),this.#n(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#s(),this.#n()}mutate(e,t){return this.#i=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#s(){let e=this.#r?.state??(0,s.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#n(e){n.Vr.batch(()=>{if(this.#i&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context;e?.type==="success"?(this.#i.onSuccess?.(e.data,t,r),this.#i.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#i.onError?.(e.error,t,r),this.#i.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#t)})})}},u=r(68e3);function c(e,t){let r=(0,u.NL)(t),[s]=i.useState(()=>new o(r,e));i.useEffect(()=>{s.setOptions(e)},[s,e]);let a=i.useSyncExternalStore(i.useCallback(e=>s.subscribe(n.Vr.batchCalls(e)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),c=i.useCallback((e,t)=>{s.mutate(e,t).catch(l.ZT)},[s]);if(a.error&&(0,l.L3)(s.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:c,mutateAsync:a.mutate}}},16072:function(e,t,r){r.d(t,{h:()=>v});var i=r(27378),s=r(83484),n=r(7246),a=r(82418),l=r(24038);function o(e,t){let r=new Set(t);return e.filter(e=>!r.has(e))}var u=class extends a.l{#e;#a;#l;#o;#u;#c;#d;#h;#p=[];constructor(e,t,r){super(),this.#e=e,this.#o=r,this.#l=[],this.#u=[],this.#a=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#u.forEach(e=>{e.subscribe(t=>{this.#b(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#u.forEach(e=>{e.destroy()})}setQueries(e,t){this.#l=e,this.#o=t,s.Vr.batch(()=>{let e=this.#u,t=this.#v(this.#l);this.#p=t,t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let r=t.map(e=>e.observer),i=r.map(e=>e.getCurrentResult()),s=r.some((t,r)=>t!==e[r]);(e.length!==r.length||s)&&(this.#u=r,this.#a=i,this.hasListeners()&&(o(e,r).forEach(e=>{e.destroy()}),o(r,e).forEach(e=>{e.subscribe(t=>{this.#b(e,t)})}),this.#n()))})}getCurrentResult(){return this.#a}getQueries(){return this.#u.map(e=>e.getCurrentQuery())}getObservers(){return this.#u}getOptimisticResult(e,t){let r=this.#v(e),i=r.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[i,e=>this.#m(e??i,t),()=>this.#y(i,r)]}#y(e,t){return t.map((r,i)=>{let s=e[i];return r.defaultedQueryOptions.notifyOnChangeProps?s:r.observer.trackResult(s,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#m(e,t){return t?(this.#c&&this.#a===this.#h&&t===this.#d||(this.#d=t,this.#h=this.#a,this.#c=(0,l.Q$)(this.#c,t(e))),this.#c):e}#v(e){let t=new Map(this.#u.map(e=>[e.options.queryHash,e])),r=[];return e.forEach(e=>{let i=this.#e.defaultQueryOptions(e),s=t.get(i.queryHash);s?r.push({defaultedQueryOptions:i,observer:s}):r.push({defaultedQueryOptions:i,observer:new n.z(this.#e,i)})}),r}#b(e,t){let r=this.#u.indexOf(e);-1!==r&&(this.#a=function(e,t,r){let i=e.slice(0);return i[t]=r,i}(this.#a,r,t),this.#n())}#n(){if(this.hasListeners()){let e=this.#c,t=this.#y(this.#a,this.#p);e!==this.#m(t,this.#o?.combine)&&s.Vr.batch(()=>{this.listeners.forEach(e=>{e(this.#a)})})}}},c=r(68e3),d=r(12675),h=r(73687),p=r(80484),b=r(76720);function v({queries:e,...t},r){let a=(0,c.NL)(r),o=(0,d.S)(),v=(0,h._)(),m=i.useMemo(()=>e.map(e=>{let t=a.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,a,o]);m.forEach(e=>{(0,b.A8)(e),(0,p.pf)(e,v)}),(0,p.JN)(v);let[y]=i.useState(()=>new u(a,m,t)),[f,x,g]=y.getOptimisticResult(m,t.combine),j=!o&&!1!==t.subscribed;i.useSyncExternalStore(i.useCallback(e=>j?y.subscribe(s.Vr.batchCalls(e)):l.ZT,[y,j]),()=>y.getCurrentResult(),()=>y.getCurrentResult()),i.useEffect(()=>{y.setQueries(m,t)},[m,t,y]);let _=f.some((e,t)=>(0,b.SB)(m[t],e))?f.flatMap((e,t)=>{let r=m[t];if(r){let t=new n.z(a,r);if((0,b.SB)(r,e))return(0,b.j8)(r,t,v);(0,b.Z$)(e,o)&&(0,b.j8)(r,t,v)}return[]}):[];if(_.length>0)throw Promise.all(_);let S=f.find((e,t)=>{let r=m[t];return r&&(0,p.KJ)({result:e,errorResetBoundary:v,throwOnError:r.throwOnError,query:a.getQueryCache().get(r.queryHash),suspense:r.suspense})});if(S?.error)throw S.error;return x(g())}}}]);