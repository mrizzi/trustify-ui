"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["404"],{32947:function(e,a,t){t.d(a,{A0:()=>c,V4:()=>u,XE:()=>d});var r=t(1811),n=t(24917),s=t(4720),l=t(54178),o=t(37106),i=t(34313);let u={unknown:{name:"Unknown",color:r.P,progressProps:{variant:void 0}},none:{name:"None",color:n.E,progressProps:{variant:void 0}},low:{name:"Low",color:s.c,progressProps:{variant:void 0}},medium:{name:"Medium",color:l.L,progressProps:{variant:"warning"}},high:{name:"High",color:o.H,progressProps:{variant:"danger"}},critical:{name:"Critical",color:i.J,progressProps:{variant:"danger"}}},d=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function c(e){return(a,t)=>d(e(a))-d(e(t))}},7615:function(e,a,t){t.d(a,{g:()=>r});let r=e=>e??"unknown"},87017:function(e,a,t){t.d(a,{Co:()=>c,Cu:()=>u,Hb:()=>d});var r=t(70233),n=t(74502);t(41947);let s="/api",l=`${s}/v2/advisory`,o=`${s}/v2/sbom`,i=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},u=(e,a)=>{let t=e.get(n.TB);return r.Z.post(`${l}`,t,{...a,headers:{"Content-Type":i(t)}})},d=(e,a)=>{let t=e.get(n.TB);return r.Z.post(`${o}`,t,{...a,headers:{"Content-Type":i(t)}})},c=e=>r.Z.get(`${o}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,a,t){t.d(a,{u:()=>o});var r=t(24246),n=t(8305),s=t(13754),l=t(39826);let o=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(n.b,{children:(0,r.jsx)(s.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(l.y,{}):e.children},39826:function(e,a,t){t.d(a,{y:()=>o});var r=t(24246),n=t(10707),s=t(16668),l=t(42160);let o=()=>(0,r.jsx)(n.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:l.ZP,variant:n.IQ.sm,children:(0,r.jsx)(s.B,{children:"There was an error retrieving data. Check your connection and try again."})})},82413:function(e,a,t){t.d(a,{A:()=>d,I:()=>c});var r=t(27378),n=t(7615),s=t(43959);let l=(e,a)=>e.vulnerability.identifier===a.vulnerability.identifier&&e.vulnerabilityStatus===a.vulnerabilityStatus,o={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},i={vulnerabilityStatus:{affected:{...o},fixed:{...o},not_affected:{...o},known_not_affected:{...o}}},u=e=>{let a=e.flatMap(e=>(e.status??[]).map(a=>({vulnerability:a,vulnerabilityStatus:a.status,advisory:e,packages:a.packages}))).reduce((e,a)=>{let t,r=e.find(e=>l(e,a));if(r)t=[...e.filter(e=>!l(e,r)),{...r,relatedPackages:[...r.relatedPackages,{advisory:a.advisory,packages:a.packages}]}];else{let r={vulnerability:a.vulnerability,vulnerabilityStatus:a.vulnerabilityStatus,relatedPackages:[{advisory:a.advisory,packages:a.packages}]};t=[...e.slice(),r]}return t},[]),t=a.reduce((e,a)=>{let t=a.vulnerabilityStatus,r=(0,n.g)(a.vulnerability.average_severity),s=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[t]:{total:s.total+1,severities:{...s.severities,[r]:s.severities[r]+1}}}})},{...i});return{vulnerabilities:a,summary:t}},d=e=>{let{advisories:a,isFetching:t,fetchError:n}=(0,s.KQ)(e);return{data:r.useMemo(()=>u(a||[]),[a]),isFetching:t,fetchError:n}},c=e=>{let{advisories:a,isFetching:t,fetchError:n}=(0,s.uz)(e);return{data:r.useMemo(()=>(a??[]).map(e=>u(e||[])),[a]),isFetching:t,fetchError:n}}},95169:function(e,a,t){t.d(a,{V:()=>d});var r=t(27378),n=t(74502),s=t(70233);let l="cancelled",o=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),i=(e,a)=>{switch(a.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"queued",cancelFn:a.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),progress:a.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"complete",response:a.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"complete",error:a.payload.error,wasCancelled:a.payload.error?.message===l})};case"removeUpload":{let t=new Map(e.uploads);return t.delete(a.payload.file),{...e,uploads:t}}default:throw Error()}},u=()=>({uploads:new Map}),d=e=>{let{parallel:a,uploadFn:t,onSuccess:o,onError:d}=e,[c,p]=r.useReducer(i,u());return{uploads:c.uploads,handleUpload:e=>{let r=[];for(let a=0;a<e.length;a++){let t=e[a],i=new FormData;i.set(n.TB,t);let u=s.Z.CancelToken.source(),c={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let a=e.total??1;p({type:"updateUploadProgress",payload:{file:t,progress:Math.round(e.loaded/a*100)}})},cancelToken:u.token};p({type:"queueUpload",payload:{file:t,cancelFn:u}});let y={formData:i,config:c,thenFn:e=>{p({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),o&&o(e,t)},catchFn:e=>{p({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==l&&d&&d(e,t)}};r.push(y)}if(a)for(let e of r)t(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else r.reduce(async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(l)},handleRemoveUpload:e=>{p({type:"removeUpload",payload:{file:e}})}}}},43959:function(e,a,t){t.d(a,{Fz:()=>p,KQ:()=>f,Oh:()=>v,km:()=>h,p4:()=>y,uz:()=>g});var r=t(1183),n=t(68e3),s=t(16072),l=t(50576),o=t(40371),i=t(95169),u=t(87017),d=t(47169);let c="sboms",p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:t,isLoading:n,error:s,refetch:i}=(0,r.a)({queryKey:[c,e],queryFn:()=>(0,o.Wp)({client:l.L,query:{...(0,d.rm)(e)}}),enabled:!a});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:n,fetchError:s,refetch:i}},y=e=>{let{data:a,isLoading:t,error:n}=(0,r.a)({queryKey:[c,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,o._Q)({client:l.L,path:{id:e}}),enabled:void 0!==e});return{sbom:a?.data,isFetching:t,fetchError:n}},h=()=>{let e=(0,n.NL)();return(0,i.V)({parallel:!0,uploadFn:(e,a)=>(0,u.Hb)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[c]})}})},v=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:n,error:s,refetch:i}=(0,r.a)({queryKey:["SBOMsQueryKeysss","by-package",e,a],queryFn:()=>(0,o.DU)({client:l.L,query:{purl:e,...(0,d.rm)(a)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:a??a},isFetching:n,fetchError:s,refetch:i}},f=e=>{let{data:a,isLoading:t,error:n}=(0,r.a)({queryKey:[c,e,"advisory"],queryFn:()=>(0,o.NU)({client:l.L,path:{id:e}})});return{advisories:a?.data||[],isFetching:t,fetchError:n}},g=e=>{let a=(0,s.h)({queries:e.map(e=>({queryKey:[c,e,"advisory"],queryFn:()=>(0,o.NU)({client:l.L,path:{id:e}})}))});return{advisories:a.map(e=>{let{data:a}=e;return a?.data||[]}),isFetching:a.some(e=>{let{isLoading:a}=e;return a}),fetchError:a.map(e=>{let{error:a}=e;return a})}}}}]);