"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["924"],{98261:function(e,i,n){n.d(i,{Q:()=>c});var l=n(97517),r=n(62540),t=n(63696),a=n(539),s=n(62634),d=n(1850);let c=e=>{var{children:i=null,className:n="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,m=(0,l.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let b=(0,d.iK)(c.displayName,u,h);return(0,r.jsx)("nav",Object.assign({},m,{"aria-label":o,className:(0,s.A)(a.A.breadcrumb,n)},b,{children:(0,r.jsx)("ol",{className:a.A.breadcrumbList,role:"list",children:t.Children.map(i,(e,i)=>(0,t.isValidElement)(e)?(0,t.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},75530:function(e,i,n){n.d(i,{J:()=>d});var l=n(97517),r=n(62540),t=n(21579),a=n(539),s=n(62634);let d=e=>{var{children:i=null,className:n="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:m="a",render:b}=e,x=(0,l.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let p=c?"page":void 0,j=(0,s.A)(a.A.breadcrumbLink,c&&a.A.modifiers.current);return(0,r.jsxs)("li",Object.assign({},x,{className:(0,s.A)(a.A.breadcrumbItem,n),children:[u&&(0,r.jsx)("span",{className:a.A.breadcrumbItemDivider,children:(0,r.jsx)(t.Ay,{})}),"button"===m&&(0,r.jsx)("button",{className:j,"aria-current":p,type:"button",children:i}),o&&(0,r.jsx)("span",{className:(0,s.A)(a.A.breadcrumbDropdown),children:i}),b&&b({className:j,ariaCurrent:p}),d&&!b&&(0,r.jsx)(m,{href:d,target:h,className:j,"aria-current":p,children:i}),!d&&"button"!==m&&!o&&i]}))};d.displayName="BreadcrumbItem"},17327:function(e,i,n){n.d(i,{E:()=>c,Z:()=>o});var l=n(97517),r=n(62540),t=n(63696),a=n(47328),s=n(62634),d=n(1850);let c=(0,t.createContext)({cardId:"",isExpanded:!1,isClickable:!1,isSelectable:!1,isSelected:!1,isClicked:!1,isDisabled:!1}),o=e=>{var{children:i,id:n="",className:t,component:u="div",isCompact:h=!1,isSelectable:m=!1,isClickable:b=!1,isDisabled:x=!1,isSelected:p=!1,isClicked:j=!1,isExpanded:f=!1,isLarge:v=!1,isFullHeight:y=!1,isPlain:g=!1,variant:A="default",ouiaId:_,ouiaSafe:C=!0}=e,k=(0,l.__rest)(e,["children","id","className","component","isCompact","isSelectable","isClickable","isDisabled","isSelected","isClicked","isExpanded","isLarge","isFullHeight","isPlain","variant","ouiaId","ouiaSafe"]);let S=(0,d.iK)(o.displayName,_,C);return h&&v&&(console.warn("Card: Cannot use isCompact with isLarge. Defaulting to isCompact"),v=!1),(0,r.jsx)(c.Provider,{value:{cardId:n,isExpanded:f,isClickable:b,isSelectable:m,isSelected:p,isClicked:j,isDisabled:x},children:(0,r.jsx)(u,Object.assign({id:n,className:(0,s.A)(a.A.card,h&&a.A.modifiers.compact,f&&a.A.modifiers.expanded,v&&a.A.modifiers.displayLg,y&&a.A.modifiers.fullHeight,g&&a.A.modifiers.plain,"secondary"===A&&a.A.modifiers.secondary,m&&b?(0,s.A)(a.A.modifiers.selectable,a.A.modifiers.clickable,(p||j)&&a.A.modifiers.current):m?(0,s.A)(a.A.modifiers.selectable,p&&a.A.modifiers.selected):b?(0,s.A)(a.A.modifiers.clickable,j&&a.A.modifiers.current):"",x&&a.A.modifiers.disabled,t)},k,S,{children:i}))})};o.displayName="Card"},71603:function(e,i,n){n.d(i,{b:()=>s});var l=n(97517),r=n(62540),t=n(47328),a=n(62634);let s=e=>{var{children:i,className:n,component:s="div",isFilled:d=!0}=e,c=(0,l.__rest)(e,["children","className","component","isFilled"]);return(0,r.jsx)(s,Object.assign({className:(0,a.A)(t.A.cardBody,!d&&t.A.modifiers.noFill,n)},c,{children:i}))};s.displayName="CardBody"},64361:function(e,i,n){n.d(i,{Z:()=>c});var l=n(97517),r=n(62540),t=n(63696),a=n(62634),s=n(47328),d=n(17327);let c=e=>{var{children:i,className:n,component:c="div"}=e,o=(0,l.__rest)(e,["children","className","component"]);let{cardId:u}=(0,t.useContext)(d.E),h=u?`${u}-title`:"";return(0,r.jsx)("div",{className:(0,a.A)(s.A.cardTitle),children:(0,r.jsx)(c,Object.assign({className:(0,a.A)(s.A.cardTitleText,n),id:h||void 0},o,{children:i}))})};c.displayName="CardTitle"},21639:function(e,i,n){n.d(i,{X:()=>s});var l=n(97517),r=n(62540),t=n(77743),a=n(62634);let s=e=>{var{children:i,className:n,icon:s}=e,d=(0,l.__rest)(e,["children","className","icon"]);return(0,r.jsxs)("dt",Object.assign({className:(0,a.A)(t.A.descriptionListTerm,n)},d,{children:[s?(0,r.jsx)("span",{className:(0,a.A)(t.A.descriptionListTermIcon),children:s}):null,(0,r.jsx)("span",{className:(0,a.A)(t.A.descriptionListText),children:i})]}))};s.displayName="DescriptionListTerm"},10410:function(e,i,n){n.d(i,{Ay:()=>l});let l=(0,n(32791).w)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},89705:function(e,i,n){n.d(i,{T:()=>c});var l=n(62540),r=n(24773),t=n(38927),a=n(80057),s=n(13021),d=n(97346);let c=e=>{let{isOpen:i,title:n,titleIconVariant:c,message:o,confirmBtnLabel:u,cancelBtnLabel:h,inProgress:m,confirmBtnVariant:b,onClose:x,onConfirm:p,onCancel:j}=e,f=(0,l.jsx)(r.$n,{"aria-label":"confirm",variant:b,isDisabled:m,onClick:p,children:u},"confirm"),v=j?(0,l.jsx)(r.$n,{"aria-label":"cancel",variant:r.Ak.link,isDisabled:m,onClick:j,children:h},"cancel"):void 0;return(0,l.jsxs)(t.a,{variant:"small",isOpen:i,onClose:x,"aria-label":"Confirm dialog",children:[(0,l.jsx)(a.r,{title:n,titleIconVariant:c}),(0,l.jsx)(s.c,{children:o}),(0,l.jsx)(d.j,{children:j?(0,l.jsxs)(l.Fragment,{children:[f,v]}):f})]})}},91242:function(e,i,n){n.d(i,{e:()=>v});var l=n(62540),r=n(63696),t=n(38914),a=n(57901),s=n(40360),d=n(42957),c=n(17327),o=n(23546),u=n(69548),h=n(75484),m=n(36284),b=n(24773),x=n(23909),p=n(71284),j=n(84631);let f=e=>{let i=(0,p.m4)(e);return{id:i,name:i}},v=e=>{let{title:i,value:n,isDisabled:v,onSave:y,onClose:g,options:A,onInputChange:_}=e,[C,k]=r.useState(Object.entries(n).map(e=>{let[i,n]=e;return f({key:i,value:n})}));return(0,l.jsxs)(t.B,{hasGutter:!0,children:[(0,l.jsx)(a.a,{children:"Labels help you organize and select resources. Adding labels below will let you query for objects that have similar, overlapping or dissimilar labels."}),(0,l.jsx)(a.a,{children:(0,l.jsx)(s.g,{label:(0,l.jsx)(d.U,{component:"h4",children:i}),children:(0,l.jsx)(c.Z,{children:(0,l.jsx)(o.o,{style:{padding:10,minHeight:10},defaultIsOpen:!0,numLabels:10,children:C.sort((e,i)=>(0,x.AA)(e.name).localeCompare((0,x.AA)(i.name))).map((e,i)=>(0,l.jsx)(u.J,{color:"blue",onClose:()=>{let e=[...C];e.splice(i,1),k(e)},children:(0,x.AA)(e.labelName||e.name)},e.id))})})})}),(0,l.jsx)(a.a,{children:(0,l.jsxs)(h.l,{onSubmit:e=>e.preventDefault(),children:[(0,l.jsx)(j.j,{selections:C,options:A.map(e=>{let{key:i,value:n}=e;return f({key:i,value:n})}),onChange:k,placeholderText:"Add label",searchInputAriaLabel:"labels-select-toggle",onSearchChange:_,onCreateNewOption:e=>({id:e,name:e}),validateNewOption:e=>!!e&&e.trim().length>0&&/^(?!.*\\)(?!\s*\\)(?!\s*=)[^=\\\s][^=\\]*\s*=?\s*[^=\\]+$/.test(e),filterBeforeOnChange:(e,i)=>{let n=(0,p.Cb)((0,x.AA)(i.name));return e.filter(e=>(0,p.Cb)((0,x.AA)(e.name)).key!==n.key)}}),(0,l.jsxs)(m.K,{children:[(0,l.jsx)(b.$n,{type:"button","aria-label":"submit",variant:b.Ak.primary,isDisabled:v,onClick:()=>{y(C.map(e=>(0,p.Cb)((0,x.AA)(e.name))).reduce((e,i)=>{let{key:n,value:l}=i;return e[n]=null!=l?l:"",e},{}))},children:"Save"}),(0,l.jsx)(b.$n,{type:"button","aria-label":"cancel",variant:b.Ak.link,isDisabled:v,onClick:g,children:"Cancel"})]})]})})]})}},12852:function(e,i,n){n.d(i,{g:()=>d});var l=n(62540),r=n(23546),t=n(69548),a=n(41628),s=n(71284);let d=e=>{let{value:i,defaultIsOpen:n,onClick:d}=e;return(0,l.jsx)(r.o,{defaultIsOpen:n,numLabels:5,children:Object.entries(i).sort((e,i)=>{let[n]=e,[l]=i;return l.localeCompare(n)}).map(e=>{let[i,n]=e;return(0,l.jsx)(t.J,{color:"blue",onClick:d?()=>d({key:i,value:n}):void 0,children:(0,l.jsx)(a.P,{content:(0,s.m4)({key:i,value:n})})},i)})})}},24296:function(e,i,n){n.d(i,{a:()=>s});var l=n(62540),r=n(59394),t=n(81595),a=n(40554);let s=e=>e.isFetching?e.isFetchingState||(0,l.jsx)(r.a,{children:(0,l.jsx)(t.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,l.jsx)(a.q,{}):e.children},20311:function(e,i,n){n.d(i,{R:()=>t});var l=n(62540),r=n(63696);let t=e=>{let{children:i}=e,[n,t]=r.useState(!1);return(0,l.jsx)(l.Fragment,{children:i(n,t)})}},64377:function(e,i,n){n.d(i,{j:()=>r});var l=n(62540);let r=e=>{let{vulnerability:i}=e;return(0,l.jsxs)("p",{children:[i.withdrawn&&(0,l.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},99528:function(e,i,n){n.d(i,{m:()=>d});var l=n(22249),r=n(81895),t=n(96002),a=n(86141),s=n(23909);let d=()=>({downloadAdvisory:(e,i)=>{(0,a.Mu)({client:t.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOM:(e,i)=>{(0,a.K0)({client:t.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(n=>{(0,l.saveAs)(new Blob([n.data]),i||"".concat(e,".json"))})},downloadSBOMLicenses:e=>{(0,r.Z3)(e).then(i=>{var n,r;let t=null,a=null==(r=i.headers)||null==(n=r["content-disposition"])?void 0:n.toString();a&&(t=(0,s.uz)(a)),(0,l.saveAs)(new Blob([i.data]),t||"".concat(e,".tar.gz"))})}})},11179:function(e,i,n){n.r(i),n.d(i,{default:()=>ep});var l=n(32909),r=n(42642),t=n(62540),a=n(63696),s=n(74343),d=n(68430),c=n(98261),o=n(75530),u=n(54518),h=n(48281),m=n(28338),b=n(70045),x=n(42957),p=n(69548),j=n(90717),f=n(96526),v=n(52993),y=n(84818),g=n(7261),A=n(40989),_=n(60423),C=n(40111),k=n(93472),S=n(24773),T=n(98259),w=n(52362),E=n(89705),N=n(24296),B=n(4392),F=n(99528),I=n(99134),D=n(51380),K=n(76072),L=n(97299),O=n(17327),P=n(64361),q=n(71603),Z=n(1020),M=n(24974),J=n(21639),H=n(3939),V=n(38927),W=n(80057),X=n(13021),R=n(10410),Y=n(12852),$=n(23909),z=n(40665);let Q=e=>{var i,n;let{advisory:l}=e,[r,s]=a.useState(!1),d=()=>{s(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(K.x,{hasGutter:!0,children:[(0,t.jsx)(L.E,{md:4,children:(0,t.jsxs)(O.Z,{isFullHeight:!0,children:[(0,t.jsx)(P.Z,{children:"Overview"}),(0,t.jsx)(q.b,{children:(0,t.jsxs)(Z.B,{children:[(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"Title"}),(0,t.jsx)(H.d,{children:l.title})]}),(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"Type"}),(0,t.jsx)(H.d,{children:l.labels.type})]}),(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"Size"}),(0,t.jsx)(H.d,{children:(0,D.A)(l.size)})]}),(0,t.jsxs)(M.W,{children:[(0,t.jsxs)(J.X,{children:["Labels ","",(0,t.jsx)(S.$n,{variant:S.Ak.link,size:"sm",icon:(0,t.jsx)(R.Ay,{}),iconPosition:"end",onClick:()=>s(!0),children:"Edit"})]}),(0,t.jsx)(H.d,{children:(0,t.jsx)(O.Z,{isCompact:!0,children:(0,t.jsx)(q.b,{children:l.labels&&(0,t.jsx)(Y.g,{defaultIsOpen:!0,value:l.labels})})})})]})]})})]})}),(0,t.jsx)(L.E,{md:4,children:(0,t.jsxs)(O.Z,{isFullHeight:!0,children:[(0,t.jsx)(P.Z,{children:"Publisher"}),(0,t.jsx)(q.b,{children:(0,t.jsxs)(Z.B,{children:[(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"Name"}),(0,t.jsx)(H.d,{children:null==(i=l.issuer)?void 0:i.name})]}),(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"Contact details"}),(0,t.jsx)(H.d,{children:null==(n=l.issuer)?void 0:n.website})]})]})})]})}),(0,t.jsx)(L.E,{md:4,children:(0,t.jsxs)(O.Z,{isFullHeight:!0,children:[(0,t.jsx)(P.Z,{children:"Tracking"}),(0,t.jsx)(q.b,{children:(0,t.jsxs)(Z.B,{children:[(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"ID"}),(0,t.jsx)(H.d,{children:l.identifier})]}),(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"Initial release date"}),(0,t.jsx)(H.d,{children:(0,$.Yq)(l.published)})]}),(0,t.jsxs)(M.W,{children:[(0,t.jsx)(J.X,{children:"Current release date"}),(0,t.jsx)(H.d,{children:(0,$.Yq)(l.modified)})]})]})})]})})]}),(0,t.jsxs)(V.a,{isOpen:r,variant:"medium",title:"Edit labels",onClose:d,children:[(0,t.jsx)(W.r,{title:"Edit labels"}),(0,t.jsx)(X.c,{children:(0,t.jsx)(z.t,{advisory:l,onClose:d})})]})]})};var G=n(61360),U=n(35048),ee=n(32490),ei=n(26917),en=n(16646),el=n(21758),er=n(40384),et=n(28516),ea=n(78517),es=n(59771),ed=n(27875),ec=n(45969),eo=n(93826),eu=n(30448),eh=n(20311),em=n(64377),eb=n(73470);let ex=e=>{let{isFetching:i,fetchError:n,vulnerabilities:a}=e,d=(0,eb.vY)({tableName:"vulnerability-table",idProperty:"identifier",items:a,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:c,numRenderedColumns:o,propHelpers:{toolbarProps:u,paginationToolbarItemProps:h,paginationProps:m,tableProps:b,getThProps:x,getTrProps:p,getTdProps:j},expansionDerivedState:{isCellExpanded:f}}=d;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G.M,(0,r._)((0,l._)({},u),{"aria-label":"vulnerability toolbar",children:(0,t.jsx)(U.P,{children:(0,t.jsx)(ee.T,(0,r._)((0,l._)({},h),{children:(0,t.jsx)(eo.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:m})}))})})),(0,t.jsxs)(ei.X,(0,r._)((0,l._)({},b),{"aria-label":"vulnerability table",children:[(0,t.jsx)(en.d,{children:(0,t.jsx)(el.Tr,{children:(0,t.jsxs)(eu.Ze,(0,r._)((0,l._)({},d),{children:[(0,t.jsx)(er.Th,(0,l._)({},x({columnKey:"identifier"}))),(0,t.jsx)(er.Th,(0,l._)({},x({columnKey:"title"}))),(0,t.jsx)(er.Th,(0,l._)({},x({columnKey:"discovery"}))),(0,t.jsx)(er.Th,(0,l._)({},x({columnKey:"release"}))),(0,t.jsx)(er.Th,(0,l._)({},x({columnKey:"score"}))),(0,t.jsx)(er.Th,(0,l._)({},x({columnKey:"cwe"})))]}))})}),(0,t.jsx)(eu.nJ,{isLoading:i,isError:!!n,isNoData:0===a.length,numRenderedColumns:o,children:null==c?void 0:c.map((e,i)=>{var n;return(0,t.jsx)(et.N,{isExpanded:f(e),children:(0,t.jsx)(el.Tr,(0,r._)((0,l._)({},p({item:e})),{children:(0,t.jsxs)(eu.Oi,(0,r._)((0,l._)({},d),{item:e,rowIndex:i,children:[(0,t.jsx)(ea.Td,(0,r._)((0,l._)({width:15,modifier:"breakWord"},j({columnKey:"identifier"})),{children:(0,t.jsx)(s.N_,{to:(0,s.tW)(w.Jh.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,t.jsx)(eh.R,{children:(i,n)=>(0,t.jsx)(ea.Td,(0,r._)((0,l._)({width:40,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},j({columnKey:"title"})),{children:(0,t.jsx)(es.mA,{focused:i,wrapModifier:"truncate",children:(0,t.jsx)(em.j,{vulnerability:e})})}))}),(0,t.jsx)(ea.Td,(0,r._)((0,l._)({width:15},j({columnKey:"discovery"})),{children:(0,$.Yq)(e.discovered)})),(0,t.jsx)(ea.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},j({columnKey:"release"})),{children:(0,$.Yq)(e.released)})),(0,t.jsx)(ea.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},j({columnKey:"score"})),{children:e.severity&&(0,t.jsx)(ec.h,{value:(0,ed.U)(e.severity),score:null!=(n=e.score)?n:null,showLabel:!0,showScore:!0})})),(0,t.jsx)(ea.Td,(0,r._)((0,l._)({width:10,modifier:"truncate"},j({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,t.jsx)(eo.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:m})]})},ep=()=>{var e,i;let n=(0,s.Zp)(),{pushNotification:D}=a.useContext(B.K),K=(0,w.Lu)("advisoryId"),{advisory:L,isFetching:O,fetchError:P}=(0,I.vy)(K),[q,Z]=a.useState(!1),M=()=>{Z(!q)},{downloadAdvisory:J}=(0,F.m)(),[H,V]=a.useState(!1),{mutate:W,isPending:X}=(0,I.ni)(e=>{V(!1),D({title:(0,T.PN)(e),variant:"success"}),n("/advisories")},e=>{D({title:(0,T.EU)(e),variant:"danger"})}),[R,Y]=a.useState(0),$=a.createRef(),z=a.createRef();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.d8,{type:"breadcrumb",children:(0,t.jsxs)(c.Q,{children:[(0,t.jsx)(o.J,{children:(0,t.jsx)(s.N_,{to:w.Jh.advisories,children:"Advisories"})}),(0,t.jsx)(o.J,{isActive:!0,children:"Advisory details"})]})}),(0,t.jsx)(d.d8,{children:(0,t.jsxs)(u.B,{children:[(0,t.jsx)(h.o,{isFilled:!0,children:(0,t.jsxs)(m.s,{children:[(0,t.jsx)(b.Z,{spacer:{default:"spacerSm"},children:(0,t.jsxs)(x.U,{children:[(0,t.jsx)(x.U,{component:"h1",children:null!=(i=null!=(e=null==L?void 0:L.document_id)?e:K)?i:""}),(0,t.jsx)(x.U,{component:"p",children:"Advisory detail information"})]})}),(0,t.jsx)(b.Z,{children:(null==L?void 0:L.labels.type)&&(0,t.jsx)(p.J,{color:"blue",children:null==L?void 0:L.labels.type})})]})}),(0,t.jsx)(h.o,{children:L&&(0,t.jsx)(j.m,{isOpen:q,onSelect:()=>Z(!1),onOpenChange:e=>Z(e),popperProps:{position:"right"},toggle:e=>(0,t.jsx)(f.S3,{ref:e,onClick:M,isExpanded:q,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsxs)(v.Q,{children:[(0,t.jsx)(y.t,{onClick:()=>{K&&J(K,(null==L?void 0:L.identifier)?"".concat(null==L?void 0:L.identifier,".json"):"".concat(K,".json"))},children:"Download Advisory"},"advisory"),(0,t.jsx)(g.c,{component:"li"},"separator"),(0,t.jsx)(y.t,{onClick:()=>V(!0),children:"Delete"},"delete")]})})})]})}),(0,t.jsx)(d.d8,{children:(0,t.jsxs)(A.t,{mountOnEnter:!0,activeKey:R,onSelect:(e,i)=>{Y(i)},"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,t.jsx)(_.o,{eventKey:0,title:(0,t.jsx)(C.V,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:$}),(0,t.jsx)(_.o,{eventKey:1,title:(0,t.jsx)(C.V,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:z})]})}),(0,t.jsxs)(d.d8,{children:[(0,t.jsx)(k.J,{eventKey:0,id:"refTabInfoSection",ref:$,"aria-label":"Information of the Advisory",children:(0,t.jsx)(N.a,{isFetching:O,fetchError:P,children:L&&(0,t.jsx)(Q,{advisory:L})})}),(0,t.jsx)(k.J,{eventKey:1,id:"refVulnerabilitiesSection",ref:z,"aria-label":"Vulnerabilities within the Advisory",hidden:!0,children:(0,t.jsx)(ex,{isFetching:O,fetchError:P,vulnerabilities:(null==L?void 0:L.vulnerabilities)||[]})})]}),(0,t.jsx)(E.T,(0,r._)((0,l._)({},(0,T.p6)(L)),{inProgress:X,titleIconVariant:"warning",isOpen:H,confirmBtnVariant:S.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>V(!1),onClose:()=>V(!1),onConfirm:()=>{L&&W(L.uuid)}}))]})}},40665:function(e,i,n){n.d(i,{t:()=>d});var l=n(62540),r=n(63696),t=n(91242),a=n(4392),s=n(99134);let d=e=>{let{advisory:i,onClose:n}=e,{pushNotification:d}=r.useContext(a.K),[c,o]=r.useState(""),[u,h]=r.useState(""),{labels:m}=(0,s.eq)(u);r.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:b,isPending:x}=(0,s.uJ)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),n()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,l.jsx)(t.e,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:x,onSave:e=>{b({id:i.uuid,labels:e})},onClose:n,onInputChange:o,options:m})}},99134:function(e,i,n){n.d(i,{VH:()=>j,Yu:()=>y,eq:()=>p,ni:()=>v,uJ:()=>g,vy:()=>f});var l=n(32909),r=n(42642),t=n(72610),a=n(77184),s=n(59722),d=n(62603),c=n(90130),o=n(96002),u=n(86141),h=n(81895),m=n(73470),b=n(93531);let x="advisories",p=e=>{let{data:i,isLoading:n,error:l,refetch:r}=(0,a.I)({queryKey:[x,"labels",e],queryFn:()=>(0,u.J)({client:o.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==i?void 0:i.data)||[],isFetching:n,fetchError:l,refetch:r}},j=function(){var e,i,n;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,m.kd)(s),{q:b}=h,p=(0,t._)(h,["q"]),j=(0,m.Er)(d),{data:f,isLoading:v,error:y,refetch:g}=(0,a.I)({queryKey:[x,s,j],queryFn:()=>(0,u.YM)({client:o.S,query:(0,r._)((0,l._)({},p),{q:[b,j].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==f||null==(e=f.data)?void 0:e.items)||[],total:null!=(n=null==f||null==(i=f.data)?void 0:i.total)?n:0,params:s},isFetching:v,fetchError:y||null,refetch:g}},f=e=>{let{data:i,isLoading:n,error:l}=(0,a.I)({queryKey:[x,e],queryFn:()=>(0,u.ai)({client:o.S,path:{key:e}}),enabled:!!e});return{advisory:null==i?void 0:i.data,isFetching:n,fetchError:l}},v=(e,i)=>{let n=(0,d.jE)();return(0,c.n)({mutationFn:async e=>(await (0,u.vl)({client:o.S,path:{key:e}})).data,onSuccess:async(i,l)=>{e(i,l),await n.invalidateQueries({queryKey:[x]})},onError:async e=>{i(e),await n.invalidateQueries({queryKey:[x]})}})},y=()=>{let e=(0,d.jE)();return(0,b.v)({parallel:!0,uploadFn:(e,i)=>(0,h.hP)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[x]})}})},g=(e,i)=>{let n=(0,d.jE)();return(0,c.n)({mutationFn:e=>(0,u._e)({client:o.S,path:{id:e.id},body:e.labels}),onSuccess:async(i,l)=>{e(),await n.invalidateQueries({queryKey:[x]})},onError:i})}},47328:function(e,i,n){n.d(i,{A:()=>l});let l={button:"pf-v6-c-button",card:"pf-v6-c-card",cardActions:"pf-v6-c-card__actions",cardBody:"pf-v6-c-card__body",cardClickableAction:"pf-v6-c-card__clickable-action",cardExpandableContent:"pf-v6-c-card__expandable-content",cardFooter:"pf-v6-c-card__footer",cardHeader:"pf-v6-c-card__header",cardHeaderMain:"pf-v6-c-card__header-main",cardHeaderToggle:"pf-v6-c-card__header-toggle",cardHeaderToggleIcon:"pf-v6-c-card__header-toggle-icon",cardSelectableActions:"pf-v6-c-card__selectable-actions",cardTitle:"pf-v6-c-card__title",cardTitleText:"pf-v6-c-card__title-text",check:"pf-v6-c-check",checkInput:"pf-v6-c-check__input",checkLabel:"pf-v6-c-check__label",dirRtl:"pf-v6-m-dir-rtl",divider:"pf-v6-c-divider",modifiers:{selectable:"pf-m-selectable",clickable:"pf-m-clickable",current:"pf-m-current",selected:"pf-m-selected",disabled:"pf-m-disabled",compact:"pf-m-compact",displayLg:"pf-m-display-lg",secondary:"pf-m-secondary",plain:"pf-m-plain",expanded:"pf-m-expanded",fullHeight:"pf-m-full-height",toggleRight:"pf-m-toggle-right",wrap:"pf-m-wrap",noOffset:"pf-m-no-offset",inline:"pf-m-inline",noFill:"pf-m-no-fill"},radio:"pf-v6-c-radio",radioInput:"pf-v6-c-radio__input",radioLabel:"pf-v6-c-radio__label"}},51380:function(e,i,n){n.d(i,{A:()=>d});let l=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],t=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],a=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],s=(e,i,n)=>{let l=e;return"string"==typeof i||Array.isArray(i)?l=e.toLocaleString(i,n):(!0===i||void 0!==n)&&(l=e.toLocaleString(void 0,n)),l};function d(e,i){let n;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?a:t:i.binary?r:l,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(n={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(n={maximumFractionDigits:i.maximumFractionDigits,...n}),e<1)return u+s(e,i.locale,n)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,n||(e=e.toPrecision(3)),u+s(Number(e),i.locale,n)+c+d[h]}}}]);