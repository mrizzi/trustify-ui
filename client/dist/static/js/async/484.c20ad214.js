"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["484"],{87017:function(e,a,r){r.d(a,{Co:()=>p,Cu:()=>d,Hb:()=>c});var t=r(70233),s=r(74502);r(41947);let l="/api",n=`${l}/v2/advisory`,o=`${l}/v2/sbom`,i=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},d=(e,a)=>{let r=e.get(s.TB);return t.Z.post(`${n}`,r,{...a,headers:{"Content-Type":i(r)}})},c=(e,a)=>{let r=e.get(s.TB);return t.Z.post(`${o}`,r,{...a,headers:{"Content-Type":i(r)}})},p=e=>t.Z.get(`${o}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},95169:function(e,a,r){r.d(a,{V:()=>d});var t=r(27378),s=r(74502),l=r(70233);let n="cancelled",o=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),i=(e,a)=>{switch(a.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"queued",cancelFn:a.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),progress:a.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"complete",response:a.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"complete",error:a.payload.error,wasCancelled:a.payload.error?.message===n})};case"removeUpload":{let r=new Map(e.uploads);return r.delete(a.payload.file),{...e,uploads:r}}default:throw Error()}},d=e=>{let{parallel:a,uploadFn:r,onSuccess:o,onError:d}=e,[c,p]=t.useReducer(i,{uploads:new Map});return{uploads:c.uploads,handleUpload:e=>{let t=[];for(let a=0;a<e.length;a++){let r=e[a],i=new FormData;i.set(s.TB,r);let c=l.Z.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let a=e.total??1;p({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/a*100)}})},cancelToken:c.token};p({type:"queueUpload",payload:{file:r,cancelFn:c}});let h={formData:i,config:u,thenFn:e=>{p({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),o&&o(e,r)},catchFn:e=>{p({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==n&&d&&d(e,r)}};t.push(h)}if(a)for(let e of t)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else t.reduce(async(e,a)=>(await e,r(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(n)},handleRemoveUpload:e=>{p({type:"removeUpload",payload:{file:e}})}}}},34473:function(e,a,r){r.r(a),r.d(a,{default:()=>M});var t=r(24246),s=r(27378),l=r(45043),n=r(68802),o=r(31757),i=r(51527),d=r(4075),c=r(27090),p=r(75165),u=r(31762),h=r(99),y=r(24787),f=r(90359),g=r(12621),m=r(17598),v=r(43959),x=r(51851),j=r(21714),F=r(40270),q=r(23056),b=r(91057),U=r(84335),w=r(13754),E=r(79551),L=r(32489),P=r(90519),C=r(81211),S=r(45882),K=r(22621),R=r(416);let T=e=>{let{uploads:a,handleUpload:r,handleRemoveUpload:l,extractSuccessMessage:n,extractErrorMessage:o}=e,[i,d]=s.useState(!1),[c,p]=s.useState("inProgress"),[u,h]=s.useState([]);!i&&a.size>0&&d(!0),s.useEffect(()=>{let e=Array.from(a.values());e.some(e=>"inProgress"===e.status)?p("inProgress"):e.every(e=>"complete"===e.status)?p("success"):p("danger")},[a]);let y=Array.from(a.values()).filter(e=>e.response).length;return(0,t.jsxs)(x.o,{onFileDrop:(e,a)=>{r(a)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{h(e)},useFsAccessApi:!1},children:[(0,t.jsx)(j.Y,{titleIcon:(0,t.jsx)(R.ZP,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),i&&(0,t.jsx)(F.M,{statusToggleText:`${y} of ${a.size} files uploaded`,statusToggleIcon:c,children:Array.from(a.entries()).map((e,a)=>{let[r,s]=e;return(0,t.jsx)(q.B,{customFileHandler:()=>{},fileIcon:(0,t.jsx)(K.ZP,{}),file:r,onClearClick:()=>(e=>{for(let a of e)l(a)})([r]),progressValue:s.progress,progressVariant:s.error?"danger":s.response?"success":void 0,progressHelperText:s.error?(0,t.jsx)(b.p,{isLiveRegion:!0,children:(0,t.jsx)(U.u,{variant:"error",children:o(s.error)})}):100!==s.progress||s.response?s.response?(0,t.jsx)(b.p,{isLiveRegion:!0,children:(0,t.jsx)(U.u,{variant:"default",children:n(s.response)})}):void 0:(0,t.jsx)(b.p,{isLiveRegion:!0,children:(0,t.jsxs)(U.u,{variant:"warning",children:[(0,t.jsx)(w.$,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},`${r.name}-${a}`)})}),(0,t.jsxs)(E.u,{isOpen:u.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>h([]),variant:"small",children:[(0,t.jsx)(L.x,{title:"Unsupported files",titleIconVariant:"warning"}),(0,t.jsx)(P.f,{children:(0,t.jsx)(C.aV,{children:u.map(e=>(0,t.jsx)(S.H,{children:e.file.name},e.file.name))})})]})]})},M=()=>{let{uploads:e,handleUpload:a,handleRemoveUpload:r}=(0,v.km)(),{uploads:x,handleUpload:j,handleRemoveUpload:F}=(0,m.tG)(),q=s.createRef(),b=s.createRef();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.NP,{hasBodyWrapper:!1,children:(0,t.jsx)(n.V,{children:(0,t.jsx)(n.V,{component:"h1",children:"Upload"})})}),(0,t.jsx)(l.NP,{hasBodyWrapper:!1,children:(0,t.jsx)(o.Z,{children:(0,t.jsx)(i.e,{children:(0,t.jsxs)(d.m,{defaultActiveKey:0,children:[(0,t.jsx)(c.O,{eventKey:0,title:(0,t.jsx)(p.T,{children:"SBOM"}),actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.b,{ref:q,children:(0,t.jsx)(g.ZP,{})}),(0,t.jsx)(h.J,{bodyContent:(0,t.jsx)("div",{children:"Upload a Software Bill of Materials (SBOM) document. We accept CycloneDX versions 1.3, 1.4, 1.5 and 1.6, and System Package Data Exchange (SPDX) versions 2.2, and 2.3."}),triggerRef:q})]}),children:(0,t.jsx)(y.I,{id:"upload-sbom-tab-content",children:(0,t.jsx)(f.H,{hasPadding:!0,children:(0,t.jsx)(T,{uploads:e,handleUpload:a,handleRemoveUpload:r,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})})})}),(0,t.jsx)(c.O,{eventKey:1,title:(0,t.jsx)(p.T,{children:"Advisory"}),actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.b,{ref:b,children:(0,t.jsx)(g.ZP,{})}),(0,t.jsx)(h.J,{bodyContent:(0,t.jsx)("div",{children:"Upload a CSAF, CVE, or OSV Advisory."}),triggerRef:b})]}),children:(0,t.jsx)(y.I,{id:"upload-advisory-tab-content",children:(0,t.jsx)(f.H,{hasPadding:!0,children:(0,t.jsx)(T,{uploads:x,handleUpload:j,handleRemoveUpload:F,extractSuccessMessage:e=>`${e.data.document_id} uploaded`,extractErrorMessage:e=>e.response?.data?e.message:"Error while uploading file"})})})})]})})})})]})}},17598:function(e,a,r){r.d(a,{N7:()=>y,VY:()=>h,gw:()=>f,sj:()=>m,tG:()=>g});var t=r(1183),s=r(24038),l=r(68e3),n=r(75503),o=r(50576),i=r(40371),d=r(87017),c=r(49988),p=r(95169);let u="advisories",h=e=>{let{data:a,isLoading:r,error:l,refetch:n}=(0,t.a)({queryKey:[u,"labels",e],queryFn:()=>(0,i.sf)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:a?.data||[],isFetching:r,fetchError:l,refetch:n}},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:s,...l}=(0,c.rm)(e),n=(0,c.Rb)(a),{data:d,isLoading:p,error:h,refetch:y}=(0,t.a)({queryKey:[u,e,n],queryFn:()=>(0,i.A1)({client:o.L,query:{...l,q:[s,n].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:d?.data?.items||[],total:d?.data?.total??0,params:e??e},isFetching:p,fetchError:h||null,refetch:y}},f=e=>{let{data:a,isLoading:r,error:s}=(0,t.a)({queryKey:[u,e],queryFn:()=>(0,i.pB)({client:o.L,path:{key:e}}),enabled:void 0!==e});return{advisory:a?.data,isFetching:r,fetchError:s}},g=()=>{let e=(0,l.NL)();return(0,p.V)({parallel:!0,uploadFn:(e,a)=>(0,d.Cu)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[u]})}})},m=(e,a)=>{let r=(0,l.NL)();return(0,n.D)({mutationFn:e=>(0,i.m5)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async(a,t)=>{e(),await r.invalidateQueries({queryKey:[u]})},onError:a})}},43959:function(e,a,r){r.d(a,{Fz:()=>f,KQ:()=>j,Oh:()=>x,i5:()=>y,km:()=>m,p4:()=>g,qi:()=>q,t9:()=>v,uz:()=>F});var t=r(1183),s=r(24038),l=r(68e3),n=r(75503),o=r(16072),i=r(50576),d=r(40371),c=r(95169),p=r(87017),u=r(49988);let h="sboms",y=e=>{let{data:a,isLoading:r,error:l,refetch:n}=(0,t.a)({queryKey:[h,"labels",e],queryFn:()=>(0,d.mh)({client:i.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:a?.data||[],isFetching:r,fetchError:l,refetch:n}},f=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:s,...l}=(0,u.rm)(e),n=(0,u.Rb)(a),{data:o,isLoading:c,error:p,refetch:y}=(0,t.a)({queryKey:[h,e,n],queryFn:()=>(0,d.Wp)({client:i.L,query:{...l,q:[s,n].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:o?.data?.items||[],total:o?.data?.total??0,params:e??e},isFetching:c,fetchError:p,refetch:y}},g=e=>{let{data:a,isLoading:r,error:s}=(0,t.a)({queryKey:[h,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,d._Q)({client:i.L,path:{id:e}}),enabled:void 0!==e});return{sbom:a?.data,isFetching:r,fetchError:s}},m=()=>{let e=(0,l.NL)();return(0,c.V)({parallel:!0,uploadFn:(e,a)=>(0,p.Hb)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[h]})}})},v=(e,a)=>{let r=(0,l.NL)();return(0,n.D)({mutationFn:e=>(0,d.zx)({client:i.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[h]})},onError:a})},x=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:s,error:l,refetch:n}=(0,t.a)({queryKey:[h,"by-package",e,a],queryFn:()=>(0,d.DU)({client:i.L,query:{purl:e,...(0,u.rm)(a)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:a??a},isFetching:s,fetchError:l,refetch:n}},j=e=>{let{data:a,isLoading:r,error:s}=(0,t.a)({queryKey:[h,e,"advisory"],queryFn:()=>(0,d.NU)({client:i.L,path:{id:e}})});return{advisories:a?.data||[],isFetching:r,fetchError:s}},F=e=>{let a=(0,o.h)({queries:e.map(e=>({queryKey:[h,e,"advisory"],queryFn:()=>(0,d.NU)({client:i.L,path:{id:e}})}))});return{advisories:a.map(e=>{let{data:a}=e;return a?.data||[]}),isFetching:a.some(e=>{let{isLoading:a}=e;return a}),fetchError:a.map(e=>{let{error:a}=e;return a})}},q=e=>{let{data:a,isLoading:r,error:s}=(0,t.a)({queryKey:[h,e,"license-ids"],queryFn:()=>(0,d.J4)({client:i.L,path:{id:e}})});return{licenseIds:a?.data||[],isFetching:r,fetchError:s}}}}]);