"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["117"],{6160:function(e,t,s){s.d(t,{E:()=>l});var r=s(97517),i=s(62540);let n={circle:"pf-m-circle",square:"pf-m-square",widthSm:"pf-m-width-sm",widthMd:"pf-m-width-md",widthLg:"pf-m-width-lg",width_25:"pf-m-width-25",width_33:"pf-m-width-33",width_50:"pf-m-width-50",width_66:"pf-m-width-66",width_75:"pf-m-width-75",heightSm:"pf-m-height-sm",heightMd:"pf-m-height-md",heightLg:"pf-m-height-lg",height_25:"pf-m-height-25",height_33:"pf-m-height-33",height_50:"pf-m-height-50",height_66:"pf-m-height-66",height_75:"pf-m-height-75",height_100:"pf-m-height-100",text_4xl:"pf-m-text-4xl",text_3xl:"pf-m-text-3xl",text_2xl:"pf-m-text-2xl",textXl:"pf-m-text-xl",textLg:"pf-m-text-lg",textMd:"pf-m-text-md",textSm:"pf-m-text-sm"};var a=s(62634);let l=e=>{var{className:t,width:s,height:l,fontSize:o,shape:u,screenreaderText:c}=e,h=(0,r.__rest)(e,["className","width","height","fontSize","shape","screenreaderText"]);let d=o?Object.values(n).find(e=>e===`pf-m-text-${o}`):void 0;return(0,i.jsx)("div",Object.assign({},h,{className:(0,a.A)("pf-v6-c-skeleton",o&&d,"circle"===u&&n.circle,"square"===u&&n.square,t)},(s||l)&&{style:Object.assign({"--pf-v6-c-skeleton--Width":s||void 0,"--pf-v6-c-skeleton--Height":l||void 0},h.style)},{children:(0,i.jsx)("span",{className:"pf-v6-screen-reader",children:c})}))};l.displayName="Skeleton"},81895:function(e,t,s){s.d(t,{J4:()=>d,SP:()=>p,Z3:()=>m,hP:()=>h});var r=s(32909),i=s(42642),n=s(46165),a=s(98259);s(56161);let l="/api",o="".concat(l,"/v2/advisory"),u="".concat(l,"/v2/sbom"),c=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},h=(e,t)=>{let s=e.get(a.fs);return n.A.post("".concat(o),s,(0,i._)((0,r._)({},t),{headers:{"Content-Type":c(s)}}))},d=(e,t)=>{let s=e.get(a.fs);return n.A.post("".concat(u),s,(0,i._)((0,r._)({},t),{headers:{"Content-Type":c(s)}}))},p=(e,t)=>{let s=e.get(a.fs);return n.A.post("/api/v2/ui/extract-sbom-purls",s,(0,i._)((0,r._)({},t),{headers:{"Content-Type":c(s)}}))},m=e=>n.A.get("".concat(u,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},24296:function(e,t,s){s.d(t,{a:()=>l});var r=s(62540),i=s(59394),n=s(81595),a=s(40554);let l=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(i.a,{children:(0,r.jsx)(n.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(a.q,{}):e.children},93826:function(e,t,s){s.d(t,{n:()=>l});var r=s(32909),i=s(42642),n=s(62540),a=s(56682);let l=e=>{let{paginationProps:t,isTop:s,isCompact:l=!1,idPrefix:o=""}=e;return(0,n.jsx)(a.d,(0,i._)((0,r._)({id:"".concat(o?"".concat(o,"-"):"","pagination-").concat(s?"top":"bottom"),variant:s?a.A.top:a.A.bottom,isCompact:l},t),{widgetId:"pagination-id"}))}},40554:function(e,t,s){s.d(t,{q:()=>l});var r=s(62540),i=s(48655),n=s(92411),a=s(60087);let l=()=>(0,r.jsx)(i.pp,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:a.Ay,variant:i.s$.sm,children:(0,r.jsx)(n.h,{children:"There was an error retrieving data. Check your connection and try again."})})},92107:function(e,t,s){s.d(t,{D:()=>n});var r=s(62540),i=s(69548);let n=e=>{let{error:t}=e;return(0,r.jsxs)(i.J,{color:"red",children:[t.status," Error"]})}},30448:function(e,t,s){s.d(t,{Ze:()=>g,nJ:()=>f,Oi:()=>b});var r=s(62540),i=s(59394),n=s(81595),a=s(28516),l=s(21758),o=s(78517),u=s(40554),c=s(48655),h=s(92411),d=s(28469);let p=e=>{let{title:t,description:s}=e;return(0,r.jsx)(c.pp,{titleText:t,headingLevel:"h4",icon:d.Ay,variant:c.s$.sm,children:s&&(0,r.jsx)(h.h,{children:s})})},m=()=>(0,r.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),f=e=>{let{numRenderedColumns:t,isLoading:s=!1,isError:c=!1,isNoData:h=!1,errorEmptyState:d=null,noDataEmptyState:p=null,children:f}=e;return(0,r.jsx)(r.Fragment,{children:s?(0,r.jsx)(a.N,{"aria-label":"Table loading",children:(0,r.jsx)(l.Tr,{children:(0,r.jsx)(o.Td,{colSpan:t,children:(0,r.jsx)(i.a,{children:(0,r.jsx)(n.y,{size:"xl"})})})})}):c?(0,r.jsx)(a.N,{"aria-label":"Table error",children:(0,r.jsx)(l.Tr,{children:(0,r.jsx)(o.Td,{colSpan:t,children:(0,r.jsx)(i.a,{children:d||(0,r.jsx)(u.q,{})})})})}):h?(0,r.jsx)(a.N,{"aria-label":"Table empty",children:(0,r.jsx)(l.Tr,{children:(0,r.jsx)(o.Td,{colSpan:t,children:(0,r.jsx)(i.a,{children:p||(0,r.jsx)(m,{})})})})}):f})};var y=s(40384);let g=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:s,children:i}=e;return(0,r.jsxs)(r.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,r.jsx)(y.Th,{screenReaderText:"before-data-".concat(t)},t)),i,Array(s).fill(null).map((e,t)=>(0,r.jsx)(y.Th,{screenReaderText:"after-data-".concat(t)},t))]})};var v=s(32909);let b=e=>{let{isExpansionEnabled:t=!1,expandableVariant:s,getSelectCheckboxTdProps:i,propHelpers:{getSingleExpandButtonTdProps:n},item:a,rowIndex:l,children:u}=e;return(0,r.jsxs)(r.Fragment,{children:[t&&"single"===s?(0,r.jsx)(o.Td,(0,v._)({},n({item:a,rowIndex:l}))):null,i?(0,r.jsx)(o.Td,(0,v._)({},i({item:a,rowIndex:l}))):null,u]})}},93531:function(e,t,s){s.d(t,{v:()=>h});var r=s(32909),i=s(42642),n=s(63696),a=s(98259),l=s(46165);let o="cancelled",u=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,t)=>{switch(t.type){case"queueUpload":return(0,i._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,i._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,i._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,i._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,i._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,i._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var s;return(0,i._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,i._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{status:"complete",error:t.payload.error,wasCancelled:(null==(s=t.payload.error)?void 0:s.message)===o}))});case"removeUpload":{let s=new Map(e.uploads);return s.delete(t.payload.file),(0,i._)((0,r._)({},e),{uploads:s})}default:throw Error()}},h=e=>{let{parallel:t,uploadFn:s,onSuccess:r,onError:i}=e,[u,h]=n.useReducer(c,{uploads:new Map});return{uploads:u.uploads,handleUpload:e=>{let n=[];for(let t=0;t<e.length;t++){let s=e[t],u=new FormData;u.set(a.fs,s);let c=l.A.CancelToken.source(),d={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let r=null!=(t=e.total)?t:1;h({type:"updateUploadProgress",payload:{file:s,progress:Math.round(e.loaded/r*100)}})},cancelToken:c.token};h({type:"queueUpload",payload:{file:s,cancelFn:c}});let p={formData:u,config:d,thenFn:e=>{h({type:"finishUploadSuccessfully",payload:{file:s,response:e}}),r&&r(e,s)},catchFn:e=>{h({type:"finishUploadWithError",payload:{file:s,error:e}}),e.message!==o&&i&&i(e,s)}};n.push(p)}if(t)for(let e of n)s(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,t)=>(await e,s(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,s;null==(s=u.uploads.get(e))||null==(t=s.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{h({type:"removeUpload",payload:{file:e}})}}}},68768:function(e,t,s){s.r(t),s.d(t,{default:()=>N});var r=s(62540),i=s(68430),n=s(42957),a=s(32909),l=s(42642),o=s(63696),u=s(98259),c=s(81592),h=s(73470),d=s(97773);let p=o.createContext({}),m=e=>{let{children:t}=e,s=(0,h.MM)({tableName:"license",persistenceKeyPrefix:u.rt.licenses,persistTo:"urlParams",columnNames:{name:"Name",packages:"Packages",sboms:"SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name"],initialSort:{columnKey:"name",direction:"asc"},isFilterEnabled:!0,filterCategories:[{categoryKey:u._G,title:"Name",placeholderText:"Search by license name",type:"search"}],isExpansionEnabled:!1}),{result:{data:i,total:n},isFetching:o,fetchError:c}=(0,d.K)((0,h.Ng)((0,l._)((0,a._)({},s),{hubSortFieldKeys:{name:"license"}})),!1),m=(0,h.PB)((0,l._)((0,a._)({},s),{idProperty:"license",currentPageItems:i,totalItemCount:n,isLoading:o}));return(0,r.jsx)(p.Provider,{value:{totalItemCount:n,isFetching:o,fetchError:c,tableControls:m},children:t})};var f=s(74343),y=s(6160),g=s(26917),v=s(16646),b=s(21758),x=s(40384),j=s(28516),_=s(78517),E=s(24296),w=s(93826),S=s(92107),q=s(30448),F=s(33468);let O=e=>{let{licenseId:t,children:s}=e,{result:i,isFetching:n,fetchError:a}=(0,F.Lx)({filters:[{field:"license",operator:"=",value:t}],page:{itemsPerPage:1,pageNumber:1}});return(0,r.jsx)(r.Fragment,{children:s(null==i?void 0:i.total,n,a)})};var R=s(30111);let M=e=>{let{licenseId:t,children:s}=e,{result:i,isFetching:n,fetchError:a}=(0,R.i$)({filters:[{field:"license",operator:"=",value:t}],page:{itemsPerPage:1,pageNumber:1}},[]);return(0,r.jsx)(r.Fragment,{children:s(null==i?void 0:i.total,n,a)})};var T=s(29991),k=s(52362);let C=()=>{let{isFetching:e,fetchError:t,totalItemCount:s,tableControls:i}=o.useContext(p),{numRenderedColumns:n,currentPageItems:c,propHelpers:{paginationProps:d,tableProps:m,getThProps:F,getTrProps:R,getTdProps:C}}=i;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(g.X,(0,l._)((0,a._)({},m),{"aria-label":"License table",children:[(0,r.jsx)(v.d,{children:(0,r.jsx)(b.Tr,{children:(0,r.jsxs)(q.Ze,(0,l._)((0,a._)({},i),{children:[(0,r.jsx)(x.Th,(0,a._)({},F({columnKey:"name"}))),(0,r.jsx)(x.Th,(0,a._)({},F({columnKey:"packages"}))),(0,r.jsx)(x.Th,(0,a._)({},F({columnKey:"sboms"})))]}))})}),(0,r.jsx)(q.nJ,{isLoading:e,isError:!!t,isNoData:0===s,numRenderedColumns:n,children:c.map((e,t)=>(0,r.jsx)(j.N,{children:(0,r.jsx)(b.Tr,(0,l._)((0,a._)({},R({item:e})),{children:(0,r.jsxs)(q.Oi,(0,l._)((0,a._)({},i),{item:e,rowIndex:t,children:[(0,r.jsx)(_.Td,(0,l._)((0,a._)({width:70,modifier:"breakWord"},C({columnKey:"name",item:e,rowIndex:t})),{children:e.license})),(0,r.jsx)(_.Td,(0,l._)((0,a._)({width:15},C({columnKey:"packages",item:e,rowIndex:t})),{children:(0,r.jsx)(O,{licenseId:e.license,children:(t,s,i)=>{var n;let a,l;return(0,r.jsx)(E.a,{isFetching:s,fetchError:i,isFetchingState:(0,r.jsx)(y.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(S.D,{error:e}),children:t&&t>0?(0,r.jsxs)(f.N_,{to:(n=[e.license],a=(0,h.om)({license:n}),l="".concat((0,T.O)({newPrefixedSerializedParams:{["".concat(u.rt.packages,":").concat("filters")]:a.filters}})),{pathname:k.Jh.packages,search:l}),children:[t," Package",t>1?"s":""]}):"0 Packages"})}},e.license)})),(0,r.jsx)(_.Td,(0,l._)((0,a._)({width:15},C({columnKey:"sboms",item:e,rowIndex:t})),{children:(0,r.jsx)(M,{licenseId:e.license,children:(t,s,i)=>{var n;let a,l;return(0,r.jsx)(E.a,{isFetching:s,fetchError:i,isFetchingState:(0,r.jsx)(y.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(S.D,{error:e}),children:t&&t>0?(0,r.jsxs)(f.N_,{to:(n=[e.license],a=(0,h.om)({license:n}),l="".concat((0,T.O)({newPrefixedSerializedParams:{["".concat(u.rt.sboms,":").concat("filters")]:a.filters}})),{pathname:k.Jh.sboms,search:l}),children:[t," SBOM",t>1?"s":""]}):"0 SBOMs"})}},e.license)}))]}))}))},e.license))})]})),(0,r.jsx)(w.n,{idPrefix:"license-table",isTop:!1,paginationProps:d})]})};var P=s(61360),K=s(35048),U=s(32490);let Q=e=>{let{showFilters:t}=e,{tableControls:s}=o.useContext(p),{propHelpers:{toolbarProps:i,filterToolbarProps:n,paginationToolbarItemProps:u,paginationProps:h}}=s;return(0,r.jsx)(P.M,(0,l._)((0,a._)({},i),{"aria-label":"license-toolbar",children:(0,r.jsxs)(K.P,{children:[t&&(0,r.jsx)(c.Us,(0,a._)({},n)),(0,r.jsx)(U.T,(0,l._)((0,a._)({},u),{children:(0,r.jsx)(w.n,{idPrefix:"license-table",isTop:!0,paginationProps:h})}))]})}))},N=()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.d8,{hasBodyWrapper:!1,children:(0,r.jsx)(n.U,{children:(0,r.jsx)(n.U,{component:"h1",children:"Licenses"})})}),(0,r.jsx)(i.d8,{hasBodyWrapper:!1,children:(0,r.jsx)("div",{children:(0,r.jsxs)(m,{children:[(0,r.jsx)(Q,{showFilters:!0}),(0,r.jsx)(C,{})]})})})]})},97773:function(e,t,s){s.d(t,{K:()=>o});var r=s(32909),i=s(77184),n=s(96002),a=s(86141),l=s(73470);let o=function(){var e,t,s;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:c,isLoading:h,error:d,refetch:p}=(0,i.I)({queryKey:["licenses",o],queryFn:()=>(0,a.Zy)({client:n.S,query:(0,r._)({},(0,l.kd)(o))}),enabled:!u});return{result:{data:(null==c||null==(e=c.data)?void 0:e.items)||[],total:null!=(s=null==c||null==(t=c.data)?void 0:t.total)?s:0,params:o},isFetching:h,fetchError:d,refetch:p}}},33468:function(e,t,s){s.d(t,{Lx:()=>u,Si:()=>c,sl:()=>h});var r=s(32909),i=s(77184),n=s(96002),a=s(86141),l=s(73470);let o="packages",u=function(){var e,t,s;let u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:h,isLoading:d,error:p,refetch:m}=(0,i.I)({queryKey:[o,u],queryFn:()=>(0,a.UD)({client:n.S,query:(0,r._)({},(0,l.kd)(u))}),enabled:!c});return{result:{data:(null==h||null==(e=h.data)?void 0:e.items)||[],total:null!=(s=null==h||null==(t=h.data)?void 0:t.total)?s:0,params:u},isFetching:d,fetchError:p,refetch:m}},c=e=>{let{data:t,isLoading:s,error:r}=(0,i.I)({queryKey:[o,e],queryFn:()=>(0,a.Y0)({client:n.S,path:{key:e}})});return{pkg:null==t?void 0:t.data,isFetching:s,fetchError:r}},h=function(e){var t,s,u;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:h,isLoading:d,error:p,refetch:m}=(0,i.I)({queryKey:[o,"by-sbom",e,c],queryFn:()=>(0,a.Ad)({client:n.S,path:{id:e},query:(0,r._)({},(0,l.kd)(c))})});return{result:{data:(null==h||null==(t=h.data)?void 0:t.items)||[],total:null!=(u=null==h||null==(s=h.data)?void 0:s.total)?u:0,params:c},isFetching:d,fetchError:p,refetch:m}}},30111:function(e,t,s){s.d(t,{DH:()=>w,Qr:()=>E,_P:()=>g,bj:()=>q,cF:()=>_,i$:()=>v,l6:()=>x,rj:()=>b,sn:()=>j,zY:()=>S});var r=s(32909),i=s(42642),n=s(72610),a=s(77184),l=s(59722),o=s(62603),u=s(90130),c=s(3822),h=s(96002),d=s(86141),p=s(93531),m=s(81895),f=s(73470);let y="sboms",g=e=>{let{data:t,isLoading:s,error:r,refetch:i}=(0,a.I)({queryKey:[y,"labels",e],queryFn:()=>(0,d.Dw)({client:h.S,query:{limit:10,filter_text:e}}),placeholderData:l.rX});return{labels:(null==t?void 0:t.data)||[],isFetching:s,fetchError:r,refetch:i}},v=function(){var e,t,s;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,f.kd)(l),{q:p}=c,m=(0,n._)(c,["q"]),g=(0,f.Er)(o),{data:v,isLoading:b,error:x,refetch:j}=(0,a.I)({queryKey:[y,l,g],queryFn:()=>(0,d.z1)({client:h.S,query:(0,i._)((0,r._)({},m),{q:[p,g].filter(e=>e).join("&")})}),enabled:!u});return{result:{data:(null==v||null==(e=v.data)?void 0:e.items)||[],total:null!=(s=null==v||null==(t=v.data)?void 0:t.total)?s:0,params:l},isFetching:b,fetchError:x,refetch:j}},b=(e,t,s)=>{let{data:r,isLoading:i,error:n}=(0,a.I)({queryKey:[y,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,d.a7)({client:h.S,path:{id:e}}),enabled:!!e,refetchInterval:t,retry:s});return{sbom:null==r?void 0:r.data,isFetching:i,fetchError:n}},x=(e,t)=>{let s=(0,o.jE)();return(0,u.n)({mutationFn:async e=>(await (0,d.bS)({client:h.S,path:{id:e}})).data,onSuccess:async(t,r)=>{e(t,r),await s.invalidateQueries({queryKey:[y]}),s.removeQueries({queryKey:[y,r]})},onError:async e=>{t(e),await s.invalidateQueries({queryKey:[y]})}})},j=()=>{let e=(0,o.jE)();return(0,p.v)({parallel:!0,uploadFn:(e,t)=>(0,m.J4)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[y]})}})},_=(e,t)=>{let s=(0,o.jE)();return(0,u.n)({mutationFn:e=>(0,d.aB)({client:h.S,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await s.invalidateQueries({queryKey:[y]})},onError:t})},E=function(e){var t,s,i;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:l,isLoading:o,error:u,refetch:c}=(0,a.I)({queryKey:[y,"by-package",e,n],queryFn:()=>(0,d.m9)({client:h.S,query:(0,r._)({purl:e},(0,f.kd)(n))})});return{result:{data:(null==l||null==(t=l.data)?void 0:t.items)||[],total:null!=(i=null==l||null==(s=l.data)?void 0:s.total)?i:0,params:n},isFetching:o,fetchError:u,refetch:c}},w=e=>{let{data:t,isLoading:s,error:r}=(0,a.I)({queryKey:[y,e,"advisory"],queryFn:()=>(0,d.bj)({client:h.S,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:s,fetchError:r}},S=e=>{let t=(0,c.E)({queries:e.map(e=>({queryKey:[y,e,"advisory"],queryFn:()=>(0,d.bj)({client:h.S,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},q=e=>{let{data:t,isLoading:s,error:r}=(0,a.I)({queryKey:[y,e,"license-ids"],queryFn:()=>(0,d.ZV)({client:h.S,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:s,fetchError:r}}},90130:function(e,t,s){s.d(t,{n:()=>c});var r=s(63696),i=s(13040),n=s(72739),a=s(42122),l=s(59722),o=class extends a.Q{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#i()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,l.f8)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,l.EN)(t.mutationKey)!==(0,l.EN)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#i(),this.#n(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#i(),this.#n()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#i(){let e=this.#s?.state??(0,i.$)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#n(e){n.jG.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,s),this.#r.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#r.onError?.(e.error,t,s),this.#r.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#t)})})}},u=s(62603);function c(e,t){let s=(0,u.jE)(t),[i]=r.useState(()=>new o(s,e));r.useEffect(()=>{i.setOptions(e)},[i,e]);let a=r.useSyncExternalStore(r.useCallback(e=>i.subscribe(n.jG.batchCalls(e)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),c=r.useCallback((e,t)=>{i.mutate(e,t).catch(l.lQ)},[i]);if(a.error&&(0,l.GU)(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:c,mutateAsync:a.mutate}}},3822:function(e,t,s){s.d(t,{E:()=>f});var r=s(63696),i=s(72739),n=s(97221),a=s(42122),l=s(59722);function o(e,t){let s=new Set(t);return e.filter(e=>!s.has(e))}var u=class extends a.Q{#e;#a;#l;#o;#u;#c;#h;#d;#p=[];constructor(e,t,s){super(),this.#e=e,this.#o=s,this.#l=[],this.#u=[],this.#a=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#u.forEach(e=>{e.subscribe(t=>{this.#m(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#u.forEach(e=>{e.destroy()})}setQueries(e,t){this.#l=e,this.#o=t,i.jG.batch(()=>{let e=this.#u,t=this.#f(this.#l);this.#p=t,t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let s=t.map(e=>e.observer),r=s.map(e=>e.getCurrentResult()),i=s.some((t,s)=>t!==e[s]);e.length===s.length&&!i||(this.#u=s,this.#a=r,this.hasListeners()&&(o(e,s).forEach(e=>{e.destroy()}),o(s,e).forEach(e=>{e.subscribe(t=>{this.#m(e,t)})}),this.#n()))})}getCurrentResult(){return this.#a}getQueries(){return this.#u.map(e=>e.getCurrentQuery())}getObservers(){return this.#u}getOptimisticResult(e,t){let s=this.#f(e),r=s.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[r,e=>this.#y(e??r,t),()=>this.#g(r,s)]}#g(e,t){return t.map((s,r)=>{let i=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?i:s.observer.trackResult(i,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#y(e,t){return t?(this.#c&&this.#a===this.#d&&t===this.#h||(this.#h=t,this.#d=this.#a,this.#c=(0,l.BH)(this.#c,t(e))),this.#c):e}#f(e){let t=new Map(this.#u.map(e=>[e.options.queryHash,e])),s=[];return e.forEach(e=>{let r=this.#e.defaultQueryOptions(e),i=t.get(r.queryHash);i?s.push({defaultedQueryOptions:r,observer:i}):s.push({defaultedQueryOptions:r,observer:new n.$(this.#e,r)})}),s}#m(e,t){let s=this.#u.indexOf(e);if(-1!==s){var r;let e;this.#a=(r=this.#a,(e=r.slice(0))[s]=t,e),this.#n()}}#n(){if(this.hasListeners()){let e=this.#c,t=this.#g(this.#a,this.#p);e!==this.#y(t,this.#o?.combine)&&i.jG.batch(()=>{this.listeners.forEach(e=>{e(this.#a)})})}}},c=s(62603),h=s(57321),d=s(15818),p=s(81796),m=s(39481);function f({queries:e,...t},s){let a=(0,c.jE)(s),o=(0,h.w)(),f=(0,d.h)(),y=r.useMemo(()=>e.map(e=>{let t=a.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,a,o]);y.forEach(e=>{(0,m.jv)(e),(0,p.LJ)(e,f)}),(0,p.wZ)(f);let[g]=r.useState(()=>new u(a,y,t)),[v,b,x]=g.getOptimisticResult(y,t.combine),j=!o&&!1!==t.subscribed;r.useSyncExternalStore(r.useCallback(e=>j?g.subscribe(i.jG.batchCalls(e)):l.lQ,[g,j]),()=>g.getCurrentResult(),()=>g.getCurrentResult()),r.useEffect(()=>{g.setQueries(y,t)},[y,t,g]);let _=v.some((e,t)=>(0,m.EU)(y[t],e))?v.flatMap((e,t)=>{let s=y[t];if(s){let t=new n.$(a,s);if((0,m.EU)(s,e))return(0,m.iL)(s,t,f);(0,m.nE)(e,o)&&(0,m.iL)(s,t,f)}return[]}):[];if(_.length>0)throw Promise.all(_);let E=v.find((e,t)=>{let s=y[t];return s&&(0,p.$1)({result:e,errorResetBoundary:f,throwOnError:s.throwOnError,query:a.getQueryCache().get(s.queryHash),suspense:s.suspense})});if(E?.error)throw E.error;return b(x())}}}]);