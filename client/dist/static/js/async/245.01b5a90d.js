"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["245"],{32947:function(e,t,r){r.d(t,{A0:()=>g,V4:()=>v,W:()=>x,nE:()=>f});var a=r(91566),i=r(839),n=r(73657),s=r(20644),l=r(89502),o=r(7596),d=r(1811),c=r(24917),u=r(4720),h=r(54178),p=r(37106),y=r(34313);let v={unknown:{name:"Unknown",color:d.P,progressProps:{variant:void 0},icon:a.M$},none:{name:"None",color:c.E,progressProps:{variant:void 0},icon:i.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:n._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:s.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:l.E2},critical:{name:"Critical",color:y.J,progressProps:{variant:"danger"},icon:o.ki}},m=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function g(e){return(t,r)=>m(e(t))-m(e(r))}let x=e=>{let{key:t,value:r}=e;return`${r?`${t}=${r}`:`${t}`}`},f=e=>{let[t,r]=e.split("=");return{key:t,value:r??""}}},7615:function(e,t,r){r.d(t,{g:()=>a});let a=e=>e??"unknown"},87017:function(e,t,r){r.d(t,{Co:()=>u,Cu:()=>d,Hb:()=>c});var a=r(70233),i=r(74502);r(41947);let n="/api",s=`${n}/v2/advisory`,l=`${n}/v2/sbom`,o=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},d=(e,t)=>{let r=e.get(i.TB);return a.Z.post(`${s}`,r,{...t,headers:{"Content-Type":o(r)}})},c=(e,t)=>{let r=e.get(i.TB);return a.Z.post(`${l}`,r,{...t,headers:{"Content-Type":o(r)}})},u=e=>a.Z.get(`${l}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,r){r.d(t,{u:()=>l});var a=r(24246),i=r(8305),n=r(13754),s=r(39826);let l=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(i.b,{children:(0,a.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(s.y,{}):e.children},68057:function(e,t,r){r.d(t,{V:()=>l});var a=r(24246),i=r(27378),n=r(63763),s=r(32947);let l=e=>{let{vulnerabilitiesSummary:t}=e,r=i.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],a=s.V4[e];return{severity:e,count:r,label:a.name,color:a.color.value}}).sort((0,s.A0)(e=>e.severity)).reverse(),[t]);return(0,a.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,a.jsx)(n.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${t.total}`,subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:`${t}: ${r}`}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return`${t.x}: ${t.y}`},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},39826:function(e,t,r){r.d(t,{y:()=>l});var a=r(24246),i=r(10707),n=r(16668),s=r(42160);let l=()=>(0,a.jsx)(i.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:s.ZP,variant:i.IQ.sm,children:(0,a.jsx)(n.B,{children:"There was an error retrieving data. Check your connection and try again."})})},82413:function(e,t,r){r.d(t,{A:()=>c,I:()=>u});var a=r(27378),i=r(7615),n=r(43959);let s=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,l={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:{...l},fixed:{...l},not_affected:{...l},known_not_affected:{...l}}},d=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce((e,t)=>{let r,a=e.find(e=>s(e,t));if(a)r=[...e.filter(e=>!s(e,a)),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,a=(0,i.g)(t.vulnerability.average_severity),n=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:n.total+1,severities:{...n.severities,[a]:n.severities[a]+1}}}})},{...o});return{vulnerabilities:t,summary:r}},c=e=>{let{advisories:t,isFetching:r,fetchError:i}=(0,n.KQ)(e);return{data:a.useMemo(()=>d(t||[]),[t]),isFetching:r,fetchError:i}},u=e=>{let{advisories:t,isFetching:r,fetchError:i}=(0,n.uz)(e);return{data:a.useMemo(()=>(t??[]).map(e=>d(e||[])),[t]),isFetching:r,fetchError:i}}},95169:function(e,t,r){r.d(t,{V:()=>d});var a=r(27378),i=r(74502),n=r(70233);let s="cancelled",l=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),o=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===s})};case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),{...e,uploads:r}}default:throw Error()}},d=e=>{let{parallel:t,uploadFn:r,onSuccess:l,onError:d}=e,[c,u]=a.useReducer(o,{uploads:new Map});return{uploads:c.uploads,handleUpload:e=>{let a=[];for(let t=0;t<e.length;t++){let r=e[t],o=new FormData;o.set(i.TB,r);let c=n.Z.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let t=e.total??1;u({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/t*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:r,cancelFn:c}});let p={formData:o,config:h,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),l&&l(e,r)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==s&&d&&d(e,r)}};a.push(p)}if(t)for(let e of a)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else a.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(s)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},21629:function(e,t,r){r.r(t),r.d(t,{default:()=>eu});var a=r(24246),i=r(45043),n=r(27317),s=r(93095),l=r(14935),o=r(65783),d=r(74485),c=r(76228),u=r(57518),h=r(24216),p=r(13864),y=r(78531),v=r(44870),m=r(93591),g=r(31757),x=r(87069),f=r(51527),j=r(87727),b=r(3498),F=r(68802),w=r(10707),k=r(16668),S=r(30329),q=r(50689),E=r(67761),P=r(81391),C=r(32947),M=r(37818),L=r(82413),$=r(17598),O=r(43959),T=r(63706);let K=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],B=()=>{let e=(0,l.s0)(),{result:{data:t,total:r},isFetching:i,fetchError:B}=(0,O.Fz)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:U,isFetching:V,fetchError:N}=(0,L.I)(t.map(e=>e.id)),D=U.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),_=(e,t)=>`${" ".repeat(t+1)}${e.name}`,{result:{data:I,total:W},isFetching:A,fetchError:Q}=(0,$.N7)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(x.l,{children:"Dashboard"}),(0,a.jsx)(f.e,{children:(0,a.jsxs)(j.r,{children:[(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(M.u,{isFetching:i||V,fetchError:B||N.some(e=>!!e),children:(0,a.jsxs)(n.K,{hasGutter:!0,children:[(0,a.jsx)(s.v,{children:(0,a.jsx)(F.V,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,a.jsx)(s.v,{children:t.length>0?(0,a.jsx)("div",{style:{height:320},children:(0,a.jsxs)(d.k,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:K.map(e=>({name:C.V4[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:c.n.multiOrdered,width:700,legendComponent:(0,a.jsx)(u.Q,{y:10,x:200,colorScale:K.map(e=>C.V4[e.severity].color.value)}),children:[(0,a.jsx)(h.C,{label:"Products",axisLabelComponent:(0,a.jsx)(p.D,{dx:0,x:15,y:140}),tickLabelComponent:(0,a.jsx)(p.D,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:r=>{let a=r.target.innerHTML,i=t.find((e,t)=>_(e,t)===a);i&&e(`/sboms/${i.id}`)}}})}),(0,a.jsx)(h.C,{dependentAxis:!0,showGrid:!0,tickValues:D?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,a.jsx)(y.K,{horizontal:!0,colorScale:K.map(e=>C.V4[e.severity].color.value),children:K.map(e=>{let r=C.V4[e.severity];return(0,a.jsx)(v.B,{labelComponent:(0,a.jsx)(m.h,{constrainToVisibleArea:!0}),data:U.map((a,i)=>{let{summary:{vulnerabilityStatus:{affected:n}}}=a,s=t[i],l=e.severity,o=n.severities[l];return{x:_(s,i),y:o,label:`${r.name}: ${o}`}})},e.severity)})})]})}):(0,a.jsx)(w.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:w.IQ.xs,children:(0,a.jsx)(k.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(M.u,{isFetching:A||i,fetchError:Q||B,children:(0,a.jsxs)(j.r,{hasGutter:!0,children:[(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Last SBOM ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(n.K,{children:[(0,a.jsx)(s.v,{children:(0,T.o0)(t?.[0]?.ingested)}),(0,a.jsx)(s.v,{children:(0,a.jsx)(o.rU,{to:`/sboms/${t?.[0]?.id}`,children:t?.[0]?.name})})]})})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Total SBOMs"}),(0,a.jsx)(P.b,{children:r})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Last Advisory ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(n.K,{children:[(0,a.jsx)(s.v,{children:(0,T.o0)(I?.[0]?.ingested)}),(0,a.jsx)(s.v,{children:(0,a.jsx)(o.rU,{to:`/advisories/${I?.[0]?.uuid}`,children:I?.[0]?.document_id})})]})})]})})}),(0,a.jsx)(b.P,{md:6,children:(0,a.jsx)(S.o,{children:(0,a.jsxs)(q.g,{children:[(0,a.jsx)(E.M,{children:"Total Advisories"}),(0,a.jsx)(P.b,{children:W})]})})})]})})})]})})]})};var U=r(27378),V=r(8305),N=r(13754),D=r(15726),_=r(1183),I=r(68e3),W=r(75503),A=r(50576),Q=r(40371);let z="watched-sboms",Z="dashboard",H=U.createContext({}),R=e=>{let{children:t}=e,{pushNotification:r}=U.useContext(D.c),{sboms:i,isFetching:n,fetchError:s}=(()=>{let{data:e,isLoading:t,error:r}=(0,_.a)({queryKey:[Z,z],queryFn:async()=>{try{return(await (0,Q.JM)({client:A.L,path:{key:z}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}})(),{mutate:l}=((e,t)=>{let r=(0,I.NL)();return(0,W.D)({mutationFn:e=>(0,Q.yu)({client:A.L,path:{key:z},body:e}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[Z,z]})},onError:t})})(()=>{},e=>{r({title:"Error while updating the user preferences",variant:"danger"})});return(0,a.jsx)(H.Provider,{value:{sboms:i,isFetching:n,fetchError:s,patch:(e,t)=>{l({...i,[e]:t})}},children:t})};var G=r(46039),Y=r(18037),J=r(24620),X=r(9426),ee=r(32050),et=r(99589),er=r(17528),ea=r(32623),ei=r(42364),en=r(29765),es=r(21843),el=r(68057);let eo=e=>{let{sbomId:t}=e,{data:r,isFetching:i,fetchError:n}=(0,L.A)(t);return(0,a.jsx)(M.u,{isFetching:i,fetchError:n,children:(0,a.jsx)(el.V,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},ed=e=>{let{fieldName:t,sbomId:r}=e,{patch:i}=U.useContext(H),l=U.useRef(),[d,c]=U.useState(""),[u,h]=U.useState("");U.useEffect(()=>{let e=setTimeout(()=>{h(d)},500);return()=>clearTimeout(e)},[d]);let[p,y]=U.useState(!1),{sbom:v,isFetching:m,fetchError:j}=(0,O.p4)(r??void 0),{result:{data:b}}=(0,O.Fz)({filters:[{field:"",operator:"~",value:u}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),F=()=>{y(!1)},S=()=>{y(!p)},q=()=>{p?d||F():y(!0)},E=(e,t)=>{c(t)},P=()=>{c(""),l?.current?.focus()};return(0,a.jsxs)(g.Z,{isFullHeight:!0,children:[(0,a.jsxs)(M.u,{isFetching:m,fetchError:j,children:[v&&(0,a.jsx)(x.l,{className:es.Z.textBreakWord,children:v?.name}),(0,a.jsx)(f.e,{children:r?(0,a.jsxs)(n.K,{children:[(0,a.jsx)(s.v,{isFilled:!0,children:(0,a.jsx)(eo,{sbomId:r})}),(0,a.jsx)(s.v,{children:(0,a.jsx)(o.rU,{to:`/sboms/${r}`,children:"View Details"})})]}):(0,a.jsx)(w.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:w.IQ.xs,children:(0,a.jsx)(k.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,a.jsx)(G.e,{children:(0,a.jsx)(Y.P,{shouldFocusFirstItemOnOpen:!1,isOpen:p,onSelect:(e,r)=>{r&&i(t,r),F()},onOpenChange:e=>{e||F()},toggle:e=>(0,a.jsx)(J.O_,{ref:e,variant:"typeahead",onClick:S,isExpanded:p,isFullWidth:!0,children:(0,a.jsxs)(X.W,{isPlain:!0,children:[(0,a.jsx)(ee.v,{autoComplete:"off",value:d,onClick:q,onChange:E,innerRef:l,isExpanded:p,placeholder:"Select a new SBOM to watch"}),(0,a.jsx)(et.t,{...!d?{style:{display:"none"}}:{},children:(0,a.jsx)(er.zx,{icon:(0,a.jsx)(en.ZP,{"aria-hidden":!0}),variant:"plain",onClick:P,"aria-label":"Clear input value"})})]})}),children:(0,a.jsx)(ea.E,{children:b.map(e=>(0,a.jsx)(ei.$,{value:e.id,children:e.name},e.id))})})})]})},ec=()=>{let{sboms:e,isFetching:t,fetchError:r}=U.useContext(H);return(0,a.jsx)(M.u,{isFetching:t,fetchError:r,isFetchingState:(0,a.jsx)(j.r,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,a.jsx)(b.P,{md:3,children:(0,a.jsx)(g.Z,{children:(0,a.jsx)(f.e,{children:(0,a.jsx)(V.b,{children:(0,a.jsx)(N.$,{})})})})},e))}),children:(0,a.jsx)(j.r,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,a.jsx)(b.P,{md:3,children:(0,a.jsx)(ed,{fieldName:t,sbomId:r})},`${t}:${r}`)})})})},eu=()=>(0,a.jsx)(i.NP,{hasBodyWrapper:!1,children:(0,a.jsxs)(n.K,{hasGutter:!0,children:[(0,a.jsx)(s.v,{children:(0,a.jsx)(B,{})}),(0,a.jsx)(s.v,{children:(0,a.jsx)(R,{children:(0,a.jsx)(ec,{})})})]})})},17598:function(e,t,r){r.d(t,{N7:()=>y,VY:()=>p,gw:()=>v,sj:()=>g,tG:()=>m});var a=r(1183),i=r(24038),n=r(68e3),s=r(75503),l=r(50576),o=r(40371),d=r(87017),c=r(49988),u=r(95169);let h="advisories",p=e=>{let{data:t,isLoading:r,error:n,refetch:s}=(0,a.a)({queryKey:[h,"labels",e],queryFn:()=>(0,o.sf)({client:l.L,query:{limit:10,filter_text:e}}),placeholderData:i.Wk});return{labels:t?.data||[],isFetching:r,fetchError:n,refetch:s}},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:i,...n}=(0,c.rm)(e),s=(0,c.Rb)(t),{data:d,isLoading:u,error:p,refetch:y}=(0,a.a)({queryKey:[h,e,s],queryFn:()=>(0,o.A1)({client:l.L,query:{...n,q:[i,s].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:d?.data?.items||[],total:d?.data?.total??0,params:e??e},isFetching:u,fetchError:p||null,refetch:y}},v=e=>{let{data:t,isLoading:r,error:i}=(0,a.a)({queryKey:[h,e],queryFn:()=>(0,o.pB)({client:l.L,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:r,fetchError:i}},m=()=>{let e=(0,n.NL)();return(0,u.V)({parallel:!0,uploadFn:(e,t)=>(0,d.Cu)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[h]})}})},g=(e,t)=>{let r=(0,n.NL)();return(0,s.D)({mutationFn:e=>(0,o.m5)({client:l.L,path:{id:e.id},body:e.labels}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[h]})},onError:t})}},43959:function(e,t,r){r.d(t,{Fz:()=>v,KQ:()=>j,Oh:()=>f,i5:()=>y,km:()=>g,p4:()=>m,qi:()=>F,t9:()=>x,uz:()=>b});var a=r(1183),i=r(24038),n=r(68e3),s=r(75503),l=r(16072),o=r(50576),d=r(40371),c=r(95169),u=r(87017),h=r(49988);let p="sboms",y=e=>{let{data:t,isLoading:r,error:n,refetch:s}=(0,a.a)({queryKey:[p,"labels",e],queryFn:()=>(0,d.mh)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:i.Wk});return{labels:t?.data||[],isFetching:r,fetchError:n,refetch:s}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:i,...n}=(0,h.rm)(e),s=(0,h.Rb)(t),{data:l,isLoading:c,error:u,refetch:y}=(0,a.a)({queryKey:[p,e,s],queryFn:()=>(0,d.Wp)({client:o.L,query:{...n,q:[i,s].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e??e},isFetching:c,fetchError:u,refetch:y}},m=e=>{let{data:t,isLoading:r,error:i}=(0,a.a)({queryKey:[p,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,d._Q)({client:o.L,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:i}},g=()=>{let e=(0,n.NL)();return(0,c.V)({parallel:!0,uploadFn:(e,t)=>(0,u.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},x=(e,t)=>{let r=(0,n.NL)();return(0,s.D)({mutationFn:e=>(0,d.zx)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[p]})},onError:t})},f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:i,error:n,refetch:s}=(0,a.a)({queryKey:[p,"by-package",e,t],queryFn:()=>(0,d.DU)({client:o.L,query:{purl:e,...(0,h.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:i,fetchError:n,refetch:s}},j=e=>{let{data:t,isLoading:r,error:i}=(0,a.a)({queryKey:[p,e,"advisory"],queryFn:()=>(0,d.NU)({client:o.L,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:i}},b=e=>{let t=(0,l.h)({queries:e.map(e=>({queryKey:[p,e,"advisory"],queryFn:()=>(0,d.NU)({client:o.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return t?.data||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},F=e=>{let{data:t,isLoading:r,error:i}=(0,a.a)({queryKey:[p,e,"license-ids"],queryFn:()=>(0,d.J4)({client:o.L,path:{id:e}})});return{licenseIds:t?.data||[],isFetching:r,fetchError:i}}}}]);