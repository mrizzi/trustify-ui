"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["819"],{97339:function(e,i,r){r.d(i,{a:()=>d});var s=r(59390),t=r(24246),n=r(27378),l=r(90633),a=r(15508),c=r(53315);let d=e=>{var{children:i=null,className:r="","aria-label":o="Breadcrumb",ouiaId:h,ouiaSafe:u=!0}=e,x=(0,s.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let j=(0,c.S$)(d.displayName,h,u);return(0,t.jsx)("nav",Object.assign({},x,{"aria-label":o,className:(0,a.i)(l.Z.breadcrumb,r)},j,{children:(0,t.jsx)("ol",{className:l.Z.breadcrumbList,role:"list",children:n.Children.map(i,(e,i)=>(0,n.isValidElement)(e)?(0,n.cloneElement)(e,{showDivider:i>0}):e)})}))};d.displayName="Breadcrumb"},18091:function(e,i,r){r.d(i,{g:()=>c});var s=r(59390),t=r(24246),n=r(91985),l=r(90633),a=r(15508);let c=e=>{var{children:i=null,className:r="",to:c,isActive:d=!1,isDropdown:o=!1,showDivider:h,target:u,component:x="a",render:j}=e,m=(0,s.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let b=d?"page":void 0,y=(0,a.i)(l.Z.breadcrumbLink,d&&l.Z.modifiers.current);return(0,t.jsxs)("li",Object.assign({},m,{className:(0,a.i)(l.Z.breadcrumbItem,r),children:[h&&(0,t.jsx)("span",{className:l.Z.breadcrumbItemDivider,children:(0,t.jsx)(n.ZP,{})}),"button"===x&&(0,t.jsx)("button",{className:y,"aria-current":b,type:"button",children:i}),o&&(0,t.jsx)("span",{className:(0,a.i)(l.Z.breadcrumbDropdown),children:i}),j&&j({className:y,ariaCurrent:b}),c&&!j&&(0,t.jsx)(x,{href:c,target:u,className:y,"aria-current":b,children:i}),!c&&"button"!==x&&!o&&i]}))};c.displayName="BreadcrumbItem"},51527:function(e,i,r){r.d(i,{e:()=>a});var s=r(59390),t=r(24246),n=r(24416),l=r(15508);let a=e=>{var{children:i,className:r,component:a="div",isFilled:c=!0}=e,d=(0,s.__rest)(e,["children","className","component","isFilled"]);return(0,t.jsx)(a,Object.assign({className:(0,l.i)(n.Z.cardBody,!c&&n.Z.modifiers.noFill,r)},d,{children:i}))};a.displayName="CardBody"},87069:function(e,i,r){r.d(i,{l:()=>d});var s=r(59390),t=r(24246),n=r(27378),l=r(15508),a=r(24416),c=r(31757);let d=e=>{var{children:i,className:r,component:d="div"}=e,o=(0,s.__rest)(e,["children","className","component"]);let{cardId:h}=(0,n.useContext)(c.H),u=h?`${h}-title`:"";return(0,t.jsx)("div",{className:(0,l.i)(a.Z.cardTitle),children:(0,t.jsx)(d,Object.assign({className:(0,l.i)(a.Z.cardTitleText,r),id:u||void 0},o,{children:i}))})};d.displayName="CardTitle"},67761:function(e,i,r){r.d(i,{M:()=>a});var s=r(59390),t=r(24246),n=r(38436),l=r(15508);let a=e=>{var{children:i,className:r,icon:a}=e,c=(0,s.__rest)(e,["children","className","icon"]);return(0,t.jsxs)("dt",Object.assign({className:(0,l.i)(n.Z.descriptionListTerm,r)},c,{children:[a?(0,t.jsx)("span",{className:(0,l.i)(n.Z.descriptionListTermIcon),children:a}):null,(0,t.jsx)("span",{className:(0,l.i)(n.Z.descriptionListText),children:i})]}))};a.displayName="DescriptionListTerm"},26235:function(e,i,r){r.d(i,{ZP:()=>s});let s=(0,r(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0})},37818:function(e,i,r){r.d(i,{u:()=>a});var s=r(24246),t=r(8305),n=r(13754),l=r(39826);let a=e=>e.isFetching?e.isFetchingState||(0,s.jsx)(t.b,{children:(0,s.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,s.jsx)(l.y,{}):e.children},3586:function(e,i,r){r.d(i,{j:()=>n});var s=r(24246),t=r(27378);let n=e=>{let{children:i}=e,[r,n]=t.useState(!1);return(0,s.jsx)(s.Fragment,{children:i(r,n)})}},24200:function(e,i,r){r.d(i,{G:()=>t});var s=r(24246);let t=e=>{let{vulnerability:i}=e;return(0,s.jsxs)("p",{children:[i.withdrawn&&(0,s.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},2588:function(e,i,r){r.r(i),r.d(i,{default:()=>ea});var s=r(24246),t=r(27378),n=r(65783),l=r(45043),a=r(97339),c=r(18091),d=r(11192),o=r(32591),h=r(34747),u=r(46770),x=r(68802),j=r(70400),m=r(17528),b=r(4075),y=r(27090),v=r(75165),f=r(24787);let p=(0,r(24329).I)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0});var g=r(9839),T=r(37818),N=r(73227),w=r(17598),F=r(65872),E=r(87727),S=r(3498),B=r(31757),C=r(87069),I=r(51527),M=r(30329),Z=r(50689),L=r(67761),P=r(81391),D=r(79551),_=r(32489),K=r(90519),A=r(26235),O=r(7615),k=r(73827),q=r(57524),V=r(63706),$=r(15167);let z=e=>{let{advisory:i}=e,[r,n]=t.useState(!1),l=()=>{n(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(E.r,{hasGutter:!0,children:[(0,s.jsx)(S.P,{md:4,children:(0,s.jsxs)(B.Z,{isFullHeight:!0,children:[(0,s.jsx)(C.l,{children:"Overview"}),(0,s.jsx)(I.e,{children:(0,s.jsxs)(M.o,{children:[(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Title"}),(0,s.jsx)(P.b,{children:i.title})]}),(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Type"}),(0,s.jsx)(P.b,{children:i.labels.type})]}),(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Aggregate Severity"}),(0,s.jsx)(P.b,{children:(0,s.jsx)(q.o,{value:(0,O.g)(i.average_severity),score:i.average_score,showLabel:!0,showScore:!0})})]}),(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Size"}),(0,s.jsx)(P.b,{children:(0,F.Z)(i.size)})]}),(0,s.jsxs)(Z.g,{children:[(0,s.jsxs)(L.M,{children:["Labels ","",(0,s.jsx)(m.zx,{variant:m.Wu.link,size:"sm",icon:(0,s.jsx)(A.ZP,{}),iconPosition:"end",onClick:()=>n(!0),children:"Edit"})]}),(0,s.jsx)(P.b,{children:(0,s.jsx)(B.Z,{isCompact:!0,children:(0,s.jsx)(I.e,{children:i.labels&&(0,s.jsx)(k.C,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,s.jsx)(S.P,{md:4,children:(0,s.jsxs)(B.Z,{isFullHeight:!0,children:[(0,s.jsx)(C.l,{children:"Publisher"}),(0,s.jsx)(I.e,{children:(0,s.jsxs)(M.o,{children:[(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Name"}),(0,s.jsx)(P.b,{children:i.issuer?.name})]}),(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Contact details"}),(0,s.jsx)(P.b,{children:i.issuer?.website})]})]})})]})}),(0,s.jsx)(S.P,{md:4,children:(0,s.jsxs)(B.Z,{isFullHeight:!0,children:[(0,s.jsx)(C.l,{children:"Tracking"}),(0,s.jsx)(I.e,{children:(0,s.jsxs)(M.o,{children:[(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"ID"}),(0,s.jsx)(P.b,{children:i.identifier})]}),(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Initial release date"}),(0,s.jsx)(P.b,{children:(0,V.p6)(i.published)})]}),(0,s.jsxs)(Z.g,{children:[(0,s.jsx)(L.M,{children:"Current release date"}),(0,s.jsx)(P.b,{children:(0,V.p6)(i.modified)})]})]})})]})})]}),(0,s.jsxs)(D.u,{isOpen:r,variant:"medium",title:"Edit labels",onClose:l,children:[(0,s.jsx)(_.x,{title:"Edit labels"}),(0,s.jsx)(K.f,{children:(0,s.jsx)($.q,{advisory:i,onClose:l})})]})]})};var R=r(70715),H=r(40982),G=r(89226),U=r(4835),Q=r(14350),Y=r(11165),W=r(89330),J=r(31423),X=r(94154),ee=r(9905),ei=r(3804),er=r(31336),es=r(3586),et=r(24200),en=r(49988);let el=e=>{let{isFetching:i,fetchError:r,vulnerabilities:t}=e,l=(0,en.sz)({tableName:"vulnerability-table",idProperty:"identifier",items:t,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:[],getSortValues:e=>({}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:a,numRenderedColumns:c,propHelpers:{toolbarProps:d,paginationToolbarItemProps:o,paginationProps:h,tableProps:u,getThProps:x,getTrProps:j,getTdProps:m},expansionDerivedState:{isCellExpanded:b}}=l;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.o,{...d,children:(0,s.jsx)(H.c,{children:(0,s.jsx)(G.E,{...o,children:(0,s.jsx)(ei.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:h})})})}),(0,s.jsxs)(U.i,{...u,"aria-label":"vulnerability table",children:[(0,s.jsx)(Q.h,{children:(0,s.jsx)(Y.Tr,{children:(0,s.jsxs)(er.qK,{...l,children:[(0,s.jsx)(W.Th,{...x({columnKey:"identifier"})}),(0,s.jsx)(W.Th,{...x({columnKey:"title"})}),(0,s.jsx)(W.Th,{...x({columnKey:"discovery"})}),(0,s.jsx)(W.Th,{...x({columnKey:"release"})}),(0,s.jsx)(W.Th,{...x({columnKey:"score"})}),(0,s.jsx)(W.Th,{...x({columnKey:"cwe"})})]})})}),(0,s.jsx)(er.hp,{isLoading:i,isError:!!r,isNoData:0===t.length,numRenderedColumns:c,children:a?.map((e,i)=>(0,s.jsx)(J.p,{isExpanded:b(e),children:(0,s.jsx)(Y.Tr,{...j({item:e}),children:(0,s.jsxs)(er.Cx,{...l,item:e,rowIndex:i,children:[(0,s.jsx)(X.Td,{width:15,modifier:"breakWord",...m({columnKey:"identifier"}),children:(0,s.jsx)(n.rU,{to:`/vulnerabilities/${e.identifier}`,children:e.identifier})}),(0,s.jsx)(es.j,{children:(i,r)=>(0,s.jsx)(X.Td,{width:40,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0,...m({columnKey:"title"}),children:(0,s.jsx)(ee.cE,{focused:i,wrapModifier:"truncate",children:(0,s.jsx)(et.G,{vulnerability:e})})})}),(0,s.jsx)(X.Td,{width:15,...m({columnKey:"discovery"}),children:(0,V.p6)(e.discovered)}),(0,s.jsx)(X.Td,{width:10,modifier:"truncate",...m({columnKey:"release"}),children:(0,V.p6)(e.released)}),(0,s.jsx)(X.Td,{width:10,modifier:"truncate",...m({columnKey:"score"}),children:e.severity&&(0,s.jsx)(q.o,{value:(0,O.g)(e.severity),score:e.score??null,showLabel:!0,showScore:!0})}),(0,s.jsx)(X.Td,{width:10,modifier:"truncate",...m({columnKey:"cwe"}),children:e.cwes.join(", ")})]})})},e.identifier))})]}),(0,s.jsx)(ei.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:h})]})},ea=()=>{let[e,i]=t.useState(0),r=t.createRef(),F=t.createRef(),E=(0,g.ZX)(g.Uo.ADVISORY_ID),{advisory:S,isFetching:B,fetchError:C}=(0,w.useFetchAdvisoryById)(E),{downloadAdvisory:I}=(0,N.useDownload)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.NP,{type:"breadcrumb",children:(0,s.jsxs)(a.a,{children:[(0,s.jsx)(c.g,{children:(0,s.jsx)(n.rU,{to:"/advisories",children:"Advisories"})}),(0,s.jsx)(c.g,{isActive:!0,children:"Advisory details"})]})}),(0,s.jsx)(l.NP,{children:(0,s.jsxs)(d.P,{children:[(0,s.jsx)(o.J,{isFilled:!0,children:(0,s.jsxs)(h.k,{children:[(0,s.jsx)(u.B,{spacer:{default:"spacerSm"},children:(0,s.jsxs)(x.V,{children:[(0,s.jsx)(x.V,{component:"h1",children:S?.document_id??E??""}),(0,s.jsx)(x.V,{component:"p",children:"Advisory detail information"})]})}),(0,s.jsx)(u.B,{children:S?.labels.type&&(0,s.jsx)(j._,{color:"blue",children:S?.labels.type})})]})}),(0,s.jsx)(o.J,{children:!B&&(0,s.jsx)(m.zx,{variant:"secondary",icon:(0,s.jsx)(p,{}),onClick:()=>{E&&I(E,S?.identifier?`${S?.identifier}.json`:`${E}.json`)},children:"Download"})})]})}),(0,s.jsx)(l.NP,{children:(0,s.jsxs)(b.m,{mountOnEnter:!0,activeKey:e,onSelect:(e,r)=>{i(r)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,s.jsx)(y.O,{eventKey:0,title:(0,s.jsx)(v.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:r}),(0,s.jsx)(y.O,{eventKey:1,title:(0,s.jsx)(v.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:F})]})}),(0,s.jsxs)(l.NP,{children:[(0,s.jsx)(f.I,{eventKey:0,id:"refTabInfoSection",ref:r,"aria-label":"Information of the Advisory",children:(0,s.jsx)(T.u,{isFetching:B,fetchError:C,children:S&&(0,s.jsx)(z,{advisory:S})})}),(0,s.jsx)(f.I,{eventKey:1,id:"refVulnerabilitiesSection",ref:F,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:(0,s.jsx)(el,{isFetching:B,fetchError:C,vulnerabilities:S?.vulnerabilities||[]})})]})]})}},15167:function(e,i,r){r.d(i,{q:()=>c});var s=r(24246),t=r(27378),n=r(24502),l=r(15726),a=r(17598);let c=e=>{let{advisory:i,onClose:r}=e,{pushNotification:c}=t.useContext(l.c),[d,o]=t.useState(""),[h,u]=t.useState(""),{labels:x}=(0,a.useFetchAdvisoryLabels)(h);t.useEffect(()=>{let e=setTimeout(()=>{u(d)},400);return()=>clearTimeout(e)},[d]);let{mutate:j,isPending:m}=(0,a.useUpdateAdvisoryLabelsMutation)(()=>{c({title:`Labels updated for Advisory ${i.document_id}`,variant:"success"}),r()},e=>{c({title:`Error while updating labels for Advisory ${i.document_id}`,variant:"danger"})});return(0,s.jsx)(n.M,{title:`Labels of Advisory: ${i.document_id}`,value:i.labels,isDisabled:m,onSave:e=>{j({id:i.uuid,labels:e})},onClose:r,onInputChange:o,options:x})}},17598:function(e,i,r){r.d(i,{useFetchAdvisories:()=>j,useFetchAdvisoryById:()=>m,useFetchAdvisoryLabels:()=>x,useUpdateAdvisoryLabelsMutation:()=>y,useUploadAdvisory:()=>b});var s=r(1183),t=r(24038),n=r(68e3),l=r(75503),a=r(50576),c=r(40371),d=r(87017),o=r(49988),h=r(95169);let u="advisories",x=e=>{let{data:i,isLoading:r,error:n,refetch:l}=(0,s.useQuery)({queryKey:[u,"labels",e],queryFn:()=>(0,c.sf)({client:a.L,query:{limit:10,filter_text:e}}),placeholderData:t.Wk});return{labels:i?.data||[],isFetching:r,fetchError:n,refetch:l}},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:t,...n}=(0,o.rm)(e),l=(0,o.Rb)(i),{data:d,isLoading:h,error:x,refetch:j}=(0,s.useQuery)({queryKey:[u,e,l],queryFn:()=>(0,c.A1)({client:a.L,query:{...n,q:[t,l].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:d?.data?.items||[],total:d?.data?.total??0,params:e??e},isFetching:h,fetchError:x||null,refetch:j}},m=e=>{let{data:i,isLoading:r,error:t}=(0,s.useQuery)({queryKey:[u,e],queryFn:()=>(0,c.pB)({client:a.L,path:{key:e}}),enabled:void 0!==e});return{advisory:i?.data,isFetching:r,fetchError:t}},b=()=>{let e=(0,n.NL)();return(0,h.V)({parallel:!0,uploadFn:(e,i)=>(0,d.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[u]})}})},y=(e,i)=>{let r=(0,n.NL)();return(0,l.D)({mutationFn:e=>(0,c.m5)({client:a.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,s)=>{e(),await r.invalidateQueries({queryKey:[u]})},onError:i})}},65872:function(e,i,r){r.d(i,{Z:()=>c});let s=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],t=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],l=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,r)=>{let s=e;return"string"==typeof i||Array.isArray(i)?s=e.toLocaleString(i,r):(!0===i||void 0!==r)&&(s=e.toLocaleString(void 0,r)),s};function c(e,i){let r;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let c=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?l:n:i.binary?t:s,d=i.space?" ":"";if(i.signed&&0===e)return` 0${d}${c[0]}`;let o=e<0,h=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(r={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(r={maximumFractionDigits:i.maximumFractionDigits,...r}),e<1)return h+a(e,i.locale,r)+d+c[0];let u=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),c.length-1);return e/=(i.binary?1024:1e3)**u,r||(e=e.toPrecision(3)),h+a(Number(e),i.locale,r)+d+c[u]}}}]);