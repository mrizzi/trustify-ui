"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["619"],{37818:function(e,t,r){r.d(t,{u:()=>n});var i=r(24246),s=r(8305),l=r(13754),a=r(39826);let n=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(s.b,{children:(0,i.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(a.y,{}):e.children},42573:function(e,t,r){r.d(t,{C:()=>l});var i=r(24246),s=r(70400);let l=e=>{let{error:t}=e;return(0,i.jsxs)(s._,{color:"red",children:[t.status," Error"]})}},49304:function(e,t,r){r.d(t,{u:()=>d});var i=r(24246),s=r(34747),l=r(46770),a=r(25138),n=r(87445),u=r(32947),o=r(57524);let d=e=>{let{severities:t}=e,r=Object.values(t).reduce((e,t)=>e+t,0);return(0,i.jsxs)(s.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(l.B,{style:{minWidth:15,textAlign:n.F2},children:r}),(0,i.jsx)(a.i,{orientation:{default:"vertical"}}),(0,i.jsx)(l.B,{children:(0,i.jsx)(s.k,{children:Object.entries(t).filter(e=>{let[t,r]=e;return r>0}).sort((0,u.A0)(e=>{let[t,r]=e;return t})).reverse().map(e=>{let[t,r]=e;return(0,i.jsx)(l.B,{spacer:{default:"spacerXs"},children:(0,i.jsxs)(s.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(l.B,{children:(0,i.jsx)(o.o,{value:t,score:null})}),(0,i.jsx)(l.B,{children:r})]})},t)})})})]})}},82413:function(e,t,r){r.d(t,{useVulnerabilitiesOfSbom:()=>d,useVulnerabilitiesOfSboms:()=>c});var i=r(27378),s=r(7615),l=r(43959);let a=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},o=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce((e,t)=>{let r,i=e.find(e=>a(e,t));if(i)r=[...e.filter(e=>!a(e,i)),{...i,relatedPackages:[...i.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,i=(0,s.g)(t.vulnerability.average_severity),l=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:l.total+1,severities:{...l.severities,[i]:l.severities[i]+1}}}})},{...u});return{vulnerabilities:t,summary:r}},d=e=>{let{advisories:t,isFetching:r,fetchError:s}=(0,l.useFetchSbomsAdvisory)(e);return{data:i.useMemo(()=>o(t||[]),[t]),isFetching:r,fetchError:s}},c=e=>{let{advisories:t,isFetching:r,fetchError:s}=(0,l.useFetchSbomsAdvisoryBatch)(e);return{data:i.useMemo(()=>(t??[]).map(e=>o(e||[])),[t]),isFetching:r,fetchError:s}}},66043:function(e,t,r){r.d(t,{_:()=>u});var i=r(24246),s=r(27378),l=r(24502),a=r(15726),n=r(43959);let u=e=>{let{sbom:t,onClose:r}=e,{pushNotification:u}=s.useContext(a.c),[o,d]=s.useState(""),[c,h]=s.useState("");s.useEffect(()=>{let e=setTimeout(()=>{h(o)},400);return()=>clearTimeout(e)},[o]);let{labels:m}=(0,n.useFetchSBOMLabels)(c),{mutate:p,isPending:b}=(0,n.useUpdateSbomLabelsMutation)(()=>{u({title:`Labels updated for SBOM ${t.name}`,variant:"success"}),r()},e=>{u({title:`Error while updating labels for SBOM ${t.name}`,variant:"danger"})});return(0,i.jsx)(l.M,{title:`Labels of SBOM: ${t.name}`,value:t.labels,isDisabled:b,onSave:e=>{p({id:t.id,labels:e})},onClose:r,onInputChange:d,options:m})}},47849:function(e,t,r){r.d(t,{F:()=>c,W:()=>d});var i=r(24246),s=r(27378),l=r(74502),a=r(32947),n=r(14629),u=r(49988),o=r(43959);let d=s.createContext({}),c=e=>{let{children:t}=e,[r,c]=s.useState(""),[h,m]=s.useState("");s.useEffect(()=>{let e=setTimeout(()=>{m(r)},400);return()=>clearTimeout(e)},[r]);let{labels:p}=(0,o.useFetchSBOMLabels)(h),b=(0,u.vZ)({tableName:"sbom",persistenceKeyPrefix:l.yq.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",labels:"Labels",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:l.L4,title:"Filter text",placeholderText:"Search",type:n.vA.search},{categoryKey:"published",title:"Created on",type:n.vA.dateRange},{categoryKey:"labels",title:"Label",type:n.vA.autocompleteLabel,placeholderText:"Filter results by label",selectOptions:p.map(e=>{let t=(0,a.W)({key:e.key,value:e.value});return{value:t,label:t}}),onInputValueChange:c}],isExpansionEnabled:!1}),{result:{data:y,total:v},isFetching:f,fetchError:x}=(0,o.useFetchSBOMs)((0,u.QO)({...b,hubSortFieldKeys:{name:"name",published:"published"}}),(b.filterState.filterValues.labels??[]).map(e=>(0,a.nE)(e))),j=(0,u.KC)({...b,idProperty:"id",currentPageItems:y,totalItemCount:v,isLoading:f});return(0,i.jsx)(d.Provider,{value:{totalItemCount:v,isFetching:f,fetchError:x,tableControls:j},children:t})}},68801:function(e,t,r){r.d(t,{H:()=>L});var i=r(24246),s=r(27378),l=r(65783),a=r(79551),n=r(32489),u=r(90519),o=r(4835),d=r(14350),c=r(11165),h=r(89330),m=r(31423),p=r(94154),b=r(88935),y=r(3804),v=r(31336),f=r(73227),x=r(63706),j=r(32947),g=r(73827),S=r(66043),F=r(11797),k=r(37818),E=r(42573),K=r(49304),C=r(82413);let T=e=>{let{sbomId:t}=e,{data:r,isFetching:s,fetchError:l}=(0,C.useVulnerabilitiesOfSbom)(t);return(0,i.jsx)(k.u,{isFetching:s,fetchError:l,isFetchingState:(0,i.jsx)(F.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,i.jsx)(E.C,{error:e}),children:(0,i.jsx)(K.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})};var w=r(47849);let L=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:F}=s.useContext(w.W),[k,E]=s.useState(null),K=null!==k,{numRenderedColumns:C,currentPageItems:L,propHelpers:{paginationProps:O,tableProps:q,getThProps:B,getTrProps:_,getTdProps:M},expansionDerivedState:{isCellExpanded:I},filterState:{filterValues:P,setFilterValues:W}}=F,{downloadSBOM:A,downloadSBOMLicenses:D}=(0,f.useDownload)(),Q=()=>{E(null)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.i,{...q,"aria-label":"sbom-table",children:[(0,i.jsx)(d.h,{children:(0,i.jsx)(c.Tr,{children:(0,i.jsxs)(v.qK,{...F,children:[(0,i.jsx)(h.Th,{...B({columnKey:"name"})}),(0,i.jsx)(h.Th,{...B({columnKey:"version"})}),(0,i.jsx)(h.Th,{...B({columnKey:"supplier"})}),(0,i.jsx)(h.Th,{...B({columnKey:"labels"})}),(0,i.jsx)(h.Th,{...B({columnKey:"published"})}),(0,i.jsx)(h.Th,{...B({columnKey:"packages"})}),(0,i.jsx)(h.Th,{...B({columnKey:"vulnerabilities"})})]})})}),(0,i.jsx)(v.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:C,children:L.map((e,t)=>(0,i.jsx)(m.p,{isExpanded:I(e),children:(0,i.jsx)(c.Tr,{..._({item:e}),children:(0,i.jsxs)(v.Cx,{...F,item:e,rowIndex:t,children:[(0,i.jsx)(p.Td,{width:20,modifier:"breakWord",...M({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t}),children:(0,i.jsx)(l.OL,{to:`/sboms/${e.id}`,children:e.name})}),(0,i.jsx)(p.Td,{width:10,modifier:"truncate",...M({columnKey:"version"}),children:e.described_by.map(e=>e.version).filter(e=>e).join(", ")}),(0,i.jsx)(p.Td,{width:10,modifier:"truncate",...M({columnKey:"supplier"}),children:e.suppliers.join(", ")}),(0,i.jsx)(p.Td,{width:20,modifier:"truncate",...M({columnKey:"labels"}),children:(0,i.jsx)(g.C,{value:e.labels,onClick:e=>{let{key:t,value:r}=e,i=(0,j.W)({key:t,value:r}),s=P.labels;if(!s?.includes(i)){let e=s?[...s,i]:[i];W({...P,labels:e})}}})}),(0,i.jsx)(p.Td,{width:10,modifier:"truncate",...M({columnKey:"published"}),children:(0,x.p6)(e.published)}),(0,i.jsx)(p.Td,{width:10,...M({columnKey:"packages"}),children:e.number_of_packages}),(0,i.jsx)(p.Td,{width:20,...M({columnKey:"vulnerabilities"}),children:(0,i.jsx)(T,{sbomId:e.id})}),(0,i.jsx)(p.Td,{isActionCell:!0,children:(0,i.jsx)(b.k,{items:[{title:"Edit labels",onClick:()=>{E(e)}},{isSeparator:!0},{title:"Download SBOM",onClick:()=>{A(e.id,`${e.name}.json`)}},{title:"Download License Report",onClick:()=>{D(e.id)}}]})})]})})},e.id))})]}),(0,i.jsx)(y.p,{idPrefix:"sbom-table",isTop:!1,paginationProps:O}),(0,i.jsxs)(a.u,{isOpen:K,variant:"medium",onClose:Q,children:[(0,i.jsx)(n.x,{title:"Edit labels"}),(0,i.jsx)(u.f,{children:k&&(0,i.jsx)(S._,{sbom:k,onClose:Q})})]})]})}},83870:function(e,t,r){r.d(t,{c:()=>c});var i=r(24246),s=r(27378),l=r(70715),a=r(40982),n=r(89226),u=r(14629),o=r(3804),d=r(47849);let c=e=>{let{showFilters:t}=e,{tableControls:r}=s.useContext(d.W),{propHelpers:{toolbarProps:c,filterToolbarProps:h,paginationToolbarItemProps:m,paginationProps:p}}=r;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(l.o,{...c,children:(0,i.jsxs)(a.c,{children:[t&&(0,i.jsx)(u.Ki,{...h}),(0,i.jsx)(n.E,{...m,children:(0,i.jsx)(o.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:p})})]})})})}},43959:function(e,t,r){r.d(t,{useFetchSBOMById:()=>y,useFetchSBOMLabels:()=>p,useFetchSBOMs:()=>b,useFetchSbomsAdvisory:()=>j,useFetchSbomsAdvisoryBatch:()=>g,useFetchSbomsByPackageId:()=>x,useUpdateSbomLabelsMutation:()=>f,useUploadSBOM:()=>v});var i=r(1183),s=r(24038),l=r(68e3),a=r(75503),n=r(16072),u=r(50576),o=r(40371),d=r(95169),c=r(87017),h=r(49988);let m="sboms",p=e=>{let{data:t,isLoading:r,error:l,refetch:a}=(0,i.useQuery)({queryKey:[m,"labels",e],queryFn:()=>(0,o.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:t?.data||[],isFetching:r,fetchError:l,refetch:a}},b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:s,...l}=(0,h.rm)(e),a=(0,h.Rb)(t),{data:n,isLoading:d,error:c,refetch:p}=(0,i.useQuery)({queryKey:[m,e,a],queryFn:()=>(0,o.Wp)({client:u.L,query:{...l,q:[s,a].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:n?.data?.items||[],total:n?.data?.total??0,params:e??e},isFetching:d,fetchError:c,refetch:p}},y=e=>{let{data:t,isLoading:r,error:s}=(0,i.useQuery)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,o._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:s}},v=()=>{let e=(0,l.NL)();return(0,d.V)({parallel:!0,uploadFn:(e,t)=>(0,c.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},f=(e,t)=>{let r=(0,l.NL)();return(0,a.D)({mutationFn:e=>(0,o.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:t})},x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:s,error:l,refetch:a}=(0,i.useQuery)({queryKey:[m,"by-package",e,t],queryFn:()=>(0,o.DU)({client:u.L,query:{purl:e,...(0,h.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:s,fetchError:l,refetch:a}},j=e=>{let{data:t,isLoading:r,error:s}=(0,i.useQuery)({queryKey:[m,e,"advisory"],queryFn:()=>(0,o.NU)({client:u.L,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:s}},g=e=>{let t=(0,n.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,o.NU)({client:u.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return t?.data||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}}}}]);