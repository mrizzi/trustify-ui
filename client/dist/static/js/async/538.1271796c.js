"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["538"],{42835:function(e,t,r){r.d(t,{p:()=>i});var n=r(24246),a=r(40583);let i=e=>{let{paginationProps:t,isTop:r,isCompact:i=!1,idPrefix:s=""}=e;return(0,n.jsx)(a.t,{id:`${s?`${s}-`:""}pagination-${r?"top":"bottom"}`,variant:r?a.a.top:a.a.bottom,isCompact:i,...t,widgetId:"pagination-id"})}},48336:function(e,t,r){r.d(t,{y:()=>c});var n=r(24246),a=r(96582),i=r(610),s=r(68940),l=r(16668),o=r(42160),d=r(92864);let c=()=>(0,n.jsxs)(a.u,{variant:a.I.sm,children:[(0,n.jsx)(i.k,{icon:o.ZP,color:d.a.value}),(0,n.jsx)(s.D,{headingLevel:"h2",size:"lg",children:"Unable to connect"}),(0,n.jsx)(l.B,{children:"There was an error retrieving data. Check your connection and try again."})]})},37024:function(e,t,r){r.d(t,{hp:()=>b,qK:()=>f,Cx:()=>y});var n=r(24246),a=r(8305),i=r(13754),s=r(31423),l=r(11165),o=r(94154),d=r(48336),c=r(96582),u=r(610),m=r(68940),h=r(16668),x=r(22119);let p=e=>{let{title:t,description:r}=e;return(0,n.jsxs)(c.u,{variant:c.I.sm,children:[(0,n.jsx)(u.k,{icon:x.ZP}),(0,n.jsx)(m.D,{headingLevel:"h2",size:"lg",children:t}),r&&(0,n.jsx)(h.B,{children:r})]})},j=()=>(0,n.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),b=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:m=null,noDataEmptyState:h=null,children:x}=e;return(0,n.jsx)(n.Fragment,{children:r?(0,n.jsx)(s.p,{children:(0,n.jsx)(l.Tr,{children:(0,n.jsx)(o.Td,{colSpan:t,children:(0,n.jsx)(a.b,{children:(0,n.jsx)(i.$,{size:"xl"})})})})}):c?(0,n.jsx)(s.p,{"aria-label":"Table error",children:(0,n.jsx)(l.Tr,{children:(0,n.jsx)(o.Td,{colSpan:t,children:(0,n.jsx)(a.b,{children:m||(0,n.jsx)(d.y,{})})})})}):u?(0,n.jsx)(s.p,{"aria-label":"Table error",children:(0,n.jsx)(l.Tr,{children:(0,n.jsx)(o.Td,{colSpan:t,children:(0,n.jsx)(a.b,{children:h||(0,n.jsx)(j,{})})})})}):x})};var g=r(67918);let f=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:a}=e;return(0,n.jsxs)(n.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,n.jsx)(g.Th,{screenReaderText:`before-data-${t}`},t)),a,Array(r).fill(null).map((e,t)=>(0,n.jsx)(g.Th,{screenReaderText:`after-data-${t}`},t))]})},y=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,isSelectionEnabled:a=!1,propHelpers:{getSingleExpandButtonTdProps:i,getSelectCheckboxTdProps:s},item:l,rowIndex:d,children:c}=e;return(0,n.jsxs)(n.Fragment,{children:[t&&"single"===r?(0,n.jsx)(o.Td,{...i({item:l,rowIndex:d})}):null,a?(0,n.jsx)(o.Td,{...s({item:l,rowIndex:d})}):null,c]})}},90834:function(e,t,r){r.r(t),r.d(t,{default:()=>es});var n=r(24246),a=r(27378),i=r(27693),s=r.n(i),l=r(50201),o=r(45043),d=r(25236),c=r(25645),u=r(27308),m=r(40982),h=r(27763),x=r(6364),p=r(98713),j=r(93436),b=r(4835),g=r(14350),f=r(11165),y=r(67918),T=r(31423),v=r(94154),D=r(88935),C=r(67447),I=r(48513);let k=e=>{let{isOpen:t,title:r,titleIconVariant:a,message:i,confirmBtnLabel:s,cancelBtnLabel:o,inProgress:d,confirmBtnVariant:c,onClose:u,onConfirm:m,onCancel:h}=e,x=(0,n.jsx)(l.zx,{id:"confirm-dialog-button","aria-label":"confirm",variant:c,isDisabled:d,onClick:m,children:s},"confirm"),j=h?(0,n.jsx)(l.zx,{id:"confirm-cancel-button","aria-label":"cancel",variant:l.Wu.link,isDisabled:d,onClick:h,children:o},"cancel"):void 0;return(0,n.jsx)(p.u,{id:"confirm-dialog",variant:p.v.small,title:r,titleIconVariant:a,isOpen:t,onClose:u,"aria-label":"Confirm dialog",actions:h?[x,j]:[x],children:i})};var S=r(71575),K=r(1183),P=r(68e3),w=r(75503),E=r(44072),$=r(22285),L=r(54227);let N="importers",O=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{isLoading:t,error:r,refetch:n,data:a}=(0,K.a)({queryKey:[N],queryFn:()=>(0,L.CZ)({client:$.L}),refetchInterval:!e&&E.x6});return{importers:a?.data||[],isFetching:t,fetchError:r,refetch:n}},F=(e,t)=>{let r=(0,P.NL)();return(0,w.D)({mutationFn:e=>(0,L.Ro)({client:$.L,path:{name:e.importerName},body:e.configuration}),onSuccess:(t,n)=>{e(),r.invalidateQueries({queryKey:[N]})},onError:t})},R=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:n,refetch:a,error:i}=(0,K.a)({queryKey:[N,e,"reports"],queryFn:()=>(0,L.qi)({client:$.L,path:{name:e}}),refetchInterval:!t&&E.x6});return{result:{data:r?.data?.items||[],total:r?.data?.total??0},isFetching:n,fetchError:i,refetch:a}};var B=r(62126),Z=r(55096),z=r(2499),A=r(34747),V=r(46770),q=r(64766),_=r(30528),U=r(42160),W=r(1353),M=r(82786),H=r(19879),Y=r(18976);let G=e=>{let{preset:t,status:r,icon:a,className:i="",label:s}=e,l={Canceled:{icon:(0,n.jsx)(H.ZP,{}),status:"info",label:"Canceled"},Completed:{icon:(0,n.jsx)(_.ZP,{}),status:"success",label:"Completed"},Error:{icon:(0,n.jsx)(U.ZP,{}),status:"danger",label:"Error"},Failed:{icon:(0,n.jsx)(U.ZP,{}),status:"danger",label:"Failed"},InProgress:{icon:(0,n.jsx)(W.ZP,{}),status:"info",label:"In-progress"},NotStarted:{icon:(0,n.jsx)(H.ZP,{}),label:"Not started"},Ok:{icon:(0,n.jsx)(_.ZP,{}),status:"success"},Scheduled:{icon:(0,n.jsx)(M.ZP,{}),status:"info",label:"Scheduled"},Unknown:{icon:(0,n.jsx)(Y.ZP,{})}},o=t&&l[t];return(0,n.jsxs)(A.k,{flexWrap:{default:"nowrap"},spaceItems:{default:"spaceItemsSm"},children:[(0,n.jsx)(V.B,{children:(0,n.jsx)(e=>{let{children:t}=e;return o?.tooltipMessage?(0,n.jsx)(z.u,{content:o?.tooltipMessage,children:t}):(0,n.jsx)(n.Fragment,{children:t})},{children:(0,n.jsx)(q.J,{status:r||o?.status,className:i,children:a||o?.icon||(0,n.jsx)(Y.ZP,{})})})}),(0,n.jsx)(V.B,{children:s||o?.label})]})};var J=r(42835),Q=r(37024),X=r(94426),ee=r(90241),et=r(20227);let er=e=>{let{value:t}=e;return(0,n.jsx)(ee.E,{"aria-label":"Progress of Importer ",value:t.current,min:0,max:t.total,measureLocation:et.nK.inside,size:ee.L.sm})},en=new Map([["waiting","Scheduled"],["running","InProgress"]]),ea=e=>{let{state:t}=e;return(0,n.jsx)(G,{preset:(e=>{if(en.has(e)){let t=en.get(e);if(t)return t}return"NotStarted"})(t)})},ei=e=>{let t=Object.keys(e.configuration??{})[0],r=e.configuration[t];return r?.disabled!==!1?"disabled":"running"===e.state?"running":"scheduled"},es=()=>{let e;let{pushNotification:t}=a.useContext(S.c),[r,i]=a.useState(null),[s,p]=a.useState(null),j=(e,t)=>{p(e),i(t)},{importers:I,isFetching:K,fetchError:P}=O(),{mutate:w}=F(()=>{},e=>{t({title:"Error while enabling/disabling the Importer",variant:"danger"})}),E=(e,t)=>{let r=Object.keys(e.configuration??{})[0],n={...e.configuration[r],disabled:!t};w({importerName:e.name,configuration:{[r]:n}})},N=()=>{t({title:"Importer scheduled to run as soon as possible",variant:"success"})},R=e=>{t({title:(0,B.dr)(e),variant:"danger"})},z=e=>{(0,L.Pj)({client:$.L,path:{name:e},body:!0}).then(N).catch(R)},A=(0,X.sz)({tableName:"importers-table",idProperty:"name",items:I,columnNames:{name:"Name",type:"Type",description:"Description",source:"Source",period:"Period",state:"State"},hasActionsColumn:!0,isSortEnabled:!0,sortableColumns:["name"],getSortValues:e=>({name:e.name}),isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"single",isFilterEnabled:!0,filterCategories:[{categoryKey:"name",title:"Name",type:Z.vA.search,placeholderText:"Search by name...",getItemValue:e=>e.name||""},{categoryKey:"status",title:"Status",type:Z.vA.multiselect,logicOperator:"OR",selectOptions:[{value:"scheduled",label:"Scheduled"},{value:"running",label:"Running"},{value:"disabled",label:"Disabled"}],placeholderText:"Status",matcher:(e,t)=>e===ei(t)}]}),{currentPageItems:V,numRenderedColumns:q,propHelpers:{toolbarProps:_,filterToolbarProps:U,paginationToolbarItemProps:W,paginationProps:M,tableProps:H,getThProps:Y,getTrProps:G,getTdProps:ee},expansionDerivedState:{isCellExpanded:et}}=A;switch(s){case"enable":e={title:"Enable Importer",titleIconVariant:"info",message:`Are you sure you want to enable the Importer ${r?.name}?`,confirmBtnVariant:l.Wu.primary,confirmBtnLabel:"Enable",cancelBtnLabel:"Cancel"};break;case"disable":e={title:"Disable Importer",titleIconVariant:"info",message:`Are you sure you want to disable the Importer ${r?.name}?`,confirmBtnVariant:l.Wu.primary,confirmBtnLabel:"Disable",cancelBtnLabel:"Cancel"};break;case"run":e={title:"Run Importer",titleIconVariant:"info",message:`Are you sure you want to run the Importer ${r?.name}?`,confirmBtnVariant:l.Wu.primary,confirmBtnLabel:"Run",cancelBtnLabel:"Cancel"};break;default:e=null}return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.NP,{variant:o.Dk.light,children:(0,n.jsx)(d.D,{children:(0,n.jsx)(c.x,{component:"h1",children:"Importers"})})}),(0,n.jsx)(o.NP,{children:(0,n.jsxs)("div",{style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"},children:[(0,n.jsx)(u.o,{..._,children:(0,n.jsxs)(m.c,{children:[(0,n.jsx)(Z.Ki,{showFiltersSideBySide:!0,...U}),(0,n.jsx)(h.E,{...W,children:(0,n.jsx)(J.p,{idPrefix:"importer-table",isTop:!0,paginationProps:M})})]})}),(0,n.jsxs)(b.i,{...H,"aria-label":"Importer table",children:[(0,n.jsx)(g.h,{children:(0,n.jsx)(f.Tr,{children:(0,n.jsxs)(Q.qK,{...A,children:[(0,n.jsx)(y.Th,{...Y({columnKey:"name"})}),(0,n.jsx)(y.Th,{...Y({columnKey:"type"})}),(0,n.jsx)(y.Th,{...Y({columnKey:"description"})}),(0,n.jsx)(y.Th,{...Y({columnKey:"source"})}),(0,n.jsx)(y.Th,{...Y({columnKey:"period"})}),(0,n.jsx)(y.Th,{...Y({columnKey:"state"})})]})})}),(0,n.jsx)(Q.hp,{isLoading:K,isError:!!P,isNoData:0===I.length,numRenderedColumns:q,children:V?.map((e,t)=>{let r=Object.keys(e.configuration??{})[0],a=e.configuration[r],i=ei(e);return n.jsxs(T.p,{children:[n.jsx(f.Tr,{...G({item:e}),children:n.jsxs(Q.Cx,{...A,item:e,rowIndex:t,children:[n.jsx(v.Td,{width:15,modifier:"truncate",...ee({columnKey:"name"}),children:e.name}),n.jsx(v.Td,{width:10,modifier:"truncate",...ee({columnKey:"type"}),children:r}),n.jsx(v.Td,{width:20,modifier:"truncate",...ee({columnKey:"description"}),children:a?.description}),n.jsx(v.Td,{width:20,modifier:"truncate",...ee({columnKey:"source"}),children:a?.source}),n.jsx(v.Td,{width:10,modifier:"truncate",...ee({columnKey:"period"}),children:a?.period}),n.jsx(v.Td,{width:10,modifier:"truncate",...ee({columnKey:"state"}),children:"disabled"===i?n.jsx(x._,{color:"orange",children:"Disabled"}):"running"===i&&e.progress?n.jsx(er,{value:e.progress}):n.jsx(ea,{state:e.state})}),n.jsx(v.Td,{isActionCell:!0,children:n.jsx(D.k,{items:[..."disabled"===i?[{title:"Enable",onClick:()=>{j("enable",e)}}]:[{title:"Run",onClick:()=>{j("run",e)},isDisabled:"running"===i},{title:"Disable",onClick:()=>{j("disable",e)}}]]})})]})}),et(e)?n.jsx(f.Tr,{isExpanded:!0,children:n.jsx(v.Td,{colSpan:7,children:n.jsx("div",{className:"pf-v5-u-m-md",children:n.jsx(C.G,{children:n.jsx(eo,{importer:e})})})})}):null]},e.name)})})]}),(0,n.jsx)(J.p,{idPrefix:"importer-table",isTop:!1,paginationProps:M})]})}),s&&e&&(0,n.jsx)(k,{...e,isOpen:!0,onCancel:()=>p(null),onClose:()=>p(null),onConfirm:()=>{if(r)switch(s){case"enable":E(r,!0);break;case"disable":E(r,!1);break;case"run":z(r.name)}i(null),p(null)}})]})},el=e=>Object.entries(e).map(e=>{let[t,r]=e;return Object.entries(r).map(e=>{let[r,n]=e;return{title:`${t.charAt(0).toUpperCase()+t.slice(1)}: "${r}"`,body:n.map(e=>{let t=null;switch(e.severity){case"none":t=E.xT.green;break;case"low":t=E.xT.cyan;break;case"medium":t=E.xT.yellow;break;case"high":t=E.xT.lightBlue;break;case"critical":t=E.xT.red}return`${t??""}${e.severity.charAt(0).toUpperCase()+e.severity.slice(1)}: ${E.xT.defaultForegroundColorAtStartup} ${e.message}`}).join(E.xT.endLine)}}).map(e=>`${E.xT.underline}${e.title}${E.xT.reset}${E.xT.endLine}${e.body}`).join(`${E.xT.endLine}${E.xT.endLine}`)}),eo=e=>{let{importer:t}=e,[r,i]=a.useState([]),[o,d]=a.useState(!1),c=()=>d(!o),{result:{data:x},isFetching:D,fetchError:C}=R(t.name),k=a.useMemo(()=>{let e={isRunning:!0,id:"root",startDate:void 0,endDate:void 0,duration:t.progress?.estimatedSecondsRemaining?t.progress?.estimatedSecondsRemaining*1e3:void 0,numberOfItems:t.progress?.current,error:void 0,messages:void 0},r=x.map(e=>{let t;if(e.report?.startDate&&e.report.endDate){let r=s()(e.report.startDate);t=s()(e.report.endDate).diff(r)}return{isRunning:!1,id:e.id,startDate:e.report?.startDate,endDate:e.report?.endDate,duration:t,numberOfItems:e.report?.numberOfItems,error:e.error??void 0,messages:e.report?.messages}});return[..."running"===t.state?[e]:[],...r]},[t,x]),S=(0,X.sz)({variant:"compact",tableName:"report-table",idProperty:"id",items:k,columnNames:{startDate:"Start date",endDate:"End date",numberOfItems:"Number of items",status:"Status",duration:"Duration"},isPaginationEnabled:!0,initialItemsPerPage:5,isSortEnabled:!0,sortableColumns:["startDate","endDate"],initialSort:{columnKey:"startDate",direction:"desc"},getSortValues:e=>({startDate:!e.startDate||s()(e.startDate).valueOf(),endDate:!e.endDate||s()(e.endDate).valueOf()}),isFilterEnabled:!1,isExpansionEnabled:!1}),{currentPageItems:K,numRenderedColumns:P,propHelpers:{toolbarProps:w,tableProps:E,paginationToolbarItemProps:$,paginationProps:L,getThProps:N,getTrProps:O,getTdProps:F}}=S;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.o,{...w,children:(0,n.jsx)(m.c,{children:(0,n.jsx)(h.E,{...$,children:(0,n.jsx)(J.p,{idPrefix:"report-table",isTop:!0,paginationProps:L})})})}),(0,n.jsxs)(b.i,{...E,"aria-label":"Report table",children:[(0,n.jsx)(I.Y,{children:"Importer reports"}),(0,n.jsx)(g.h,{children:(0,n.jsx)(f.Tr,{children:(0,n.jsxs)(Q.qK,{...S,children:[(0,n.jsx)(y.Th,{...N({columnKey:"startDate"})}),(0,n.jsx)(y.Th,{...N({columnKey:"endDate"})}),(0,n.jsx)(y.Th,{...N({columnKey:"numberOfItems"})}),(0,n.jsx)(y.Th,{...N({columnKey:"status"})}),(0,n.jsx)(y.Th,{...N({columnKey:"duration"})})]})})}),(0,n.jsx)(Q.hp,{isLoading:D,isError:!!C,isNoData:k?.length===0,numRenderedColumns:P,children:K?.map((e,t)=>n.jsx(T.p,{children:n.jsx(f.Tr,{...O({item:e}),children:n.jsxs(Q.Cx,{...S,item:e,rowIndex:t,children:[n.jsx(v.Td,{width:15,modifier:"truncate",...F({columnKey:"startDate"}),children:B.o0(e.startDate)}),n.jsx(v.Td,{width:15,modifier:"truncate",...F({columnKey:"endDate"}),children:B.o0(e.endDate)}),n.jsx(v.Td,{width:15,modifier:"truncate",...F({columnKey:"numberOfItems"}),children:e.numberOfItems}),n.jsx(v.Td,{width:30,modifier:"truncate",...F({columnKey:"status"}),children:e.isRunning?n.jsx(ea,{state:"running"}):n.jsx(t=>{let{children:r}=t;return e.messages?n.jsx(l.zx,{isInline:!0,variant:"link",onClick:()=>{i(el(e.messages??{})),c()},children:r}):r},{children:e.error?n.jsx(G,{preset:"Failed",label:e.error}):n.jsx(G,{preset:"Completed",label:"Finished successfully"})})}),n.jsx(v.Td,{width:25,modifier:"truncate",...F({columnKey:"duration"}),children:e.duration?e.isRunning?`Time remaining: ${s().duration(e.duration).humanize()}`:`Run for: ${s().duration(e.duration).humanize()}`:""})]})})},e.id))})]}),(0,n.jsx)(J.p,{idPrefix:"report-table",isTop:!1,paginationProps:L}),(0,n.jsx)(p.u,{title:"Log",variant:"large",isOpen:o,onClose:c,actions:[(0,n.jsx)(l.zx,{variant:"link",onClick:c,children:"Close"},"cancel")],children:(0,n.jsx)(j.nU,{hasLineNumbers:!1,height:400,data:r,theme:"dark",toolbar:(0,n.jsx)(u.o,{children:(0,n.jsx)(m.c,{children:(0,n.jsx)(h.E,{children:(0,n.jsx)(j.Yt,{placeholder:"Search value",minSearchChars:1})})})})})})]})}}}]);