"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["968"],{18142:function(e,a,t){t.d(a,{A0:()=>c,V4:()=>u,XE:()=>d});var r=t(56149),n=t(62835),l=t(6357),s=t(1085),o=t(12773),i=t(98271);let u={unknown:{name:"Unknown",color:r.y,progressProps:{variant:void 0}},none:{name:"None",color:n.O,progressProps:{variant:void 0}},low:{name:"Low",color:l.R,progressProps:{variant:void 0}},medium:{name:"Medium",color:s.F,progressProps:{variant:"warning"}},high:{name:"High",color:o.Q,progressProps:{variant:"danger"}},critical:{name:"Critical",color:i.G,progressProps:{variant:"danger"}}},d=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function c(e){return(a,t)=>d(e(a))-d(e(t))}},86602:function(e,a,t){t.d(a,{g:()=>r});let r=e=>e??"unknown"},54774:function(e,a,t){t.d(a,{Co:()=>c,Cu:()=>u,Hb:()=>d});var r=t(70233),n=t(44072);t(23475);let l="/api",s=`${l}/v2/advisory`,o=`${l}/v2/sbom`,i=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},u=(e,a)=>{let t=e.get(n.TB);return r.Z.post(`${s}`,t,{...a,headers:{"Content-Type":i(t)}})},d=(e,a)=>{let t=e.get(n.TB);return r.Z.post(`${o}`,t,{...a,headers:{"Content-Type":i(t)}})},c=e=>r.Z.get(`${o}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},35843:function(e,a,t){t.d(a,{u:()=>o});var r=t(24246),n=t(8305),l=t(13754),s=t(48336);let o=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(n.b,{children:(0,r.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(s.y,{}):e.children},48336:function(e,a,t){t.d(a,{y:()=>d});var r=t(24246),n=t(96582),l=t(610),s=t(68940),o=t(16668),i=t(42160),u=t(92864);let d=()=>(0,r.jsxs)(n.u,{variant:n.I.sm,children:[(0,r.jsx)(l.k,{icon:i.ZP,color:u.a.value}),(0,r.jsx)(s.D,{headingLevel:"h2",size:"lg",children:"Unable to connect"}),(0,r.jsx)(o.B,{children:"There was an error retrieving data. Check your connection and try again."})]})},74889:function(e,a,t){t.d(a,{A:()=>d,I:()=>c});var r=t(27378),n=t(86602),l=t(99915);let s=(e,a)=>e.vulnerability.identifier===a.vulnerability.identifier&&e.vulnerabilityStatus===a.vulnerabilityStatus,o={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},i={vulnerabilityStatus:{affected:{...o},fixed:{...o},not_affected:{...o},known_not_affected:{...o}}},u=e=>{let a=e.flatMap(e=>(e.status??[]).map(a=>({vulnerability:a,vulnerabilityStatus:a.status,advisory:e,packages:a.packages}))).reduce((e,a)=>{let t;let r=e.find(e=>s(e,a));if(r)t=[...e.filter(e=>!s(e,r)),{...r,relatedPackages:[...r.relatedPackages,{advisory:a.advisory,packages:a.packages}]}];else{let r={vulnerability:a.vulnerability,vulnerabilityStatus:a.vulnerabilityStatus,relatedPackages:[{advisory:a.advisory,packages:a.packages}]};t=[...e.slice(),r]}return t},[]),t=a.reduce((e,a)=>{let t=a.vulnerabilityStatus,r=(0,n.g)(a.vulnerability.average_severity),l=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[t]:{total:l.total+1,severities:{...l.severities,[r]:l.severities[r]+1}}}})},{...i});return{vulnerabilities:a,summary:t}},d=e=>{let{advisories:a,isFetching:t,fetchError:n}=(0,l.KQ)(e);return{data:r.useMemo(()=>u(a||[]),[a]),isFetching:t,fetchError:n}},c=e=>{let{advisories:a,isFetching:t,fetchError:n}=(0,l.uz)(e);return{data:r.useMemo(()=>(a??[]).map(e=>u(e||[])),[a]),isFetching:t,fetchError:n}}},22100:function(e,a,t){t.d(a,{V:()=>d});var r=t(27378),n=t(44072),l=t(70233);let s="cancelled",o=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),i=(e,a)=>{switch(a.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"queued",cancelFn:a.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),progress:a.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"complete",response:a.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(a.payload.file,{...e.uploads.get(a.payload.file)||o(),status:"complete",error:a.payload.error,wasCancelled:a.payload.error?.message===s})};case"removeUpload":{let t=new Map(e.uploads);return t.delete(a.payload.file),{...e,uploads:t}}default:throw Error()}},u=()=>({uploads:new Map}),d=e=>{let{parallel:a,uploadFn:t,onSuccess:o,onError:d}=e,[c,p]=r.useReducer(i,u());return{uploads:c.uploads,handleUpload:e=>{let r=[];for(let a=0;a<e.length;a++){let t=e[a],i=new FormData;i.set(n.TB,t);let u=l.Z.CancelToken.source(),c={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let a=e.total??1;p({type:"updateUploadProgress",payload:{file:t,progress:Math.round(e.loaded/a*100)}})},cancelToken:u.token};p({type:"queueUpload",payload:{file:t,cancelFn:u}});let y={formData:i,config:c,thenFn:e=>{p({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),o&&o(e,t)},catchFn:e=>{p({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==s&&d&&d(e,t)}};r.push(y)}if(a)for(let e of r)t(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else r.reduce(async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(s)},handleRemoveUpload:e=>{p({type:"removeUpload",payload:{file:e}})}}}},99915:function(e,a,t){t.d(a,{Fz:()=>p,KQ:()=>f,Oh:()=>v,km:()=>h,p4:()=>y,uz:()=>g});var r=t(1183),n=t(68e3),l=t(16072),s=t(22285),o=t(54227),i=t(22100),u=t(54774),d=t(94426);let c="sboms",p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:t,isLoading:n,error:l,refetch:i}=(0,r.a)({queryKey:[c,e],queryFn:()=>(0,o.Wp)({client:s.L,query:{...(0,d.rm)(e)}}),enabled:!a});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:n,fetchError:l,refetch:i}},y=e=>{let{data:a,isLoading:t,error:n}=(0,r.a)({queryKey:[c,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,o._Q)({client:s.L,path:{id:e}}),enabled:void 0!==e});return{sbom:a?.data,isFetching:t,fetchError:n}},h=()=>{let e=(0,n.NL)();return(0,i.V)({parallel:!0,uploadFn:(e,a)=>(0,u.Hb)(e,a),onSuccess:()=>{e.invalidateQueries({queryKey:[c]})}})},v=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:n,error:l,refetch:i}=(0,r.a)({queryKey:["SBOMsQueryKeysss","by-package",e,a],queryFn:()=>(0,o.DU)({client:s.L,query:{purl:e,...(0,d.rm)(a)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:a??a},isFetching:n,fetchError:l,refetch:i}},f=e=>{let{data:a,isLoading:t,error:n}=(0,r.a)({queryKey:[c,e,"advisory"],queryFn:()=>(0,o.NU)({client:s.L,path:{id:e}})});return{advisories:a?.data||[],isFetching:t,fetchError:n}},g=e=>{let a=(0,l.h)({queries:e.map(e=>({queryKey:[c,e,"advisory"],queryFn:()=>(0,o.NU)({client:s.L,path:{id:e}})}))});return{advisories:a.map(e=>{let{data:a}=e;return a?.data||[]}),isFetching:a.some(e=>{let{isLoading:a}=e;return a}),fetchError:a.map(e=>{let{error:a}=e;return a})}}}}]);