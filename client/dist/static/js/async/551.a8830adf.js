"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["551"],{27889:function(e,i,t){t.d(i,{R:()=>c,r:()=>y});var l=t(32909),n=t(42642),r=t(62540),a=t(63696),s=t(98259),d=t(71284);t(81592);var o=t(73470),u=t(99134);let c=a.createContext({}),y=e=>{var i;let{children:t}=e,[y,h]=a.useState(""),[m,v]=a.useState("");a.useEffect(()=>{let e=setTimeout(()=>{v(y)},400);return()=>clearTimeout(e)},[y]);let{labels:p}=(0,u.eq)(m),x=(0,o.MM)({tableName:"advisory",persistenceKeyPrefix:s.rt.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",type:"Type",labels:"Labels",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","modified"],initialSort:{columnKey:"modified",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:s._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"modified",title:"Revision",type:"dateRange"},{categoryKey:"labels",title:"Label",type:"autocompleteLabel",placeholderText:"Filter results by label",selectOptions:p.map(e=>{let i=(0,d.m4)({key:e.key,value:e.value});return{value:i,label:i}}),onInputValueChange:h}],isExpansionEnabled:!1}),{result:{data:f,total:_},isFetching:b,fetchError:j}=(0,u.VH)((0,o.Ng)((0,n._)((0,l._)({},x),{hubSortFieldKeys:{identifier:"identifier",modified:"modified"}})),(null!=(i=x.filterState.filterValues.labels)?i:[]).map(e=>(0,d.Cb)(e))),g=(0,o.PB)((0,n._)((0,l._)({},x),{idProperty:"identifier",currentPageItems:f,totalItemCount:_,isLoading:b}));return(0,r.jsx)(c.Provider,{value:{totalItemCount:_,isFetching:b,fetchError:j,tableControls:g},children:t})}},41484:function(e,i,t){t.d(i,{q:()=>D});var l=t(32909),n=t(42642),r=t(62540),a=t(63696),s=t(74343),d=t(38927),o=t(80057),u=t(13021),c=t(24773),y=t(26917),h=t(16646),m=t(21758),v=t(40384),p=t(28516),x=t(78517),f=t(62101),_=t(71284),b=t(27875),j=t(89705),g=t(12852),T=t(4392),C=t(93826),K=t(30448),E=t(15461),S=t(99528),w=t(99134),q=t(52362),k=t(23909),F=t(27889),P=t(40665),I=t(98259);let D=()=>{let{pushNotification:e}=a.useContext(T.K),{isFetching:i,fetchError:t,totalItemCount:D,tableControls:L}=a.useContext(F.R),[A,R]=a.useState(null),V=null!==A,{numRenderedColumns:J,currentPageItems:N,propHelpers:{paginationProps:B,tableProps:H,getThProps:M,getTrProps:O,getTdProps:Q},expansionDerivedState:{isCellExpanded:U},filterState:{filterValues:Y,setFilterValues:G}}=L,{downloadAdvisory:W}=(0,S.m)(),X=()=>{R(null)},[Z,$]=a.useState(null),{mutate:z,isPending:ee}=(0,w.ni)(i=>{$(null),e({title:"The Advisory ".concat(i.identifier," was deleted"),variant:"success"})},i=>{e({title:"Error occurred while deleting the Advisory",variant:"danger"})});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(y.X,(0,n._)((0,l._)({},H),{"aria-label":"advisory-table",children:[(0,r.jsx)(h.d,{children:(0,r.jsx)(m.Tr,{children:(0,r.jsxs)(K.Ze,(0,n._)((0,l._)({},L),{children:[(0,r.jsx)(v.Th,(0,l._)({},M({columnKey:"identifier"}))),(0,r.jsx)(v.Th,(0,l._)({},M({columnKey:"title"}))),(0,r.jsx)(v.Th,(0,l._)({},M({columnKey:"type"}))),(0,r.jsx)(v.Th,(0,l._)({},M({columnKey:"labels"}))),(0,r.jsx)(v.Th,(0,l._)({},M({columnKey:"modified"}))),(0,r.jsx)(v.Th,(0,l._)({},M({columnKey:"vulnerabilities"})))]}))})}),(0,r.jsx)(K.nJ,{isLoading:i,isError:!!t,isNoData:0===D,numRenderedColumns:J,children:N.map((e,i)=>{let t=e.vulnerabilities.reduce((e,i)=>{let t=(0,b.U)(i.severity);return e[t]=e[t]+1,e},{critical:0,high:0,medium:0,low:0,none:0,unknown:0});return(0,r.jsx)(p.N,{isExpanded:U(e),children:(0,r.jsx)(m.Tr,(0,n._)((0,l._)({},O({item:e})),{children:(0,r.jsxs)(K.Oi,(0,n._)((0,l._)({},L),{item:e,rowIndex:i,children:[(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:15,modifier:"breakWord"},Q({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:i})),{children:(0,r.jsx)(s.k2,{to:(0,s.tW)(q.Jh.advisoryDetails,{advisoryId:e.uuid}),children:e.document_id})})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:35,modifier:"truncate"},Q({columnKey:"title"})),{children:e.title})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:10},Q({columnKey:"type"})),{children:e.labels.type})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:20},Q({columnKey:"labels"})),{children:(0,r.jsx)(g.g,{value:e.labels,onClick:e=>{let{key:i,value:t}=e,r=(0,_.m4)({key:i,value:t}),a=Y.labels;if(!(null==a?void 0:a.includes(r))){let e=a?[...a,r]:[r];G((0,n._)((0,l._)({},Y),{labels:e}))}}})})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:10,modifier:"truncate"},Q({columnKey:"modified"})),{children:(0,k.Yq)(e.modified)})),(0,r.jsx)(x.Td,(0,n._)((0,l._)({width:10},Q({columnKey:"vulnerabilities"})),{children:(0,r.jsx)(E.n,{severities:t})})),(0,r.jsx)(x.Td,{isActionCell:!0,children:(0,r.jsx)(f.G,{items:[{title:"Edit labels",onClick:()=>{R(e)}},{title:"Download",onClick:()=>{W(e.uuid,"".concat(e.identifier,".json"))}},{isSeparator:!0},{title:"Delete",onClick:()=>{$(e)}}]})})]}))}))},e.identifier)})})]})),(0,r.jsx)(C.n,{idPrefix:"advisory-table",isTop:!1,paginationProps:B}),(0,r.jsxs)(d.a,{isOpen:V,variant:"medium",onClose:X,children:[(0,r.jsx)(o.r,{title:"Edit labels"}),(0,r.jsx)(u.c,{children:A&&(0,r.jsx)(P.t,{advisory:A,onClose:X})})]}),(0,r.jsx)(j.T,(0,n._)((0,l._)({},(0,I.p6)(Z)),{inProgress:ee,titleIconVariant:"warning",isOpen:!!Z,confirmBtnVariant:c.Ak.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>$(null),onClose:()=>$(null),onConfirm:()=>{Z&&z(Z.uuid)}}))]})}},5193:function(e,i,t){t.d(i,{F:()=>p});var l=t(32909),n=t(42642),r=t(62540),a=t(63696),s=t(74343),d=t(61360),o=t(35048),u=t(32490),c=t(24773),y=t(81592),h=t(93826),m=t(52362),v=t(27889);let p=e=>{let{showFilters:i}=e,t=(0,s.Zp)(),{tableControls:p}=a.useContext(v.R),{propHelpers:{toolbarProps:x,filterToolbarProps:f,paginationToolbarItemProps:_,paginationProps:b}}=p;return(0,r.jsx)(d.M,(0,n._)((0,l._)({},x),{"aria-label":"advisory-toolbar",children:(0,r.jsxs)(o.P,{children:[i&&(0,r.jsx)(y.Us,(0,l._)({},f)),(0,r.jsx)(u.T,{children:(0,r.jsx)(c.$n,{variant:"primary",onClick:()=>t(m.Jh.advisoryUpload),children:"Upload Advisory"})}),(0,r.jsx)(u.T,(0,n._)((0,l._)({},_),{children:(0,r.jsx)(h.n,{idPrefix:"advisory-table",isTop:!0,paginationProps:b})}))]})}))}},40665:function(e,i,t){t.d(i,{t:()=>d});var l=t(62540),n=t(63696),r=t(91242),a=t(4392),s=t(99134);let d=e=>{let{advisory:i,onClose:t}=e,{pushNotification:d}=n.useContext(a.K),[o,u]=n.useState(""),[c,y]=n.useState(""),{labels:h}=(0,s.eq)(c);n.useEffect(()=>{let e=setTimeout(()=>{y(o)},400);return()=>clearTimeout(e)},[o]);let{mutate:m,isPending:v}=(0,s.uJ)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),t()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,l.jsx)(r.e,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:v,onSave:e=>{m({id:i.uuid,labels:e})},onClose:t,onInputChange:u,options:h})}},99134:function(e,i,t){t.d(i,{VH:()=>x,Yu:()=>b,eq:()=>p,ni:()=>_,uJ:()=>j,vy:()=>f});var l=t(32909),n=t(42642),r=t(72610),a=t(77184),s=t(59722),d=t(62603),o=t(90130),u=t(96002),c=t(86141),y=t(81895),h=t(73470),m=t(93531);let v="advisories",p=e=>{let{data:i,isLoading:t,error:l,refetch:n}=(0,a.I)({queryKey:[v,"labels",e],queryFn:()=>(0,c.J)({client:u.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==i?void 0:i.data)||[],isFetching:t,fetchError:l,refetch:n}},x=function(){var e,i,t;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],y=(0,h.kd)(s),{q:m}=y,p=(0,r._)(y,["q"]),x=(0,h.Er)(d),{data:f,isLoading:_,error:b,refetch:j}=(0,a.I)({queryKey:[v,s,x],queryFn:()=>(0,c.YM)({client:u.S,query:(0,n._)((0,l._)({},p),{q:[m,x].filter(e=>e).join("&")})}),enabled:!o});return{result:{data:(null==f||null==(e=f.data)?void 0:e.items)||[],total:null!=(t=null==f||null==(i=f.data)?void 0:i.total)?t:0,params:s},isFetching:_,fetchError:b||null,refetch:j}},f=e=>{let{data:i,isLoading:t,error:l}=(0,a.I)({queryKey:[v,e],queryFn:()=>(0,c.ai)({client:u.S,path:{key:e}}),enabled:!!e});return{advisory:null==i?void 0:i.data,isFetching:t,fetchError:l}},_=(e,i)=>{let t=(0,d.jE)();return(0,o.n)({mutationFn:async e=>(await (0,c.vl)({client:u.S,path:{key:e}})).data,onSuccess:async(i,l)=>{e(i,l),await t.invalidateQueries({queryKey:[v]})},onError:async e=>{i(e),await t.invalidateQueries({queryKey:[v]})}})},b=()=>{let e=(0,d.jE)();return(0,m.v)({parallel:!0,uploadFn:(e,i)=>(0,y.hP)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[v]})}})},j=(e,i)=>{let t=(0,d.jE)();return(0,o.n)({mutationFn:e=>(0,c._e)({client:u.S,path:{id:e.id},body:e.labels}),onSuccess:async(i,l)=>{e(),await t.invalidateQueries({queryKey:[v]})},onError:i})}}}]);