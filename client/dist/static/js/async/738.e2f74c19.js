"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["738"],{71284:function(e,r,t){t.d(r,{Cb:()=>j,Kb:()=>y,Sx:()=>x,hs:()=>g,m4:()=>m,pJ:()=>f,xh:()=>S});var n=t(88741),a=t(99111),l=t(22134),i=t(57822),s=t(32635),o=t(1734),d=t(84249),c=t(95283),u=t(52040),h=t(44240),p=t(43967),v=t(36808);let y={unknown:{name:"Unknown",color:d.o,progressProps:{variant:void 0},icon:n.ZP},none:{name:"None",color:c.q,progressProps:{variant:void 0},icon:a.VQ},low:{name:"Low",color:u.b,progressProps:{variant:void 0},icon:l.g8},medium:{name:"Medium",color:h.B,progressProps:{variant:"warning"},icon:i.Yc},high:{name:"High",color:p.e,progressProps:{variant:"danger"},icon:s.Fc},critical:{name:"Critical",color:v.d,progressProps:{variant:"danger"},icon:o.id}},f={fixed:{name:"Fixed",color:"blue"},not_affected:{name:"Not affected",color:"green"},known_not_affected:{name:"Known not affected",color:"green"},under_investigation:{name:"Under investigation",color:"yellow"},affected:{name:"Affected",color:"red"}},b=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function x(e){return(r,t)=>b(e(r))-b(e(t))}let m=e=>{let{key:r,value:t}=e;return"".concat(t?"".concat(r,"=").concat(t):"".concat(r))},j=e=>{let[r,t]=e.split("=");return{key:r,value:null!=t?t:""}},_=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function g(e){return(r,t)=>_(e(r))-_(e(t))}let S=e=>0===e.length?null:[...e].sort(g(e=>e.type))[0]},27875:function(e,r,t){t.d(r,{U:()=>n});let n=e=>null!=e?e:"unknown"},81895:function(e,r,t){t.d(r,{J4:()=>h,SP:()=>p,Z3:()=>v,hP:()=>u});var n=t(32909),a=t(42642),l=t(46165),i=t(98259);t(56161);let s="/api",o="".concat(s,"/v2/advisory"),d="".concat(s,"/v2/sbom"),c=e=>{let r="application/json";return e.name.endsWith(".bz2")&&(r="application/json+bzip2"),r},u=(e,r)=>{let t=e.get(i.fs);return l.A.post("".concat(o),t,(0,a._)((0,n._)({},r),{headers:{"Content-Type":c(t)}}))},h=(e,r)=>{let t=e.get(i.fs);return l.A.post("".concat(d),t,(0,a._)((0,n._)({},r),{headers:{"Content-Type":c(t)}}))},p=(e,r)=>{let t=e.get(i.fs);return l.A.post("/api/v2/ui/extract-sbom-purls",t,(0,a._)((0,n._)({},r),{headers:{"Content-Type":c(t)}}))},v=e=>l.A.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},24296:function(e,r,t){t.d(r,{a:()=>s});var n=t(62540),a=t(59394),l=t(81595),i=t(40554);let s=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(a.a,{children:(0,n.jsx)(l.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(i.q,{}):e.children},85790:function(e,r,t){t.d(r,{a:()=>l});var n=t(62540),a=t(69548);let l=e=>{let{value:r}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(r).map(e=>{let[r,t]=e;return(0,n.jsx)(a.J,{isCompact:!0,children:"".concat(r,"=").concat(t)},"".concat(r,"=").concat(t))})})}},45969:function(e,r,t){t.d(r,{h:()=>d});var n=t(62540),a=t(28338),l=t(70045),i=t(2057),s=t(29508),o=t(71284);let d=e=>{let{value:r,score:t,showScore:d,showLabel:c}=e,u=o.Kb[r],h=u.name,p=u.icon;return(0,n.jsxs)(a.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(l.Z,{children:c?(0,n.jsx)(i.I,{children:(0,n.jsx)(p,{color:u.color.value})}):(0,n.jsx)(s.m,{content:h,children:(0,n.jsx)(i.I,{children:(0,n.jsx)(p,{color:u.color.value})})})}),c&&(0,n.jsx)(l.Z,{children:h}),d&&null!==t&&(0,n.jsxs)(l.Z,{children:["(",Math.round(10*t)/10,")"]})]})}},93826:function(e,r,t){t.d(r,{n:()=>s});var n=t(32909),a=t(42642),l=t(62540),i=t(56682);let s=e=>{let{paginationProps:r,isTop:t,isCompact:s=!1,idPrefix:o=""}=e;return(0,l.jsx)(i.d,(0,a._)((0,n._)({id:"".concat(o?"".concat(o,"-"):"","pagination-").concat(t?"top":"bottom"),variant:t?i.A.top:i.A.bottom,isCompact:s},r),{widgetId:"pagination-id"}))}},40554:function(e,r,t){t.d(r,{q:()=>s});var n=t(62540),a=t(48655),l=t(92411),i=t(60087);let s=()=>(0,n.jsx)(a.pp,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:i.Ay,variant:a.s$.sm,children:(0,n.jsx)(l.h,{children:"There was an error retrieving data. Check your connection and try again."})})},30448:function(e,r,t){t.d(r,{Ze:()=>b,nJ:()=>y,Oi:()=>m});var n=t(62540),a=t(59394),l=t(81595),i=t(28516),s=t(21758),o=t(78517),d=t(40554),c=t(48655),u=t(92411),h=t(28469);let p=e=>{let{title:r,description:t}=e;return(0,n.jsx)(c.pp,{titleText:r,headingLevel:"h4",icon:h.Ay,variant:c.s$.sm,children:t&&(0,n.jsx)(u.h,{children:t})})},v=()=>(0,n.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),y=e=>{let{numRenderedColumns:r,isLoading:t=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:y}=e;return(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)(i.N,{"aria-label":"Table loading",children:(0,n.jsx)(s.Tr,{children:(0,n.jsx)(o.Td,{colSpan:r,children:(0,n.jsx)(a.a,{children:(0,n.jsx)(l.y,{size:"xl"})})})})}):c?(0,n.jsx)(i.N,{"aria-label":"Table error",children:(0,n.jsx)(s.Tr,{children:(0,n.jsx)(o.Td,{colSpan:r,children:(0,n.jsx)(a.a,{children:h||(0,n.jsx)(d.q,{})})})})}):u?(0,n.jsx)(i.N,{"aria-label":"Table empty",children:(0,n.jsx)(s.Tr,{children:(0,n.jsx)(o.Td,{colSpan:r,children:(0,n.jsx)(a.a,{children:p||(0,n.jsx)(v,{})})})})}):y})};var f=t(40384);let b=e=>{let{numColumnsBeforeData:r,numColumnsAfterData:t,children:a}=e;return(0,n.jsxs)(n.Fragment,{children:[Array(r).fill(null).map((e,r)=>(0,n.jsx)(f.Th,{screenReaderText:"before-data-".concat(r)},r)),a,Array(t).fill(null).map((e,r)=>(0,n.jsx)(f.Th,{screenReaderText:"after-data-".concat(r)},r))]})};var x=t(32909);let m=e=>{let{isExpansionEnabled:r=!1,expandableVariant:t,getSelectCheckboxTdProps:a,propHelpers:{getSingleExpandButtonTdProps:l},item:i,rowIndex:s,children:d}=e;return(0,n.jsxs)(n.Fragment,{children:[r&&"single"===t?(0,n.jsx)(o.Td,(0,x._)({},l({item:i,rowIndex:s}))):null,a?(0,n.jsx)(o.Td,(0,x._)({},a({item:i,rowIndex:s}))):null,d]})}},20311:function(e,r,t){t.d(r,{R:()=>l});var n=t(62540),a=t(63696);let l=e=>{let{children:r}=e,[t,l]=a.useState(!1);return(0,n.jsx)(n.Fragment,{children:r(t,l)})}},64377:function(e,r,t){t.d(r,{j:()=>a});var n=t(62540);let a=e=>{let{vulnerability:r}=e;return(0,n.jsxs)("p",{children:[r.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),r.title||r.description]})}},35913:function(e,r,t){t.d(r,{$:()=>p,G:()=>h});var n=t(32909),a=t(42642),l=t(63696),i=t(27875),s=t(33468);let o=(e,r)=>e.vulnerability.identifier===r.vulnerability.identifier&&e.vulnerabilityStatus===r.vulnerabilityStatus,d={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,n._)({},d),fixed:(0,n._)({},d),not_affected:(0,n._)({},d),known_not_affected:(0,n._)({},d),under_investigation:(0,n._)({},d)}},u=e=>{let r=e.flatMap(e=>{var r;return(null!=(r=e.status)?r:[]).map(r=>{let t=(0,i.U)(r.average_severity);return{vulnerability:(0,a._)((0,n._)({},r.vulnerability),{average_severity:t,average_score:r.average_score}),vulnerabilityStatus:r.status,advisory:e}})}).reduce((e,r)=>{let t,l=e.find(e=>o(e,r));if(l)t=[...e.filter(e=>!o(e,l)),(0,a._)((0,n._)({},l),{relatedSboms:[...l.relatedSboms,{advisory:r.advisory}]})];else{let n={vulnerability:r.vulnerability,vulnerabilityStatus:r.vulnerabilityStatus,relatedSboms:[{advisory:r.advisory}]};t=[...e.slice(),n]}return t},[]),t=r.reduce((e,r)=>{let t=r.vulnerabilityStatus,l=r.vulnerability.average_severity,i=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:(0,a._)((0,n._)({},e.vulnerabilityStatus),{[t]:{total:i.total+1,severities:(0,a._)((0,n._)({},i.severities),{[l]:i.severities[l]+1})}})})},(0,n._)({},c));return{vulnerabilities:r,summary:t}},h=e=>{let{pkg:r,isFetching:t,fetchError:n}=(0,s.Si)(e);return{data:l.useMemo(()=>u((null==r?void 0:r.advisories)||[]),[r]),isFetching:t,fetchError:n}},p=e=>({data:l.useMemo(()=>u((null==e?void 0:e.advisories)||[]),[e])})},93531:function(e,r,t){t.d(r,{v:()=>u});var n=t(32909),a=t(42642),l=t(63696),i=t(98259),s=t(46165);let o="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,r)=>{switch(r.type){case"queueUpload":return(0,a._)((0,n._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,a._)((0,n._)({},e.uploads.get(r.payload.file)||d()),{status:"queued",cancelFn:r.payload.cancelFn}))});case"updateUploadProgress":return(0,a._)((0,n._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,a._)((0,n._)({},e.uploads.get(r.payload.file)||d()),{progress:r.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,a._)((0,n._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,a._)((0,n._)({},e.uploads.get(r.payload.file)||d()),{status:"complete",response:r.payload.response}))});case"finishUploadWithError":var t;return(0,a._)((0,n._)({},e),{uploads:new Map(e.uploads).set(r.payload.file,(0,a._)((0,n._)({},e.uploads.get(r.payload.file)||d()),{status:"complete",error:r.payload.error,wasCancelled:(null==(t=r.payload.error)?void 0:t.message)===o}))});case"removeUpload":{let t=new Map(e.uploads);return t.delete(r.payload.file),(0,a._)((0,n._)({},e),{uploads:t})}default:throw Error()}},u=e=>{let{parallel:r,uploadFn:t,onSuccess:n,onError:a}=e,[d,u]=l.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let l=[];for(let r=0;r<e.length;r++){let t=e[r],d=new FormData;d.set(i.fs,t);let c=s.A.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var r;let n=null!=(r=e.total)?r:1;u({type:"updateUploadProgress",payload:{file:t,progress:Math.round(e.loaded/n*100)}})},cancelToken:c.token};u({type:"queueUpload",payload:{file:t,cancelFn:c}});let p={formData:d,config:h,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),n&&n(e,t)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==o&&a&&a(e,t)}};l.push(p)}if(r)for(let e of l)t(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else l.reduce(async(e,r)=>(await e,t(r.formData,r.config).then(r.thenFn).catch(r.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var r,t;null==(t=d.uploads.get(e))||null==(r=t.cancelFn)||r.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},77870:function(e,r,t){t.r(r),t.d(r,{default:()=>$});var n=t(62540),a=t(63696),l=t(74343),i=t(68430),s=t(98261),o=t(75530),d=t(38914),c=t(57901),u=t(42957),h=t(28338),p=t(70045),v=t(40989),y=t(60423),f=t(40111),b=t(70414),x=t(66542),m=t(93472),j=t(8210),_=t(52362),g=t(24296),S=t(85790),F=t(33468),w=t(23909),T=t(32909),q=t(42642),K=t(61360),E=t(35048),P=t(32490),k=t(26917),C=t(16646),I=t(21758),M=t(40384),U=t(28516),A=t(78517);t(81592);var N=t(93826),R=t(30448),D=t(98259),J=t(73470),O=t(30111);let B=e=>{let{purl:r}=e,t=(0,J.MM)({tableName:"sboms",persistenceKeyPrefix:D.rt.sboms_by_package,columnNames:{name:"Name",version:"Version",supplier:"Supplier"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:"search"}]}),{result:{data:a,total:i},isFetching:s,fetchError:o}=(0,O.Qr)(r,(0,J.Ng)((0,q._)((0,T._)({},t),{hubSortFieldKeys:{name:"name"}}))),d=(0,J.PB)((0,q._)((0,T._)({},t),{idProperty:"id",currentPageItems:a,totalItemCount:i,isLoading:s})),{numRenderedColumns:c,currentPageItems:u,propHelpers:{toolbarProps:h,paginationToolbarItemProps:p,paginationProps:v,tableProps:y,getThProps:f,getTrProps:b,getTdProps:x}}=d;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(K.M,(0,q._)((0,T._)({},h),{"aria-label":"SBOM toolbar",children:(0,n.jsx)(E.P,{children:(0,n.jsx)(P.T,(0,q._)((0,T._)({},p),{children:(0,n.jsx)(N.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:v})}))})})),(0,n.jsxs)(k.X,(0,q._)((0,T._)({},y),{"aria-label":"SBOM table",children:[(0,n.jsx)(C.d,{children:(0,n.jsx)(I.Tr,{children:(0,n.jsxs)(R.Ze,(0,q._)((0,T._)({},d),{children:[(0,n.jsx)(M.Th,(0,T._)({},f({columnKey:"name"}))),(0,n.jsx)(M.Th,(0,T._)({},f({columnKey:"version"}))),(0,n.jsx)(M.Th,(0,T._)({},f({columnKey:"supplier"})))]}))})}),(0,n.jsx)(R.nJ,{isLoading:s,isError:!!o,isNoData:0===i,numRenderedColumns:c,children:null==u?void 0:u.map(e=>(0,n.jsx)(U.N,{children:(0,n.jsxs)(I.Tr,(0,q._)((0,T._)({},b({item:e})),{children:[(0,n.jsx)(A.Td,(0,q._)((0,T._)({width:35,modifier:"breakWord"},x({columnKey:"name"})),{children:(0,n.jsx)(l.N_,{to:(0,l.tW)(_.Jh.sbomDetails,{sbomId:e.id}),children:e.name})})),(0,n.jsx)(A.Td,(0,q._)((0,T._)({width:15,modifier:"truncate"},x({columnKey:"version"})),{children:e.described_by.map(e=>e.version).join(", ")})),(0,n.jsx)(A.Td,(0,q._)((0,T._)({width:50,modifier:"truncate"},x({columnKey:"supplier"})),{children:e.suppliers.join(", ")}))]}))},e.id))})]})),(0,n.jsx)(N.n,{idPrefix:"sbom-table",isTop:!1,paginationProps:v})]})};var L=t(95285),V=t.n(L),Z=t(59771),Q=t(45969),W=t(20311),H=t(64377),X=t(35913),z=t(21328);let Y=e=>{let{packageId:r}=e,{data:{vulnerabilities:t},isFetching:i,fetchError:s}=(0,X.G)(r),o=a.useMemo(()=>t.filter(e=>"affected"===e.vulnerabilityStatus),[t]),d=(0,z.f)(o,e=>"".concat(e.vulnerability.identifier,"-").concat(e.vulnerabilityStatus)),c=(0,J.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:d,isLoading:i,columnNames:{identifier:"ID",description:"Description",severity:"CVSS",published:"Date published"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","severity","published"],getSortValues:e=>{var r,t,n;return{identifier:e.vulnerability.identifier,severity:(null==(r=e.vulnerability)?void 0:r.average_score)||0,published:(null==(t=e.vulnerability)?void 0:t.published)?V()(null==(n=e.vulnerability)?void 0:n.published).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:u,numRenderedColumns:h,propHelpers:{toolbarProps:p,paginationToolbarItemProps:v,paginationProps:y,tableProps:f,getThProps:b,getTrProps:x,getTdProps:m},expansionDerivedState:{isCellExpanded:j}}=c;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(K.M,(0,q._)((0,T._)({},p),{"aria-label":"vulnerability toolbar",children:(0,n.jsx)(E.P,{children:(0,n.jsx)(P.T,(0,q._)((0,T._)({},v),{children:(0,n.jsx)(N.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:y})}))})})),(0,n.jsxs)(k.X,(0,q._)((0,T._)({},f),{"aria-label":"vulnerability table",children:[(0,n.jsx)(C.d,{children:(0,n.jsx)(I.Tr,{children:(0,n.jsxs)(R.Ze,(0,q._)((0,T._)({},c),{children:[(0,n.jsx)(M.Th,(0,T._)({},b({columnKey:"identifier"}))),(0,n.jsx)(M.Th,(0,T._)({},b({columnKey:"description"}))),(0,n.jsx)(M.Th,(0,T._)({},b({columnKey:"severity"}))),(0,n.jsx)(M.Th,(0,T._)({},b({columnKey:"published"})))]}))})}),(0,n.jsx)(R.nJ,{isLoading:i,isError:!!s,isNoData:0===d.length,numRenderedColumns:h,children:null==u?void 0:u.map((e,r)=>{var t,a;return(0,n.jsx)(U.N,{isExpanded:j(e),children:(0,n.jsx)(I.Tr,(0,q._)((0,T._)({},x({item:e})),{children:(0,n.jsxs)(R.Oi,(0,q._)((0,T._)({},c),{item:e,rowIndex:r,children:[(0,n.jsx)(A.Td,(0,q._)((0,T._)({width:15,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,n.jsx)(l.N_,{to:(0,l.tW)(_.Jh.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,n.jsx)(W.R,{children:(r,t)=>(0,n.jsx)(A.Td,(0,q._)((0,T._)({width:60,modifier:"truncate",onFocus:()=>t(!0),onBlur:()=>t(!1),tabIndex:0},m({columnKey:"description"})),{children:(0,n.jsx)(Z.mA,{focused:r,wrapModifier:"truncate",children:e.vulnerability&&(0,n.jsx)(H.j,{vulnerability:e.vulnerability})})}))}),(0,n.jsx)(A.Td,(0,q._)((0,T._)({width:15},m({columnKey:"severity"})),{children:(null==(t=e.vulnerability)?void 0:t.average_severity)&&(0,n.jsx)(Q.h,{value:e.vulnerability.average_severity,score:e.vulnerability.average_score,showLabel:!0,showScore:!0})})),(0,n.jsx)(A.Td,(0,q._)((0,T._)({width:10,modifier:"truncate"},m({columnKey:"published"})),{children:(0,w.Yq)(null==(a=e.vulnerability)?void 0:a.published)}))]}))}))},e._ui_unique_id)})})]})),(0,n.jsx)(N.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:y})]})},$=()=>{var e,r;let t=(0,_.Lu)("packageId"),{pkg:T,isFetching:q,fetchError:K}=(0,F.Si)(t),E=a.useMemo(()=>T?(0,w.fe)(T.purl):void 0,[T]),[P,k]=a.useState(0),C=a.createRef(),I=a.createRef(),M=a.createRef();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.d8,{type:"breadcrumb",children:(0,n.jsxs)(s.Q,{children:[(0,n.jsx)(o.J,{children:(0,n.jsx)(l.N_,{to:_.Jh.packages,children:"Packages"})}),(0,n.jsx)(o.J,{isActive:!0,children:"Package details"})]})}),(0,n.jsx)(i.d8,{children:(0,n.jsxs)(d.B,{children:[(0,n.jsx)(c.a,{children:(0,n.jsx)(u.U,{children:(0,n.jsx)(u.U,{component:"h1",children:null!=(r=null!=(e=null==E?void 0:E.name)?e:t)?r:""})})}),(0,n.jsx)(c.a,{children:(0,n.jsxs)(h.s,{children:[(0,n.jsxs)(p.Z,{spacer:{default:"spacerSm"},children:[(0,n.jsxs)("p",{children:["version: ",null==E?void 0:E.version]})," "]}),(0,n.jsx)(p.Z,{children:(null==E?void 0:E.qualifiers)&&(0,n.jsx)(S.a,{value:null==E?void 0:E.qualifiers})})]})})]})}),(0,n.jsx)(i.d8,{children:(0,n.jsxs)(v.t,{mountOnEnter:!0,activeKey:P,onSelect:(e,r)=>{k(r)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,n.jsx)(y.o,{eventKey:0,title:(0,n.jsx)(f.V,{children:"Vulnerabilities"}),tabContentId:"refTabVulnerabilitiesSection",tabContentRef:C}),(0,n.jsx)(y.o,{eventKey:1,title:(0,n.jsx)(f.V,{children:"SBOMs using package"}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b.o,{ref:M,children:(0,n.jsx)(j.Ay,{})}),(0,n.jsx)(x.A,{bodyContent:(0,n.jsx)("div",{children:"A list of SBOMs using this package."}),triggerRef:M})]}),tabContentId:"refTabSbomsSection",tabContentRef:I})]})}),(0,n.jsxs)(i.d8,{children:[(0,n.jsx)(m.J,{eventKey:0,id:"refTabVulnerabilitiesSection",ref:C,"aria-label":"Vulnerabilities of the Package",children:t&&(0,n.jsx)(Y,{packageId:t})}),(0,n.jsx)(m.J,{eventKey:1,id:"refTabSbomsSection",ref:I,"aria-label":"SBOMs using the Package",hidden:!0,children:(0,n.jsx)(g.a,{isFetching:q,fetchError:K,children:(null==T?void 0:T.purl)&&(0,n.jsx)(B,{purl:T.purl})})})]})]})}},33468:function(e,r,t){t.d(r,{Lx:()=>d,Si:()=>c,sl:()=>u});var n=t(32909),a=t(77184),l=t(96002),i=t(86141),s=t(73470);let o="packages",d=function(){var e,r,t;let d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:h,error:p,refetch:v}=(0,a.I)({queryKey:[o,d],queryFn:()=>(0,i.UD)({client:l.S,query:(0,n._)({},(0,s.kd)(d))}),enabled:!c});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(t=null==u||null==(r=u.data)?void 0:r.total)?t:0,params:d},isFetching:h,fetchError:p,refetch:v}},c=e=>{let{data:r,isLoading:t,error:n}=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,i.Y0)({client:l.S,path:{key:e}})});return{pkg:null==r?void 0:r.data,isFetching:t,fetchError:n}},u=function(e){var r,t,d;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:u,isLoading:h,error:p,refetch:v}=(0,a.I)({queryKey:[o,"by-sbom",e,c],queryFn:()=>(0,i.Ad)({client:l.S,path:{id:e},query:(0,n._)({},(0,s.kd)(c))})});return{result:{data:(null==u||null==(r=u.data)?void 0:r.items)||[],total:null!=(d=null==u||null==(t=u.data)?void 0:t.total)?d:0,params:c},isFetching:h,fetchError:p,refetch:v}}},30111:function(e,r,t){t.d(r,{DH:()=>F,Qr:()=>S,_P:()=>b,bj:()=>T,cF:()=>g,i$:()=>x,l6:()=>j,rj:()=>m,sn:()=>_,zY:()=>w});var n=t(32909),a=t(42642),l=t(72610),i=t(77184),s=t(59722),o=t(62603),d=t(90130),c=t(3822),u=t(96002),h=t(86141),p=t(93531),v=t(81895),y=t(73470);let f="sboms",b=e=>{let{data:r,isLoading:t,error:n,refetch:a}=(0,i.I)({queryKey:[f,"labels",e],queryFn:()=>(0,h.Dw)({client:u.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==r?void 0:r.data)||[],isFetching:t,fetchError:n,refetch:a}},x=function(){var e,r,t;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,y.kd)(s),{q:p}=c,v=(0,l._)(c,["q"]),b=(0,y.Er)(o),{data:x,isLoading:m,error:j,refetch:_}=(0,i.I)({queryKey:[f,s,b],queryFn:()=>(0,h.z1)({client:u.S,query:(0,a._)((0,n._)({},v),{q:[p,b].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(t=null==x||null==(r=x.data)?void 0:r.total)?t:0,params:s},isFetching:m,fetchError:j,refetch:_}},m=(e,r,t)=>{let{data:n,isLoading:a,error:l}=(0,i.I)({queryKey:[f,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h.a7)({client:u.S,path:{id:e}}),enabled:!!e,refetchInterval:r,retry:t});return{sbom:null==n?void 0:n.data,isFetching:a,fetchError:l}},j=(e,r)=>{let t=(0,o.jE)();return(0,d.n)({mutationFn:async e=>(await (0,h.bS)({client:u.S,path:{id:e}})).data,onSuccess:async(r,n)=>{e(r,n),await t.invalidateQueries({queryKey:[f]}),t.removeQueries({queryKey:[f,n]})},onError:async e=>{r(e),await t.invalidateQueries({queryKey:[f]})}})},_=()=>{let e=(0,o.jE)();return(0,p.v)({parallel:!0,uploadFn:(e,r)=>(0,v.J4)(e,r),onSuccess:async()=>{await e.invalidateQueries({queryKey:[f]})}})},g=(e,r)=>{let t=(0,o.jE)();return(0,d.n)({mutationFn:e=>(0,h.aB)({client:u.S,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await t.invalidateQueries({queryKey:[f]})},onError:r})},S=function(e){var r,t,a;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:d,refetch:c}=(0,i.I)({queryKey:[f,"by-package",e,l],queryFn:()=>(0,h.m9)({client:u.S,query:(0,n._)({purl:e},(0,y.kd)(l))})});return{result:{data:(null==s||null==(r=s.data)?void 0:r.items)||[],total:null!=(a=null==s||null==(t=s.data)?void 0:t.total)?a:0,params:l},isFetching:o,fetchError:d,refetch:c}},F=e=>{let{data:r,isLoading:t,error:n}=(0,i.I)({queryKey:[f,e,"advisory"],queryFn:()=>(0,h.bj)({client:u.S,path:{id:e}})});return{advisories:(null==r?void 0:r.data)||[],isFetching:t,fetchError:n}},w=e=>{let r=(0,c.E)({queries:e.map(e=>({queryKey:[f,e,"advisory"],queryFn:()=>(0,h.bj)({client:u.S,path:{id:e}})}))});return{advisories:r.map(e=>{let{data:r}=e;return(null==r?void 0:r.data)||[]}),isFetching:r.some(e=>{let{isLoading:r}=e;return r}),fetchError:r.map(e=>{let{error:r}=e;return r})}},T=e=>{let{data:r,isLoading:t,error:n}=(0,i.I)({queryKey:[f,e,"license-ids"],queryFn:()=>(0,h.ZV)({client:u.S,path:{id:e}})});return{licenseIds:(null==r?void 0:r.data)||[],isFetching:t,fetchError:n}}},21328:function(e,r,t){t.d(r,{f:()=>s});var n=t(32909),a=t(42642),l=t(63696),i=t(98259);let s=(e,r)=>(0,l.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,a._)((0,n._)({},e),{[i.FA]:r(e)})):[],[e,r])}}]);