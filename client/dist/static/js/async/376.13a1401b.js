"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["376"],{99196:function(e,t,r){r.d(t,{V:()=>a});var i=r(24246),s=r(27378),n=r(73474),l=r(18142);let a=e=>{let{vulnerabilitiesSummary:t}=e,r=s.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],i=l.V4[e];return{severity:e,count:r,label:i.name,color:i.color.value}}).sort((0,l.A0)(e=>e.severity)),[t]);return(0,i.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,i.jsx)(n.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${t.total}`,subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:`${t}: ${r}`}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return`${t.x}: ${t.y}`},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},70193:function(e,t,r){r.r(t),r.d(t,{default:()=>ex});var i=r(24246),s=r(45043),n=r(27317),l=r(93095),a=r(14935),d=r(65783),c=r(61145),o=r(43863),h=r(82920),u=r(59448),x=r(15219),j=r(82913),m=r(50665),v=r(37168),y=r(31757),g=r(87069),p=r(51527),b=r(87727),f=r(3498),S=r(25236),F=r(96582),k=r(63653),O=r(16668),P=r(74481),C=r(50689),E=r(67761),M=r(81391),w=r(18142),B=r(35843),$=r(74889),L=r(60787),V=r(99915),T=r(62126);let K=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],I=()=>{let e=(0,a.s0)(),{result:{data:t,total:r},isFetching:s,fetchError:I}=(0,V.Fz)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:N,isFetching:q,fetchError:A}=(0,$.I)(t.map(e=>e.id)),D=N.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),G=(e,t)=>`${" ".repeat(t+1)}${e.name}`,{result:{data:_,total:z},isFetching:Y,fetchError:Z}=(0,L.N7)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(g.l,{children:"Your dashboard"}),(0,i.jsx)(p.e,{children:(0,i.jsxs)(b.r,{children:[(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(B.u,{isFetching:s||q,fetchError:I||A.some(e=>!!e),children:(0,i.jsxs)(n.K,{hasGutter:!0,children:[(0,i.jsx)(l.v,{children:(0,i.jsx)(S.D,{children:"Below is a summary of Vulnerability status for your last 10 ingested SBOMs. You can click on the SBOM name to be taken to their respective details page."})}),(0,i.jsx)(l.v,{children:t.length>0?(0,i.jsx)("div",{style:{height:320},children:(0,i.jsxs)(c.k,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:K.map(e=>({name:w.V4[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:o.n.multiOrdered,width:700,legendComponent:(0,i.jsx)(h.Q,{y:10,x:200,colorScale:K.map(e=>w.V4[e.severity].color.value)}),children:[(0,i.jsx)(u.C,{label:"Products",axisLabelComponent:(0,i.jsx)(x.D,{dx:0,x:15,y:140}),tickLabelComponent:(0,i.jsx)(x.D,{className:"pf-v5-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:r=>{let i=r.target.innerHTML,s=t.find((e,t)=>G(e,t)===i);s&&e(`/sboms/${s.id}`)}}})}),(0,i.jsx)(u.C,{dependentAxis:!0,showGrid:!0,tickValues:D?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,i.jsx)(j.K,{horizontal:!0,colorScale:K.map(e=>w.V4[e.severity].color.value),children:K.map(e=>{let r=w.V4[e.severity];return(0,i.jsx)(m.B,{labelComponent:(0,i.jsx)(v.h,{constrainToVisibleArea:!0}),data:N.map((i,s)=>{let{summary:{vulnerabilityStatus:{affected:n}}}=i,l=t[s],a=e.severity,d=n.severities[a];return{x:G(l,s),y:d,label:`${r.name}: ${d}`}})},e.severity)})})]})}):(0,i.jsxs)(F.u,{variant:F.I.xs,children:[(0,i.jsx)(k.t,{titleText:"There is nothing here yet",headingLevel:"h4"}),(0,i.jsx)(O.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})]})})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(B.u,{isFetching:Y||s,fetchError:Z||I,children:(0,i.jsxs)(b.r,{hasGutter:!0,children:[(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(P.o,{children:(0,i.jsxs)(C.g,{children:[(0,i.jsx)(E.M,{children:"Last SBOM ingested"}),(0,i.jsx)(M.b,{children:(0,i.jsxs)(n.K,{children:[(0,i.jsx)(l.v,{children:(0,T.o0)(t?.[0]?.ingested)}),(0,i.jsx)(l.v,{children:(0,i.jsx)(d.rU,{to:`/sboms/${t?.[0]?.id}`,children:t?.[0]?.name})})]})})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(P.o,{children:(0,i.jsxs)(C.g,{children:[(0,i.jsx)(E.M,{children:"Total SBOMs"}),(0,i.jsx)(M.b,{children:r})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(P.o,{children:(0,i.jsxs)(C.g,{children:[(0,i.jsx)(E.M,{children:"Last Advisory ingested"}),(0,i.jsx)(M.b,{children:(0,i.jsxs)(n.K,{children:[(0,i.jsx)(l.v,{children:(0,T.o0)(_?.[0]?.ingested)}),(0,i.jsx)(l.v,{children:_?.[0]?.identifier})]})})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(P.o,{children:(0,i.jsxs)(C.g,{children:[(0,i.jsx)(E.M,{children:"Total Advisories"}),(0,i.jsx)(M.b,{children:z})]})})})]})})})]})})]})};var N=r(27378),q=r(8305),A=r(13754),D=r(71575),G=r(1183),_=r(68e3),z=r(75503),Y=r(22285),Z=r(54227);let H="watched-sboms",Q="dashboard",W=()=>{let{data:e,isLoading:t,error:r}=(0,G.a)({queryKey:[Q,H],queryFn:async()=>{try{return(await (0,Z.JM)({client:Y.L,path:{key:H}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}},R=(e,t)=>{let r=(0,_.NL)();return(0,z.D)({mutationFn:e=>(0,Z.yu)({client:Y.L,path:{key:H},body:e}),onSuccess:(t,i)=>{e(),r.invalidateQueries({queryKey:[Q,H]})},onError:t})},U=N.createContext({}),J=e=>{let{children:t}=e,{pushNotification:r}=N.useContext(D.c),{sboms:s,isFetching:n,fetchError:l}=W(),{mutate:a}=R(()=>{},e=>{r({title:"Error while updating the user preferences",variant:"danger"})});return(0,i.jsx)(U.Provider,{value:{sboms:s,isFetching:n,fetchError:l,patch:(e,t)=>{a({...s,[e]:t})}},children:t})};var X=r(46039),ee=r(18037),et=r(24620),er=r(9426),ei=r(18786),es=r(99589),en=r(50201),el=r(32623),ea=r(42364),ed=r(29765),ec=r(99196);let eo=e=>{let{sbomId:t}=e,{data:r,isFetching:s,fetchError:n}=(0,$.A)(t);return(0,i.jsx)(B.u,{isFetching:s,fetchError:n,children:(0,i.jsx)(ec.V,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},eh=e=>{let{fieldName:t,sbomId:r}=e,{patch:s}=N.useContext(U),a=N.useRef(),[c,o]=N.useState(""),[h,u]=N.useState("");N.useEffect(()=>{let e=setTimeout(()=>{u(c)},500);return()=>clearTimeout(e)},[c]);let[x,j]=N.useState(!1),{sbom:m,isFetching:v,fetchError:b}=(0,V.p4)(r??void 0),{result:{data:f}}=(0,V.Fz)({filters:[{field:"",operator:"~",value:h}],page:{pageNumber:1,itemsPerPage:10}}),S=()=>{j(!1)},P=()=>{j(!x)},C=()=>{x?c||S():j(!0)},E=(e,t)=>{o(t)},M=()=>{o(""),a?.current?.focus()};return(0,i.jsxs)(y.Z,{isFullHeight:!0,children:[(0,i.jsxs)(B.u,{isFetching:v,fetchError:b,children:[m&&(0,i.jsx)(g.l,{children:m?.name}),(0,i.jsx)(p.e,{children:r?(0,i.jsxs)(n.K,{children:[(0,i.jsx)(l.v,{isFilled:!0,children:(0,i.jsx)(eo,{sbomId:r})}),(0,i.jsx)(l.v,{children:(0,i.jsx)(d.rU,{to:`/sboms/${r}`,children:"View Details"})})]}):(0,i.jsxs)(F.u,{variant:F.I.xs,children:[(0,i.jsx)(k.t,{titleText:"There is nothing here yet",headingLevel:"h4"}),(0,i.jsx)(O.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})]})})]}),(0,i.jsx)(X.e,{children:(0,i.jsx)(ee.P,{shouldFocusFirstItemOnOpen:!1,isOpen:x,onSelect:(e,r)=>{r&&s(t,r),S()},onOpenChange:e=>{e||S()},toggle:e=>(0,i.jsx)(et.O,{ref:e,variant:"typeahead",onClick:P,isExpanded:x,isFullWidth:!0,children:(0,i.jsxs)(er.W,{isPlain:!0,children:[(0,i.jsx)(ei.v,{autoComplete:"off",value:c,onClick:C,onChange:E,innerRef:a,isExpanded:x,placeholder:"Select a new SBOM to watch"}),(0,i.jsx)(es.t,{...c?{}:{style:{display:"none"}},children:(0,i.jsx)(en.zx,{variant:"plain",onClick:M,"aria-label":"Clear input value",children:(0,i.jsx)(ed.ZP,{"aria-hidden":!0})})})]})}),children:(0,i.jsx)(el.E,{children:f.map(e=>(0,i.jsx)(ea.$,{value:e.id,children:e.name},e.id))})})})]})},eu=()=>{let{sboms:e,isFetching:t,fetchError:r}=N.useContext(U);return(0,i.jsx)(B.u,{isFetching:t,fetchError:r,isFetchingState:(0,i.jsx)(b.r,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,i.jsx)(f.P,{md:3,children:(0,i.jsx)(y.Z,{children:(0,i.jsx)(p.e,{children:(0,i.jsx)(q.b,{children:(0,i.jsx)(A.$,{})})})})},e))}),children:(0,i.jsx)(b.r,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,i.jsx)(f.P,{md:3,children:(0,i.jsx)(eh,{fieldName:t,sbomId:r})},`${t}:${r}`)})})})},ex=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.NP,{children:(0,i.jsxs)(n.K,{hasGutter:!0,children:[(0,i.jsx)(l.v,{children:(0,i.jsx)(I,{})}),(0,i.jsx)(l.v,{children:(0,i.jsx)(J,{children:(0,i.jsx)(eu,{})})})]})})})},60787:function(e,t,r){r.d(t,{N7:()=>h,gw:()=>u,tG:()=>x});var i=r(1183),s=r(68e3),n=r(22285),l=r(54227),a=r(54774),d=r(94426),c=r(22100);let o="advisories",h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:s,error:a,refetch:c}=(0,i.a)({queryKey:[o,e],queryFn:()=>(0,l.A1)({client:n.L,query:{...(0,d.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e??e},isFetching:s,fetchError:a||null,refetch:c}},u=e=>{let{data:t,isLoading:r,error:s}=(0,i.a)({queryKey:[o,e],queryFn:()=>(0,l.pB)({client:n.L,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:r,fetchError:s}},x=()=>{let e=(0,s.NL)();return(0,c.V)({parallel:!0,uploadFn:(e,t)=>(0,a.Cu)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[o]})}})}}}]);