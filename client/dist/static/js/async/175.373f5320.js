"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["175"],{97838:function(e,t,r){r.r(t),r.d(t,{default:()=>eA});var l,i=r(79192),s=r(53195),n=r(24246),a=r(27378),o=r(45043),c=r(70715),d=r(40982),u=r(75070),p=r(68802),h=r(89226),x=r(74502),j=r(65783),y=r(855),v=r(70400),f=r(60850),g=r(3594),b=r(106),m=r(13754),C=r(91865),k=r(19364),F=r(24252),S=r(47849),P=r(17598),_=r(59015),w=r(43959),A=r(52030);let R=e=>(0,n.jsx)(j.rU,{to:e.navLink,style:{textDecoration:"none"},children:(0,n.jsxs)(y.s,{itemId:e.id,description:e.description,children:[e.title," ",(0,n.jsx)(v._,{color:e.typeColor,children:e.type})]})},e.id),O=e=>{let{onChangeSearch:t}=e,{tableControls:r}=a.useContext(S.W),[l,s]=a.useState(""),[o,c]=a.useState(!1);a.useEffect(()=>{var e;let t=null==(e=r.filterState.filterValues[x.L4])?void 0:e[0];s(null!=t?t:"")},[r.filterState]);let[d,u]=(0,F.nj)(l,500);a.useEffect(()=>{u(l)},[u,l]);let{isFetching:p,list:h}=function(e,t){let r={filters:[{field:x.L4,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:l,result:{data:s}}=(0,P.N7)((0,i._)({},r),[],t),{isFetching:n,result:{data:a}}=(0,_.fF)((0,i._)({},r),t),{isFetching:o,result:{data:c}}=(0,w.Fz)((0,i._)({},r),[],t),{isFetching:d,result:{data:u}}=(0,A.fd)((0,i._)({},r),t),p=s.map(e=>{var t;return{id:"advisory-".concat(e.uuid),title:e.document_id,description:null==(t=e.title)?void 0:t.substring(0,75),navLink:"/advisories/".concat(e.uuid),type:"Advisory",typeColor:"blue"}}),h=a.map(e=>({id:"package-".concat(e.uuid),title:e.purl,navLink:"/packages/".concat(e.uuid),type:"Package",typeColor:"teal"})),j=c.map(e=>({id:"sbom-".concat(e.id),title:e.name,description:e.suppliers.join(", "),navLink:"/sboms/".concat(e.id),type:"SBOM",typeColor:"purple"})),y=u.map(e=>{var t;return{id:"vulnerability-".concat(e.identifier),title:e.identifier,description:null==(t=e.description)?void 0:t.substring(0,75),navLink:"/vulnerabilities/".concat(e.identifier),type:"Vulnerability",typeColor:"orange"}}),v=e.toLowerCase();return{isFetching:l||n||o||d,list:[...y,...j,...p,...h].sort((e,t)=>{var r,l;return(null==(r=e.title)?void 0:r.includes(v))?-1:(null==(l=t.title)?void 0:l.includes(v))?1:(e.description||"").toLowerCase().indexOf(v)-(t.description||"").toLowerCase().indexOf(v)})}}(d,!o),[j,v]=a.useState(!1),O=a.useRef(null),T=a.useRef(null);a.useEffect(()=>{let e=e=>{var t,r,l;if(j&&O.current&&O.current===e.target)if("Escape"===e.key)v(!1),O.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t=null==(r=T.current)?void 0:r.querySelector("li > button:not(:disabled)");t&&(null==t||t.focus()),e.preventDefault()}else("Tab"===e.key||"Enter"===e.key||"Space"===e.key)&&(v(!1),("Enter"===e.key||"Space"===e.key)&&e.preventDefault());else j&&(null==(t=T.current)?void 0:t.contains(e.target))&&"Tab"===e.key&&(e.preventDefault(),v(!1),null==(l=O.current)||l.focus())},t=e=>{j&&T&&T.current&&!T.current.contains(e.target)&&v(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}},[j]);let L=(0,n.jsx)(f.v,{ref:T,style:{width:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"},children:(0,n.jsx)(g.D,{children:(0,n.jsx)(b.q,{children:p?(0,n.jsx)(y.s,{itemId:"loading",children:(0,n.jsx)(m.$,{size:"sm"})}):h.map(R)})})}),V=(0,n.jsx)(C.M,{placeholder:"Search for an SBOM, Package, Advisory, or Vulnerability",value:l,onChange:(e,t)=>{""!==t&&O&&O.current&&O.current.contains(document.activeElement)?v(!0):v(!1),s(t),c(!0)},onClear:()=>{s("")},onSearch:()=>{t(l)},onKeyDown:e=>{if(e.key&&"Enter"!==e.key)return},ref:O,id:"autocomplete-search",style:{width:500}});return(0,n.jsx)(k.r,{trigger:V,triggerRef:O,popper:L,popperRef:T,isVisible:j&&h.length>0||p,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var T=r(92934),L=r(33384),V=r(27722);function E(e,t){return{Component:e,props:t}}let K=(l=[E(S.F,{}),E(L.u,{}),E(V.W,{}),E(T.F,{})],e=>{let{children:t}=e,r=(0,n.jsx)(n.Fragment,{children:t});return l.reduceRight((e,t)=>{let{Component:r,props:l={}}=t;return(0,n.jsx)(r,(0,s._)((0,i._)({},l),{children:e}),e.key)},r)});var D=r(11192),M=r(32591),I=r(31757),H=r(51527),B=r(2075),J=r(27090),Y=r(75165),Z=r(84780),W=r(64766),z=r(31762),N=r(99),q=r(12621),G=r(64118),U=r(27317),X=r(93095),$=r(78700),Q=r(70186),ee=r(14629),et=r(63706),er=r(40165);let el=e=>{let{category:t,filterValue:r,setFilterValue:l,isDisabled:i=!1}=e,[s,o]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);return a.useEffect(()=>{o(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]),(0,n.jsx)(er.F,{showChips:!0,isDisabled:i,options:s.map(e=>{var t;return{id:e.value,name:null!=(t=e.label)?t:e.value}}),selections:null==r?void 0:r.map(e=>({id:e,name:e})),onChange:e=>{l(e.map(e=>(0,et.KF)(e.name)))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})};var ei=r(70919);let es=e=>{let{category:t,filterValue:r,setFilterValue:l}=e,[i,s]=a.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);a.useEffect(()=>{s(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let o=Array.isArray(i)?i:Object.values(i).flat();return(0,n.jsx)(n.Fragment,{children:o.map((e,i)=>{let{label:s,value:a}=e;return(0,n.jsx)(ei.X,{id:"checkbox-".concat(i,"-").concat(t.categoryKey),isLabelWrapped:!0,label:s,isChecked:null==r?void 0:r.includes(a),onChange:()=>{a&&"No results"!==a&&l((null==r?void 0:r.includes(a))?r.filter(e=>e!==a):r?[...r,a]:[a])}},s)})})};var en=r(51088),ea=r(54816),eo=r(77152),ec=r(61244),ed=r(13464);let eu=e=>{let{filterValue:t,setFilterValue:r,isDisabled:l=!1}=e,[i,s]=(0,a.useState)(),[o,c]=(0,a.useState)();return a.useEffect(()=>{if(null==t?void 0:t[0]){let[e,r]=(0,ed.bG)(null==t?void 0:t[0]);s(e.toDate()),c(r.toDate())}else s(void 0),c(void 0)},[t]),(0,n.jsxs)(en.l,{children:[(0,n.jsx)(ea.c,{role:"group",isInline:!0,label:"From",children:(0,n.jsx)(eo.M,{value:i?(0,ed.xR)(i):"",dateFormat:ed.xR,dateParse:ed.Hy,onChange:(e,t)=>{(0,ed.pq)(t)&&(s((0,ed.Hy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:l})}),(0,n.jsx)(ea.c,{role:"group",isInline:!0,label:"To",children:(0,n.jsx)(eo.M,{value:o?(0,ed.xR)(o):"",onChange:(e,t)=>{if((0,ed.pq)(t)){let e=(0,ed.Hy)(t);c(e);let l=(0,ed.bP)(i,e);l&&r([l])}},isDisabled:l||!(0,ec.q)(i),dateFormat:ed.xR,dateParse:ed.Hy,invalidFormatText:"",rangeStart:i,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})})]})};var ep=r(97656);let eh=e=>{let{category:t,filterValue:r,setFilterValue:l,isDisabled:i=!1}=e;return(0,n.jsx)(n.Fragment,{children:t.selectOptions.map((e,s)=>{let{label:a,value:o}=e,c=(null==r?void 0:r.includes(o))||!1;return(0,n.jsx)(ep.Y,{isDisabled:i,id:"radio-".concat(s),name:"radio",isLabelWrapped:!0,label:a,isChecked:c,onChange:()=>{l(t.selectOptions.find(e=>{let{value:t}=e;return t===o})?[o]:null)}},a)})})};var ex=r(56081),ej=r(34091),ey=r(9767);let ev=e=>{let{category:t,filterValue:r,setFilterValue:l,isNumeric:i,isDisabled:s=!1}=e,[o,c]=a.useState((null==r?void 0:r[0])||"");a.useEffect(()=>{c((null==r?void 0:r[0])||"")},[r]);let d=()=>{let e=o.trim();l(e?[e.replace(/\s+/g," ")]:[])},u="".concat(t.categoryKey,"-input");return(0,n.jsxs)(ex.B,{children:[(0,n.jsx)(ej.oi,{name:u,id:"search-input",type:i?"number":"search",onChange:(e,t)=>c(t),"aria-label":"".concat(t.title," filter"),value:o,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||d()},isDisabled:s}),(0,n.jsx)($.zx,{icon:(0,n.jsx)(ey.ZP,{}),variant:$.Wu.control,id:"search-button","aria-label":"search button for search input",onClick:d,isDisabled:s})]})},ef=e=>{var{category:t}=e,r=(0,Q._)(e,["category"]);return t.type===ee.vA.select?(0,n.jsx)(eh,(0,i._)({category:t},r)):t.type===ee.vA.search||t.type===ee.vA.numsearch?(0,n.jsx)(ev,(0,i._)({category:t,isNumeric:t.type===ee.vA.numsearch},r)):t.type===ee.vA.multiselect?(0,n.jsx)(es,(0,i._)({category:t},r)):t.type===ee.vA.dateRange?(0,n.jsx)(eu,(0,i._)({category:t},r)):t.type===ee.vA.autocompleteLabel?(0,n.jsx)(el,(0,i._)({category:t},r)):null},eg=e=>{let{filterCategories:t,filterValues:r,setFilterValues:l,isDisabled:a=!1,omitFilterCategoryKeys:o=[]}=e;return(0,n.jsxs)(U.K,{hasGutter:!0,children:[(0,n.jsx)(X.v,{children:(0,n.jsx)($.zx,{variant:"link",isInline:!0,onClick:()=>{let e=t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).reduce((e,t)=>(e[t.categoryKey]=void 0,e),{});l((0,i._)({},r,e))},children:"Clear all filters"})}),t.filter(e=>void 0===o.find(t=>t===e.categoryKey)).map(e=>(0,n.jsx)(X.v,{children:(0,n.jsxs)(U.K,{hasGutter:!0,children:[(0,n.jsx)(X.v,{children:(0,n.jsx)(p.V,{component:"h4",children:e.title})}),(0,n.jsx)(X.v,{children:(0,n.jsx)(ef,{category:e,filterValue:r[e.categoryKey],setFilterValue:t=>l((0,s._)((0,i._)({},r),{[e.categoryKey]:t})),isDisabled:a,isSidebar:!0})})]})},e.categoryKey))]})};var eb=r(26179),em=r(80475),eC=r(75778),ek=r(39305),eF=r(68801),eS=r(83870),eP=r(96138),e_=r(27970);let ew=e=>{let{filterPanelProps:t,sbomTable:r,sbomTotalCount:l,packageTable:s,packageTotalCount:o,vulnerabilityTable:c,vulnerabilityTotalCount:d,advisoryTable:u,advisoryTotalCount:p,isFetchingPackages:h,isFetchingSboms:x,isFetchingVulnerabilities:j,isFetchingAdvisories:y}=e,[v,f]=a.useState(0),{sbomFilterPanelProps:g,packageFilterPanelProps:b,vulnerabilityFilterPanelProps:m,advisoryFilterPanelProps:C}=t,k=a.createRef(),F=a.createRef(),S=a.createRef(),P=a.createRef();return(0,n.jsxs)(D.P,{hasGutter:!0,children:[(0,n.jsx)(M.J,{children:(0,n.jsx)(I.Z,{isFullHeight:!0,children:(0,n.jsx)(H.e,{style:{width:241},children:0===v?(0,n.jsx)(eg,(0,i._)({omitFilterCategoryKeys:[""]},g)):1===v?(0,n.jsx)(eg,(0,i._)({omitFilterCategoryKeys:[""]},b)):2===v?(0,n.jsx)(eg,(0,i._)({omitFilterCategoryKeys:[""]},m)):3===v?(0,n.jsx)(eg,(0,i._)({omitFilterCategoryKeys:[""]},C)):null})})}),(0,n.jsx)(M.J,{isFilled:!0,children:(0,n.jsxs)(B.m,{mountOnEnter:!0,isBox:!0,activeKey:v,onSelect:(e,t)=>{f(t)},"aria-label":"Tabs",role:"region",children:[(0,n.jsxs)(J.O,{eventKey:0,title:(0,n.jsxs)(Y.T,{children:["SBOMs","  ",(0,n.jsx)(Z.C,{screenReaderText:"Search Result Count",children:x?(0,n.jsx)(W.J,{size:"sm",children:(0,n.jsx)(G.ZP,{})}):l})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.b,{"aria-label":"SBOM help popover",ref:k,children:(0,n.jsx)(q.ZP,{})}),(0,n.jsx)(N.J,{bodyContent:(0,n.jsx)("div",{children:"A list of ingested Software Bill of Materials (SBOM) documents."}),position:"right",triggerRef:k})]}),children:[(0,n.jsx)(eS.c,{}),null!=r?r:(0,n.jsx)(eF.H,{})]}),(0,n.jsxs)(J.O,{eventKey:1,title:(0,n.jsxs)(Y.T,{children:["Packages","  ",(0,n.jsx)(Z.C,{screenReaderText:"Search Result Count",children:h?(0,n.jsx)(W.J,{size:"sm",children:(0,n.jsx)(G.ZP,{})}):o})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.b,{"aria-label":"Package help popover",ref:F,children:(0,n.jsx)(q.ZP,{})}),(0,n.jsx)(N.J,{bodyContent:(0,n.jsx)("div",{children:"A list of packages along with the count of vulnerabilities."}),position:"right",triggerRef:F})]}),children:[(0,n.jsx)(ek.v,{}),null!=s?s:(0,n.jsx)(eC.L,{})]}),(0,n.jsxs)(J.O,{eventKey:2,title:(0,n.jsxs)(Y.T,{children:["Vulnerabilities","  ",(0,n.jsx)(Z.C,{screenReaderText:"Search Result Count",children:j?(0,n.jsx)(W.J,{size:"sm",children:(0,n.jsx)(G.ZP,{})}):d})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.b,{"aria-label":"Vulnerability help popover",ref:S,children:(0,n.jsx)(q.ZP,{})}),(0,n.jsx)(N.J,{bodyContent:(0,n.jsx)("div",{children:"A list of publicly known Common Vulnerabilities and Exposures (CVE)."}),position:"right",triggerRef:S})]}),children:[(0,n.jsx)(e_.R,{}),null!=c?c:(0,n.jsx)(eP.u,{})]}),(0,n.jsxs)(J.O,{eventKey:3,title:(0,n.jsxs)(Y.T,{children:["Advisories","  ",(0,n.jsx)(Z.C,{screenReaderText:"Advisory Result Count",children:y?(0,n.jsx)(W.J,{size:"sm",children:(0,n.jsx)(G.ZP,{})}):p})]}),actions:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(z.b,{"aria-label":"Advisory help popover",ref:P,children:(0,n.jsx)(q.ZP,{})}),(0,n.jsx)(N.J,{bodyContent:(0,n.jsx)("div",{children:"A list of available advisories."}),position:"right",triggerRef:P})]}),children:[(0,n.jsx)(em.P,{}),null!=u?u:(0,n.jsx)(eb.H,{})]})]})})]})},eA=e=>{let{searchBodyOverride:t}=e;return(0,n.jsx)(K,{children:(0,n.jsx)(eR,{searchBodyOverride:t})})},eR=e=>{let{searchBodyOverride:t}=e,{tableControls:r}=a.useContext(S.W),{tableControls:l}=a.useContext(L.a),{tableControls:j}=a.useContext(V.P),{tableControls:y}=a.useContext(T.P),{isFetching:v,totalItemCount:f,tableControls:{propHelpers:{filterPanelProps:g}}}=a.useContext(S.W),{isFetching:b,totalItemCount:m,tableControls:{propHelpers:{filterPanelProps:C}}}=a.useContext(L.a),{isFetching:k,totalItemCount:F,tableControls:{propHelpers:{filterPanelProps:P}}}=a.useContext(V.P),{isFetching:_,totalItemCount:w,tableControls:{propHelpers:{filterPanelProps:A}}}=a.useContext(T.P),R=(0,n.jsx)(ew,{filterPanelProps:{advisoryFilterPanelProps:A,packageFilterPanelProps:C,sbomFilterPanelProps:g,vulnerabilityFilterPanelProps:P},packageTotalCount:m,sbomTotalCount:f,vulnerabilityTotalCount:F,advisoryTotalCount:w,isFetchingPackages:b,isFetchingSboms:v,isFetchingVulnerabilities:k,isFetchingAdvisories:_});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.NP,{hasBodyWrapper:!1,children:(0,n.jsx)(c.o,{isStatic:!0,children:(0,n.jsxs)(d.c,{children:[(0,n.jsx)(u.k,{align:{default:"alignStart"},children:(0,n.jsx)(p.V,{children:(0,n.jsx)(p.V,{component:"h1",children:"Search Results"})})}),(0,n.jsx)(u.k,{variant:"action-group-plain",align:{default:"alignEnd"},children:(0,n.jsx)(u.k,{visibility:{default:"visible"},children:(0,n.jsx)(h.E,{children:(0,n.jsx)(O,{onChangeSearch:e=>{void 0!==e&&(r.filterState.setFilterValues((0,s._)((0,i._)({},r.filterState.filterValues),{[x.L4]:[e]})),l.filterState.setFilterValues((0,s._)((0,i._)({},l.filterState.filterValues),{[x.L4]:[e]})),j.filterState.setFilterValues((0,s._)((0,i._)({},j.filterState.filterValues),{[x.L4]:[e]})),y.filterState.setFilterValues((0,s._)((0,i._)({},y.filterState.filterValues),{[x.L4]:[e]})))}})})})})]})})}),(0,n.jsx)(o.NP,{hasBodyWrapper:!1,children:t||R})]})}}}]);