"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["321"],{97339:function(e,i,r){r.d(i,{a:()=>c});var t=r(59390),s=r(24246),n=r(27378),l=r(90633),a=r(15508),d=r(53315);let c=e=>{var{children:i=null,className:r="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,m=(0,t.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let x=(0,d.S$)(c.displayName,u,h);return(0,s.jsx)("nav",Object.assign({},m,{"aria-label":o,className:(0,a.i)(l.Z.breadcrumb,r)},x,{children:(0,s.jsx)("ol",{className:l.Z.breadcrumbList,role:"list",children:n.Children.map(i,(e,i)=>(0,n.isValidElement)(e)?(0,n.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,r){r.d(i,{g:()=>d});var t=r(59390),s=r(24246),n=r(91985),l=r(90633),a=r(15508);let d=e=>{var{children:i=null,className:r="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:m="a",render:x}=e,j=(0,t.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let b=c?"page":void 0,p=(0,a.i)(l.Z.breadcrumbLink,c&&l.Z.modifiers.current);return(0,s.jsxs)("li",Object.assign({},j,{className:(0,a.i)(l.Z.breadcrumbItem,r),children:[u&&(0,s.jsx)("span",{className:l.Z.breadcrumbItemDivider,children:(0,s.jsx)(n.ZP,{})}),"button"===m&&(0,s.jsx)("button",{className:p,"aria-current":b,type:"button",children:i}),o&&(0,s.jsx)("span",{className:(0,a.i)(l.Z.breadcrumbDropdown),children:i}),x&&x({className:p,ariaCurrent:b}),d&&!x&&(0,s.jsx)(m,{href:d,target:h,className:p,"aria-current":b,children:i}),!d&&"button"!==m&&!o&&i]}))};d.displayName="BreadcrumbItem"},81211:function(e,i,r){r.d(i,{aV:()=>h});var t,s,n,l,a,d=r(59390),c=r(24246),o=r(40269),u=r(15508);(t=n||(n={})).number="1",t.lowercaseLetter="a",t.uppercaseLetter="A",t.lowercaseRomanNumber="i",t.uppercaseRomanNumber="I",(l||(l={})).inline="inline",(s=a||(a={})).ol="ol",s.ul="ul";let h=e=>{var{className:i="",children:r=null,variant:t=null,isBordered:s=!1,isPlain:l=!1,iconSize:h="default",type:m=n.number,ref:x=null,component:j=a.ul}=e,b=(0,d.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return j===a.ol?(0,c.jsx)("ol",Object.assign({ref:x,type:m},l&&{role:"list"},b,{className:(0,u.i)(o.Z.list,t&&o.Z.modifiers[t],s&&o.Z.modifiers.bordered,l&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:r})):(0,c.jsx)("ul",Object.assign({ref:x},l&&{role:"list"},b,{className:(0,u.i)(o.Z.list,t&&o.Z.modifiers[t],s&&o.Z.modifiers.bordered,l&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:r}))};h.displayName="List"},45882:function(e,i,r){r.d(i,{H:()=>a});var t=r(59390),s=r(24246),n=r(40269),l=r(15508);let a=e=>{var{icon:i=null,children:r=null}=e,a=(0,t.__rest)(e,["icon","children"]);return(0,s.jsxs)("li",Object.assign({className:(0,l.i)(i&&n.Z.listItem)},a,{children:[i&&(0,s.jsx)("span",{className:(0,l.i)(n.Z.listItemIcon),children:i}),(0,s.jsx)("span",{className:i&&(0,l.i)(`${n.Z.list}__item-text`),children:r})]}))};a.displayName="ListItem"},26235:function(e,i,r){r.d(i,{ZP:()=>t});let t=(0,r(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0})},67447:function(e,i,r){r.d(i,{G:()=>a});var t=r(59390),s=r(24246),n=r(15508),l=r(39157);let a=e=>{var{children:i=null}=e,r=(0,t.__rest)(e,["children"]);return(0,s.jsx)("div",Object.assign({},r,{className:(0,n.i)(l.Z.tableExpandableRowContent),children:i}))};a.displayName="ExpandableRowContent"},37818:function(e,i,r){r.d(i,{u:()=>a});var t=r(24246),s=r(8305),n=r(13754),l=r(39826);let a=e=>e.isFetching?e.isFetchingState||(0,t.jsx)(s.b,{children:(0,t.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,t.jsx)(l.y,{}):e.children},69876:function(e,i,r){r.d(i,{D:()=>n});var t=r(24246),s=r(70400);let n=e=>{let{value:i}=e;return(0,t.jsx)(t.Fragment,{children:Object.entries(i).map(e=>{let[i,r]=e;return(0,t.jsx)(s._,{isCompact:!0,children:`${i}=${r}`},`${i}=${r}`)})})}},68057:function(e,i,r){r.d(i,{V:()=>a});var t=r(24246),s=r(27378),n=r(63763),l=r(32947);let a=e=>{let{vulnerabilitiesSummary:i}=e,r=s.useMemo(()=>Object.keys(i.severities).map(e=>{let r=i.severities[e],t=l.V4[e];return{severity:e,count:r,label:t.name,color:t.color.value}}).sort((0,l.A0)(e=>e.severity)).reverse(),[i]);return(0,t.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,t.jsx)(n.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:i,count:r}=e;return{name:`${i}: ${r}`}}),data:r.map(e=>{let{label:i,count:r}=e;return{x:i,y:r}}),labels:e=>{let{datum:i}=e;return`${i.x}: ${i.y}`},colorScale:r.map(e=>{let{color:i}=e;return i})})})}},3586:function(e,i,r){r.d(i,{j:()=>n});var t=r(24246),s=r(27378);let n=e=>{let{children:i}=e,[r,n]=s.useState(!1);return(0,t.jsx)(t.Fragment,{children:i(r,n)})}},24200:function(e,i,r){r.d(i,{G:()=>s});var t=r(24246);let s=e=>{let{vulnerability:i}=e;return(0,t.jsxs)("p",{children:[i.withdrawn&&(0,t.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},82413:function(e,i,r){r.d(i,{useVulnerabilitiesOfSbom:()=>o,useVulnerabilitiesOfSboms:()=>u});var t=r(27378),s=r(7615),n=r(43959);let l=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,a={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:{...a},fixed:{...a},not_affected:{...a},known_not_affected:{...a}}},c=e=>{let i=e.flatMap(e=>(e.status??[]).map(i=>({vulnerability:i,vulnerabilityStatus:i.status,advisory:e,packages:i.packages}))).reduce((e,i)=>{let r,t=e.find(e=>l(e,i));if(t)r=[...e.filter(e=>!l(e,t)),{...t,relatedPackages:[...t.relatedPackages,{advisory:i.advisory,packages:i.packages}]}];else{let t={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedPackages:[{advisory:i.advisory,packages:i.packages}]};r=[...e.slice(),t]}return r},[]),r=i.reduce((e,i)=>{let r=i.vulnerabilityStatus,t=(0,s.g)(i.vulnerability.average_severity),n=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:n.total+1,severities:{...n.severities,[t]:n.severities[t]+1}}}})},{...d});return{vulnerabilities:i,summary:r}},o=e=>{let{advisories:i,isFetching:r,fetchError:s}=(0,n.useFetchSbomsAdvisory)(e);return{data:t.useMemo(()=>c(i||[]),[i]),isFetching:r,fetchError:s}},u=e=>{let{advisories:i,isFetching:r,fetchError:s}=(0,n.useFetchSbomsAdvisoryBatch)(e);return{data:t.useMemo(()=>(i??[]).map(e=>c(e||[])),[i]),isFetching:r,fetchError:s}}},41362:function(e,i,r){r.r(i),r.d(i,{default:()=>eN});var t=r(24246),s=r(27378),n=r(65783),l=r(45043),a=r(97339),d=r(18091),c=r(11192),o=r(32591),u=r(34747),h=r(46770),m=r(68802),x=r(70400),j=r(32939),b=r(24620),p=r(37961),y=r(69265),f=r(4075),g=r(27090),v=r(75165),S=r(31762),T=r(99),F=r(24787),M=r(12621),P=r(9839),B=r(37818),E=r(73227),k=r(43959),N=r(65872),O=r(87727),_=r(3498),K=r(31757),I=r(87069),w=r(51527),C=r(30329),Z=r(50689),L=r(67761),D=r(81391),q=r(17528),$=r(81211),V=r(45882),R=r(79551),A=r(32489),H=r(90519),Q=r(26235),G=r(73827),U=r(63706),z=r(66043);let W=e=>{let{sbom:i}=e,[r,n]=s.useState(!1),l=()=>{n(!1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(O.r,{hasGutter:!0,children:[(0,t.jsx)(_.P,{md:4,children:(0,t.jsxs)(K.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Metadata"}),(0,t.jsx)(w.e,{children:(0,t.jsxs)(C.o,{children:[(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Name"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Namespace"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Data License"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,t.jsx)(_.P,{md:4,children:(0,t.jsxs)(K.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Creation"}),(0,t.jsx)(w.e,{children:(0,t.jsxs)(C.o,{children:[(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Created"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's creation date",children:(0,U.p6)(i.published)})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Creator"}),(0,t.jsx)(D.b,{"aria-label":"SBOM's creator",children:i.suppliers})]})]})})]})}),(0,t.jsx)(_.P,{md:4,children:(0,t.jsxs)(K.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Statistics"}),(0,t.jsx)(w.e,{children:(0,t.jsxs)(C.o,{children:[(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Size"}),(0,t.jsx)(D.b,{children:(0,N.Z)(i.size)})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Packages"}),(0,t.jsx)(D.b,{children:i.number_of_packages})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsxs)(L.M,{children:["Labels ","",(0,t.jsx)(q.zx,{variant:q.Wu.link,size:"sm",icon:(0,t.jsx)(Q.ZP,{}),iconPosition:"end",onClick:()=>n(!0),children:"Edit"})]}),(0,t.jsx)(D.b,{children:(0,t.jsx)(K.Z,{isCompact:!0,children:(0,t.jsx)(w.e,{children:i.labels&&(0,t.jsx)(G.C,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,t.jsx)(_.P,{md:12,children:(0,t.jsxs)(K.Z,{isFullHeight:!0,children:[(0,t.jsx)(I.l,{children:"Package"}),(0,t.jsx)(w.e,{children:(0,t.jsxs)(C.o,{children:[(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Name"}),(0,t.jsx)(D.b,{children:i.name})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Version"}),(0,t.jsx)(D.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"External References"}),(0,t.jsx)(D.b,{children:(0,t.jsxs)($.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,t.jsx)(V.H,{children:e},e)),(0,t.jsx)(V.H,{children:i.described_by.flatMap(e=>e.purl).map(e=>e.purl)})]})})]})]})})]})})]}),(0,t.jsxs)(R.u,{isOpen:r,variant:"medium",onClose:l,children:[(0,t.jsx)(A.x,{title:"Edit labels"}),(0,t.jsx)(H.f,{children:(0,t.jsx)(z._,{sbom:i,onClose:l})})]})]})};var Y=r(70715),J=r(40982),X=r(89226),ee=r(62997),ei=r(4835),er=r(14350),et=r(11165),es=r(89330),en=r(31423),el=r(94154),ea=r(67447),ed=r(74502),ec=r(14629),eo=r(3804),eu=r(31336),eh=r(49988),em=r(59015);let ex=e=>{let{sbomId:i}=e,r=(0,eh.vZ)({tableName:"package-table",columnNames:{name:"Name",version:"Version"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:ed.L4,title:"Filter text",placeholderText:"Search",type:ec.vA.search}],isExpansionEnabled:!0,expandableVariant:"single"}),{result:{data:s,total:l},isFetching:a,fetchError:d}=(0,em.useFetchPackagesBySbomId)(i,(0,eh.QO)({...r,hubSortFieldKeys:{name:"name"}})),c=(0,eh.KC)({...r,idProperty:"id",currentPageItems:s,totalItemCount:l,isLoading:a}),{currentPageItems:o,numRenderedColumns:u,propHelpers:{toolbarProps:h,filterToolbarProps:m,paginationToolbarItemProps:x,paginationProps:j,tableProps:b,getThProps:p,getTrProps:y,getTdProps:f,getExpandedContentTdProps:g},expansionDerivedState:{isCellExpanded:v}}=c;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.o,{...h,children:(0,t.jsxs)(J.c,{children:[(0,t.jsx)(ec.Ki,{showFiltersSideBySide:!0,...m}),(0,t.jsx)(X.E,{...x,children:(0,t.jsx)(eo.p,{idPrefix:"package-table",isTop:!0,paginationProps:j})})]})}),(0,t.jsxs)(ei.i,{...b,"aria-label":"Package table",children:[(0,t.jsx)(er.h,{children:(0,t.jsx)(et.Tr,{children:(0,t.jsxs)(eu.qK,{...c,children:[(0,t.jsx)(es.Th,{...p({columnKey:"name"})}),(0,t.jsx)(es.Th,{...p({columnKey:"version"})})]})})}),(0,t.jsx)(eu.hp,{isLoading:a,isError:!!d,isNoData:0===l,numRenderedColumns:u,children:o?.map((e,i)=>(0,t.jsxs)(en.p,{children:[(0,t.jsx)(et.Tr,{...y({item:e}),children:(0,t.jsxs)(eu.Cx,{...c,item:e,rowIndex:i,children:[(0,t.jsx)(el.Td,{width:80,...f({columnKey:"name"}),children:[e.name,e.group].filter(Boolean).join("/")}),(0,t.jsx)(el.Td,{width:20,modifier:"truncate",...f({columnKey:"version"}),children:e?.version})]})}),v(e)?(0,t.jsxs)(et.Tr,{isExpanded:!0,children:[(0,t.jsx)(el.Td,{}),(0,t.jsx)(el.Td,{...g({item:e}),className:ee.Z.pyLg,children:(0,t.jsx)(ea.G,{children:(0,t.jsx)(C.o,{children:(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"External identifier"}),(0,t.jsx)(D.b,{children:(0,t.jsxs)($.aV,{children:[e.purl.map(e=>(0,t.jsx)(V.H,{children:(0,t.jsx)(n.rU,{to:`/packages/${e.uuid}`,children:e.purl})},e.uuid)),e.cpe.map(e=>(0,t.jsx)(V.H,{children:e},e))]})})]})})})})]}):null]},e.id))})]}),(0,t.jsx)(eo.p,{idPrefix:"package-table",isTop:!1,paginationProps:j})]})};var ej=r(27693),eb=r.n(ej),ep=r(27317),ey=r(93095),ef=r(9905),eg=r(32947),ev=r(7615),eS=r(69876),eT=r(68057),eF=r(57524),eM=r(3586),eP=r(24200),eB=r(82413),eE=r(41135);let ek=e=>{let{sbomId:i}=e,{sbom:r,isFetching:l,fetchError:a}=(0,k.useFetchSBOMById)(i),{data:{vulnerabilities:d,summary:c},isFetching:o,fetchError:u}=(0,eB.useVulnerabilitiesOfSbom)(i),h=s.useMemo(()=>d.filter(e=>"affected"===e.vulnerabilityStatus),[d]),m=s.useMemo(()=>h.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return{...e,summary:{totalPackages:i.length,allPackages:i}}}),[h]),x=(0,eE.T)(m,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),j=(0,eh.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:x,isLoading:o,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,eg.XE)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?eb()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?eb()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:b,numRenderedColumns:p,propHelpers:{toolbarProps:y,paginationToolbarItemProps:f,paginationProps:g,tableProps:v,getThProps:S,getTrProps:T,getTdProps:F,getExpandedContentTdProps:M},expansionDerivedState:{isCellExpanded:P}}=j;return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(ep.K,{hasGutter:!0,children:[(0,t.jsx)(ey.v,{children:(0,t.jsx)(K.Z,{children:(0,t.jsx)(w.e,{children:(0,t.jsx)(B.u,{isFetching:l||o,fetchError:a,children:(0,t.jsxs)(O.r,{hasGutter:!0,children:[(0,t.jsx)(_.P,{md:6,children:(0,t.jsx)(eT.V,{vulnerabilitiesSummary:c.vulnerabilityStatus.affected})}),(0,t.jsx)(_.P,{md:6,children:(0,t.jsxs)(C.o,{children:[(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Name"}),(0,t.jsx)(D.b,{children:r?.name})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Version"}),(0,t.jsx)(D.b,{children:r?.described_by.map(e=>e.version).join(", ")})]}),(0,t.jsxs)(Z.g,{children:[(0,t.jsx)(L.M,{children:"Creation date"}),(0,t.jsx)(D.b,{children:(0,U.p6)(r?.published)})]})]})})]})})})})}),(0,t.jsxs)(ey.v,{children:[(0,t.jsx)(Y.o,{...y,children:(0,t.jsx)(J.c,{children:(0,t.jsx)(X.E,{...f,children:(0,t.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})})})}),(0,t.jsxs)(ei.i,{...v,"aria-label":"Vulnerability table",children:[(0,t.jsx)(er.h,{children:(0,t.jsx)(et.Tr,{children:(0,t.jsxs)(eu.qK,{...j,children:[(0,t.jsx)(es.Th,{...S({columnKey:"id"})}),(0,t.jsx)(es.Th,{...S({columnKey:"description"})}),(0,t.jsx)(es.Th,{...S({columnKey:"cvss"})}),(0,t.jsx)(es.Th,{...S({columnKey:"affectedDependencies"})}),(0,t.jsx)(es.Th,{...S({columnKey:"published"})}),(0,t.jsx)(es.Th,{...S({columnKey:"updated"})})]})})}),(0,t.jsx)(eu.hp,{isLoading:o,isError:!!u,isNoData:0===x.length,numRenderedColumns:p,children:b?.map((e,i)=>(0,t.jsxs)(en.p,{isExpanded:P(e),children:[(0,t.jsx)(et.Tr,{...T({item:e}),children:(0,t.jsxs)(eu.Cx,{...j,item:e,rowIndex:i,children:[(0,t.jsx)(el.Td,{width:15,modifier:"breakWord",...F({columnKey:"id"}),children:(0,t.jsx)(n.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),(0,t.jsx)(eM.j,{children:(i,r)=>(0,t.jsx)(el.Td,{width:35,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0,...F({columnKey:"description"}),children:(0,t.jsx)(ef.cE,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,t.jsx)(eP.G,{vulnerability:e.vulnerability})})})}),(0,t.jsx)(el.Td,{width:10,...F({columnKey:"cvss"}),children:(0,t.jsx)(eF.o,{value:(0,ev.g)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})}),(0,t.jsx)(el.Td,{width:15,modifier:"truncate",...F({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:e.summary.totalPackages}),(0,t.jsx)(el.Td,{width:10,modifier:"truncate",...F({columnKey:"published"}),children:(0,U.p6)(e.vulnerability?.published)}),(0,t.jsx)(el.Td,{width:10,modifier:"truncate",...F({columnKey:"updated"}),children:(0,U.p6)(e.vulnerability?.modified)})]})}),P(e)?(0,t.jsx)(et.Tr,{isExpanded:!0,children:(0,t.jsx)(el.Td,{...M({item:e}),children:(0,t.jsx)(ea.G,{children:P(e,"affectedDependencies")?(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(ei.i,{variant:"compact",children:[(0,t.jsx)(er.h,{children:(0,t.jsxs)(et.Tr,{children:[(0,t.jsx)(es.Th,{children:"Type"}),(0,t.jsx)(es.Th,{children:"Namespace"}),(0,t.jsx)(es.Th,{children:"Name"}),(0,t.jsx)(es.Th,{children:"Version"}),(0,t.jsx)(es.Th,{children:"Path"}),(0,t.jsx)(es.Th,{children:"Qualifiers"})]})}),(0,t.jsx)(en.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,U.qX)(e.purlSummary.purl);return(0,t.jsxs)(et.Tr,{children:[(0,t.jsx)(el.Td,{children:i?.type}),(0,t.jsx)(el.Td,{children:i?.namespace}),(0,t.jsx)(el.Td,{children:(0,t.jsx)(n.rU,{to:`/packages/${e.purlSummary.uuid}`,children:i?.name})}),(0,t.jsx)(el.Td,{children:i?.version}),(0,t.jsx)(el.Td,{children:i?.path}),(0,t.jsx)(el.Td,{children:i?.qualifiers&&(0,t.jsx)(eS.D,{value:i?.qualifiers})})]},e.purlSummary.uuid)}return(0,t.jsxs)(et.Tr,{children:[(0,t.jsx)(el.Td,{}),(0,t.jsx)(el.Td,{}),(0,t.jsx)(el.Td,{children:e.parentName}),(0,t.jsx)(el.Td,{}),(0,t.jsx)(el.Td,{}),(0,t.jsx)(el.Td,{})]},`${e.parentName}-${i}-name`)})})]})}):null})})}):null]},e._ui_unique_id))})]}),(0,t.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:g})]})]})})},eN=()=>{let e=(0,P.ZX)(P.Uo.SBOM_ID),{sbom:i,isFetching:r,fetchError:N}=(0,k.useFetchSBOMById)(e),{downloadSBOM:O,downloadSBOMLicenses:_}=(0,E.useDownload)(),[K,I]=s.useState(!1),[w,C]=s.useState(0),Z=s.createRef(),L=s.createRef(),D=s.createRef(),q=s.createRef(),$=()=>{I(!K)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.NP,{type:"breadcrumb",children:(0,t.jsxs)(a.a,{children:[(0,t.jsx)(d.g,{children:(0,t.jsx)(n.rU,{to:"/sboms",children:"SBOMs"})}),(0,t.jsx)(d.g,{isActive:!0,children:"SBOM details"})]})}),(0,t.jsx)(l.NP,{children:(0,t.jsxs)(c.P,{children:[(0,t.jsx)(o.J,{isFilled:!0,children:(0,t.jsxs)(u.k,{children:[(0,t.jsx)(h.B,{spacer:{default:"spacerSm"},children:(0,t.jsx)(m.V,{children:(0,t.jsx)(m.V,{component:"h1",children:i?.name??e??""})})}),(0,t.jsx)(h.B,{children:i?.labels.type&&(0,t.jsx)(x._,{color:"blue",children:i?.labels.type})})]})}),(0,t.jsx)(o.J,{children:i&&(0,t.jsx)(j.L,{isOpen:K,onSelect:()=>I(!1),onOpenChange:e=>I(e),popperProps:{position:"right"},toggle:e=>(0,t.jsx)(b.O_,{ref:e,onClick:$,isExpanded:K,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,t.jsxs)(p.s,{children:[(0,t.jsx)(y.h,{onClick:()=>{e&&O(e,i?.name?`${i?.name}.json`:`${e}.json`)},children:"Download SBOM"},"sbom"),(0,t.jsx)(y.h,{onClick:()=>{e&&_(e)},children:"Download License Report"},"license")]})})})]})}),(0,t.jsx)(l.NP,{children:(0,t.jsxs)(f.m,{mountOnEnter:!0,activeKey:w,onSelect:(e,i)=>{C(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,t.jsx)(g.O,{eventKey:0,title:(0,t.jsx)(v.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:Z}),(0,t.jsx)(g.O,{eventKey:1,title:(0,t.jsx)(v.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:L}),(0,t.jsx)(g.O,{eventKey:2,title:(0,t.jsx)(v.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:D,actions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(S.b,{ref:q,children:(0,t.jsx)(M.ZP,{})}),(0,t.jsx)(T.J,{triggerRef:q,bodyContent:(0,t.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,t.jsxs)(l.NP,{children:[(0,t.jsx)(F.I,{eventKey:0,id:"refTabInfoSection",ref:Z,"aria-label":"Information of the SBOM",children:(0,t.jsx)(B.u,{isFetching:r,fetchError:N,children:i&&(0,t.jsx)(W,{sbom:i})})}),(0,t.jsx)(F.I,{eventKey:1,id:"refTabPackagesSection",ref:L,"aria-label":"Packages within the SBOM",hidden:!0,children:e&&(0,t.jsx)(ex,{sbomId:e})}),(0,t.jsx)(F.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:D,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:e&&(0,t.jsx)(ek,{sbomId:e})})]})]})}},66043:function(e,i,r){r.d(i,{_:()=>d});var t=r(24246),s=r(27378),n=r(24502),l=r(15726),a=r(43959);let d=e=>{let{sbom:i,onClose:r}=e,{pushNotification:d}=s.useContext(l.c),[c,o]=s.useState(""),[u,h]=s.useState("");s.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{labels:m}=(0,a.useFetchSBOMLabels)(u),{mutate:x,isPending:j}=(0,a.useUpdateSbomLabelsMutation)(()=>{d({title:`Labels updated for SBOM ${i.name}`,variant:"success"}),r()},e=>{d({title:`Error while updating labels for SBOM ${i.name}`,variant:"danger"})});return(0,t.jsx)(n.M,{title:`Labels of SBOM: ${i.name}`,value:i.labels,isDisabled:j,onSave:e=>{x({id:i.id,labels:e})},onClose:r,onInputChange:o,options:m})}},59015:function(e,i,r){r.d(i,{useFetchPackageById:()=>c,useFetchPackages:()=>d,useFetchPackagesBySbomId:()=>o});var t=r(1183),s=r(50576),n=r(40371),l=r(49988);let a="packages",d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:d,error:c,refetch:o}=(0,t.useQuery)({queryKey:[a,e],queryFn:()=>(0,n.tj)({client:s.L,query:{...(0,l.rm)(e)}}),enabled:!i});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:d,fetchError:c,refetch:o}},c=e=>{let{data:i,isLoading:r,error:l}=(0,t.useQuery)({queryKey:[a,e],queryFn:()=>(0,n.BK)({client:s.L,path:{key:e}})});return{pkg:i?.data,isFetching:r,fetchError:l}},o=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:d,error:c,refetch:o}=(0,t.useQuery)({queryKey:[a,"by-sbom",e,i],queryFn:()=>(0,n.Pg)({client:s.L,path:{id:e},query:{...(0,l.rm)(i)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:i},isFetching:d,fetchError:c,refetch:o}}},43959:function(e,i,r){r.d(i,{useFetchSBOMById:()=>b,useFetchSBOMLabels:()=>x,useFetchSBOMs:()=>j,useFetchSbomsAdvisory:()=>g,useFetchSbomsAdvisoryBatch:()=>v,useFetchSbomsByPackageId:()=>f,useUpdateSbomLabelsMutation:()=>y,useUploadSBOM:()=>p});var t=r(1183),s=r(24038),n=r(68e3),l=r(75503),a=r(16072),d=r(50576),c=r(40371),o=r(95169),u=r(87017),h=r(49988);let m="sboms",x=e=>{let{data:i,isLoading:r,error:n,refetch:l}=(0,t.useQuery)({queryKey:[m,"labels",e],queryFn:()=>(0,c.mh)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:i?.data||[],isFetching:r,fetchError:n,refetch:l}},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:s,...n}=(0,h.rm)(e),l=(0,h.Rb)(i),{data:a,isLoading:o,error:u,refetch:x}=(0,t.useQuery)({queryKey:[m,e,l],queryFn:()=>(0,c.Wp)({client:d.L,query:{...n,q:[s,l].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:o,fetchError:u,refetch:x}},b=e=>{let{data:i,isLoading:r,error:s}=(0,t.useQuery)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,c._Q)({client:d.L,path:{id:e}}),enabled:void 0!==e});return{sbom:i?.data,isFetching:r,fetchError:s}},p=()=>{let e=(0,n.NL)();return(0,o.V)({parallel:!0,uploadFn:(e,i)=>(0,u.Hb)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},y=(e,i)=>{let r=(0,n.NL)();return(0,l.D)({mutationFn:e=>(0,c.zx)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:i})},f=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:s,error:n,refetch:l}=(0,t.useQuery)({queryKey:[m,"by-package",e,i],queryFn:()=>(0,c.DU)({client:d.L,query:{purl:e,...(0,h.rm)(i)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:i??i},isFetching:s,fetchError:n,refetch:l}},g=e=>{let{data:i,isLoading:r,error:s}=(0,t.useQuery)({queryKey:[m,e,"advisory"],queryFn:()=>(0,c.NU)({client:d.L,path:{id:e}})});return{advisories:i?.data||[],isFetching:r,fetchError:s}},v=e=>{let i=(0,a.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,c.NU)({client:d.L,path:{id:e}})}))});return{advisories:i.map(e=>{let{data:i}=e;return i?.data||[]}),isFetching:i.some(e=>{let{isLoading:i}=e;return i}),fetchError:i.map(e=>{let{error:i}=e;return i})}}},41135:function(e,i,r){r.d(i,{T:()=>n});var t=r(27378),s=r(74502);let n=(e,i)=>(0,t.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[s.nM]:i(e)})):[],[e,i])},40269:function(e,i,r){r.d(i,{Z:()=>t});let t={list:"pf-v6-c-list",listItem:"pf-v6-c-list__item",listItemIcon:"pf-v6-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},65872:function(e,i,r){r.d(i,{Z:()=>d});let t=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],s=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],n=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],l=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,r)=>{let t=e;return"string"==typeof i||Array.isArray(i)?t=e.toLocaleString(i,r):(!0===i||void 0!==r)&&(t=e.toLocaleString(void 0,r)),t};function d(e,i){let r;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?l:n:i.binary?s:t,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(r={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(r={maximumFractionDigits:i.maximumFractionDigits,...r}),e<1)return u+a(e,i.locale,r)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,r||(e=e.toPrecision(3)),u+a(Number(e),i.locale,r)+c+d[h]}}}]);