"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["944"],{97339:function(e,i,n){n.d(i,{a:()=>c});var r=n(59390),t=n(24246),l=n(27378),s=n(90633),a=n(15508),d=n(53315);let c=e=>{var{children:i=null,className:n="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,x=(0,r.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let j=(0,d.S$)(c.displayName,u,h);return(0,t.jsx)("nav",Object.assign({},x,{"aria-label":o,className:(0,a.i)(s.Z.breadcrumb,n)},j,{children:(0,t.jsx)("ol",{className:s.Z.breadcrumbList,role:"list",children:l.Children.map(i,(e,i)=>(0,l.isValidElement)(e)?(0,l.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,n){n.d(i,{g:()=>d});var r=n(59390),t=n(24246),l=n(91985),s=n(90633),a=n(15508);let d=e=>{var{children:i=null,className:n="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:x="a",render:j}=e,m=(0,r.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let b=c?"page":void 0,v=(0,a.i)(s.Z.breadcrumbLink,c&&s.Z.modifiers.current);return(0,t.jsxs)("li",Object.assign({},m,{className:(0,a.i)(s.Z.breadcrumbItem,n),children:[u&&(0,t.jsx)("span",{className:s.Z.breadcrumbItemDivider,children:(0,t.jsx)(l.ZP,{})}),"button"===x&&(0,t.jsx)("button",{className:v,"aria-current":b,type:"button",children:i}),o&&(0,t.jsx)("span",{className:(0,a.i)(s.Z.breadcrumbDropdown),children:i}),j&&j({className:v,ariaCurrent:b}),d&&!j&&(0,t.jsx)(x,{href:d,target:h,className:v,"aria-current":b,children:i}),!d&&"button"!==x&&!o&&i]}))};d.displayName="BreadcrumbItem"},51527:function(e,i,n){n.d(i,{e:()=>a});var r=n(59390),t=n(24246),l=n(24416),s=n(15508);let a=e=>{var{children:i,className:n,component:a="div",isFilled:d=!0}=e,c=(0,r.__rest)(e,["children","className","component","isFilled"]);return(0,t.jsx)(a,Object.assign({className:(0,s.i)(l.Z.cardBody,!d&&l.Z.modifiers.noFill,n)},c,{children:i}))};a.displayName="CardBody"},87069:function(e,i,n){n.d(i,{l:()=>c});var r=n(59390),t=n(24246),l=n(27378),s=n(15508),a=n(24416),d=n(31757);let c=e=>{var{children:i,className:n,component:c="div"}=e,o=(0,r.__rest)(e,["children","className","component"]);let{cardId:u}=(0,l.useContext)(d.H),h=u?`${u}-title`:"";return(0,t.jsx)("div",{className:(0,s.i)(a.Z.cardTitle),children:(0,t.jsx)(c,Object.assign({className:(0,s.i)(a.Z.cardTitleText,n),id:h||void 0},o,{children:i}))})};c.displayName="CardTitle"},67761:function(e,i,n){n.d(i,{M:()=>a});var r=n(59390),t=n(24246),l=n(38436),s=n(15508);let a=e=>{var{children:i,className:n,icon:a}=e,d=(0,r.__rest)(e,["children","className","icon"]);return(0,t.jsxs)("dt",Object.assign({className:(0,s.i)(l.Z.descriptionListTerm,n)},d,{children:[a?(0,t.jsx)("span",{className:(0,s.i)(l.Z.descriptionListTermIcon),children:a}):null,(0,t.jsx)("span",{className:(0,s.i)(l.Z.descriptionListText),children:i})]}))};a.displayName="DescriptionListTerm"},26235:function(e,i,n){n.d(i,{ZP:()=>r});let r=(0,n(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0,svgClassName:void 0})},37818:function(e,i,n){n.d(i,{u:()=>a});var r=n(24246),t=n(8305),l=n(13754),s=n(39826);let a=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(t.b,{children:(0,r.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(s.y,{}):e.children},3586:function(e,i,n){n.d(i,{j:()=>l});var r=n(24246),t=n(27378);let l=e=>{let{children:i}=e,[n,l]=t.useState(!1);return(0,r.jsx)(r.Fragment,{children:i(n,l)})}},24200:function(e,i,n){n.d(i,{G:()=>t});var r=n(24246);let t=e=>{let{vulnerability:i}=e;return(0,r.jsxs)("p",{children:[i.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},74247:function(e,i,n){n.r(i),n.d(i,{default:()=>ey});var r=n(79192),t=n(53195),l=n(24246),s=n(27378),a=n(14935),d=n(65783),c=n(45043),o=n(97339),u=n(18091),h=n(11192),x=n(32591),j=n(34747),m=n(46770),b=n(68802),v=n(70400),y=n(32939),f=n(24620),p=n(37961),g=n(69265),_=n(25138),T=n(2075),N=n(27090),w=n(75165),C=n(59086),E=n(78700),B=n(74502),S=n(9839),F=n(6348),P=n(37818),D=n(15726),Z=n(73227),I=n(17598),K=n(65872),L=n(87727),M=n(3498),k=n(31757),O=n(87069),A=n(51527),q=n(30329),V=n(50689),R=n(67761),G=n(81391),z=n(79551),Y=n(32489),$=n(90519),W=n(26235),H=n(73827),Q=n(63706),U=n(15167);let J=e=>{var i,n;let{advisory:r}=e,[t,a]=s.useState(!1),d=()=>{a(!1)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(L.r,{hasGutter:!0,children:[(0,l.jsx)(M.P,{md:4,children:(0,l.jsxs)(k.Z,{isFullHeight:!0,children:[(0,l.jsx)(O.l,{children:"Overview"}),(0,l.jsx)(A.e,{children:(0,l.jsxs)(q.o,{children:[(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"Title"}),(0,l.jsx)(G.b,{children:r.title})]}),(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"Type"}),(0,l.jsx)(G.b,{children:r.labels.type})]}),(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"Size"}),(0,l.jsx)(G.b,{children:(0,K.Z)(r.size)})]}),(0,l.jsxs)(V.g,{children:[(0,l.jsxs)(R.M,{children:["Labels ","",(0,l.jsx)(E.zx,{variant:E.Wu.link,size:"sm",icon:(0,l.jsx)(W.ZP,{}),iconPosition:"end",onClick:()=>a(!0),children:"Edit"})]}),(0,l.jsx)(G.b,{children:(0,l.jsx)(k.Z,{isCompact:!0,children:(0,l.jsx)(A.e,{children:r.labels&&(0,l.jsx)(H.C,{defaultIsOpen:!0,value:r.labels})})})})]})]})})]})}),(0,l.jsx)(M.P,{md:4,children:(0,l.jsxs)(k.Z,{isFullHeight:!0,children:[(0,l.jsx)(O.l,{children:"Publisher"}),(0,l.jsx)(A.e,{children:(0,l.jsxs)(q.o,{children:[(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"Name"}),(0,l.jsx)(G.b,{children:null==(i=r.issuer)?void 0:i.name})]}),(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"Contact details"}),(0,l.jsx)(G.b,{children:null==(n=r.issuer)?void 0:n.website})]})]})})]})}),(0,l.jsx)(M.P,{md:4,children:(0,l.jsxs)(k.Z,{isFullHeight:!0,children:[(0,l.jsx)(O.l,{children:"Tracking"}),(0,l.jsx)(A.e,{children:(0,l.jsxs)(q.o,{children:[(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"ID"}),(0,l.jsx)(G.b,{children:r.identifier})]}),(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"Initial release date"}),(0,l.jsx)(G.b,{children:(0,Q.p6)(r.published)})]}),(0,l.jsxs)(V.g,{children:[(0,l.jsx)(R.M,{children:"Current release date"}),(0,l.jsx)(G.b,{children:(0,Q.p6)(r.modified)})]})]})})]})})]}),(0,l.jsxs)(z.u,{isOpen:t,variant:"medium",title:"Edit labels",onClose:d,children:[(0,l.jsx)(Y.x,{title:"Edit labels"}),(0,l.jsx)($.f,{children:(0,l.jsx)(U.q,{advisory:r,onClose:d})})]})]})};var X=n(46403),ee=n(70715),ei=n(40982),en=n(89226),er=n(4835),et=n(14350),el=n(11165),es=n(89330),ea=n(31423),ed=n(94154),ec=n(9905),eo=n(7615),eu=n(57524),eh=n(3804),ex=n(31336),ej=n(3586),em=n(24200),eb=n(49988);let ev=e=>{let{isFetching:i,fetchError:n,vulnerabilities:s}=e,a=(0,eb.sz)({tableName:"vulnerability-table",idProperty:"identifier",items:s,isLoading:i,columnNames:{identifier:"ID",title:"Title",discovery:"Discovery",release:"Release",score:"Score",cwe:"CWE"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:c,numRenderedColumns:o,propHelpers:{toolbarProps:u,paginationToolbarItemProps:h,paginationProps:x,tableProps:j,getThProps:m,getTrProps:b,getTdProps:v},expansionDerivedState:{isCellExpanded:y}}=a;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(ee.o,(0,t._)((0,r._)({},u),{"aria-label":"vulnerability toolbar",children:(0,l.jsx)(ei.c,{children:(0,l.jsx)(en.E,(0,t._)((0,r._)({},h),{children:(0,l.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:x})}))})})),(0,l.jsxs)(er.i,(0,t._)((0,r._)({},j),{"aria-label":"vulnerability table",children:[(0,l.jsx)(et.h,{children:(0,l.jsx)(el.Tr,{children:(0,l.jsxs)(ex.qK,(0,t._)((0,r._)({},a),{children:[(0,l.jsx)(es.Th,(0,r._)({},m({columnKey:"identifier"}))),(0,l.jsx)(es.Th,(0,r._)({},m({columnKey:"title"}))),(0,l.jsx)(es.Th,(0,r._)({},m({columnKey:"discovery"}))),(0,l.jsx)(es.Th,(0,r._)({},m({columnKey:"release"}))),(0,l.jsx)(es.Th,(0,r._)({},m({columnKey:"score"}))),(0,l.jsx)(es.Th,(0,r._)({},m({columnKey:"cwe"})))]}))})}),(0,l.jsx)(ex.hp,{isLoading:i,isError:!!n,isNoData:0===s.length,numRenderedColumns:o,children:null==c?void 0:c.map((e,i)=>{var n;return(0,l.jsx)(ea.p,{isExpanded:y(e),children:(0,l.jsx)(el.Tr,(0,t._)((0,r._)({},b({item:e})),{children:(0,l.jsxs)(ex.Cx,(0,t._)((0,r._)({},a),{item:e,rowIndex:i,children:[(0,l.jsx)(ed.Td,(0,t._)((0,r._)({width:15,modifier:"breakWord"},v({columnKey:"identifier"})),{children:(0,l.jsx)(d.rU,{to:(0,X.Gn)(S.nB.vulnerabilityDetails,{vulnerabilityId:e.identifier}),children:e.identifier})})),(0,l.jsx)(ej.j,{children:(i,n)=>(0,l.jsx)(ed.Td,(0,t._)((0,r._)({width:40,modifier:"truncate",onFocus:()=>n(!0),onBlur:()=>n(!1),tabIndex:0},v({columnKey:"title"})),{children:(0,l.jsx)(ec.cE,{focused:i,wrapModifier:"truncate",children:(0,l.jsx)(em.G,{vulnerability:e})})}))}),(0,l.jsx)(ed.Td,(0,t._)((0,r._)({width:15},v({columnKey:"discovery"})),{children:(0,Q.p6)(e.discovered)})),(0,l.jsx)(ed.Td,(0,t._)((0,r._)({width:10,modifier:"truncate"},v({columnKey:"release"})),{children:(0,Q.p6)(e.released)})),(0,l.jsx)(ed.Td,(0,t._)((0,r._)({width:10,modifier:"truncate"},v({columnKey:"score"})),{children:e.severity&&(0,l.jsx)(eu.o,{value:(0,eo.g)(e.severity),score:null!=(n=e.score)?n:null,showLabel:!0,showScore:!0})})),(0,l.jsx)(ed.Td,(0,t._)((0,r._)({width:10,modifier:"truncate"},v({columnKey:"cwe"})),{children:e.cwes.join(", ")}))]}))}))},e.identifier)})})]})),(0,l.jsx)(eh.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:x})]})},ey=()=>{var e,i;let n=(0,a.s0)(),{pushNotification:K}=s.useContext(D.c),L=(0,S.ZX)(S.Uo.ADVISORY_ID),{advisory:M,isFetching:k,fetchError:O}=(0,I.gw)(L),[A,q]=s.useState(!1),V=()=>{q(!A)},{downloadAdvisory:R}=(0,Z.i)(),[G,z]=s.useState(!1),{mutate:Y,isPending:$}=(0,I.y2)(e=>{z(!1),K({title:(0,B.TR)(e),variant:"success"}),n("/advisories")},e=>{K({title:(0,B.BS)(e),variant:"danger"})}),[W,H]=s.useState(0),Q=s.createRef(),U=s.createRef();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.NP,{type:"breadcrumb",children:(0,l.jsxs)(o.a,{children:[(0,l.jsx)(u.g,{children:(0,l.jsx)(d.rU,{to:S.nB.advisories,children:"Advisories"})}),(0,l.jsx)(u.g,{isActive:!0,children:"Advisory details"})]})}),(0,l.jsx)(c.NP,{children:(0,l.jsxs)(h.P,{children:[(0,l.jsx)(x.J,{isFilled:!0,children:(0,l.jsxs)(j.k,{children:[(0,l.jsx)(m.B,{spacer:{default:"spacerSm"},children:(0,l.jsxs)(b.V,{children:[(0,l.jsx)(b.V,{component:"h1",children:null!=(i=null!=(e=null==M?void 0:M.document_id)?e:L)?i:""}),(0,l.jsx)(b.V,{component:"p",children:"Advisory detail information"})]})}),(0,l.jsx)(m.B,{children:(null==M?void 0:M.labels.type)&&(0,l.jsx)(v._,{color:"blue",children:null==M?void 0:M.labels.type})})]})}),(0,l.jsx)(x.J,{children:M&&(0,l.jsx)(y.L,{isOpen:A,onSelect:()=>q(!1),onOpenChange:e=>q(e),popperProps:{position:"right"},toggle:e=>(0,l.jsx)(f.O_,{ref:e,onClick:V,isExpanded:A,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,l.jsxs)(p.s,{children:[(0,l.jsx)(g.h,{onClick:()=>{L&&R(L,(null==M?void 0:M.identifier)?"".concat(null==M?void 0:M.identifier,".json"):"".concat(L,".json"))},children:"Download Advisory"},"advisory"),(0,l.jsx)(_.i,{component:"li"},"separator"),(0,l.jsx)(g.h,{onClick:()=>z(!0),children:"Delete"},"delete")]})})})]})}),(0,l.jsx)(c.NP,{children:(0,l.jsxs)(T.m,{mountOnEnter:!0,activeKey:W,onSelect:(e,i)=>{H(i)},"aria-label":"Tabs that contain the Advisory information",role:"region",children:[(0,l.jsx)(N.O,{eventKey:0,title:(0,l.jsx)(w.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:Q}),(0,l.jsx)(N.O,{eventKey:1,title:(0,l.jsx)(w.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:U})]})}),(0,l.jsxs)(c.NP,{children:[(0,l.jsx)(C.I,{eventKey:0,id:"refTabInfoSection",ref:Q,"aria-label":"Information of the Advisory",children:(0,l.jsx)(P.u,{isFetching:k,fetchError:O,children:M&&(0,l.jsx)(J,{advisory:M})})}),(0,l.jsx)(C.I,{eventKey:1,id:"refVulnerabilitiesSection",ref:U,"aria-label":"Vulnerabilities within the Advisory",hidden:!0,children:(0,l.jsx)(ev,{isFetching:k,fetchError:O,vulnerabilities:(null==M?void 0:M.vulnerabilities)||[]})})]}),(0,l.jsx)(F.Q,(0,t._)((0,r._)({},(0,B.gn)(M)),{inProgress:$,titleIconVariant:"warning",isOpen:G,confirmBtnVariant:E.Wu.danger,confirmBtnLabel:"Delete",cancelBtnLabel:"Cancel",onCancel:()=>z(!1),onClose:()=>z(!1),onConfirm:()=>{M&&Y(M.uuid)}}))]})}},15167:function(e,i,n){n.d(i,{q:()=>d});var r=n(24246),t=n(27378),l=n(24502),s=n(15726),a=n(17598);let d=e=>{let{advisory:i,onClose:n}=e,{pushNotification:d}=t.useContext(s.c),[c,o]=t.useState(""),[u,h]=t.useState(""),{labels:x}=(0,a.VY)(u);t.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{mutate:j,isPending:m}=(0,a.sj)(()=>{d({title:"Labels updated for Advisory ".concat(i.document_id),variant:"success"}),n()},e=>{d({title:"Error while updating labels for Advisory ".concat(i.document_id),variant:"danger"})});return(0,r.jsx)(l.M,{title:"Labels of Advisory: ".concat(i.document_id),value:i.labels,isDisabled:m,onSave:e=>{j({id:i.uuid,labels:e})},onClose:n,onInputChange:o,options:x})}},17598:function(e,i,n){n.d(i,{N7:()=>v,VY:()=>b,gw:()=>y,sj:()=>g,tG:()=>p,y2:()=>f});var r=n(79192),t=n(53195),l=n(70186),s=n(1183),a=n(24038),d=n(68e3),c=n(75503),o=n(50576),u=n(40371),h=n(87017),x=n(49988),j=n(95169);let m="advisories",b=e=>{let{data:i,isLoading:n,error:r,refetch:t}=(0,s.a)({queryKey:[m,"labels",e],queryFn:()=>(0,u.sf)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:(null==i?void 0:i.data)||[],isFetching:n,fetchError:r,refetch:t}},v=function(){var e,i,n;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,x.rm)(a),{q:j}=h,b=(0,l._)(h,["q"]),v=(0,x.Rb)(d),{data:y,isLoading:f,error:p,refetch:g}=(0,s.a)({queryKey:[m,a,v],queryFn:()=>(0,u.A1)({client:o.L,query:(0,t._)((0,r._)({},b),{q:[j,v].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==y||null==(e=y.data)?void 0:e.items)||[],total:null!=(n=null==y||null==(i=y.data)?void 0:i.total)?n:0,params:a},isFetching:f,fetchError:p||null,refetch:g}},y=e=>{let{data:i,isLoading:n,error:r}=(0,s.a)({queryKey:[m,e],queryFn:()=>(0,u.pB)({client:o.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==i?void 0:i.data,isFetching:n,fetchError:r}},f=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:async e=>(await (0,u.Wr)({client:o.L,path:{key:e}})).data,onSuccess:async(i,r)=>{e(i,r),await n.invalidateQueries({queryKey:[m]})},onError:async e=>{i(e),await n.invalidateQueries({queryKey:[m]})}})},p=()=>{let e=(0,d.NL)();return(0,j.V)({parallel:!0,uploadFn:(e,i)=>(0,h.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},g=(e,i)=>{let n=(0,d.NL)();return(0,c.D)({mutationFn:e=>(0,u.m5)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,r)=>{e(),await n.invalidateQueries({queryKey:[m]})},onError:i})}},65872:function(e,i,n){n.d(i,{Z:()=>d});let r=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],t=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],l=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],s=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,n)=>{let r=e;return"string"==typeof i||Array.isArray(i)?r=e.toLocaleString(i,n):(!0===i||void 0!==n)&&(r=e.toLocaleString(void 0,n)),r};function d(e,i){let n;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?s:l:i.binary?t:r,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(n={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(n={maximumFractionDigits:i.maximumFractionDigits,...n}),e<1)return u+a(e,i.locale,n)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,n||(e=e.toPrecision(3)),u+a(Number(e),i.locale,n)+c+d[h]}}}]);