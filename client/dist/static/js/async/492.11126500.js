"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["492"],{69876:function(e,t,l){l.d(t,{D:()=>i});var r=l(24246),a=l(70400);let i=e=>{let{value:t}=e;return(0,r.jsx)(r.Fragment,{children:Object.entries(t).map(e=>{let[t,l]=e;return(0,r.jsx)(a._,{isCompact:!0,children:"".concat(t,"=").concat(l)},"".concat(t,"=").concat(l))})})}},31373:function(e,t,l){l.d(t,{H:()=>d});var r=l(79192),a=l(53195),i=l(27378),n=l(7615),s=l(59015);let u=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,o={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:(0,r._)({},o),fixed:(0,r._)({},o),not_affected:(0,r._)({},o),known_not_affected:(0,r._)({},o)}},d=e=>{let{pkg:t,isFetching:l,fetchError:o}=(0,s.ZA)(e);return{data:i.useMemo(()=>(e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>{let l=(0,n.g)(t.average_severity);return{vulnerability:(0,a._)((0,r._)({},t.vulnerability),{average_severity:l,average_score:t.average_score}),vulnerabilityStatus:t.status,advisory:e}})}).reduce((e,t)=>{let l,i=e.find(e=>u(e,t));if(i)l=[...e.filter(e=>!u(e,i)),(0,a._)((0,r._)({},i),{relatedSboms:[...i.relatedSboms,{advisory:t.advisory}]})];else{let r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};l=[...e.slice(),r]}return l},[]),l=t.reduce((e,t)=>{let l=t.vulnerabilityStatus,i=t.vulnerability.average_severity,n=e.vulnerabilityStatus[l];return Object.assign(e,{vulnerabilityStatus:(0,a._)((0,r._)({},e.vulnerabilityStatus),{[l]:{total:n.total+1,severities:(0,a._)((0,r._)({},n.severities),{[i]:n.severities[i]+1})}})})},(0,r._)({},c));return{vulnerabilities:t,summary:l}})((null==t?void 0:t.advisories)||[]),[t]),isFetching:l,fetchError:o}}},96308:function(e,t,l){l.d(t,{n:()=>o});var r=l(24246),a=l(11797),i=l(37818),n=l(42573),s=l(49304),u=l(31373);let o=e=>{let{packageId:t}=e,{data:l,isFetching:o,fetchError:c}=(0,u.H)(t);return(0,r.jsx)(i.u,{isFetching:o,fetchError:c,isFetchingState:(0,r.jsx)(a.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(n.C,{error:e}),children:(0,r.jsx)(s.u,{severities:l.summary.vulnerabilityStatus.affected.severities})})}},33384:function(e,t,l){l.d(t,{a:()=>v,u:()=>p});var r=l(79192),a=l(53195),i=l(24246),n=l(27378),s=l(74502),u=l(14629),o=l(49988),c=l(59015),d=l(63706);let v=n.createContext({}),p=e=>{let{children:t}=e,l=(0,o.vZ)({tableName:"packages",persistenceKeyPrefix:s.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:s.L4,title:"Filter text",placeholderText:"Search",type:u.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:u.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:u.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:p,total:h},isFetching:m,fetchError:y}=(0,c.fF)((0,o.QO)((0,a._)((0,r._)({},l),{hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}}))),_=n.useMemo(()=>p.map(e=>(0,a._)((0,r._)({},e),{decomposedPurl:(0,d.qX)(e.purl)})),[p]),b=(0,o.KC)((0,a._)((0,r._)({},l),{idProperty:"uuid",currentPageItems:_,totalItemCount:h,isLoading:m}));return(0,i.jsx)(v.Provider,{value:{totalItemCount:h,isFetching:m,fetchError:y,tableControls:b},children:t})}},75778:function(e,t,l){l.d(t,{L:()=>g});var r=l(79192),a=l(53195),i=l(24246),n=l(27378),s=l(65783),u=l(46403),o=l(4835),c=l(14350),d=l(11165),v=l(89330),p=l(31423),h=l(94154),m=l(69876),y=l(3804),_=l(31336),b=l(9839),x=l(96308),f=l(33384);let g=()=>{let{isFetching:e,fetchError:t,totalItemCount:l,tableControls:g}=n.useContext(f.a),{numRenderedColumns:j,currentPageItems:K,propHelpers:{paginationProps:P,tableProps:T,getThProps:S,getTrProps:k,getTdProps:F}}=g;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(o.i,(0,a._)((0,r._)({},T),{"aria-label":"Package table",children:[(0,i.jsx)(c.h,{children:(0,i.jsx)(d.Tr,{children:(0,i.jsxs)(_.qK,(0,a._)((0,r._)({},g),{children:[(0,i.jsx)(v.Th,(0,r._)({},S({columnKey:"name"}))),(0,i.jsx)(v.Th,(0,r._)({},S({columnKey:"namespace"}))),(0,i.jsx)(v.Th,(0,r._)({},S({columnKey:"version"}))),(0,i.jsx)(v.Th,(0,r._)({},S({columnKey:"type"}))),(0,i.jsx)(v.Th,(0,r._)({},S({columnKey:"path"}))),(0,i.jsx)(v.Th,(0,r._)({},S({columnKey:"qualifiers"}))),(0,i.jsx)(v.Th,(0,r._)({},S({columnKey:"vulnerabilities"})))]}))})}),(0,i.jsx)(_.hp,{isLoading:e,isError:!!t,isNoData:0===l,numRenderedColumns:j,children:K.map((e,t)=>{var l,n,o,c,v,y,f;return(0,i.jsx)(p.p,{children:(0,i.jsx)(d.Tr,(0,a._)((0,r._)({},k({item:e})),{children:(0,i.jsxs)(_.Cx,(0,a._)((0,r._)({},g),{item:e,rowIndex:t,children:[(0,i.jsx)(h.Td,(0,a._)((0,r._)({width:15,modifier:"breakWord"},F({columnKey:"name"})),{children:(0,i.jsx)(s.OL,{to:(0,u.Gn)(b.nB.packageDetails,{packageId:e.uuid}),children:e.decomposedPurl?null==(l=e.decomposedPurl)?void 0:l.name:e.purl})})),(0,i.jsx)(h.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},F({columnKey:"namespace"})),{children:null==(n=e.decomposedPurl)?void 0:n.namespace})),(0,i.jsx)(h.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},F({columnKey:"version"})),{children:null==(o=e.decomposedPurl)?void 0:o.version})),(0,i.jsx)(h.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},F({columnKey:"type"})),{children:null==(c=e.decomposedPurl)?void 0:c.type})),(0,i.jsx)(h.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},F({columnKey:"path"})),{children:null==(v=e.decomposedPurl)?void 0:v.path})),(0,i.jsx)(h.Td,(0,a._)((0,r._)({width:20},F({columnKey:"qualifiers"})),{children:(null==(y=e.decomposedPurl)?void 0:y.qualifiers)&&(0,i.jsx)(m.D,{value:null==(f=e.decomposedPurl)?void 0:f.qualifiers})})),(0,i.jsx)(h.Td,(0,a._)((0,r._)({width:20},F({columnKey:"vulnerabilities"})),{children:(0,i.jsx)(x.n,{packageId:e.uuid})}))]}))}))},e.uuid)})})]})),(0,i.jsx)(y.p,{idPrefix:"package-table",isTop:!1,paginationProps:P})]})}},39305:function(e,t,l){l.d(t,{v:()=>p});var r=l(79192),a=l(53195),i=l(24246),n=l(27378),s=l(70715),u=l(40982),o=l(89226),c=l(14629),d=l(3804),v=l(33384);let p=e=>{let{showFilters:t}=e,{tableControls:l}=n.useContext(v.a),{propHelpers:{toolbarProps:p,filterToolbarProps:h,paginationToolbarItemProps:m,paginationProps:y}}=l;return(0,i.jsx)(s.o,(0,a._)((0,r._)({},p),{"aria-label":"package-toolbar",children:(0,i.jsxs)(u.c,{children:[t&&(0,i.jsx)(c.Ki,(0,r._)({},h)),(0,i.jsx)(o.E,(0,a._)((0,r._)({},m),{children:(0,i.jsx)(d.p,{idPrefix:"package-table",isTop:!0,paginationProps:y})}))]})}))}},59015:function(e,t,l){l.d(t,{D4:()=>d,ZA:()=>c,fF:()=>o});var r=l(79192),a=l(1183),i=l(50576),n=l(40371),s=l(49988);let u="packages",o=function(){var e,t,l;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:v,error:p,refetch:h}=(0,a.a)({queryKey:[u,o],queryFn:()=>(0,n.tj)({client:i.L,query:(0,r._)({},(0,s.rm)(o))}),enabled:!c});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(l=null==d||null==(t=d.data)?void 0:t.total)?l:0,params:o},isFetching:v,fetchError:p,refetch:h}},c=e=>{let{data:t,isLoading:l,error:r}=(0,a.a)({queryKey:[u,e],queryFn:()=>(0,n.BK)({client:i.L,path:{key:e}})});return{pkg:null==t?void 0:t.data,isFetching:l,fetchError:r}},d=function(e){var t,l,o;let c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d,isLoading:v,error:p,refetch:h}=(0,a.a)({queryKey:[u,"by-sbom",e,c],queryFn:()=>(0,n.Pg)({client:i.L,path:{id:e},query:(0,r._)({},(0,s.rm)(c))})});return{result:{data:(null==d||null==(t=d.data)?void 0:t.items)||[],total:null!=(o=null==d||null==(l=d.data)?void 0:l.total)?o:0,params:c},isFetching:v,fetchError:p,refetch:h}}}}]);