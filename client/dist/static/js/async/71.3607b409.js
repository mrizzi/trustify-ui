"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["71"],{89705:function(e,n,t){t.d(n,{T:()=>d});var r=t(62540),a=t(24773),i=t(38927),l=t(80057),s=t(13021),o=t(97346);let d=e=>{let{isOpen:n,title:t,titleIconVariant:d,message:c,confirmBtnLabel:u,cancelBtnLabel:m,inProgress:h,confirmBtnVariant:x,onClose:p,onConfirm:j,onCancel:b}=e,v=(0,r.jsx)(a.$n,{"aria-label":"confirm",variant:x,isDisabled:h,onClick:j,children:u},"confirm"),g=b?(0,r.jsx)(a.$n,{"aria-label":"cancel",variant:a.Ak.link,isDisabled:h,onClick:b,children:m},"cancel"):void 0;return(0,r.jsxs)(i.a,{variant:"small",isOpen:n,onClose:p,"aria-label":"Confirm dialog",children:[(0,r.jsx)(l.r,{title:t,titleIconVariant:d}),(0,r.jsx)(s.c,{children:c}),(0,r.jsx)(o.j,{children:b?(0,r.jsxs)(r.Fragment,{children:[v,g]}):v})]})}},93826:function(e,n,t){t.d(n,{n:()=>s});var r=t(32909),a=t(42642),i=t(62540),l=t(56682);let s=e=>{let{paginationProps:n,isTop:t,isCompact:s=!1,idPrefix:o=""}=e;return(0,i.jsx)(l.d,(0,a._)((0,r._)({id:"".concat(o?"".concat(o,"-"):"","pagination-").concat(t?"top":"bottom"),variant:t?l.A.top:l.A.bottom,isCompact:s},n),{widgetId:"pagination-id"}))}},40554:function(e,n,t){t.d(n,{q:()=>s});var r=t(62540),a=t(48655),i=t(92411),l=t(60087);let s=()=>(0,r.jsx)(a.pp,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:l.Ay,variant:a.s$.sm,children:(0,r.jsx)(i.h,{children:"There was an error retrieving data. Check your connection and try again."})})},30448:function(e,n,t){t.d(n,{Ze:()=>b,nJ:()=>p,Oi:()=>g});var r=t(62540),a=t(59394),i=t(81595),l=t(28516),s=t(21758),o=t(78517),d=t(40554),c=t(48655),u=t(92411),m=t(28469);let h=e=>{let{title:n,description:t}=e;return(0,r.jsx)(c.pp,{titleText:n,headingLevel:"h4",icon:m.Ay,variant:c.s$.sm,children:t&&(0,r.jsx)(u.h,{children:t})})},x=()=>(0,r.jsx)(h,{title:"No data available",description:"No data available to be shown here."}),p=e=>{let{numRenderedColumns:n,isLoading:t=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:m=null,noDataEmptyState:h=null,children:p}=e;return(0,r.jsx)(r.Fragment,{children:t?(0,r.jsx)(l.N,{"aria-label":"Table loading",children:(0,r.jsx)(s.Tr,{children:(0,r.jsx)(o.Td,{colSpan:n,children:(0,r.jsx)(a.a,{children:(0,r.jsx)(i.y,{size:"xl"})})})})}):c?(0,r.jsx)(l.N,{"aria-label":"Table error",children:(0,r.jsx)(s.Tr,{children:(0,r.jsx)(o.Td,{colSpan:n,children:(0,r.jsx)(a.a,{children:m||(0,r.jsx)(d.q,{})})})})}):u?(0,r.jsx)(l.N,{"aria-label":"Table empty",children:(0,r.jsx)(s.Tr,{children:(0,r.jsx)(o.Td,{colSpan:n,children:(0,r.jsx)(a.a,{children:h||(0,r.jsx)(x,{})})})})}):p})};var j=t(40384);let b=e=>{let{numColumnsBeforeData:n,numColumnsAfterData:t,children:a}=e;return(0,r.jsxs)(r.Fragment,{children:[Array(n).fill(null).map((e,n)=>(0,r.jsx)(j.Th,{screenReaderText:"before-data-".concat(n)},n)),a,Array(t).fill(null).map((e,n)=>(0,r.jsx)(j.Th,{screenReaderText:"after-data-".concat(n)},n))]})};var v=t(32909);let g=e=>{let{isExpansionEnabled:n=!1,expandableVariant:t,getSelectCheckboxTdProps:a,propHelpers:{getSingleExpandButtonTdProps:i},item:l,rowIndex:s,children:d}=e;return(0,r.jsxs)(r.Fragment,{children:[n&&"single"===t?(0,r.jsx)(o.Td,(0,v._)({},i({item:l,rowIndex:s}))):null,a?(0,r.jsx)(o.Td,(0,v._)({},a({item:l,rowIndex:s}))):null,d]})}},38198:function(e,n,t){t.r(n),t.d(n,{default:()=>ec});var r=t(32909),a=t(42642),i=t(62540),l=t(63696),s=t(95285),o=t.n(s),d=t(24773),c=t(68430),u=t(42957),m=t(61360),h=t(35048),x=t(32490),p=t(69548),j=t(38927),b=t(80057),v=t(13021),g=t(97346),y=t(95515),f=t(52526),_=t(26917),T=t(16646),D=t(21758),S=t(40384),I=t(28516),C=t(78517),k=t(62101),w=t(38139),A=t(87514),K=t(89705),N=t(4392),O=t(77184),E=t(62603),P=t(90130),F=t(98259),R=t(96002),L=t(86141);let B="importers",V=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{isLoading:n,error:t,refetch:r,data:a}=(0,O.I)({queryKey:[B],queryFn:()=>(0,L.wb)({client:R.S}),refetchInterval:!e&&F.yf});return{importers:(null==a?void 0:a.data)||[],isFetching:n,fetchError:t,refetch:r}},M=function(e){var n,t,r;let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:i,isLoading:l,refetch:s,error:o}=(0,O.I)({queryKey:[B,e,"reports"],queryFn:()=>(0,L.e9)({client:R.S,path:{name:e}}),refetchInterval:!a&&F.yf});return{result:{data:(null==i||null==(n=i.data)?void 0:n.items)||[],total:null!=(r=null==i||null==(t=i.data)?void 0:t.total)?r:0},isFetching:l,fetchError:o,refetch:s}};var U=t(23909),q=t(81592),$=t(29508),z=t(28338),Z=t(70045),H=t(2057),J=t(93302),W=t(60087),X=t(55092),Y=t(47538),G=t(84632),Q=t(57481);let ee=e=>{let{preset:n,status:t,icon:r,className:a="",label:l}=e,s={Canceled:{icon:(0,i.jsx)(G.Ay,{}),status:"info",label:"Canceled"},Completed:{icon:(0,i.jsx)(J.Ay,{}),status:"success",label:"Completed"},Error:{icon:(0,i.jsx)(W.Ay,{}),status:"danger",label:"Error"},Failed:{icon:(0,i.jsx)(W.Ay,{}),status:"danger",label:"Failed"},InProgress:{icon:(0,i.jsx)(X.Ay,{}),status:"info",label:"In-progress"},NotStarted:{icon:(0,i.jsx)(G.Ay,{}),label:"Not started"},Ok:{icon:(0,i.jsx)(J.Ay,{}),status:"success"},Scheduled:{icon:(0,i.jsx)(Y.Ay,{}),status:"info",label:"Scheduled"},Unknown:{icon:(0,i.jsx)(Q.Ay,{})}},o=n&&s[n];return(0,i.jsxs)(z.s,{flexWrap:{default:"nowrap"},spaceItems:{default:"spaceItemsSm"},children:[(0,i.jsx)(Z.Z,{children:(0,i.jsx)(e=>{let{children:n}=e;return(null==o?void 0:o.tooltipMessage)?(0,i.jsx)($.m,{content:null==o?void 0:o.tooltipMessage,children:n}):n},{children:(0,i.jsx)(H.I,{status:t||(null==o?void 0:o.status),className:a,children:r||(null==o?void 0:o.icon)||(0,i.jsx)(Q.Ay,{})})})}),(0,i.jsx)(Z.Z,{children:l||(null==o?void 0:o.label)})]})};var en=t(93826),et=t(30448),er=t(73470),ea=t(90929),ei=t(6451);let el=e=>{let{value:n}=e;return(0,i.jsx)(ea.k,{"aria-label":"Progress of Importer ",value:n.current,min:0,max:n.total,measureLocation:ei.Ri.inside,size:ea.j.sm})},es=new Map([["waiting","Scheduled"],["running","InProgress"]]),eo=e=>{let{state:n}=e;return(0,i.jsx)(ee,{preset:(e=>{if(es.has(e)){let n=es.get(e);if(n)return n}return"NotStarted"})(n)})},ed=e=>{var n;let t=Object.keys(null!=(n=e.configuration)?n:{})[0],r=e.configuration[t];return(null==r?void 0:r.disabled)!==!1?"disabled":"running"===e.state?"running":"scheduled"},ec=()=>{var e,n;let t,s,{pushNotification:o}=l.useContext(N.K),[j,b]=l.useState(null),[v,g]=l.useState(null),y=(e,n)=>{g(e),b(n)},{importers:A,isFetching:O,fetchError:F}=V(),{mutate:M}=(e=()=>{},n=e=>{o({title:"Error while enabling/disabling the Importer",variant:"danger"})},s=(0,E.jE)(),(0,P.n)({mutationFn:e=>(0,L.U0)({client:R.S,path:{name:e.importerName},body:e.configuration}),onSuccess:async(n,t)=>{e(),await s.invalidateQueries({queryKey:[B]})},onError:n})),$=(e,n)=>{var t;let i=Object.keys(null!=(t=e.configuration)?t:{})[0],l=e.configuration[i],s=(0,a._)((0,r._)({},l),{disabled:!n});M({importerName:e.name,configuration:{[i]:s}})},z=()=>{o({title:"Importer scheduled to run as soon as possible",variant:"success"})},Z=e=>{o({title:(0,U.sO)(e),variant:"danger"})},H=(0,er.vY)({tableName:"importers-table",idProperty:"name",items:A,columnNames:{name:"Name",type:"Type",description:"Description",source:"Source",period:"Period",state:"State"},hasActionsColumn:!0,isSortEnabled:!0,sortableColumns:["name"],getSortValues:e=>({name:e.name}),isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"single",isFilterEnabled:!0,filterCategories:[{categoryKey:"name",title:"Name",type:"search",placeholderText:"Search by name...",getItemValue:e=>e.name||""},{categoryKey:"status",title:"Status",type:"multiselect",logicOperator:"OR",selectOptions:[{value:"scheduled",label:"Scheduled"},{value:"running",label:"Running"},{value:"disabled",label:"Disabled"}],placeholderText:"Status",matcher:(e,n)=>e===ed(n)}]}),{currentPageItems:J,numRenderedColumns:W,propHelpers:{toolbarProps:X,filterToolbarProps:Y,paginationToolbarItemProps:G,paginationProps:Q,tableProps:ee,getThProps:ea,getTrProps:ei,getTdProps:es},expansionDerivedState:{isCellExpanded:ec}}=H;switch(v){case"enable":t={title:"Enable Importer",titleIconVariant:"info",message:"Are you sure you want to enable the Importer ".concat(null==j?void 0:j.name,"?"),confirmBtnVariant:d.Ak.primary,confirmBtnLabel:"Enable",cancelBtnLabel:"Cancel"};break;case"disable":t={title:"Disable Importer",titleIconVariant:"info",message:"Are you sure you want to disable the Importer ".concat(null==j?void 0:j.name,"?"),confirmBtnVariant:d.Ak.primary,confirmBtnLabel:"Disable",cancelBtnLabel:"Cancel"};break;case"run":t={title:"Run Importer",titleIconVariant:"info",message:"Are you sure you want to run the Importer ".concat(null==j?void 0:j.name,"?"),confirmBtnVariant:d.Ak.primary,confirmBtnLabel:"Run",cancelBtnLabel:"Cancel"};break;default:t=null}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c.d8,{hasBodyWrapper:!1,children:(0,i.jsx)(u.U,{children:(0,i.jsx)(u.U,{component:"h1",children:"Importers"})})}),(0,i.jsx)(c.d8,{hasBodyWrapper:!1,children:(0,i.jsxs)("div",{children:[(0,i.jsx)(m.M,(0,a._)((0,r._)({},X),{children:(0,i.jsxs)(h.P,{children:[(0,i.jsx)(q.Us,(0,r._)({showFiltersSideBySide:!0},Y)),(0,i.jsx)(x.T,(0,a._)((0,r._)({},G),{children:(0,i.jsx)(en.n,{idPrefix:"importer-table",isTop:!0,paginationProps:Q})}))]})})),(0,i.jsxs)(_.X,(0,a._)((0,r._)({},ee),{"aria-label":"Importer table",children:[(0,i.jsx)(T.d,{children:(0,i.jsx)(D.Tr,{children:(0,i.jsxs)(et.Ze,(0,a._)((0,r._)({},H),{children:[(0,i.jsx)(S.Th,(0,r._)({},ea({columnKey:"name"}))),(0,i.jsx)(S.Th,(0,r._)({},ea({columnKey:"type"}))),(0,i.jsx)(S.Th,(0,r._)({},ea({columnKey:"description"}))),(0,i.jsx)(S.Th,(0,r._)({},ea({columnKey:"source"}))),(0,i.jsx)(S.Th,(0,r._)({},ea({columnKey:"period"}))),(0,i.jsx)(S.Th,(0,r._)({},ea({columnKey:"state"})))]}))})}),(0,i.jsx)(et.nJ,{isLoading:O,isError:!!F,isNoData:0===A.length,numRenderedColumns:W,children:null==J?void 0:J.map((e,n)=>{var t;let l=Object.keys(null!=(t=e.configuration)?t:{})[0],s=e.configuration[l],o=ed(e);return(0,i.jsxs)(I.N,{children:[(0,i.jsx)(D.Tr,(0,a._)((0,r._)({},ei({item:e})),{children:(0,i.jsxs)(et.Oi,(0,a._)((0,r._)({},H),{item:e,rowIndex:n,children:[(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},es({columnKey:"name"})),{children:e.name})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},es({columnKey:"type"})),{children:l})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:20,modifier:"truncate"},es({columnKey:"description"})),{children:null==s?void 0:s.description})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:20,modifier:"truncate"},es({columnKey:"source"})),{children:null==s?void 0:s.source})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},es({columnKey:"period"})),{children:null==s?void 0:s.period})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},es({columnKey:"state"})),{children:"disabled"===o?(0,i.jsx)(p.J,{color:"orange",children:"Disabled"}):"running"===o&&e.progress?(0,i.jsx)(el,{value:e.progress}):(0,i.jsx)(eo,{state:e.state})})),(0,i.jsx)(C.Td,{isActionCell:!0,children:(0,i.jsx)(k.G,{items:[..."disabled"===o?[{title:"Enable",onClick:()=>{y("enable",e)}}]:[{title:"Run",onClick:()=>{y("run",e)},isDisabled:"running"===o},{title:"Disable",onClick:()=>{y("disable",e)}}]]})})]}))})),ec(e)?(0,i.jsx)(D.Tr,{isExpanded:!0,children:(0,i.jsx)(C.Td,{colSpan:7,children:(0,i.jsx)("div",{className:f.A.mMd,children:(0,i.jsx)(w.g,{children:(0,i.jsx)(eu,{importer:e})})})})}):null]},e.name)})})]})),(0,i.jsx)(en.n,{idPrefix:"importer-table",isTop:!1,paginationProps:Q})]})}),v&&t&&(0,i.jsx)(K.T,(0,a._)((0,r._)({},t),{isOpen:!0,onCancel:()=>g(null),onClose:()=>g(null),onConfirm:()=>{if(j)switch(v){case"enable":$(j,!0);break;case"disable":$(j,!1);break;case"run":var e;e=j.name,(0,L.Nz)({client:R.S,path:{name:e},body:!0}).then(z).catch(Z)}b(null),g(null)}}))]})},eu=e=>{let{importer:n}=e,[t,s]=l.useState([]),[c,u]=l.useState(!1),p=()=>u(!c),{result:{data:f},isFetching:k,fetchError:w}=M(n.name),K=l.useMemo(()=>{var e,t,r;let a={isRunning:!0,id:"root",startDate:void 0,endDate:void 0,duration:(null==(e=n.progress)?void 0:e.estimatedSecondsRemaining)?(null==(t=n.progress)?void 0:t.estimatedSecondsRemaining)*1e3:void 0,numberOfItems:null==(r=n.progress)?void 0:r.current,error:void 0,messages:void 0},i=f.map(e=>{var n,t,r,a,i,l;let s;if((null==(n=e.report)?void 0:n.startDate)&&e.report.endDate){let n=o()(e.report.startDate);s=o()(e.report.endDate).diff(n)}return{isRunning:!1,id:e.id,startDate:null==(t=e.report)?void 0:t.startDate,endDate:null==(r=e.report)?void 0:r.endDate,duration:s,numberOfItems:null==(a=e.report)?void 0:a.numberOfItems,error:null!=(l=e.error)?l:void 0,messages:null==(i=e.report)?void 0:i.messages}});return[..."running"===n.state?[a]:[],...i]},[n,f]),N=(0,er.vY)({variant:"compact",tableName:"report-table",idProperty:"id",items:K,columnNames:{startDate:"Start date",endDate:"End date",numberOfItems:"Number of items",status:"Status",duration:"Duration"},isPaginationEnabled:!0,initialItemsPerPage:5,isSortEnabled:!0,sortableColumns:["startDate","endDate"],initialSort:{columnKey:"startDate",direction:"desc"},getSortValues:e=>({startDate:!e.startDate||o()(e.startDate).valueOf(),endDate:!e.endDate||o()(e.endDate).valueOf()}),isFilterEnabled:!1,isExpansionEnabled:!1}),{currentPageItems:O,numRenderedColumns:E,propHelpers:{toolbarProps:P,tableProps:R,paginationToolbarItemProps:L,paginationProps:B,getThProps:V,getTrProps:q,getTdProps:$}}=N;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.M,(0,a._)((0,r._)({},P),{children:(0,i.jsx)(h.P,{children:(0,i.jsx)(x.T,(0,a._)((0,r._)({},L),{children:(0,i.jsx)(en.n,{idPrefix:"report-table",isTop:!0,paginationProps:B})}))})})),(0,i.jsxs)(_.X,(0,a._)((0,r._)({},R),{"aria-label":"Report table",children:[(0,i.jsx)(A.H,{children:"Importer reports"}),(0,i.jsx)(T.d,{children:(0,i.jsx)(D.Tr,{children:(0,i.jsxs)(et.Ze,(0,a._)((0,r._)({},N),{children:[(0,i.jsx)(S.Th,(0,r._)({},V({columnKey:"startDate"}))),(0,i.jsx)(S.Th,(0,r._)({},V({columnKey:"endDate"}))),(0,i.jsx)(S.Th,(0,r._)({},V({columnKey:"numberOfItems"}))),(0,i.jsx)(S.Th,(0,r._)({},V({columnKey:"status"}))),(0,i.jsx)(S.Th,(0,r._)({},V({columnKey:"duration"})))]}))})}),(0,i.jsx)(et.nJ,{isLoading:k,isError:!!w,isNoData:(null==K?void 0:K.length)===0,numRenderedColumns:E,children:null==O?void 0:O.map((e,n)=>(0,i.jsx)(I.N,{children:(0,i.jsx)(D.Tr,(0,a._)((0,r._)({},q({item:e})),{children:(0,i.jsxs)(et.Oi,(0,a._)((0,r._)({},N),{item:e,rowIndex:n,children:[(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},$({columnKey:"startDate"})),{children:(0,U.r6)(e.startDate)})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},$({columnKey:"endDate"})),{children:(0,U.r6)(e.endDate)})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},$({columnKey:"numberOfItems"})),{children:e.numberOfItems})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:30,modifier:"truncate"},$({columnKey:"status"})),{children:e.isRunning?(0,i.jsx)(eo,{state:"running"}):(0,i.jsx)(n=>{let{children:t}=n;return e.messages?(0,i.jsx)(d.$n,{isInline:!0,variant:"link",onClick:()=>{var n;s(Object.entries(null!=(n=e.messages)?n:{}).map(e=>{let[n,t]=e;return Object.entries(t).map(e=>{let[t,r]=e;return{title:"".concat(n.charAt(0).toUpperCase()+n.slice(1),': "').concat(t,'"'),body:r.map(e=>{let n=null;switch(e.severity){case"none":n=F.bv.green;break;case"low":n=F.bv.cyan;break;case"medium":n=F.bv.yellow;break;case"high":n=F.bv.lightBlue;break;case"critical":n=F.bv.red}return"".concat(null!=n?n:"").concat(e.severity.charAt(0).toUpperCase()+e.severity.slice(1),": ").concat(F.bv.defaultForegroundColorAtStartup," ").concat(e.message)}).join(F.bv.endLine)}}).map(e=>"".concat(F.bv.underline).concat(e.title).concat(F.bv.reset).concat(F.bv.endLine).concat(e.body)).join("".concat(F.bv.endLine).concat(F.bv.endLine))})),p()},children:t}):t},{children:e.error?(0,i.jsx)(ee,{preset:"Failed",label:e.error}):(0,i.jsx)(ee,{preset:"Completed",label:"Finished successfully"})})})),(0,i.jsx)(C.Td,(0,a._)((0,r._)({width:25,modifier:"truncate"},$({columnKey:"duration"})),{children:e.duration?e.isRunning?"Time remaining: ".concat(o().duration(e.duration).humanize()):"Run for: ".concat(o().duration(e.duration).humanize()):""}))]}))}))},e.id))})]})),(0,i.jsx)(en.n,{idPrefix:"report-table",isTop:!1,paginationProps:B}),(0,i.jsxs)(j.a,{variant:"large",isOpen:c,onClose:p,children:[(0,i.jsx)(b.r,{title:"Log"}),(0,i.jsx)(v.c,{children:(0,i.jsx)(y.rW,{hasLineNumbers:!1,height:400,data:t,theme:"dark",toolbar:(0,i.jsx)(m.M,{children:(0,i.jsx)(h.P,{children:(0,i.jsx)(x.T,{children:(0,i.jsx)(y.ht,{placeholder:"Search value",minSearchChars:1})})})})})}),(0,i.jsx)(g.j,{children:(0,i.jsx)(d.$n,{variant:"link",onClick:p,children:"Close"},"cancel")})]})]})}}}]);