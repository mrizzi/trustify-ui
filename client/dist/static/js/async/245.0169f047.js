"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["245"],{32947:function(e,t,r){r.d(t,{A0:()=>g,V4:()=>v,W:()=>x,XE:()=>m,nE:()=>f});var a=r(91566),s=r(839),i=r(73657),n=r(20644),l=r(89502),o=r(7596),d=r(1811),c=r(24917),u=r(4720),h=r(54178),p=r(37106),y=r(34313);let v={unknown:{name:"Unknown",color:d.P,progressProps:{variant:void 0},icon:a.M$},none:{name:"None",color:c.E,progressProps:{variant:void 0},icon:s.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:i._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:n.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:l.E2},critical:{name:"Critical",color:y.J,progressProps:{variant:"danger"},icon:o.ki}},m=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function g(e){return(t,r)=>m(e(t))-m(e(r))}let x=e=>{let{key:t,value:r}=e;return`${r?`${t}=${r}`:`${t}`}`},f=e=>{let[t,r]=e.split("=");return{key:t,value:r??""}}},7615:function(e,t,r){r.d(t,{g:()=>a});let a=e=>e??"unknown"},87017:function(e,t,r){r.d(t,{Co:()=>u,Cu:()=>d,Hb:()=>c});var a=r(70233),s=r(74502);r(41947);let i="/api",n=`${i}/v2/advisory`,l=`${i}/v2/sbom`,o=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},d=(e,t)=>{let r=e.get(s.TB);return a.Z.post(`${n}`,r,{...t,headers:{"Content-Type":o(r)}})},c=(e,t)=>{let r=e.get(s.TB);return a.Z.post(`${l}`,r,{...t,headers:{"Content-Type":o(r)}})},u=e=>a.Z.get(`${l}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,r){r.d(t,{u:()=>l});var a=r(24246),s=r(8305),i=r(13754),n=r(39826);let l=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(s.b,{children:(0,a.jsx)(i.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(n.y,{}):e.children},68057:function(e,t,r){r.d(t,{V:()=>l});var a=r(24246),s=r(27378),i=r(63763),n=r(32947);let l=e=>{let{vulnerabilitiesSummary:t}=e,r=s.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],a=n.V4[e];return{severity:e,count:r,label:a.name,color:a.color.value}}).sort((0,n.A0)(e=>e.severity)).reverse(),[t]);return(0,a.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,a.jsx)(i.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${t.total}`,subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:`${t}: ${r}`}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return`${t.x}: ${t.y}`},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},39826:function(e,t,r){r.d(t,{y:()=>l});var a=r(24246),s=r(10707),i=r(16668),n=r(42160);let l=()=>(0,a.jsx)(s.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:n.ZP,variant:s.IQ.sm,children:(0,a.jsx)(i.B,{children:"There was an error retrieving data. Check your connection and try again."})})},82413:function(e,t,r){r.d(t,{useVulnerabilitiesOfSbom:()=>c,useVulnerabilitiesOfSboms:()=>u});var a=r(27378),s=r(7615),i=r(43959);let n=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,l={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:{...l},fixed:{...l},not_affected:{...l},known_not_affected:{...l}}},d=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce((e,t)=>{let r,a=e.find(e=>n(e,t));if(a)r=[...e.filter(e=>!n(e,a)),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,a=(0,s.g)(t.vulnerability.average_severity),i=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:i.total+1,severities:{...i.severities,[a]:i.severities[a]+1}}}})},{...o});return{vulnerabilities:t,summary:r}},c=e=>{let{advisories:t,isFetching:r,fetchError:s}=(0,i.useFetchSbomsAdvisory)(e);return{data:a.useMemo(()=>d(t||[]),[t]),isFetching:r,fetchError:s}},u=e=>{let{advisories:t,isFetching:r,fetchError:s}=(0,i.useFetchSbomsAdvisoryBatch)(e);return{data:a.useMemo(()=>(t??[]).map(e=>d(e||[])),[t]),isFetching:r,fetchError:s}}},95169:function(e,t,r){r.d(t,{V:()=>c});var a=r(27378),s=r(74502),i=r(70233);let n="cancelled",l=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),o=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||l(),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===n})};case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),{...e,uploads:r}}default:throw Error()}},d=()=>({uploads:new Map}),c=e=>{let{parallel:t,uploadFn:r,onSuccess:l,onError:c}=e,[u,h]=a.useReducer(o,d());return{uploads:u.uploads,handleUpload:e=>{let a=[];for(let t=0;t<e.length;t++){let r=e[t],o=new FormData;o.set(s.TB,r);let d=i.Z.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let t=e.total??1;h({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/t*100)}})},cancelToken:d.token};h({type:"queueUpload",payload:{file:r,cancelFn:d}});let p={formData:o,config:u,thenFn:e=>{h({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),l&&l(e,r)},catchFn:e=>{h({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==n&&c&&c(e,r)}};a.push(p)}if(t)for(let e of a)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else a.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{u.uploads.get(e)?.cancelFn?.cancel(n)},handleRemoveUpload:e=>{h({type:"removeUpload",payload:{file:e}})}}}},21629:function(e,t,r){r.r(t),r.d(t,{default:()=>eh});var a=r(24246),s=r(45043),i=r(27317),n=r(93095),l=r(14935),o=r(65783),d=r(74485),c=r(76228),u=r(57518),h=r(24216),p=r(13864),y=r(78531),v=r(44870),m=r(93591),g=r(31757),x=r(87069),f=r(51527),b=r(87727),j=r(3498),F=r(68802),S=r(10707),w=r(16668),k=r(30329),E=r(50689),M=r(67761),P=r(81391),q=r(32947),O=r(37818),B=r(82413),L=r(17598),C=r(43959),$=r(63706);let U=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],T=()=>{let e=(0,l.s0)(),{result:{data:t,total:r},isFetching:s,fetchError:T}=(0,C.useFetchSBOMs)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:V,isFetching:K,fetchError:A}=(0,B.useVulnerabilitiesOfSboms)(t.map(e=>e.id)),Q=V.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),D=(e,t)=>`${" ".repeat(t+1)}${e.name}`,{result:{data:_,total:I},isFetching:N,fetchError:W}=(0,L.useFetchAdvisories)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,a.jsxs)(g.Z,{children:[(0,a.jsx)(x.l,{children:"Dashboard"}),(0,a.jsx)(f.e,{children:(0,a.jsxs)(b.r,{children:[(0,a.jsx)(j.P,{md:6,children:(0,a.jsx)(O.u,{isFetching:s||K,fetchError:T||A.some(e=>!!e),children:(0,a.jsxs)(i.K,{hasGutter:!0,children:[(0,a.jsx)(n.v,{children:(0,a.jsx)(F.V,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,a.jsx)(n.v,{children:t.length>0?(0,a.jsx)("div",{style:{height:320},children:(0,a.jsxs)(d.k,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:U.map(e=>({name:q.V4[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:c.n.multiOrdered,width:700,legendComponent:(0,a.jsx)(u.Q,{y:10,x:200,colorScale:U.map(e=>q.V4[e.severity].color.value)}),children:[(0,a.jsx)(h.C,{label:"Products",axisLabelComponent:(0,a.jsx)(p.D,{dx:0,x:15,y:140}),tickLabelComponent:(0,a.jsx)(p.D,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:r=>{let a=r.target.innerHTML,s=t.find((e,t)=>D(e,t)===a);s&&e(`/sboms/${s.id}`)}}})}),(0,a.jsx)(h.C,{dependentAxis:!0,showGrid:!0,tickValues:Q?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,a.jsx)(y.K,{horizontal:!0,colorScale:U.map(e=>q.V4[e.severity].color.value),children:U.map(e=>{let r=q.V4[e.severity];return(0,a.jsx)(v.B,{labelComponent:(0,a.jsx)(m.h,{constrainToVisibleArea:!0}),data:V.map((a,s)=>{let{summary:{vulnerabilityStatus:{affected:i}}}=a,n=t[s],l=e.severity,o=i.severities[l];return{x:D(n,s),y:o,label:`${r.name}: ${o}`}})},e.severity)})})]})}):(0,a.jsx)(S.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:S.IQ.xs,children:(0,a.jsx)(w.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,a.jsx)(j.P,{md:6,children:(0,a.jsx)(O.u,{isFetching:N||s,fetchError:W||T,children:(0,a.jsxs)(b.r,{hasGutter:!0,children:[(0,a.jsx)(j.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(E.g,{children:[(0,a.jsx)(M.M,{children:"Last SBOM ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(i.K,{children:[(0,a.jsx)(n.v,{children:(0,$.o0)(t?.[0]?.ingested)}),(0,a.jsx)(n.v,{children:(0,a.jsx)(o.rU,{to:`/sboms/${t?.[0]?.id}`,children:t?.[0]?.name})})]})})]})})}),(0,a.jsx)(j.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(E.g,{children:[(0,a.jsx)(M.M,{children:"Total SBOMs"}),(0,a.jsx)(P.b,{children:r})]})})}),(0,a.jsx)(j.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(E.g,{children:[(0,a.jsx)(M.M,{children:"Last Advisory ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(i.K,{children:[(0,a.jsx)(n.v,{children:(0,$.o0)(_?.[0]?.ingested)}),(0,a.jsx)(n.v,{children:(0,a.jsx)(o.rU,{to:`/advisories/${_?.[0]?.uuid}`,children:_?.[0]?.document_id})})]})})]})})}),(0,a.jsx)(j.P,{md:6,children:(0,a.jsx)(k.o,{children:(0,a.jsxs)(E.g,{children:[(0,a.jsx)(M.M,{children:"Total Advisories"}),(0,a.jsx)(P.b,{children:I})]})})})]})})})]})})]})};var V=r(27378),K=r(8305),A=r(13754),Q=r(15726),D=r(1183),_=r(68e3),I=r(75503),N=r(50576),W=r(40371);let Z="watched-sboms",H="dashboard",R=()=>{let{data:e,isLoading:t,error:r}=(0,D.useQuery)({queryKey:[H,Z],queryFn:async()=>{try{return(await (0,W.JM)({client:N.L,path:{key:Z}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}},z=(e,t)=>{let r=(0,_.NL)();return(0,I.D)({mutationFn:e=>(0,W.yu)({client:N.L,path:{key:Z},body:e}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[H,Z]})},onError:t})},G=V.createContext({}),X=e=>{let{children:t}=e,{pushNotification:r}=V.useContext(Q.c),{sboms:s,isFetching:i,fetchError:n}=R(),{mutate:l}=z(()=>{},e=>{r({title:"Error while updating the user preferences",variant:"danger"})});return(0,a.jsx)(G.Provider,{value:{sboms:s,isFetching:i,fetchError:n,patch:(e,t)=>{l({...s,[e]:t})}},children:t})};var Y=r(46039),J=r(18037),ee=r(24620),et=r(9426),er=r(32050),ea=r(99589),es=r(17528),ei=r(32623),en=r(42364),el=r(29765),eo=r(68057);let ed=e=>{let{sbomId:t}=e,{data:r,isFetching:s,fetchError:i}=(0,B.useVulnerabilitiesOfSbom)(t);return(0,a.jsx)(O.u,{isFetching:s,fetchError:i,children:(0,a.jsx)(eo.V,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},ec=e=>{let{fieldName:t,sbomId:r}=e,{patch:s}=V.useContext(G),l=V.useRef(),[d,c]=V.useState(""),[u,h]=V.useState("");V.useEffect(()=>{let e=setTimeout(()=>{h(d)},500);return()=>clearTimeout(e)},[d]);let[p,y]=V.useState(!1),{sbom:v,isFetching:m,fetchError:b}=(0,C.useFetchSBOMById)(r??void 0),{result:{data:j}}=(0,C.useFetchSBOMs)({filters:[{field:"",operator:"~",value:u}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),F=()=>{y(!1)},k=()=>{y(!p)},E=()=>{p?d||F():y(!0)},M=(e,t)=>{c(t)},P=()=>{c(""),l?.current?.focus()};return(0,a.jsxs)(g.Z,{isFullHeight:!0,children:[(0,a.jsxs)(O.u,{isFetching:m,fetchError:b,children:[v&&(0,a.jsx)(x.l,{children:v?.name}),(0,a.jsx)(f.e,{children:r?(0,a.jsxs)(i.K,{children:[(0,a.jsx)(n.v,{isFilled:!0,children:(0,a.jsx)(ed,{sbomId:r})}),(0,a.jsx)(n.v,{children:(0,a.jsx)(o.rU,{to:`/sboms/${r}`,children:"View Details"})})]}):(0,a.jsx)(S.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:S.IQ.xs,children:(0,a.jsx)(w.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,a.jsx)(Y.e,{children:(0,a.jsx)(J.P,{shouldFocusFirstItemOnOpen:!1,isOpen:p,onSelect:(e,r)=>{r&&s(t,r),F()},onOpenChange:e=>{e||F()},toggle:e=>(0,a.jsx)(ee.O_,{ref:e,variant:"typeahead",onClick:k,isExpanded:p,isFullWidth:!0,children:(0,a.jsxs)(et.W,{isPlain:!0,children:[(0,a.jsx)(er.v,{autoComplete:"off",value:d,onClick:E,onChange:M,innerRef:l,isExpanded:p,placeholder:"Select a new SBOM to watch"}),(0,a.jsx)(ea.t,{...!d?{style:{display:"none"}}:{},children:(0,a.jsx)(es.zx,{icon:(0,a.jsx)(el.ZP,{"aria-hidden":!0}),variant:"plain",onClick:P,"aria-label":"Clear input value"})})]})}),children:(0,a.jsx)(ei.E,{children:j.map(e=>(0,a.jsx)(en.$,{value:e.id,children:e.name},e.id))})})})]})},eu=()=>{let{sboms:e,isFetching:t,fetchError:r}=V.useContext(G);return(0,a.jsx)(O.u,{isFetching:t,fetchError:r,isFetchingState:(0,a.jsx)(b.r,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,a.jsx)(j.P,{md:3,children:(0,a.jsx)(g.Z,{children:(0,a.jsx)(f.e,{children:(0,a.jsx)(K.b,{children:(0,a.jsx)(A.$,{})})})})},e))}),children:(0,a.jsx)(b.r,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,a.jsx)(j.P,{md:3,children:(0,a.jsx)(ec,{fieldName:t,sbomId:r})},`${t}:${r}`)})})})},eh=()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.NP,{hasBodyWrapper:!1,children:(0,a.jsxs)(i.K,{hasGutter:!0,children:[(0,a.jsx)(n.v,{children:(0,a.jsx)(T,{})}),(0,a.jsx)(n.v,{children:(0,a.jsx)(X,{children:(0,a.jsx)(eu,{})})})]})})})},17598:function(e,t,r){r.d(t,{useFetchAdvisories:()=>y,useFetchAdvisoryById:()=>v,useFetchAdvisoryLabels:()=>p,useUpdateAdvisoryLabelsMutation:()=>g,useUploadAdvisory:()=>m});var a=r(1183),s=r(24038),i=r(68e3),n=r(75503),l=r(50576),o=r(40371),d=r(87017),c=r(49988),u=r(95169);let h="advisories",p=e=>{let{data:t,isLoading:r,error:i,refetch:n}=(0,a.useQuery)({queryKey:[h,"labels",e],queryFn:()=>(0,o.sf)({client:l.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:t?.data||[],isFetching:r,fetchError:i,refetch:n}},y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:s,...i}=(0,c.rm)(e),n=(0,c.Rb)(t),{data:d,isLoading:u,error:p,refetch:y}=(0,a.useQuery)({queryKey:[h,e,n],queryFn:()=>(0,o.A1)({client:l.L,query:{...i,q:[s,n].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:d?.data?.items||[],total:d?.data?.total??0,params:e??e},isFetching:u,fetchError:p||null,refetch:y}},v=e=>{let{data:t,isLoading:r,error:s}=(0,a.useQuery)({queryKey:[h,e],queryFn:()=>(0,o.pB)({client:l.L,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:r,fetchError:s}},m=()=>{let e=(0,i.NL)();return(0,u.V)({parallel:!0,uploadFn:(e,t)=>(0,d.Cu)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[h]})}})},g=(e,t)=>{let r=(0,i.NL)();return(0,n.D)({mutationFn:e=>(0,o.m5)({client:l.L,path:{id:e.id},body:e.labels}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[h]})},onError:t})}},43959:function(e,t,r){r.d(t,{useFetchSBOMById:()=>m,useFetchSBOMLabels:()=>y,useFetchSBOMs:()=>v,useFetchSbomsAdvisory:()=>b,useFetchSbomsAdvisoryBatch:()=>j,useFetchSbomsByPackageId:()=>f,useUpdateSbomLabelsMutation:()=>x,useUploadSBOM:()=>g});var a=r(1183),s=r(24038),i=r(68e3),n=r(75503),l=r(16072),o=r(50576),d=r(40371),c=r(95169),u=r(87017),h=r(49988);let p="sboms",y=e=>{let{data:t,isLoading:r,error:i,refetch:n}=(0,a.useQuery)({queryKey:[p,"labels",e],queryFn:()=>(0,d.mh)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:t?.data||[],isFetching:r,fetchError:i,refetch:n}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:s,...i}=(0,h.rm)(e),n=(0,h.Rb)(t),{data:l,isLoading:c,error:u,refetch:y}=(0,a.useQuery)({queryKey:[p,e,n],queryFn:()=>(0,d.Wp)({client:o.L,query:{...i,q:[s,n].filter(e=>e).join("&")}}),enabled:!r});return{result:{data:l?.data?.items||[],total:l?.data?.total??0,params:e??e},isFetching:c,fetchError:u,refetch:y}},m=e=>{let{data:t,isLoading:r,error:s}=(0,a.useQuery)({queryKey:[p,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,d._Q)({client:o.L,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:r,fetchError:s}},g=()=>{let e=(0,i.NL)();return(0,c.V)({parallel:!0,uploadFn:(e,t)=>(0,u.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},x=(e,t)=>{let r=(0,i.NL)();return(0,n.D)({mutationFn:e=>(0,d.zx)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[p]})},onError:t})},f=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:s,error:i,refetch:n}=(0,a.useQuery)({queryKey:[p,"by-package",e,t],queryFn:()=>(0,d.DU)({client:o.L,query:{purl:e,...(0,h.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t??t},isFetching:s,fetchError:i,refetch:n}},b=e=>{let{data:t,isLoading:r,error:s}=(0,a.useQuery)({queryKey:[p,e,"advisory"],queryFn:()=>(0,d.NU)({client:o.L,path:{id:e}})});return{advisories:t?.data||[],isFetching:r,fetchError:s}},j=e=>{let t=(0,l.h)({queries:e.map(e=>({queryKey:[p,e,"advisory"],queryFn:()=>(0,d.NU)({client:o.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return t?.data||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}}}}]);