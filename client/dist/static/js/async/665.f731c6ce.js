"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["665"],{69876:function(e,t,r){r.d(t,{D:()=>l});var a=r(24246),i=r(70400);let l=e=>{let{value:t}=e;return(0,a.jsx)(a.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,a.jsx)(i._,{isCompact:!0,children:`${t}=${r}`},`${t}=${r}`)})})}},31373:function(e,t,r){r.d(t,{useVulnerabilitiesOfPackage:()=>o});var a=r(27378),i=r(7615),l=r(59015);let s=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},c=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>{let r=(0,i.g)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r,average_score:t.average_score},vulnerabilityStatus:t.status,advisory:e}})).reduce((e,t)=>{let r,a=e.find(e=>s(e,t));if(a)r=[...e.filter(e=>!s(e,a)),{...a,relatedSboms:[...a.relatedSboms,{advisory:t.advisory}]}];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,a=t.vulnerability.average_severity,i=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:i.total+1,severities:{...i.severities,[a]:i.severities[a]+1}}}})},{...u});return{vulnerabilities:t,summary:r}},o=e=>{let{pkg:t,isFetching:r,fetchError:i}=(0,l.useFetchPackageById)(e);return{data:a.useMemo(()=>c(t?.advisories||[]),[t]),isFetching:r,fetchError:i}}},33384:function(e,t,r){r.d(t,{a:()=>o,u:()=>d});var a=r(24246),i=r(27378),l=r(74502),s=r(14629),n=r(49988),u=r(59015),c=r(63706);let o=i.createContext({}),d=e=>{let{children:t}=e,r=(0,n.vZ)({tableName:"packages",persistenceKeyPrefix:l.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:l.L4,title:"Filter text",placeholderText:"Search",type:s.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:s.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:s.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:d,total:h},isFetching:p,fetchError:y}=(0,u.useFetchPackages)((0,n.QO)({...r,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),m=i.useMemo(()=>d.map(e=>({...e,decomposedPurl:(0,c.qX)(e.purl)})),[d]),v=(0,n.KC)({...r,idProperty:"uuid",currentPageItems:m,totalItemCount:h,isLoading:p});return(0,a.jsx)(o.Provider,{value:{totalItemCount:h,isFetching:p,fetchError:y,tableControls:v},children:t})}},88466:function(e,t,r){r.d(t,{L:()=>P});var a=r(24246),i=r(27378),l=r(65783),s=r(4835),n=r(14350),u=r(11165),c=r(89330),o=r(31423),d=r(94154),h=r(69876),p=r(3804),y=r(31336),m=r(11797),v=r(37818),b=r(42573),x=r(49304),f=r(31373);let g=e=>{let{packageId:t}=e,{data:r,isFetching:i,fetchError:l}=(0,f.useVulnerabilitiesOfPackage)(t);return(0,a.jsx)(v.u,{isFetching:i,fetchError:l,isFetchingState:(0,a.jsx)(m.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,a.jsx)(b.C,{error:e}),children:(0,a.jsx)(x.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})};var j=r(33384);let P=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:m}=i.useContext(j.a),{numRenderedColumns:v,currentPageItems:b,propHelpers:{paginationProps:x,tableProps:f,getThProps:P,getTrProps:K,getTdProps:T}}=m;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.i,{...f,"aria-label":"Package table",children:[(0,a.jsx)(n.h,{children:(0,a.jsx)(u.Tr,{children:(0,a.jsxs)(y.qK,{...m,children:[(0,a.jsx)(c.Th,{...P({columnKey:"name"})}),(0,a.jsx)(c.Th,{...P({columnKey:"namespace"})}),(0,a.jsx)(c.Th,{...P({columnKey:"version"})}),(0,a.jsx)(c.Th,{...P({columnKey:"type"})}),(0,a.jsx)(c.Th,{...P({columnKey:"path"})}),(0,a.jsx)(c.Th,{...P({columnKey:"qualifiers"})}),(0,a.jsx)(c.Th,{...P({columnKey:"vulnerabilities"})})]})})}),(0,a.jsx)(y.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:v,children:b.map((e,t)=>(0,a.jsx)(o.p,{children:(0,a.jsx)(u.Tr,{...K({item:e}),children:(0,a.jsxs)(y.Cx,{...m,item:e,rowIndex:t,children:[(0,a.jsx)(d.Td,{width:15,modifier:"breakWord",...T({columnKey:"name"}),children:(0,a.jsx)(l.OL,{to:`/packages/${e.uuid}`,children:e.decomposedPurl?e.decomposedPurl?.name:e.purl})}),(0,a.jsx)(d.Td,{width:15,modifier:"truncate",...T({columnKey:"namespace"}),children:e.decomposedPurl?.namespace}),(0,a.jsx)(d.Td,{width:10,modifier:"truncate",...T({columnKey:"version"}),children:e.decomposedPurl?.version}),(0,a.jsx)(d.Td,{width:10,modifier:"truncate",...T({columnKey:"type"}),children:e.decomposedPurl?.type}),(0,a.jsx)(d.Td,{width:10,modifier:"truncate",...T({columnKey:"path"}),children:e.decomposedPurl?.path}),(0,a.jsx)(d.Td,{width:20,...T({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&(0,a.jsx)(h.D,{value:e.decomposedPurl?.qualifiers})}),(0,a.jsx)(d.Td,{width:20,...T({columnKey:"vulnerabilities"}),children:(0,a.jsx)(g,{packageId:e.uuid})})]})})},e.uuid))})]}),(0,a.jsx)(p.p,{idPrefix:"package-table",isTop:!1,paginationProps:x})]})}},39305:function(e,t,r){r.d(t,{v:()=>d});var a=r(24246),i=r(27378),l=r(70715),s=r(40982),n=r(89226),u=r(14629),c=r(3804),o=r(33384);let d=e=>{let{showFilters:t}=e,{tableControls:r}=i.useContext(o.a),{propHelpers:{toolbarProps:d,filterToolbarProps:h,paginationToolbarItemProps:p,paginationProps:y}}=r;return(0,a.jsx)(l.o,{...d,children:(0,a.jsxs)(s.c,{children:[t&&(0,a.jsx)(u.Ki,{...h}),(0,a.jsx)(n.E,{...p,children:(0,a.jsx)(c.p,{idPrefix:"package-table",isTop:!0,paginationProps:y})})]})})}},59015:function(e,t,r){r.d(t,{useFetchPackageById:()=>c,useFetchPackages:()=>u,useFetchPackagesBySbomId:()=>o});var a=r(1183),i=r(50576),l=r(40371),s=r(49988);let n="packages",u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:u,error:c,refetch:o}=(0,a.useQuery)({queryKey:[n,e],queryFn:()=>(0,l.tj)({client:i.L,query:{...(0,s.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:u,fetchError:c,refetch:o}},c=e=>{let{data:t,isLoading:r,error:s}=(0,a.useQuery)({queryKey:[n,e],queryFn:()=>(0,l.BK)({client:i.L,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:s}},o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:u,error:c,refetch:o}=(0,a.useQuery)({queryKey:[n,"by-sbom",e,t],queryFn:()=>(0,l.Pg)({client:i.L,path:{id:e},query:{...(0,s.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:u,fetchError:c,refetch:o}}}}]);