"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["754"],{6364:function(e,t,r){r.d(t,{_:()=>p});var i=r(59390),n=r(27378);let s={label:"pf-v5-c-label",labelActions:"pf-v5-c-label__actions",labelContent:"pf-v5-c-label__content",labelIcon:"pf-v5-c-label__icon",labelText:"pf-v5-c-label__text",modifiers:{compact:"pf-m-compact",blue:"pf-m-blue",green:"pf-m-green",orange:"pf-m-orange",red:"pf-m-red",purple:"pf-m-purple",cyan:"pf-m-cyan",gold:"pf-m-gold",outline:"pf-m-outline",overflow:"pf-m-overflow",add:"pf-m-add",editable:"pf-m-editable",editableActive:"pf-m-editable-active",disabled:"pf-m-disabled"}},l={modifiers:{category:"pf-m-category",vertical:"pf-m-vertical",editable:"pf-m-editable",textarea:"pf-m-textarea"}};var a=r(50201),o=r(2499),d=r(15508),c=r(29765),u=r(59289);let m={name:"--pf-v5-c-label__text--MaxWidth"},h={blue:s.modifiers.blue,cyan:s.modifiers.cyan,green:s.modifiers.green,orange:s.modifiers.orange,purple:s.modifiers.purple,red:s.modifiers.red,gold:s.modifiers.gold,grey:""},p=e=>{var{children:t,className:r="",color:p="grey",variant:x="filled",isCompact:b=!1,isDisabled:f=!1,isEditable:j=!1,editableProps:v,textMaxWidth:g,tooltipPosition:y,icon:T,onClose:E,onClick:P,onEditCancel:k,onEditComplete:w,closeBtn:S,closeBtnAriaLabel:C,closeBtnProps:_,href:K,isOverflowLabel:N,render:I}=e,O=(0,i.__rest)(e,["children","className","color","variant","isCompact","isDisabled","isEditable","editableProps","textMaxWidth","tooltipPosition","icon","onClose","onClick","onEditCancel","onEditComplete","closeBtn","closeBtnAriaLabel","closeBtnProps","href","isOverflowLabel","render"]);let[F,R]=(0,n.useState)(!1),[L,A]=(0,n.useState)(t),M=n.useRef(),D=n.useRef();n.useEffect(()=>(document.addEventListener("mousedown",$),document.addEventListener("keydown",q),()=>{document.removeEventListener("mousedown",$),document.removeEventListener("keydown",q)})),n.useEffect(()=>{P&&K?console.warn("Link labels cannot have onClick passed, this results in invalid HTML. Please remove either the href or onClick prop."):P&&j&&console.warn("Editable labels cannot have onClick passed, clicking starts the label edit process. Please remove either the isEditable or onClick prop.")},[P,K,j]);let $=e=>{F&&D&&D.current&&!D.current.contains(e.target)&&(D.current.value&&w&&w(e,D.current.value),R(!1))},q=e=>{var r,i;let n=e.key;if((F||M&&M.current&&M.current.contains(e.target))&&(!F||D&&D.current&&D.current.contains(e.target))&&(F&&("Enter"===n||"Tab"===n)&&(e.preventDefault(),e.stopImmediatePropagation(),D.current.value&&w&&w(e,D.current.value),R(!1),null===(r=null==M?void 0:M.current)||void 0===r||r.focus()),F&&"Escape"===n&&(e.preventDefault(),e.stopImmediatePropagation(),D.current.value&&(D.current.value=t,k&&k(e,t)),R(!1),null===(i=null==M?void 0:M.current)||void 0===i||i.focus()),!F&&"Enter"===n)){e.preventDefault(),e.stopImmediatePropagation(),R(!0);let t=e.target,r=document.createRange(),i=window.getSelection();r.selectNodeContents(t),r.collapse(!1),i.removeAllRanges(),i.addRange(r)}},B=(K||P)&&f,V=n.createElement(a.zx,Object.assign({type:"button",variant:"plain",onClick:E,"aria-label":C||`Close ${t}`},B&&{isDisabled:!0},_),n.createElement(c.ZP,null)),Z=n.createElement("span",{className:(0,d.i)(s.labelActions)},S||V),U=n.createRef(),G=n.useRef(),[z,W]=n.useState(!1);(0,u.L)(()=>{let e=j?M:U;F||W(e.current&&e.current.offsetWidth<e.current.scrollWidth)},[F]);let H=n.createElement(n.Fragment,null,T&&n.createElement("span",{className:(0,d.i)(s.labelIcon)},T),n.createElement("span",Object.assign({ref:U,className:(0,d.i)(s.labelText)},g&&{style:{[m.name]:g}}),t));n.useEffect(()=>{F&&D&&D.current&&D.current.focus()},[D,F]);let X="span";K?X="a":(j||P&&!N)&&(X="button");let Q="button"===X,Y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({className:(0,d.i)(s.labelContent)},z&&{tabIndex:0}),K&&{href:K}),K&&f&&{onClick:e=>e.preventDefault()}),Q&&{type:"button",onClick:P}),j&&Object.assign({ref:M,onClick:e=>{R(!0),e.stopPropagation()}},v)),B&&Q&&{disabled:!0}),B&&K&&{tabIndex:-1,"aria-disabled":!0}),J=n.createElement(X,Object.assign({},Y),H);I?J=n.createElement(n.Fragment,null,z&&n.createElement(o.u,{triggerRef:G,content:t,position:y}),I({className:s.labelContent,content:H,componentRef:G})):z&&(J=n.createElement(o.u,{content:t,position:y},J));let ee=N?"button":"span";return n.createElement(ee,Object.assign({},O,{className:(0,d.i)(s.label,B&&s.modifiers.disabled,h[p],"outline"===x&&s.modifiers.outline,N&&s.modifiers.overflow,b&&s.modifiers.compact,j&&l.modifiers.editable,F&&s.modifiers.editableActive,r),onClick:N?P:void 0},"button"===ee&&{type:"button"}),!F&&J,!F&&E&&Z,F&&n.createElement("input",Object.assign({className:(0,d.i)(s.labelContent),type:"text",id:"editable-input",ref:D,value:L,onChange:()=>{A(D.current.value)}},v)))};p.displayName="Label"},27317:function(e,t,r){r.d(t,{K:()=>a});var i=r(59390),n=r(27378),s=r(33625),l=r(15508);let a=e=>{var{hasGutter:t=!1,className:r="",children:a=null,component:o="div"}=e,d=(0,i.__rest)(e,["hasGutter","className","children","component"]);return n.createElement(o,Object.assign({},d,{className:(0,l.i)(s.Z.stack,t&&s.Z.modifiers.gutter,r)}),a)};a.displayName="Stack"},93095:function(e,t,r){r.d(t,{v:()=>a});var i=r(59390),n=r(27378),s=r(33625),l=r(15508);let a=e=>{var{isFilled:t=!1,className:r="",children:a=null}=e,o=(0,i.__rest)(e,["isFilled","className","children"]);return n.createElement("div",Object.assign({},o,{className:(0,l.i)(s.Z.stackItem,t&&s.Z.modifiers.fill,r)}),a)};a.displayName="StackItem"},35676:function(e,t,r){r.d(t,{ZP:()=>i});let i=(0,r(24329).I)({name:"ShieldAltIcon",height:512,width:512,svgPath:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z",yOffset:0,xOffset:0})},67447:function(e,t,r){r.d(t,{G:()=>a});var i=r(59390),n=r(27378),s=r(15508),l=r(39157);let a=e=>{var{children:t=null}=e,r=(0,i.__rest)(e,["children"]);return n.createElement("div",Object.assign({},r,{className:(0,s.i)(l.Z.tableExpandableRowContent)}),t)};a.displayName="ExpandableRowContent"},18142:function(e,t,r){r.d(t,{A0:()=>u,V4:()=>d,XE:()=>c});var i=r(56149),n=r(62835),s=r(6357),l=r(1085),a=r(12773),o=r(98271);let d={unknown:{name:"Unknown",color:i.y,progressProps:{variant:void 0}},none:{name:"None",color:n.O,progressProps:{variant:void 0}},low:{name:"Low",color:s.R,progressProps:{variant:void 0}},medium:{name:"Medium",color:l.F,progressProps:{variant:"warning"}},high:{name:"High",color:a.Q,progressProps:{variant:"danger"}},critical:{name:"Critical",color:o.G,progressProps:{variant:"danger"}}},c=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function u(e){return(t,r)=>c(e(t))-c(e(r))}},86602:function(e,t,r){r.d(t,{g:()=>i});let i=e=>e??"unknown"},35843:function(e,t,r){r.d(t,{u:()=>a});var i=r(24246),n=r(8305),s=r(13754),l=r(48336);let a=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(n.b,{children:(0,i.jsx)(s.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(l.y,{}):e.children},25769:function(e,t,r){r.d(t,{D:()=>s});var i=r(24246),n=r(6364);let s=e=>{let{value:t}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,i.jsx)(n._,{isCompact:!0,children:`${t}=${r}`},`${t}=${r}`)})})}},3175:function(e,t,r){r.d(t,{o:()=>d});var i=r(24246),n=r(34747),s=r(46770),l=r(2499),a=r(35676),o=r(18142);let d=e=>{let{value:t,score:r,showScore:d,showLabel:c}=e,u=o.V4[t],m=u.name;return(0,i.jsxs)(n.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(s.B,{children:c?(0,i.jsx)(a.ZP,{color:u.color.value}):(0,i.jsx)(l.u,{content:m,children:(0,i.jsx)(a.ZP,{color:u.color.value})})}),c&&(0,i.jsx)(s.B,{children:m}),d&&null!==r&&(0,i.jsxs)(s.B,{children:["(",Math.round(10*r)/10,")"]})]})}},42835:function(e,t,r){r.d(t,{p:()=>s});var i=r(24246),n=r(40583);let s=e=>{let{paginationProps:t,isTop:r,isCompact:s=!1,idPrefix:l=""}=e;return(0,i.jsx)(n.t,{id:`${l?`${l}-`:""}pagination-${r?"top":"bottom"}`,variant:r?n.a.top:n.a.bottom,isCompact:s,...t,widgetId:"pagination-id"})}},48336:function(e,t,r){r.d(t,{y:()=>c});var i=r(24246),n=r(96582),s=r(610),l=r(68940),a=r(16668),o=r(42160),d=r(92864);let c=()=>(0,i.jsxs)(n.u,{variant:n.I.sm,children:[(0,i.jsx)(s.k,{icon:o.ZP,color:d.a.value}),(0,i.jsx)(l.D,{headingLevel:"h2",size:"lg",children:"Unable to connect"}),(0,i.jsx)(a.B,{children:"There was an error retrieving data. Check your connection and try again."})]})},37024:function(e,t,r){r.d(t,{hp:()=>f,qK:()=>v,Cx:()=>g});var i=r(24246),n=r(8305),s=r(13754),l=r(31423),a=r(11165),o=r(94154),d=r(48336),c=r(96582),u=r(610),m=r(68940),h=r(16668),p=r(22119);let x=e=>{let{title:t,description:r}=e;return(0,i.jsxs)(c.u,{variant:c.I.sm,children:[(0,i.jsx)(u.k,{icon:p.ZP}),(0,i.jsx)(m.D,{headingLevel:"h2",size:"lg",children:t}),r&&(0,i.jsx)(h.B,{children:r})]})},b=()=>(0,i.jsx)(x,{title:"No data available",description:"No data available to be shown here."}),f=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:m=null,noDataEmptyState:h=null,children:p}=e;return(0,i.jsx)(i.Fragment,{children:r?(0,i.jsx)(l.p,{children:(0,i.jsx)(a.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(n.b,{children:(0,i.jsx)(s.$,{size:"xl"})})})})}):c?(0,i.jsx)(l.p,{"aria-label":"Table error",children:(0,i.jsx)(a.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(n.b,{children:m||(0,i.jsx)(d.y,{})})})})}):u?(0,i.jsx)(l.p,{"aria-label":"Table error",children:(0,i.jsx)(a.Tr,{children:(0,i.jsx)(o.Td,{colSpan:t,children:(0,i.jsx)(n.b,{children:h||(0,i.jsx)(b,{})})})})}):p})};var j=r(67918);let v=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:n}=e;return(0,i.jsxs)(i.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,i.jsx)(j.Th,{screenReaderText:`before-data-${t}`},t)),n,Array(r).fill(null).map((e,t)=>(0,i.jsx)(j.Th,{screenReaderText:`after-data-${t}`},t))]})},g=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,isSelectionEnabled:n=!1,propHelpers:{getSingleExpandButtonTdProps:s,getSelectCheckboxTdProps:l},item:a,rowIndex:d,children:c}=e;return(0,i.jsxs)(i.Fragment,{children:[t&&"single"===r?(0,i.jsx)(o.Td,{...s({item:a,rowIndex:d})}):null,n?(0,i.jsx)(o.Td,{...l({item:a,rowIndex:d})}):null,c]})}},28986:function(e,t,r){r.d(t,{G:()=>n});var i=r(24246);let n=e=>{let{vulnerability:t}=e;return(0,i.jsxs)("p",{children:[t.withdrawn&&(0,i.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},11458:function(e,t,r){r.d(t,{s:()=>o});var i=r(27378),n=r(20711);let s=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,l={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},a=e=>{let t=e.flatMap(e=>(e.sboms??[]).flatMap(t=>Object.entries(t.purl_statuses||{}).map(r=>{let[i,n]=r;return{sbom:{...t},sbomStatus:i,advisory:e,packages:n}}))).reduce((e,t)=>{let r;let i=e.find(e=>s(e,t));if(i)r=[...e.filter(e=>!s(e,i)),{...i,relatedPackages:[...i.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let i={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:{...e.sbomStatus,[r]:e.sbomStatus[r]+1}})},{...l});return{sboms:t,summary:r}},o=e=>{let{vulnerability:t,isFetching:r,fetchError:s}=(0,n.p6)(e);return{data:i.useMemo(()=>a(t?.advisories||[]),[t]),isFetching:r,fetchError:s}}},15507:function(e,t,r){r.r(t),r.d(t,{default:()=>ee});var i=r(24246),n=r(27378),s=r(45043),l=r(34747),a=r(46770),o=r(25236),d=r(25645),c=r(4075),u=r(27090),m=r(75165),h=r(24787),p=r(6643),x=r(86602),b=r(35843),f=r(3175),j=r(20711),v=r(27308),g=r(40982),y=r(27763),T=r(4835),E=r(14350),P=r(11165),k=r(67918),w=r(31423),S=r(94154),C=r(65783),_=r(55096),K=r(42835),N=r(37024),I=r(94426),O=r(62126);let F=e=>{let{advisories:t}=e,r=(0,I.sz)({tableName:"advisory-table",idProperty:"uuid",items:t,isLoading:!1,columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",type:"Type",revision:"Revision",vulnerabilities:"Vulnerabilities"},hasActionsColumn:!1,isSortEnabled:!1,isPaginationEnabled:!0,initialItemsPerPage:10,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:_.vA.search,getItemValue:e=>e.identifier??""}]}),{currentPageItems:n,numRenderedColumns:s,propHelpers:{toolbarProps:l,filterToolbarProps:a,paginationToolbarItemProps:o,paginationProps:d,tableProps:c,getThProps:u,getTrProps:m,getTdProps:h}}=r;return(0,i.jsxs)(i.Fragment,{children:[r.isFilterEnabled&&(0,i.jsx)(v.o,{...l,children:(0,i.jsxs)(g.c,{children:[(0,i.jsx)(_.Ki,{showFiltersSideBySide:!0,...a}),(0,i.jsx)(y.E,{...o,children:(0,i.jsx)(K.p,{idPrefix:"advisory-table",isTop:!0,paginationProps:d})})]})}),(0,i.jsxs)(T.i,{...c,"aria-label":"Advisory table",children:[(0,i.jsx)(E.h,{children:(0,i.jsx)(P.Tr,{children:(0,i.jsxs)(N.qK,{...r,children:[(0,i.jsx)(k.Th,{...u({columnKey:"identifier"})}),(0,i.jsx)(k.Th,{...u({columnKey:"title"})}),(0,i.jsx)(k.Th,{...u({columnKey:"severity"})}),(0,i.jsx)(k.Th,{...u({columnKey:"type"})}),(0,i.jsx)(k.Th,{...u({columnKey:"revision"})}),(0,i.jsx)(k.Th,{...u({columnKey:"vulnerabilities"})})]})})}),(0,i.jsx)(N.hp,{isLoading:!1,isError:void 0,isNoData:0===t.length,numRenderedColumns:s,children:(0,i.jsx)(w.p,{children:n?.map(e=>i.jsxs(P.Tr,{...m({item:e}),children:[i.jsx(S.Td,{width:15,modifier:"breakWord",...h({columnKey:"identifier"}),children:i.jsx(C.rU,{to:`/advisories/${e.uuid}`,children:e.document_id})}),i.jsx(S.Td,{width:45,modifier:"truncate",...h({columnKey:"title"}),children:e.title}),i.jsx(S.Td,{width:10,...h({columnKey:"severity"}),children:i.jsx(f.o,{value:x.g(e.severity),score:e.score,showLabel:!0,showScore:!0})}),i.jsx(S.Td,{width:10,modifier:"truncate",...h({columnKey:"type"}),children:e.labels.type}),i.jsx(S.Td,{width:10,modifier:"truncate",...h({columnKey:"revision"}),children:O.p6(e.modified)}),i.jsx(S.Td,{width:10,modifier:"truncate",...h({columnKey:"vulnerabilities"}),children:e.number_of_vulnerabilities})]},e.identifier))})})]}),(0,i.jsx)(K.p,{idPrefix:"advisory-table",isTop:!1,paginationProps:d})]})};var R=r(27317),L=r(93095),A=r(87727),M=r(3498),D=r(50689),$=r(81391),q=r(74481),B=r(67761),V=r(28986);let Z=e=>{let{vulnerability:t}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(R.K,{hasGutter:!0,children:(0,i.jsx)(L.v,{children:(0,i.jsxs)(A.r,{hasGutter:!0,children:[(0,i.jsx)(M.P,{md:10,children:(0,i.jsx)(A.r,{children:(0,i.jsx)(M.P,{md:8,children:(0,i.jsx)(D.g,{children:(0,i.jsx)($.b,{children:(0,i.jsx)(V.G,{vulnerability:t})})})})})}),(0,i.jsx)(M.P,{md:10,children:(0,i.jsxs)(q.o,{columnModifier:{default:"3Col"},children:[(0,i.jsxs)(D.g,{children:[(0,i.jsx)(B.M,{children:"Reserved"}),(0,i.jsx)($.b,{children:(0,O.p6)(t.reserved)})]}),(0,i.jsxs)(D.g,{children:[(0,i.jsx)(B.M,{children:"Published date"}),(0,i.jsx)($.b,{children:(0,O.p6)(t.published)})]}),(0,i.jsxs)(D.g,{children:[(0,i.jsx)(B.M,{children:"Last modified"}),(0,i.jsx)($.b,{children:(0,O.p6)(t.modified)})]})]})})]})})})})};var U=r(27693),G=r.n(U),z=r(67447),W=r(25769),H=r(6364);let X=e=>{let{value:t}=e;return(0,i.jsx)(H._,{children:t.charAt(0).toUpperCase()+t.slice(1).replace("_"," ")})};var Q=r(11458),Y=r(3946);let J=e=>{let{vulnerabilityId:t}=e,{data:{sboms:r},isFetching:s,fetchError:l}=(0,Q.s)(t),a=n.useMemo(()=>r.map(e=>{let t=e.relatedPackages.flatMap(e=>e.packages).reduce((e,t)=>e.find(e=>e.uuid===t.uuid)?e:[...e.slice(),t],[]).map(e=>{let t=(0,O.qX)(e.purl);return{purlSummary:e,decomposedPurl:t}});return{...e,allUniquePackages:t}}),[r]),o=(0,Y.T)(a,e=>`${e.sbom.id}-${e.sbomStatus}`),d=(0,I.sz)({tableName:"sboms-table",idProperty:"_ui_unique_id",items:o,isLoading:s,columnNames:{name:"Name",version:"Version",status:"Status",dependencies:"Dependencies",supplier:"Supplier",created:"Created on"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","dependencies","created"],getSortValues:e=>({name:e.sbom.name,dependencies:e.sbom.number_of_packages,created:e.sbom?.published?G()(e.sbom.published).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:_.vA.search,getItemValue:e=>e.sbom?.name??""}],isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:c,numRenderedColumns:u,propHelpers:{toolbarProps:m,paginationToolbarItemProps:h,paginationProps:p,tableProps:x,getThProps:b,getTrProps:f,getTdProps:j,getExpandedContentTdProps:F},expansionDerivedState:{isCellExpanded:R}}=d;return(0,i.jsxs)(i.Fragment,{children:[d.isFilterEnabled&&(0,i.jsx)(v.o,{...m,children:(0,i.jsx)(g.c,{children:(0,i.jsx)(y.E,{...h,children:(0,i.jsx)(K.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:p})})})}),(0,i.jsxs)(T.i,{...x,"aria-label":"Sbom table",children:[(0,i.jsx)(E.h,{children:(0,i.jsx)(P.Tr,{children:(0,i.jsxs)(N.qK,{...d,children:[(0,i.jsx)(k.Th,{...b({columnKey:"name"})}),(0,i.jsx)(k.Th,{...b({columnKey:"version"})}),(0,i.jsx)(k.Th,{...b({columnKey:"status"})}),(0,i.jsx)(k.Th,{...b({columnKey:"dependencies"})}),(0,i.jsx)(k.Th,{...b({columnKey:"supplier"})}),(0,i.jsx)(k.Th,{...b({columnKey:"created"})})]})})}),(0,i.jsx)(N.hp,{isLoading:s,isError:!!l,isNoData:0===o.length,numRenderedColumns:u,children:c?.map((e,t)=>i.jsxs(w.p,{isExpanded:R(e),children:[i.jsx(P.Tr,{...f({item:e}),children:i.jsxs(N.Cx,{...d,item:e,rowIndex:t,children:[i.jsx(S.Td,{width:25,modifier:"breakWord",...j({columnKey:"name"}),children:i.jsx(C.rU,{to:`/sboms/${e.sbom.id}`,children:e?.sbom?.name})}),i.jsx(S.Td,{width:10,modifier:"truncate",...j({columnKey:"version"}),children:e.sbom?.version}),i.jsx(S.Td,{width:10,...j({columnKey:"status"}),children:i.jsx(X,{value:e.sbomStatus})}),i.jsx(S.Td,{width:10,...j({columnKey:"dependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t}),children:e.allUniquePackages.length}),i.jsx(S.Td,{width:10,modifier:"truncate",...j({columnKey:"supplier"}),children:e?.sbom?.suppliers.join(", ")}),i.jsx(S.Td,{width:10,modifier:"truncate",...j({columnKey:"created"}),children:O.p6(e.sbom?.published)})]})}),R(e)?i.jsx(P.Tr,{isExpanded:!0,children:i.jsx(S.Td,{...F({item:e}),children:i.jsx(z.G,{children:R(e,"dependencies")?i.jsx(i.Fragment,{children:i.jsxs(T.i,{variant:"compact",children:[i.jsx(E.h,{children:i.jsxs(P.Tr,{children:[i.jsx(k.Th,{children:"Type"}),i.jsx(k.Th,{children:"Namespace"}),i.jsx(k.Th,{children:"Name"}),i.jsx(k.Th,{children:"Version"}),i.jsx(k.Th,{children:"Path"}),i.jsx(k.Th,{children:"Qualifiers"})]})}),i.jsx(w.p,{children:e.allUniquePackages.map(e=>i.jsxs(P.Tr,{children:[i.jsx(S.Td,{children:e.decomposedPurl?.type}),i.jsx(S.Td,{children:e.decomposedPurl?.namespace}),i.jsx(S.Td,{children:i.jsx(C.rU,{to:`/packages/${e.purlSummary.uuid}`,children:e.decomposedPurl?.name})}),i.jsx(S.Td,{children:e.decomposedPurl?.version}),i.jsx(S.Td,{children:e.decomposedPurl?.path}),i.jsx(S.Td,{children:e.decomposedPurl?.qualifiers&&i.jsx(W.D,{value:e.decomposedPurl?.qualifiers})})]},e.purlSummary.uuid))})]})}):null})})}):null]},e._ui_unique_id))})]}),(0,i.jsx)(K.p,{idPrefix:"sboms-table",isTop:!1,paginationProps:p})]})},ee=()=>{let e=(0,p.ZX)(p.Uo.VULNERABILITY_ID),{vulnerability:t,isFetching:r,fetchError:v}=(0,j.p6)(e),[g,y]=(0,n.useState)(0),T=n.createRef(),E=n.createRef();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.NP,{variant:s.Dk.light,children:[(0,i.jsxs)(l.k,{children:[(0,i.jsx)(a.B,{children:(0,i.jsx)(o.D,{children:(0,i.jsxs)(d.x,{component:"h1",children:[t?.identifier??""," "]})})}),(0,i.jsx)(a.B,{children:t&&(0,i.jsx)(f.o,{value:(0,x.g)(t.average_severity),score:t.average_score,showLabel:!0,showScore:!0})})]}),(0,i.jsx)("div",{className:"pf-v5-u-mt-sm",children:(0,i.jsx)(b.u,{isFetching:r,fetchError:v,children:t&&(0,i.jsx)(Z,{vulnerability:t})})})]}),(0,i.jsx)(s.NP,{type:"nav",children:(0,i.jsxs)(c.m,{mountOnEnter:!0,activeKey:g,onSelect:(e,t)=>{y(t)},"aria-label":"Vulnerability detail tabs",role:"region",children:[(0,i.jsx)(u.O,{eventKey:0,title:(0,i.jsx)(m.T,{children:"Related SBOMs"}),tabContentId:"refTabSbomsSection",tabContentRef:T,"aria-label":"Related SBOMs for this Vulnerability"}),(0,i.jsx)(u.O,{eventKey:1,title:(0,i.jsx)(m.T,{children:"Related Advisories"}),tabContentId:"refTabAdvisoriesSection",tabContentRef:E,"aria-label":"Advisories that explain the current Vulnerability"})]})}),(0,i.jsxs)(s.NP,{children:[(0,i.jsx)(h.I,{eventKey:0,id:"refTabSbomsSection",ref:T,"aria-label":"Related SBOMs",children:(0,i.jsx)(J,{vulnerabilityId:e})}),(0,i.jsx)(h.I,{eventKey:1,id:"refTabAdvisoriesSection",ref:E,"aria-label":"Related Advisories",hidden:!0,children:(0,i.jsx)(F,{isFetching:r,fetchError:v,advisories:t?.advisories||[]})})]})]})}},20711:function(e,t,r){r.d(t,{fd:()=>o,p6:()=>d});var i=r(1183),n=r(22285),s=r(54227),l=r(94426);let a="vulnerabilities",o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:o,error:d,refetch:c}=(0,i.a)({queryKey:[a,e],queryFn:()=>(0,s.b5)({client:n.L,query:{...(0,l.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:o,fetchError:d,refetch:c}},d=e=>{let{data:t,isLoading:r,error:l}=(0,i.a)({queryKey:[a,e],queryFn:()=>(0,s.OG)({client:n.L,path:{id:e}})});return{vulnerability:t?.data,isFetching:r,fetchError:l}}},3946:function(e,t,r){r.d(t,{T:()=>s});var i=r(27378),n=r(44072);let s=(e,t)=>(0,i.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[n.nM]:t(e)})):[],[e,t])},33625:function(e,t,r){r.d(t,{Z:()=>i});let i={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v5-l-stack",stackItem:"pf-v5-l-stack__item"}}}]);