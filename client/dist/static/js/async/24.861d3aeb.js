"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["24"],{71284:function(e,t,r){r.d(t,{Cb:()=>j,Kb:()=>v,Sx:()=>g,hs:()=>_,m4:()=>x,pJ:()=>m,xh:()=>S});var a=r(88741),n=r(99111),l=r(22134),i=r(57822),s=r(32635),o=r(1734),c=r(84249),d=r(95283),u=r(52040),h=r(44240),p=r(43967),y=r(36808);let v={unknown:{name:"Unknown",color:c.o,progressProps:{variant:void 0},icon:a.ZP},none:{name:"None",color:d.q,progressProps:{variant:void 0},icon:n.VQ},low:{name:"Low",color:u.b,progressProps:{variant:void 0},icon:l.g8},medium:{name:"Medium",color:h.B,progressProps:{variant:"warning"},icon:i.Yc},high:{name:"High",color:p.e,progressProps:{variant:"danger"},icon:s.Fc},critical:{name:"Critical",color:y.d,progressProps:{variant:"danger"},icon:o.id}},m={fixed:{name:"Fixed",color:"blue"},not_affected:{name:"Not affected",color:"green"},known_not_affected:{name:"Known not affected",color:"green"},under_investigation:{name:"Under investigation",color:"yellow"},affected:{name:"Affected",color:"red"}},f=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function g(e){return(t,r)=>f(e(t))-f(e(r))}let x=e=>{let{key:t,value:r}=e;return"".concat(r?"".concat(t,"=").concat(r):"".concat(t))},j=e=>{let[t,r]=e.split("=");return{key:t,value:null!=r?r:""}},b=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function _(e){return(t,r)=>b(e(t))-b(e(r))}let S=e=>0===e.length?null:[...e].sort(_(e=>e.type))[0]},27875:function(e,t,r){r.d(t,{U:()=>a});let a=e=>null!=e?e:"unknown"},81895:function(e,t,r){r.d(t,{J4:()=>h,SP:()=>p,Z3:()=>y,hP:()=>u});var a=r(32909),n=r(42642),l=r(46165),i=r(98259);r(56161);let s="/api",o="".concat(s,"/v2/advisory"),c="".concat(s,"/v2/sbom"),d=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},u=(e,t)=>{let r=e.get(i.fs);return l.A.post("".concat(o),r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":d(r)}}))},h=(e,t)=>{let r=e.get(i.fs);return l.A.post("".concat(c),r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":d(r)}}))},p=(e,t)=>{let r=e.get(i.fs);return l.A.post("/api/v2/ui/extract-sbom-purls",r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":d(r)}}))},y=e=>l.A.get("".concat(c,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},24296:function(e,t,r){r.d(t,{a:()=>s});var a=r(62540),n=r(59394),l=r(81595),i=r(40554);let s=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(n.a,{children:(0,a.jsx)(l.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(i.q,{}):e.children},65346:function(e,t,r){r.d(t,{Y:()=>s});var a=r(62540),n=r(63696),l=r(88057),i=r(71284);let s=e=>{let{vulnerabilitiesSummary:t}=e,r=n.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],a=i.Kb[e];return{severity:e,count:r,label:a.name,color:a.color.value}}).sort((0,i.Sx)(e=>e.severity)).reverse(),[t]);return(0,a.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,a.jsx)(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(t.total),subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:"".concat(t,": ").concat(r)}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return"".concat(t.x,": ").concat(t.y)},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},40554:function(e,t,r){r.d(t,{q:()=>s});var a=r(62540),n=r(48655),l=r(92411),i=r(60087);let s=()=>(0,a.jsx)(n.pp,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:i.Ay,variant:n.s$.sm,children:(0,a.jsx)(l.h,{children:"There was an error retrieving data. Check your connection and try again."})})},3652:function(e,t,r){r.d(t,{RQ:()=>d,UI:()=>h,nm:()=>p});var a=r(32909),n=r(42642),l=r(63696),i=r(27875),s=r(30111);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:(0,a._)({},c),fixed:(0,a._)({},c),not_affected:(0,a._)({},c),known_not_affected:(0,a._)({},c),under_investigation:(0,a._)({},c)}},u=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,l=e.find(e=>o(e,t));if(l)r=[...e.filter(e=>!o(e,l)),(0,n._)((0,a._)({},l),{relatedPackages:[...l.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,l=(0,i.U)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,n._)((0,a._)({},e.vulnerabilityStatus),{[r]:{total:s.total+1,severities:(0,n._)((0,a._)({},s.severities),{[l]:s.severities[l]+1})}})})},(0,a._)({},d));return{vulnerabilities:t,summary:r}},h=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.DH)(e);return{data:l.useMemo(()=>u(t||[]),[t]),isFetching:r,fetchError:a}},p=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.zY)(e);return{data:l.useMemo(()=>(null!=t?t:[]).map(e=>u(e||[])),[t]),isFetching:r,fetchError:a}}},93531:function(e,t,r){r.d(t,{v:()=>u});var a=r(32909),n=r(42642),l=r(63696),i=r(98259),s=r(46165);let o="cancelled",c=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),d=(e,t)=>{switch(t.type){case"queueUpload":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var r;return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"complete",error:t.payload.error,wasCancelled:(null==(r=t.payload.error)?void 0:r.message)===o}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),(0,n._)((0,a._)({},e),{uploads:r})}default:throw Error()}},u=e=>{let{parallel:t,uploadFn:r,onSuccess:a,onError:n}=e,[c,u]=l.useReducer(d,{uploads:new Map});return{uploads:c.uploads,handleUpload:e=>{let l=[];for(let t=0;t<e.length;t++){let r=e[t],c=new FormData;c.set(i.fs,r);let d=s.A.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let a=null!=(t=e.total)?t:1;u({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/a*100)}})},cancelToken:d.token};u({type:"queueUpload",payload:{file:r,cancelFn:d}});let p={formData:c,config:h,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),a&&a(e,r)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==o&&n&&n(e,r)}};l.push(p)}if(t)for(let e of l)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else l.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,r;null==(r=c.uploads.get(e))||null==(t=r.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},44503:function(e,t,r){r.r(t),r.d(t,{default:()=>ey});var a=r(62540),n=r(68430),l=r(38914),i=r(57901),s=r(74343),o=r(57887),c=r(95409),d=r(5088),u=r(35204),h=r(79266),p=r(61316),y=r(40135),v=r(41890),m=r(17327),f=r(64361),g=r(71603),x=r(76072),j=r(97299),b=r(42957),_=r(48655),S=r(92411),F=r(1020),w=r(24974),E=r(21639),q=r(3939),k=r(71284),P=r(24296),C=r(3652),K=r(99134),M=r(30111),B=r(52362),O=r(23909);let I=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],T=()=>{var e,t,r,n,T,U;let A=(0,s.Zp)(),{result:{data:D,total:W},isFetching:Q,fetchError:L}=(0,M.i$)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:N,isFetching:V,fetchError:Y}=(0,C.nm)(D.map(e=>e.id)),H=N.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),J=(e,t)=>"".concat(" ".repeat(t+1)).concat(e.name),{result:{data:Z,total:R},isFetching:X,fetchError:$}=(0,K.VH)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,a.jsxs)(m.Z,{children:[(0,a.jsx)(f.Z,{children:"Dashboard"}),(0,a.jsx)(g.b,{children:(0,a.jsxs)(x.x,{children:[(0,a.jsx)(j.E,{md:6,children:(0,a.jsx)(P.a,{isFetching:Q||V,fetchError:L||Y.find(e=>!!e),children:(0,a.jsxs)(l.B,{hasGutter:!0,children:[(0,a.jsx)(i.a,{children:(0,a.jsx)(b.U,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,a.jsx)(i.a,{children:D.length>0?(0,a.jsx)("div",{style:{height:320},children:(0,a.jsxs)(o.t,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:I.map(e=>({name:k.Kb[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:c.L.multiOrdered,width:700,legendComponent:(0,a.jsx)(d._,{y:10,x:200,colorScale:I.map(e=>k.Kb[e.severity].color.value)}),children:[(0,a.jsx)(u.c,{label:"Products",axisLabelComponent:(0,a.jsx)(h.j,{dx:0,x:15,y:140}),tickLabelComponent:(0,a.jsx)(h.j,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:e=>{let t=e.target.innerHTML,r=D.find((e,r)=>J(e,r)===t);r&&A((0,s.tW)(B.Jh.sbomDetails,{sbomId:r.id}))}}})}),(0,a.jsx)(u.c,{dependentAxis:!0,showGrid:!0,tickValues:H?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,a.jsx)(p.R,{horizontal:!0,colorScale:I.map(e=>k.Kb[e.severity].color.value),children:I.map(e=>{let t=k.Kb[e.severity];return(0,a.jsx)(y._,{labelComponent:(0,a.jsx)(v.I,{constrainToVisibleArea:!0}),data:N.map((r,a)=>{let{summary:{vulnerabilityStatus:{affected:n}}}=r,l=D[a],i=e.severity,s=n.severities[i];return{x:J(l,a),y:s,label:"".concat(t.name,": ").concat(s)}})},e.severity)})})]})}):(0,a.jsx)(_.pp,{headingLevel:"h4",titleText:"There is nothing here yet",variant:_.s$.xs,children:(0,a.jsx)(S.h,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,a.jsx)(j.E,{md:6,children:(0,a.jsx)(P.a,{isFetching:X||Q,fetchError:$||L,children:(0,a.jsxs)(x.x,{hasGutter:!0,children:[(0,a.jsx)(j.E,{md:6,children:(0,a.jsx)(F.B,{children:(0,a.jsxs)(w.W,{children:[(0,a.jsx)(E.X,{children:"Last SBOM ingested"}),(0,a.jsx)(q.d,{children:(0,a.jsxs)(l.B,{children:[(0,a.jsx)(i.a,{children:(0,O.r6)(null==D||null==(e=D[0])?void 0:e.ingested)}),(0,a.jsx)(i.a,{children:(null==D?void 0:D[0])&&(0,a.jsx)(s.N_,{to:(0,s.tW)(B.Jh.sbomDetails,{sbomId:null==D||null==(t=D[0])?void 0:t.id}),children:null==D||null==(r=D[0])?void 0:r.name})})]})})]})})}),(0,a.jsx)(j.E,{md:6,children:(0,a.jsx)(F.B,{children:(0,a.jsxs)(w.W,{children:[(0,a.jsx)(E.X,{children:"Total SBOMs"}),(0,a.jsx)(q.d,{children:W})]})})}),(0,a.jsx)(j.E,{md:6,children:(0,a.jsx)(F.B,{children:(0,a.jsxs)(w.W,{children:[(0,a.jsx)(E.X,{children:"Last Advisory ingested"}),(0,a.jsx)(q.d,{children:(0,a.jsxs)(l.B,{children:[(0,a.jsx)(i.a,{children:(0,O.r6)(null==Z||null==(n=Z[0])?void 0:n.ingested)}),(0,a.jsx)(i.a,{children:(null==Z?void 0:Z[0])&&(0,a.jsx)(s.N_,{to:(0,s.tW)(B.Jh.advisoryDetails,{advisoryId:null==Z||null==(T=Z[0])?void 0:T.uuid}),children:null==Z||null==(U=Z[0])?void 0:U.document_id})})]})})]})})}),(0,a.jsx)(j.E,{md:6,children:(0,a.jsx)(F.B,{children:(0,a.jsxs)(w.W,{children:[(0,a.jsx)(E.X,{children:"Total Advisories"}),(0,a.jsx)(q.d,{children:R})]})})})]})})})]})})]})};var U=r(63696),A=r(59394),D=r(81595),W=r(32909),Q=r(42642),L=r(4392),N=r(77184),V=r(62603),Y=r(90130),H=r(96002),J=r(86141);let Z="watched-sboms",R="dashboard",X=U.createContext({}),$=e=>{var t,r;let n,{children:l}=e,{pushNotification:i}=U.useContext(L.K),{sboms:s,isFetching:o,fetchError:c}=(()=>{let{data:e,isLoading:t,error:r}=(0,N.I)({queryKey:[R,Z],queryFn:async()=>{try{return(await (0,J.oE)({client:H.S,path:{key:Z}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}})(),{mutate:d}=(t=()=>{},r=e=>{i({title:"Error while updating the user preferences",variant:"danger"})},n=(0,V.jE)(),(0,Y.n)({mutationFn:e=>(0,J.A2)({client:H.S,path:{key:Z},body:e}),onSuccess:async(e,r)=>{t(),await n.invalidateQueries({queryKey:[R,Z]})},onError:r})),u=U.useCallback((e,t)=>{d((0,Q._)((0,W._)({},s),{[e]:t}))},[s,d]);return(0,a.jsx)(X.Provider,{value:{sboms:s,isFetching:o,fetchError:c,patch:u},children:l})};var z=r(34260),G=r(63392),ee=r(22431),et=r(96526),er=r(81643),ea=r(95354),en=r(35743),el=r(24773),ei=r(93831),es=r(77570),eo=r(53025),ec=r(26997),ed=r(65346);let eu=e=>{let{sbomId:t}=e,{data:r,isFetching:n,fetchError:l}=(0,C.UI)(t);return(0,a.jsx)(P.a,{isFetching:n,fetchError:l,children:(0,a.jsx)(ed.Y,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},eh=e=>{let{fieldName:t,sbomId:r}=e,{patch:n}=U.useContext(X),o=U.useRef(null),[c,d]=U.useState(""),[u,h]=U.useState("");U.useEffect(()=>{let e=setTimeout(()=>{h(c)},500);return()=>clearTimeout(e)},[c]);let[p,y]=U.useState(!1),{sbom:v,isFetching:x,fetchError:j}=(0,M.rj)(null!=r?r:void 0,void 0,1),b=U.useMemo(()=>{var e;return(null==j||null==(e=j.response)?void 0:e.status)===404},[j]),F=(0,z.l)();U.useEffect(()=>{b&&n(t,null)},[t,b,n]);let{result:{data:w}}=(0,M.i$)({filters:[{field:"",operator:"~",value:u}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),E=()=>{y(!1)},q=()=>{y(!p)},k=()=>{p?c||E():y(!0)},C=(e,t)=>{d(t)},K=()=>{var e;d(""),null==o||null==(e=o.current)||e.focus()};return(0,a.jsxs)(m.Z,{isFullHeight:!0,children:[(0,a.jsxs)(P.a,{isFetching:x||b||F>0,fetchError:j,children:[v&&(0,a.jsx)(f.Z,{className:ec.A.textBreakWord,children:null==v?void 0:v.name}),(0,a.jsx)(g.b,{children:r?(0,a.jsxs)(l.B,{children:[(0,a.jsx)(i.a,{isFilled:!0,children:(0,a.jsx)(eu,{sbomId:r})}),(0,a.jsx)(i.a,{children:(0,a.jsx)(s.N_,{to:(0,s.tW)(B.Jh.sbomDetails,{sbomId:r}),children:"View Details"})})]}):(0,a.jsx)(_.pp,{headingLevel:"h4",titleText:"There is nothing here yet",variant:_.s$.xs,children:(0,a.jsx)(S.h,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,a.jsx)(G.w,{children:(0,a.jsx)(ee.l,{shouldFocusFirstItemOnOpen:!1,isOpen:p,onSelect:(e,r)=>{r&&n(t,r),E()},onOpenChange:e=>{e||E()},toggle:e=>(0,a.jsx)(et.S3,{ref:e,variant:"typeahead",onClick:q,isExpanded:p,isFullWidth:!0,children:(0,a.jsxs)(er.f,{isPlain:!0,children:[(0,a.jsx)(ea.Q,{autoComplete:"off",value:c,onClick:k,onChange:C,innerRef:o,isExpanded:p,placeholder:"Select a new SBOM to watch"}),(0,a.jsx)(en.N,(0,Q._)((0,W._)({},c?{}:{style:{display:"none"}}),{children:(0,a.jsx)(el.$n,{icon:(0,a.jsx)(eo.Ay,{"aria-hidden":!0}),variant:"plain",onClick:K,"aria-label":"Clear input value"})}))]})}),children:(0,a.jsx)(ei.B,{children:w.map(e=>(0,a.jsx)(es.O,{value:e.id,children:e.name},e.id))})})})]})},ep=()=>{let{sboms:e,isFetching:t,fetchError:r}=U.useContext(X);return(0,a.jsx)(P.a,{isFetching:t,fetchError:r,isFetchingState:(0,a.jsx)(x.x,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,a.jsx)(j.E,{md:3,children:(0,a.jsx)(m.Z,{children:(0,a.jsx)(g.b,{children:(0,a.jsx)(A.a,{children:(0,a.jsx)(D.y,{})})})})},e))}),children:(0,a.jsx)(x.x,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,a.jsx)(j.E,{md:3,children:(0,a.jsx)(eh,{fieldName:t,sbomId:r})},"".concat(t,":").concat(r))})})})},ey=()=>(0,a.jsx)(n.d8,{hasBodyWrapper:!1,children:(0,a.jsxs)(l.B,{hasGutter:!0,children:[(0,a.jsx)(i.a,{children:(0,a.jsx)(T,{})}),(0,a.jsx)(i.a,{children:(0,a.jsx)($,{children:(0,a.jsx)(ep,{})})})]})})},99134:function(e,t,r){r.d(t,{VH:()=>f,Yu:()=>j,eq:()=>m,ni:()=>x,uJ:()=>b,vy:()=>g});var a=r(32909),n=r(42642),l=r(72610),i=r(77184),s=r(59722),o=r(62603),c=r(90130),d=r(96002),u=r(86141),h=r(81895),p=r(73470),y=r(93531);let v="advisories",m=e=>{let{data:t,isLoading:r,error:a,refetch:n}=(0,i.I)({queryKey:[v,"labels",e],queryFn:()=>(0,u.J)({client:d.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:n}},f=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,p.kd)(s),{q:y}=h,m=(0,l._)(h,["q"]),f=(0,p.Er)(o),{data:g,isLoading:x,error:j,refetch:b}=(0,i.I)({queryKey:[v,s,f],queryFn:()=>(0,u.YM)({client:d.S,query:(0,n._)((0,a._)({},m),{q:[y,f].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==g||null==(e=g.data)?void 0:e.items)||[],total:null!=(r=null==g||null==(t=g.data)?void 0:t.total)?r:0,params:s},isFetching:x,fetchError:j||null,refetch:b}},g=e=>{let{data:t,isLoading:r,error:a}=(0,i.I)({queryKey:[v,e],queryFn:()=>(0,u.ai)({client:d.S,path:{key:e}}),enabled:!!e});return{advisory:null==t?void 0:t.data,isFetching:r,fetchError:a}},x=(e,t)=>{let r=(0,o.jE)();return(0,c.n)({mutationFn:async e=>(await (0,u.vl)({client:d.S,path:{key:e}})).data,onSuccess:async(t,a)=>{e(t,a),await r.invalidateQueries({queryKey:[v]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[v]})}})},j=()=>{let e=(0,o.jE)();return(0,y.v)({parallel:!0,uploadFn:(e,t)=>(0,h.hP)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[v]})}})},b=(e,t)=>{let r=(0,o.jE)();return(0,c.n)({mutationFn:e=>(0,u._e)({client:d.S,path:{id:e.id},body:e.labels}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[v]})},onError:t})}},30111:function(e,t,r){r.d(t,{DH:()=>F,Qr:()=>S,_P:()=>f,bj:()=>E,cF:()=>_,i$:()=>g,l6:()=>j,rj:()=>x,sn:()=>b,zY:()=>w});var a=r(32909),n=r(42642),l=r(72610),i=r(77184),s=r(59722),o=r(62603),c=r(90130),d=r(3822),u=r(96002),h=r(86141),p=r(93531),y=r(81895),v=r(73470);let m="sboms",f=e=>{let{data:t,isLoading:r,error:a,refetch:n}=(0,i.I)({queryKey:[m,"labels",e],queryFn:()=>(0,h.Dw)({client:u.S,query:{limit:10,filter_text:e}}),placeholderData:s.rX});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:n}},g=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=(0,v.kd)(s),{q:p}=d,y=(0,l._)(d,["q"]),f=(0,v.Er)(o),{data:g,isLoading:x,error:j,refetch:b}=(0,i.I)({queryKey:[m,s,f],queryFn:()=>(0,h.z1)({client:u.S,query:(0,n._)((0,a._)({},y),{q:[p,f].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==g||null==(e=g.data)?void 0:e.items)||[],total:null!=(r=null==g||null==(t=g.data)?void 0:t.total)?r:0,params:s},isFetching:x,fetchError:j,refetch:b}},x=(e,t,r)=>{let{data:a,isLoading:n,error:l}=(0,i.I)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h.a7)({client:u.S,path:{id:e}}),enabled:!!e,refetchInterval:t,retry:r});return{sbom:null==a?void 0:a.data,isFetching:n,fetchError:l}},j=(e,t)=>{let r=(0,o.jE)();return(0,c.n)({mutationFn:async e=>(await (0,h.bS)({client:u.S,path:{id:e}})).data,onSuccess:async(t,a)=>{e(t,a),await r.invalidateQueries({queryKey:[m]}),r.removeQueries({queryKey:[m,a]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[m]})}})},b=()=>{let e=(0,o.jE)();return(0,p.v)({parallel:!0,uploadFn:(e,t)=>(0,y.J4)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},_=(e,t)=>{let r=(0,o.jE)();return(0,c.n)({mutationFn:e=>(0,h.aB)({client:u.S,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:t})},S=function(e){var t,r,n;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:c,refetch:d}=(0,i.I)({queryKey:[m,"by-package",e,l],queryFn:()=>(0,h.m9)({client:u.S,query:(0,a._)({purl:e},(0,v.kd)(l))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(n=null==s||null==(r=s.data)?void 0:r.total)?n:0,params:l},isFetching:o,fetchError:c,refetch:d}},F=e=>{let{data:t,isLoading:r,error:a}=(0,i.I)({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.bj)({client:u.S,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}},w=e=>{let t=(0,d.E)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.bj)({client:u.S,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},E=e=>{let{data:t,isLoading:r,error:a}=(0,i.I)({queryKey:[m,e,"license-ids"],queryFn:()=>(0,h.ZV)({client:u.S,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}}}}]);