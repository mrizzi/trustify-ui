"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["593"],{38139:function(e,t,r){r.d(t,{g:()=>a});var i=r(97517),l=r(62540),s=r(62634),n=r(82980);let a=e=>{var{children:t=null,hasNoBackground:r}=e,a=(0,i.__rest)(e,["children","hasNoBackground"]);return(0,l.jsx)("div",Object.assign({},a,{className:(0,s.A)(n.A.tableExpandableRowContent,r&&n.A.modifiers.noBackground),children:t}))};a.displayName="ExpandableRowContent"},85790:function(e,t,r){r.d(t,{a:()=>s});var i=r(62540),l=r(69548);let s=e=>{let{value:t}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,i.jsx)(l.J,{isCompact:!0,children:"".concat(t,"=").concat(r)},"".concat(t,"=").concat(r))})})}},20311:function(e,t,r){r.d(t,{R:()=>s});var i=r(62540),l=r(63696);let s=e=>{let{children:t}=e,[r,s]=l.useState(!1);return(0,i.jsx)(i.Fragment,{children:t(r,s)})}},64377:function(e,t,r){r.d(t,{j:()=>l});var i=r(62540);let l=e=>{let{vulnerability:t}=e;return(0,i.jsxs)("p",{children:[t.withdrawn&&(0,i.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},19595:function(e,t,r){r.d(t,{F:()=>n});var i=r(62540),l=r(69548),s=r(71284);let n=e=>{var t;let{value:r}=e,n=null!=(t=s.pJ[r])?t:{name:r,color:void 0};return(0,i.jsx)(l.J,{color:n.color,children:n.name})}},3652:function(e,t,r){r.d(t,{RQ:()=>u,UI:()=>h,nm:()=>v});var i=r(32909),l=r(42642),s=r(63696),n=r(27875),a=r(30111);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,d={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},u={vulnerabilityStatus:{affected:(0,i._)({},d),fixed:(0,i._)({},d),not_affected:(0,i._)({},d),known_not_affected:(0,i._)({},d),under_investigation:(0,i._)({},d)}},c=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,s=e.find(e=>o(e,t));if(s)r=[...e.filter(e=>!o(e,s)),(0,l._)((0,i._)({},s),{relatedPackages:[...s.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let i={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),i]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,s=(0,n.U)(t.vulnerability.average_severity),a=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,l._)((0,i._)({},e.vulnerabilityStatus),{[r]:{total:a.total+1,severities:(0,l._)((0,i._)({},a.severities),{[s]:a.severities[s]+1})}})})},(0,i._)({},u));return{vulnerabilities:t,summary:r}},h=e=>{let{advisories:t,isFetching:r,fetchError:i}=(0,a.DH)(e);return{data:s.useMemo(()=>c(t||[]),[t]),isFetching:r,fetchError:i}},v=e=>{let{advisories:t,isFetching:r,fetchError:i}=(0,a.zY)(e);return{data:s.useMemo(()=>(null!=t?t:[]).map(e=>c(e||[])),[t]),isFetching:r,fetchError:i}}},82268:function(e,t,r){r.r(t),r.d(t,{default:()=>ek});var i=r(62540),l=r(63696),s=r(74343),n=r(22249),a=r(68430),o=r(98261),d=r(75530),u=r(42957),c=r(54518),h=r(48281),v=r(90717),y=r(96526),p=r(52993),f=r(84818),b=r(48655),m=r(92411),x=r(97517),j=r(62634),g=r(15153);let _=e=>{var{children:t,className:r}=e,l=(0,x.__rest)(e,["children","className"]);return(0,i.jsx)("div",Object.assign({className:(0,j.A)(g.A.emptyStateFooter,r)},l,{children:t}))};_.displayName="EmptyStateFooter";let S=e=>{var{children:t,className:r}=e,l=(0,x.__rest)(e,["children","className"]);return(0,i.jsx)("div",Object.assign({className:(0,j.A)(g.A.emptyStateActions,r)},l,{children:t}))};S.displayName="EmptyStateActions";var w=r(24773),T=r(38927),k=r(80057),E=r(13021),A=r(97346),O=r(93302);let q=(0,r(32791).w)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0,svgClassName:void 0});var F=r(60087),C=r(55092),R=r(62603),K=r(81895),M=r(93531),P=r(52362),I=r(72775),Q=r(56129),U=r(50501),N=r(94279),z=r(16172),D=r(84608);let B=e=>{let{uploads:t,handleUpload:r,handleRemoveUpload:s,handleCancelUpload:n}=e,{rejectedFiles:a,setRejectedFiles:o,handleFileDrop:d,handleDropRejected:u,removeFiles:c}=(e=>{let{uploads:t,handleUpload:r,handleRemoveUpload:i}=e,[s,n]=l.useState(!1),[a,o]=l.useState("inProgress"),[d,u]=l.useState([]);return!s&&t.size>0&&n(!0),l.useEffect(()=>{let e=Array.from(t.values());e.some(e=>"inProgress"===e.status)?o("inProgress"):e.every(e=>"complete"===e.status)?o("success"):o("danger")},[t]),{showStatus:s,status:a,rejectedFiles:d,setRejectedFiles:u,handleFileDrop:(e,t)=>{r(t)},handleDropRejected:e=>{u(e)},successFileCount:Array.from(t.values()).filter(e=>e.response).length,removeFiles:e=>{for(let t of e)i(t)}}})({uploads:t,handleUpload:r,handleRemoveUpload:s});return(0,i.jsxs)(I.w,{onFileDrop:d,dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:u,useFsAccessApi:!1,multiple:!1,disabled:t.size>0},children:[0===t.size?(0,i.jsx)(Q.x,{titleIcon:(0,i.jsx)(D.Ay,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2",browseButtonText:"Browse Files"}):Array.from(t.entries()).map((e,t)=>{let[r,l]=e;if(l.error){var s,a,o;return l.wasCancelled?(0,i.jsxs)(b.pp,{status:"danger",headingLevel:"h4",titleText:"Upload cancelled",icon:F.Ay,variant:b.s$.sm,children:[(0,i.jsx)(m.h,{children:"The file could not be analyzed. The operation was cancelled."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(w.$n,{variant:"primary",onClick:()=>c([r]),children:"Try another file"})})})]},"".concat(r.name,"-").concat(t,"-cancelled")):(console.log(l.error),(0,i.jsxs)(b.pp,{status:"danger",headingLevel:"h4",titleText:"Error ".concat(null!=(o=l.error.status)?o:l.error.code,": Upload failed"),icon:F.Ay,variant:b.s$.sm,children:[(0,i.jsxs)(m.h,{children:["The file could not be analyzed. The file might be corrupted or an unsupported format.",(null==(s=l.error.response)?void 0:s.data.message)&&(0,i.jsx)(U.Q,{toggleText:"Show details",children:null==(a=l.error.response)?void 0:a.data.message})]}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(w.$n,{variant:"primary",onClick:()=>c([r]),children:"Try another file"})})})]},"".concat(r.name,"-").concat(t,"-error")))}return(0,i.jsxs)(b.pp,{headingLevel:"h4",titleText:"Uploading SBOM ".concat(l.progress,"%"),icon:C.Ay,variant:b.s$.sm,children:[(0,i.jsx)(m.h,{children:"Securely uploading your SBOM for analysis. The file will not be saved."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(w.$n,{variant:"link",onClick:()=>n(r),children:"Cancel upload"})})})]},"".concat(r.name,"-").concat(t,"-progress"))}),(0,i.jsxs)(T.a,{isOpen:a.length>0,"aria-label":"rejected files",onClose:()=>o([]),variant:"small",children:[(0,i.jsx)(k.r,{title:"Rejected files",titleIconVariant:"warning"}),(0,i.jsx)(E.c,{children:(0,i.jsx)(N.B8,{children:a.map(e=>(0,i.jsx)(z.c,{children:e.file.name},e.file.name))})})]})]})};var L=r(32909),V=r(42642),$=r(95285),J=r.n($),H=r(61360),G=r(35048),Y=r(32490),Z=r(23546),W=r(28338),X=r(70045),ee=r(26917),et=r(16646),er=r(21758),ei=r(40384),el=r(28516),es=r(78517),en=r(59771),ea=r(38139),eo=r(81592),ed=r(85790),eu=r(45969),ec=r(93826),eh=r(30448),ev=r(20311),ey=r(64377),ep=r(19595),ef=r(73470),eb=r(21328),em=r(23909);let ex=e=>{var t;return null!=(t=e.labels.importer)?t:"Unknown"},ej=e=>{let t=e.replace(/"/g,'""');return/[",\r\n]/.test(t)&&(t='"'.concat(t,'"')),t},eg=e=>{let{vulnerabilities:t,isFetching:r,fetchError:n}=e,a=l.useMemo(()=>t.flatMap(e=>Array.from(e.advisories.values())).reduce((e,t)=>{let r=ex(t.advisory);return e.add(r),e},new Set),[t]),o=(0,eb.f)(t,e=>"".concat(e.vulnerability.identifier,"-").concat(e.status)),d=(0,ef.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:o,isLoading:r,columnNames:{vulnerabilityId:"Vulnerability ID",description:"Description",severity:"Severity",status:"Status",affectedPackages:"Affected packages",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["vulnerabilityId","affectedPackages","published","updated"],getSortValues:e=>{var t,r;return{vulnerabilityId:e.vulnerability.identifier,affectedPackages:e.purls.size,published:(null==(t=e.vulnerability)?void 0:t.published)?J()(e.vulnerability.published).valueOf():0,updated:(null==(r=e.vulnerability)?void 0:r.modified)?J()(e.vulnerability.modified).valueOf():0}},isFilterEnabled:!0,filterCategories:[{categoryKey:"vulnerabilityId",title:"Vulnerability ID",type:"search",placeholderText:"Search by Vulnerability ID",getItemValue:e=>e.vulnerability.identifier},{categoryKey:"importer",title:"Importer",type:"multiselect",placeholderText:"Importer",selectOptions:Array.from(a).map(e=>({value:e,label:e})),matcher:(e,t)=>!!Array.from(t.advisories.values()).map(e=>{let{advisory:t}=e;return ex(t)}).find(t=>t===e)},{categoryKey:"status",title:"Status",type:"multiselect",placeholderText:"Status",selectOptions:[{value:"affected",label:"Affected"},{value:"under_investigation",label:"Under investigation"},{value:"known_not_affected",label:"Known not affected"},{value:"not_affected",label:"Not affected"},{value:"fixed",label:"Fixed"}],matcher:(e,t)=>e===t.status},{categoryKey:"severity",title:"Severity",placeholderText:"Severity",type:"multiselect",selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}],matcher:(e,t)=>!!Array.from(t.advisories.values()).map(e=>{let{opinionatedExtendedSeverity:t}=e;return t}).find(t=>t===e)}],initialFilterValues:{status:["affected"]},isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:c,propHelpers:{toolbarProps:h,paginationToolbarItemProps:v,paginationProps:y,tableProps:p,filterToolbarProps:f,getThProps:b,getTrProps:m,getTdProps:x,getExpandedContentTdProps:j},expansionDerivedState:{isCellExpanded:g},filterState:{filterValues:_}}=d;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H.M,(0,V._)((0,L._)({},h),{children:(0,i.jsxs)(G.P,{children:[(0,i.jsx)(eo.Us,(0,L._)({},f)),(0,i.jsx)(Y.T,(0,V._)((0,L._)({},v),{children:(0,i.jsx)(ec.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:y})}))]})})),(0,i.jsxs)(ee.X,(0,V._)((0,L._)({},p),{"aria-label":"Vulnerability table",children:[(0,i.jsx)(et.d,{children:(0,i.jsx)(er.Tr,{children:(0,i.jsxs)(eh.Ze,(0,V._)((0,L._)({},d),{children:[(0,i.jsx)(ei.Th,(0,L._)({},b({columnKey:"vulnerabilityId"}))),(0,i.jsx)(ei.Th,(0,L._)({},b({columnKey:"description"}))),(0,i.jsx)(ei.Th,(0,L._)({},b({columnKey:"severity"}))),(0,i.jsx)(ei.Th,(0,L._)({},b({columnKey:"status"}))),(0,i.jsx)(ei.Th,(0,L._)({},b({columnKey:"affectedPackages"}))),(0,i.jsx)(ei.Th,(0,V._)((0,L._)({},b({columnKey:"published"})),{info:{tooltip:"The date when information about this vulnerability was first made available."}})),(0,i.jsx)(ei.Th,(0,V._)((0,L._)({},b({columnKey:"updated"})),{info:{tooltip:"The date when information about this vulnerability was most recently revised."}}))]}))})}),(0,i.jsx)(eh.nJ,{isLoading:r,isError:!!n,isNoData:0===o.length,numRenderedColumns:c,children:null==u?void 0:u.map((e,t)=>{var r,l;return(0,i.jsxs)(el.N,{isExpanded:g(e),children:[(0,i.jsx)(er.Tr,(0,V._)((0,L._)({},m({item:e})),{children:(0,i.jsxs)(eh.Oi,(0,V._)((0,L._)({},d),{item:e,rowIndex:t,children:[(0,i.jsx)(es.Td,(0,V._)((0,L._)({width:15,modifier:"breakWord"},x({columnKey:"vulnerabilityId"})),{children:(0,i.jsx)(s.N_,{to:(0,s.tW)(P.Jh.vulnerabilityDetails,{vulnerabilityId:e.vulnerability.identifier}),children:e.vulnerability.identifier})})),(0,i.jsx)(ev.R,{children:(t,r)=>(0,i.jsx)(es.Td,(0,V._)((0,L._)({width:25,modifier:"truncate",onFocus:()=>r(!0),onBlur:()=>r(!1),tabIndex:0},x({columnKey:"description"})),{children:(0,i.jsx)(en.mA,{focused:t,wrapModifier:"truncate",children:e.vulnerability&&(0,i.jsx)(ey.j,{vulnerability:e.vulnerability})})}))}),(0,i.jsx)(es.Td,(0,V._)((0,L._)({width:20,modifier:"breakWord"},x({columnKey:"severity"})),{children:(0,i.jsx)(Z.o,{isVertical:!0,children:Array.from(e.advisories.entries()).filter(e=>{let[t,r]=e;return!_.importer||0===_.importer.length||-1!==_.importer.indexOf(ex(r.advisory))}).map(e=>{var t,r;let[l,s]=e;return(0,i.jsxs)(W.s,{children:[(0,i.jsx)(X.Z,{spacer:{default:"spacerNone"},children:(0,i.jsx)(eu.h,{value:s.opinionatedExtendedSeverity,score:null!=(r=null==(t=s.opinionatedScore)?void 0:t.value)?r:null,showLabel:!0,showScore:!0})}),(0,i.jsxs)(X.Z,{children:[":"," ",ex(s.advisory)]})]},l)})})})),(0,i.jsx)(es.Td,(0,V._)((0,L._)({width:10,modifier:"truncate"},x({columnKey:"status"})),{children:(0,i.jsx)(ep.F,{value:e.status})})),(0,i.jsx)(es.Td,(0,V._)((0,L._)({width:10,modifier:"truncate"},x({columnKey:"affectedPackages",isCompoundExpandToggle:!0,item:e,rowIndex:t})),{children:e.purls.size})),(0,i.jsx)(es.Td,(0,V._)((0,L._)({width:10,modifier:"truncate"},x({columnKey:"published"})),{children:(0,em.Yq)(null==(r=e.vulnerability)?void 0:r.published)})),(0,i.jsx)(es.Td,(0,V._)((0,L._)({width:10,modifier:"truncate"},x({columnKey:"updated"})),{children:(0,em.Yq)(null==(l=e.vulnerability)?void 0:l.modified)}))]}))})),g(e)?(0,i.jsx)(er.Tr,{isExpanded:!0,children:(0,i.jsx)(es.Td,(0,V._)((0,L._)({},j({item:e})),{children:(0,i.jsxs)(ea.g,{children:[g(e,"severity")?(0,i.jsx)(N.B8,{isPlain:!0,children:Array.from(e.advisories.values()).map(e=>(0,i.jsx)(z.c,{children:e.advisory.identifier},"".concat(e.advisory.identifier)))}):null,g(e,"affectedPackages")?(0,i.jsxs)(ee.X,{variant:"compact",children:[(0,i.jsx)(et.d,{children:(0,i.jsxs)(er.Tr,{children:[(0,i.jsx)(ei.Th,{children:"Type"}),(0,i.jsx)(ei.Th,{children:"Namespace"}),(0,i.jsx)(ei.Th,{children:"Name"}),(0,i.jsx)(ei.Th,{children:"Version"}),(0,i.jsx)(ei.Th,{children:"Path"}),(0,i.jsx)(ei.Th,{children:"Qualifiers"})]})}),(0,i.jsx)(el.N,{children:Array.from(e.purls.values()).map(e=>{let t=(0,em.fe)(e);return t?(0,i.jsxs)(er.Tr,{children:[(0,i.jsx)(es.Td,{children:null==t?void 0:t.type}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.namespace}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.name}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.version}),(0,i.jsx)(es.Td,{children:null==t?void 0:t.path}),(0,i.jsx)(es.Td,{children:(null==t?void 0:t.qualifiers)&&(0,i.jsx)(ed.a,{value:null==t?void 0:t.qualifiers})})]},e):(0,i.jsx)(er.Tr,{children:(0,i.jsx)(es.Td,{colSpan:6,children:e})},e)})})]}):null]})}))}):null]},e._ui_unique_id)})})]})),(0,i.jsx)(ec.n,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:y})]})};var e_=r(71284),eS=r(27875),ew=r(3652),eT=r(31903);let ek=()=>{var e;let t,[r,x]=(0,l.useState)(!1),j=()=>{x(!r)},[g,I]=(0,l.useState)(null),{uploads:Q,handleUpload:U,handleCancelUpload:N,handleRemoveUpload:z}=(e=(e,t)=>{I(e)},t=(0,R.jE)(),(0,M.v)({parallel:!0,uploadFn:(e,t)=>(0,K.SP)(e,t),onSuccess:async(r,i)=>{e(r.data,i),await t.invalidateQueries({queryKey:["sbom-analysis"]})}})),D=l.useMemo(()=>Array.from(Q.keys()).map(e=>e.name).join("_"),[Q]),$=l.useCallback(e=>{let{currentLocation:t,nextLocation:r}=e;return null!==g&&t.pathname!==r.pathname},[g]),J=(0,s.KP)($),{data:{vulnerabilities:H},isFetching:G,fetchError:Y}=(e=>{let{analysisResponse:t,isFetching:r,fetchError:i}=(0,eT.Bi)(e);return{data:l.useMemo(()=>{if(r||i||0===Object.keys(t).length)return{summary:(0,L._)({},ew.RQ),vulnerabilities:[]};let e=Object.entries(t).flatMap(e=>{let[t,r]=e;return r.details.flatMap(e=>Object.entries(e.status).flatMap(r=>{let[i,l]=r;return l.map(r=>({purl:t,vulnerability:e,status:i,advisory:r,scores:r.scores}))}))}).reduce((e,t)=>{let r,i=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.status===t.status,l=e.find(e=>i(e,t));if(l){var s,n,a,o;let d=e.filter(e=>!i(e,l)),u=(0,e_.xh)(t.scores),c=(0,eS.U)(null==u?void 0:u.severity),h=new Map(l.advisories);h.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedScore:u,opinionatedExtendedSeverity:c});let v=new Set(l.purls);v.add(t.purl);let y=null,p=null;if((null==(s=l.opinionatedAvisory.score)?void 0:s.type)!==(null==u?void 0:u.type)){let e=[{advisory:l.opinionatedAvisory.advisory,score:l.opinionatedAvisory.score},{advisory:t.advisory,score:u}].sort((0,e_.hs)(e=>{var t,r;return null!=(r=null==(t=e.score)?void 0:t.type)?r:null}))[0];y=e.advisory,p=e.score}else{let{advisory:e,score:r}=(null!=(a=null==u?void 0:u.value)?a:0)>(null!=(o=null==(n=l.opinionatedAvisory.score)?void 0:n.value)?o:0)?{score:u,advisory:t.advisory}:{score:l.opinionatedAvisory.score,advisory:l.opinionatedAvisory.advisory};y=e,p=r}let f=(0,eS.U)(null==p?void 0:p.severity);r=[...d,{vulnerability:l.vulnerability,status:l.status,advisories:h,purls:v,opinionatedAvisory:{advisory:y,score:p,extendedSeverity:f}}]}else{let i=(0,e_.xh)(t.scores),l=(0,eS.U)(null==i?void 0:i.severity),s=new Map;s.set(t.advisory.identifier,{advisory:t.advisory,scores:t.scores,opinionatedExtendedSeverity:l,opinionatedScore:i});let n=new Set;n.add(t.purl);let a={vulnerability:t.vulnerability,status:t.status,advisories:s,purls:n,opinionatedAvisory:{advisory:t.advisory,score:i,extendedSeverity:l}};r=[...e.slice(),a]}return r},[]),l=e.reduce((e,t)=>{let r=t.status,i=t.opinionatedAvisory.extendedSeverity,l=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,V._)((0,L._)({},e.vulnerabilityStatus),{[r]:{total:l.total+1,severities:(0,V._)((0,L._)({},l.severities),{[i]:l.severities[i]+1})}})})},(0,L._)({},ew.RQ));return{vulnerabilities:e,summary:l}},[t,r,i]),analysisResponse:t,isFetching:r,fetchError:i}})((0,l.useMemo)(()=>{var e;return Object.entries(null!=(e=null==g?void 0:g.packages)?e:{}).flatMap(e=>{let[t,{purls:r}]=e;return r})},[g])),Z=async()=>{let e=new Blob(["VulnerabilityID, Description, Severity, Severity score, Advisory, Status, Affected package, Published, Updated\n"+H.flatMap(e=>{let{advisories:t,purls:r,vulnerability:i,status:l}=e;return Array.from(t.values()).flatMap(e=>{let{opinionatedExtendedSeverity:t,opinionatedScore:s,advisory:n}=e;return Array.from(r).map(e=>{var r,a,o,d;return{vulnerabilityId:ej(i.identifier),description:ej(null!=(r=i.description)?r:""),severity:ej(t),severityScore:null!=(a=null==s?void 0:s.value)?a:"",advisory:ex(n),status:ej(l),affectedPackage:ej(e),published:ej(null!=(o=(0,em.Yq)(i.published))?o:""),updated:ej(null!=(d=(0,em.Yq)(i.modified))?d:"")}})})}).map(e=>Object.values(e).join(",")).join("\n")],{type:"text/csv;charset=utf-8"});(0,n.saveAs)(e,"".concat(D,".csv"))},W=()=>{for(let e of Q.keys())z(e);I(null)},X=null===g||G||Y||0===H.length;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.d8,{type:"breadcrumb",children:(0,i.jsxs)(o.Q,{children:[(0,i.jsx)(d.J,{children:(0,i.jsx)(s.N_,{to:P.Jh.sboms,children:"SBOMs"})}),X?(0,i.jsx)(d.J,{isActive:!0,children:"Generate vulnerability report"}):(0,i.jsx)(d.J,{isActive:!0,children:"Vulnerability report"})]})}),(0,i.jsx)(a.d8,{children:X?(0,i.jsxs)(u.U,{children:[(0,i.jsx)(u.U,{component:"h1",children:"Generate vulnerability report"}),(0,i.jsx)(u.U,{component:"p",children:"Select an SBOM file to generate a temporary vulnerability report. The file and report will not be saved."})]}):(0,i.jsxs)(c.B,{children:[(0,i.jsx)(h.o,{isFilled:!0,children:(0,i.jsxs)(u.U,{children:[(0,i.jsx)(u.U,{component:"h1",children:"Vulnerability report"}),(0,i.jsx)(u.U,{component:"p",children:"This is a temporary vulnerability report."})]})}),(0,i.jsx)(h.o,{children:(0,i.jsxs)(v.m,{isOpen:r,onSelect:()=>x(!1),onOpenChange:e=>x(e),popperProps:{position:"right"},toggle:e=>(0,i.jsx)(y.S3,{ref:e,onClick:j,isExpanded:r,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:[(0,i.jsx)(p.Q,{children:(0,i.jsx)(f.t,{onClick:W,children:"Generate new report"},"scan-another")}),(0,i.jsx)(p.Q,{children:(0,i.jsx)(f.t,{onClick:Z,children:"Download CSV"},"download-report")})]})})]})}),(0,i.jsx)(a.d8,{children:null===g?(0,i.jsx)(B,{uploads:Q,handleUpload:U,handleRemoveUpload:z,handleCancelUpload:N}):G?(0,i.jsxs)(b.pp,{titleText:"Generating SBOM report",headingLevel:"h4",icon:C.Ay,children:[(0,i.jsx)(m.h,{children:"Analyzing your SBOM for security vulnerabilities, license issues and dependency details."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(w.$n,{variant:"link",onClick:W,children:"Cancel scan"})})})]}):Y?(0,i.jsxs)(b.pp,{status:"danger",headingLevel:"h4",titleText:"Scan failed",icon:F.Ay,variant:b.s$.sm,children:[(0,i.jsx)(m.h,{children:"The file could not be analyzed. The file might be corrupted or an unsupported format."}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(w.$n,{variant:"primary",onClick:W,children:"Try another file"})})})]}):0===H.length?(0,i.jsxs)(b.pp,{status:"success",headingLevel:"h4",titleText:"No vulnerabilities found",icon:O.Ay,variant:b.s$.sm,children:[(0,i.jsxs)(m.h,{children:["The ",D," was successfully analyzed and found no vulnerabilities to report."]}),(0,i.jsx)(_,{children:(0,i.jsx)(S,{children:(0,i.jsx)(w.$n,{variant:"primary",onClick:W,children:"Try another file"})})})]}):(0,i.jsx)(eg,{vulnerabilities:H,isFetching:G,fetchError:Y})}),(0,i.jsxs)(T.a,{variant:"small",isOpen:"blocked"===J.state,onClose:()=>"blocked"===J.state&&J.reset(),children:[(0,i.jsx)(k.r,{title:"Leave Vulnerability report?"}),(0,i.jsx)(E.c,{children:"This report is not saved and will be unavailable after leaving this page. To save the report, download it."}),(0,i.jsxs)(A.j,{children:[(0,i.jsx)(w.$n,{variant:"primary",icon:(0,i.jsx)(q,{}),onClick:async()=>{await Z(),"blocked"===J.state&&J.proceed()},children:"Download and leave"}),(0,i.jsx)(w.$n,{variant:"secondary",onClick:async()=>{"blocked"===J.state&&J.proceed()},children:"Leave without downloading"}),(0,i.jsx)(w.$n,{variant:"link",onClick:()=>{"blocked"===J.state&&J.reset()},children:"Cancel"},"cancel")]})]})]})}},30111:function(e,t,r){r.d(t,{DH:()=>w,Qr:()=>S,_P:()=>b,bj:()=>k,cF:()=>_,i$:()=>m,l6:()=>j,rj:()=>x,sn:()=>g,zY:()=>T});var i=r(32909),l=r(42642),s=r(72610),n=r(77184),a=r(59722),o=r(62603),d=r(90130),u=r(3822),c=r(96002),h=r(86141),v=r(93531),y=r(81895),p=r(73470);let f="sboms",b=e=>{let{data:t,isLoading:r,error:i,refetch:l}=(0,n.I)({queryKey:[f,"labels",e],queryFn:()=>(0,h.Dw)({client:c.S,query:{limit:10,filter_text:e}}),placeholderData:a.rX});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i,refetch:l}},m=function(){var e,t,r;let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,p.kd)(a),{q:v}=u,y=(0,s._)(u,["q"]),b=(0,p.Er)(o),{data:m,isLoading:x,error:j,refetch:g}=(0,n.I)({queryKey:[f,a,b],queryFn:()=>(0,h.z1)({client:c.S,query:(0,l._)((0,i._)({},y),{q:[v,b].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(r=null==m||null==(t=m.data)?void 0:t.total)?r:0,params:a},isFetching:x,fetchError:j,refetch:g}},x=(e,t,r)=>{let{data:i,isLoading:l,error:s}=(0,n.I)({queryKey:[f,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h.a7)({client:c.S,path:{id:e}}),enabled:!!e,refetchInterval:t,retry:r});return{sbom:null==i?void 0:i.data,isFetching:l,fetchError:s}},j=(e,t)=>{let r=(0,o.jE)();return(0,d.n)({mutationFn:async e=>(await (0,h.bS)({client:c.S,path:{id:e}})).data,onSuccess:async(t,i)=>{e(t,i),await r.invalidateQueries({queryKey:[f]}),r.removeQueries({queryKey:[f,i]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[f]})}})},g=()=>{let e=(0,o.jE)();return(0,v.v)({parallel:!0,uploadFn:(e,t)=>(0,y.J4)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[f]})}})},_=(e,t)=>{let r=(0,o.jE)();return(0,d.n)({mutationFn:e=>(0,h.aB)({client:c.S,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[f]})},onError:t})},S=function(e){var t,r,l;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:a,isLoading:o,error:d,refetch:u}=(0,n.I)({queryKey:[f,"by-package",e,s],queryFn:()=>(0,h.m9)({client:c.S,query:(0,i._)({purl:e},(0,p.kd)(s))})});return{result:{data:(null==a||null==(t=a.data)?void 0:t.items)||[],total:null!=(l=null==a||null==(r=a.data)?void 0:r.total)?l:0,params:s},isFetching:o,fetchError:d,refetch:u}},w=e=>{let{data:t,isLoading:r,error:i}=(0,n.I)({queryKey:[f,e,"advisory"],queryFn:()=>(0,h.bj)({client:c.S,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i}},T=e=>{let t=(0,u.E)({queries:e.map(e=>({queryKey:[f,e,"advisory"],queryFn:()=>(0,h.bj)({client:c.S,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},k=e=>{let{data:t,isLoading:r,error:i}=(0,n.I)({queryKey:[f,e,"license-ids"],queryFn:()=>(0,h.ZV)({client:c.S,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:i}}},31903:function(e,t,r){r.d(t,{Bi:()=>c,WJ:()=>u,uN:()=>h});var i=r(32909),l=r(77184),s=r(3822),n=r(96002),a=r(86141),o=r(73470);let d="vulnerabilities",u=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:c,isLoading:h,error:v,refetch:y}=(0,l.I)({queryKey:[d,s],queryFn:()=>(0,a.NI)({client:n.S,query:(0,i._)({},(0,o.kd)(s))}),enabled:!u});return{result:{data:(null==c||null==(e=c.data)?void 0:e.items)||[],total:null!=(r=null==c||null==(t=c.data)?void 0:t.total)?r:0,params:s},isFetching:h,fetchError:v,refetch:y}},c=e=>{var t;let r={ids:e.reduce((e,t,r)=>(r%100==0?e.push([t]):e[e.length-1].push(t),e),[]),dataResolver:async e=>(await (0,a.ns)({client:n.S,body:{purls:e}})).data},i=(0,s.E)({queries:r.ids.map(e=>({queryKey:[d,e],queryFn:()=>r.dataResolver(e),retry:!1}))}),l=i.some(e=>{let{isLoading:t}=e;return t}),o=i.find(e=>{let{error:t}=e;return!!t}),u={};if(!l)for(let e of i.map(e=>{var t;return null!=(t=null==e?void 0:e.data)?t:{}}))for(let[t,r]of Object.entries(e))u[t]=r;return{analysisResponse:u,isFetching:l,fetchError:null!=(t=null==o?void 0:o.error)?t:void 0}},h=e=>{let{data:t,isLoading:r,error:i}=(0,l.I)({queryKey:[d,e],queryFn:()=>(0,a.dZ)({client:n.S,path:{id:e}})});return{vulnerability:null==t?void 0:t.data,isFetching:r,fetchError:i}}},21328:function(e,t,r){r.d(t,{f:()=>a});var i=r(32909),l=r(42642),s=r(63696),n=r(98259);let a=(e,t)=>(0,s.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,l._)((0,i._)({},e),{[n.FA]:t(e)})):[],[e,t])},3822:function(e,t,r){r.d(t,{E:()=>p});var i=r(63696),l=r(72739),s=r(97221),n=r(42122),a=r(59722);function o(e,t){let r=new Set(t);return e.filter(e=>!r.has(e))}var d=class extends n.Q{#e;#t;#r;#i;#l;#s;#n;#a;#o=[];constructor(e,t,r){super(),this.#e=e,this.#i=r,this.#r=[],this.#l=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#l.forEach(e=>{e.subscribe(t=>{this.#d(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#l.forEach(e=>{e.destroy()})}setQueries(e,t){this.#r=e,this.#i=t,l.jG.batch(()=>{let e=this.#l,t=this.#u(this.#r);this.#o=t,t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let r=t.map(e=>e.observer),i=r.map(e=>e.getCurrentResult()),l=r.some((t,r)=>t!==e[r]);e.length===r.length&&!l||(this.#l=r,this.#t=i,this.hasListeners()&&(o(e,r).forEach(e=>{e.destroy()}),o(r,e).forEach(e=>{e.subscribe(t=>{this.#d(e,t)})}),this.#c()))})}getCurrentResult(){return this.#t}getQueries(){return this.#l.map(e=>e.getCurrentQuery())}getObservers(){return this.#l}getOptimisticResult(e,t){let r=this.#u(e),i=r.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[i,e=>this.#h(e??i,t),()=>this.#v(i,r)]}#v(e,t){return t.map((r,i)=>{let l=e[i];return r.defaultedQueryOptions.notifyOnChangeProps?l:r.observer.trackResult(l,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#h(e,t){return t?(this.#s&&this.#t===this.#a&&t===this.#n||(this.#n=t,this.#a=this.#t,this.#s=(0,a.BH)(this.#s,t(e))),this.#s):e}#u(e){let t=new Map(this.#l.map(e=>[e.options.queryHash,e])),r=[];return e.forEach(e=>{let i=this.#e.defaultQueryOptions(e),l=t.get(i.queryHash);l?r.push({defaultedQueryOptions:i,observer:l}):r.push({defaultedQueryOptions:i,observer:new s.$(this.#e,i)})}),r}#d(e,t){let r=this.#l.indexOf(e);if(-1!==r){var i;let e;this.#t=(i=this.#t,(e=i.slice(0))[r]=t,e),this.#c()}}#c(){if(this.hasListeners()){let e=this.#s,t=this.#v(this.#t,this.#o);e!==this.#h(t,this.#i?.combine)&&l.jG.batch(()=>{this.listeners.forEach(e=>{e(this.#t)})})}}},u=r(62603),c=r(57321),h=r(15818),v=r(81796),y=r(39481);function p({queries:e,...t},r){let n=(0,u.jE)(r),o=(0,c.w)(),p=(0,h.h)(),f=i.useMemo(()=>e.map(e=>{let t=n.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,n,o]);f.forEach(e=>{(0,y.jv)(e),(0,v.LJ)(e,p)}),(0,v.wZ)(p);let[b]=i.useState(()=>new d(n,f,t)),[m,x,j]=b.getOptimisticResult(f,t.combine),g=!o&&!1!==t.subscribed;i.useSyncExternalStore(i.useCallback(e=>g?b.subscribe(l.jG.batchCalls(e)):a.lQ,[b,g]),()=>b.getCurrentResult(),()=>b.getCurrentResult()),i.useEffect(()=>{b.setQueries(f,t)},[f,t,b]);let _=m.some((e,t)=>(0,y.EU)(f[t],e))?m.flatMap((e,t)=>{let r=f[t];if(r){let t=new s.$(n,r);if((0,y.EU)(r,e))return(0,y.iL)(r,t,p);(0,y.nE)(e,o)&&(0,y.iL)(r,t,p)}return[]}):[];if(_.length>0)throw Promise.all(_);let S=m.find((e,t)=>{let r=f[t];return r&&(0,v.$1)({result:e,errorResetBoundary:p,throwOnError:r.throwOnError,query:n.getQueryCache().get(r.queryHash),suspense:r.suspense})});if(S?.error)throw S.error;return x(j())}}}]);