"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["573"],{81895:function(e,a,r){r.d(a,{J4:()=>u,SP:()=>h,Z3:()=>y,hP:()=>p});var t=r(32909),s=r(42642),l=r(46165),n=r(98259);r(56161);let o="/api",i="".concat(o,"/v2/advisory"),d="".concat(o,"/v2/sbom"),c=e=>{let a="application/json";return e.name.endsWith(".bz2")&&(a="application/json+bzip2"),a},p=(e,a)=>{let r=e.get(n.fs);return l.A.post("".concat(i),r,(0,s._)((0,t._)({},a),{headers:{"Content-Type":c(r)}}))},u=(e,a)=>{let r=e.get(n.fs);return l.A.post("".concat(d),r,(0,s._)((0,t._)({},a),{headers:{"Content-Type":c(r)}}))},h=(e,a)=>{let r=e.get(n.fs);return l.A.post("/api/v2/ui/extract-sbom-purls",r,(0,s._)((0,t._)({},a),{headers:{"Content-Type":c(r)}}))},y=e=>l.A.get("".concat(d,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},90165:function(e,a,r){r.d(a,{h:()=>j});var t=r(62540),s=r(63696),l=r(72775),n=r(56129),o=r(13767),i=r(8406),d=r(99205),c=r(16681),p=r(81595),u=r(38927),h=r(80057),y=r(13021),f=r(94279),v=r(16172),g=r(56279),x=r(84608);let j=e=>{let{uploads:a,handleUpload:r,handleRemoveUpload:j,extractSuccessMessage:m,extractErrorMessage:_}=e,[F,w]=s.useState(!1),[U,q]=s.useState("inProgress"),[b,A]=s.useState([]);!F&&a.size>0&&w(!0),s.useEffect(()=>{let e=Array.from(a.values());e.some(e=>"inProgress"===e.status)?q("inProgress"):e.every(e=>"complete"===e.status)?q("success"):q("danger")},[a]);let E=Array.from(a.values()).filter(e=>e.response).length;return(0,t.jsxs)(l.w,{onFileDrop:(e,a)=>{r(a)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{A(e)},useFsAccessApi:!1},children:[(0,t.jsx)(n.x,{titleIcon:(0,t.jsx)(x.Ay,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),F&&(0,t.jsx)(o.y,{statusToggleText:"".concat(E," of ").concat(a.size," files uploaded"),statusToggleIcon:U,children:Array.from(a.entries()).map((e,a)=>{let[r,s]=e;return(0,t.jsx)(i.L,{customFileHandler:()=>{},fileIcon:(0,t.jsx)(g.Ay,{}),file:r,onClearClick:()=>(e=>{for(let a of e)j(a)})([r]),progressValue:s.progress,progressVariant:s.error?"danger":s.response?"success":void 0,progressHelperText:s.error?(0,t.jsx)(d.E,{isLiveRegion:!0,children:(0,t.jsx)(c.j,{variant:"error",children:_(s.error)})}):100!==s.progress||s.response?s.response?(0,t.jsx)(d.E,{isLiveRegion:!0,children:(0,t.jsx)(c.j,{variant:"default",children:m(s.response)})}):void 0:(0,t.jsx)(d.E,{isLiveRegion:!0,children:(0,t.jsxs)(c.j,{variant:"warning",children:[(0,t.jsx)(p.y,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},"".concat(r.name,"-").concat(a))})}),(0,t.jsxs)(u.a,{isOpen:b.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>A([]),variant:"small",children:[(0,t.jsx)(h.r,{title:"Unsupported files",titleIconVariant:"warning"}),(0,t.jsx)(y.c,{children:(0,t.jsx)(f.B8,{children:b.map(e=>(0,t.jsx)(v.c,{children:e.file.name},e.file.name))})})]})]})}},93531:function(e,a,r){r.d(a,{v:()=>p});var t=r(32909),s=r(42642),l=r(63696),n=r(98259),o=r(46165);let i="cancelled",d=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,a)=>{switch(a.type){case"queueUpload":return(0,s._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,s._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{status:"queued",cancelFn:a.payload.cancelFn}))});case"updateUploadProgress":return(0,s._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,s._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{progress:a.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,s._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,s._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",response:a.payload.response}))});case"finishUploadWithError":var r;return(0,s._)((0,t._)({},e),{uploads:new Map(e.uploads).set(a.payload.file,(0,s._)((0,t._)({},e.uploads.get(a.payload.file)||d()),{status:"complete",error:a.payload.error,wasCancelled:(null==(r=a.payload.error)?void 0:r.message)===i}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(a.payload.file),(0,s._)((0,t._)({},e),{uploads:r})}default:throw Error()}},p=e=>{let{parallel:a,uploadFn:r,onSuccess:t,onError:s}=e,[d,p]=l.useReducer(c,{uploads:new Map});return{uploads:d.uploads,handleUpload:e=>{let l=[];for(let a=0;a<e.length;a++){let r=e[a],d=new FormData;d.set(n.fs,r);let c=o.A.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var a;let t=null!=(a=e.total)?a:1;p({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/t*100)}})},cancelToken:c.token};p({type:"queueUpload",payload:{file:r,cancelFn:c}});let h={formData:d,config:u,thenFn:e=>{p({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),t&&t(e,r)},catchFn:e=>{p({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==i&&s&&s(e,r)}};l.push(h)}if(a)for(let e of l)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else l.reduce(async(e,a)=>(await e,r(a.formData,a.config).then(a.thenFn).catch(a.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var a,r;null==(r=d.uploads.get(e))||null==(a=r.cancelFn)||a.cancel(i)},handleRemoveUpload:e=>{p({type:"removeUpload",payload:{file:e}})}}}},54006:function(e,a,r){r.r(a),r.d(a,{default:()=>u});var t=r(62540),s=r(74343),l=r(68430),n=r(98261),o=r(75530),i=r(42957),d=r(90165),c=r(99134),p=r(52362);let u=()=>{let{uploads:e,handleUpload:a,handleRemoveUpload:r}=(0,c.Yu)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.d8,{type:"breadcrumb",children:(0,t.jsxs)(n.Q,{children:[(0,t.jsx)(o.J,{children:(0,t.jsx)(s.N_,{to:p.Jh.advisories,children:"Advisories"})}),(0,t.jsx)(o.J,{isActive:!0,children:"Upload Advisory"})]})}),(0,t.jsx)(l.d8,{children:(0,t.jsxs)(i.U,{children:[(0,t.jsx)(i.U,{component:"h1",children:"Upload Advisory"}),(0,t.jsx)(i.U,{component:"p",children:"Upload a CSAF, CVE, or OSV Advisory."})]})}),(0,t.jsx)(l.d8,{children:(0,t.jsx)(d.h,{uploads:e,handleUpload:a,handleRemoveUpload:r,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var a;return(null==(a=e.response)?void 0:a.data)?e.message:"Error while uploading file"}})})]})}},99134:function(e,a,r){r.d(a,{VH:()=>g,Yu:()=>m,eq:()=>v,ni:()=>j,uJ:()=>_,vy:()=>x});var t=r(32909),s=r(42642),l=r(72610),n=r(77184),o=r(59722),i=r(62603),d=r(90130),c=r(96002),p=r(86141),u=r(81895),h=r(73470),y=r(93531);let f="advisories",v=e=>{let{data:a,isLoading:r,error:t,refetch:s}=(0,n.I)({queryKey:[f,"labels",e],queryFn:()=>(0,p.J)({client:c.S,query:{limit:10,filter_text:e}}),placeholderData:o.rX});return{labels:(null==a?void 0:a.data)||[],isFetching:r,fetchError:t,refetch:s}},g=function(){var e,a,r;let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,h.kd)(o),{q:y}=u,v=(0,l._)(u,["q"]),g=(0,h.Er)(i),{data:x,isLoading:j,error:m,refetch:_}=(0,n.I)({queryKey:[f,o,g],queryFn:()=>(0,p.YM)({client:c.S,query:(0,s._)((0,t._)({},v),{q:[y,g].filter(e=>e).join("&")})}),enabled:!d});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(a=x.data)?void 0:a.total)?r:0,params:o},isFetching:j,fetchError:m||null,refetch:_}},x=e=>{let{data:a,isLoading:r,error:t}=(0,n.I)({queryKey:[f,e],queryFn:()=>(0,p.ai)({client:c.S,path:{key:e}}),enabled:!!e});return{advisory:null==a?void 0:a.data,isFetching:r,fetchError:t}},j=(e,a)=>{let r=(0,i.jE)();return(0,d.n)({mutationFn:async e=>(await (0,p.vl)({client:c.S,path:{key:e}})).data,onSuccess:async(a,t)=>{e(a,t),await r.invalidateQueries({queryKey:[f]})},onError:async e=>{a(e),await r.invalidateQueries({queryKey:[f]})}})},m=()=>{let e=(0,i.jE)();return(0,y.v)({parallel:!0,uploadFn:(e,a)=>(0,u.hP)(e,a),onSuccess:async()=>{await e.invalidateQueries({queryKey:[f]})}})},_=(e,a)=>{let r=(0,i.jE)();return(0,d.n)({mutationFn:e=>(0,p._e)({client:c.S,path:{id:e.id},body:e.labels}),onSuccess:async(a,t)=>{e(),await r.invalidateQueries({queryKey:[f]})},onError:a})}}}]);