"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["665"],{69876:function(e,t,r){r.d(t,{D:()=>i});var l=r(24246),a=r(70400);let i=e=>{let{value:t}=e;return(0,l.jsx)(l.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,l.jsx)(a._,{isCompact:!0,children:`${t}=${r}`},`${t}=${r}`)})})}},57524:function(e,t,r){r.d(t,{o:()=>u});var l=r(24246),a=r(34747),i=r(46770),n=r(2499),s=r(35676),c=r(32947);let u=e=>{let{value:t,score:r,showScore:u,showLabel:d}=e,o=c.V4[t],h=o.name;return(0,l.jsxs)(a.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(i.B,{children:d?(0,l.jsx)(s.ZP,{color:o.color.value}):(0,l.jsx)(n.u,{content:h,children:(0,l.jsx)(s.ZP,{color:o.color.value})})}),d&&(0,l.jsx)(i.B,{children:h}),u&&null!==r&&(0,l.jsxs)(i.B,{children:["(",Math.round(10*r)/10,")"]})]})}},3804:function(e,t,r){r.d(t,{p:()=>i});var l=r(24246),a=r(27230);let i=e=>{let{paginationProps:t,isTop:r,isCompact:i=!1,idPrefix:n=""}=e;return(0,l.jsx)(a.t,{id:`${n?`${n}-`:""}pagination-${r?"top":"bottom"}`,variant:r?a.a.top:a.a.bottom,isCompact:i,...t,widgetId:"pagination-id"})}},42573:function(e,t,r){r.d(t,{C:()=>i});var l=r(24246),a=r(70400);let i=e=>{let{error:t}=e;return(0,l.jsxs)(a._,{color:"red",children:[t.status," Error"]})}},31336:function(e,t,r){r.d(t,{hp:()=>m,qK:()=>j,Cx:()=>y});var l=r(24246),a=r(8305),i=r(13754),n=r(31423),s=r(11165),c=r(94154),u=r(39826),d=r(10707),o=r(16668),h=r(22119);let p=e=>{let{title:t,description:r}=e;return(0,l.jsx)(d.ub,{titleText:t,headingLevel:"h4",icon:h.ZP,variant:d.IQ.sm,children:r&&(0,l.jsx)(o.B,{children:r})})},x=()=>(0,l.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),m=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:d=!1,isNoData:o=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:m}=e;return(0,l.jsx)(l.Fragment,{children:r?(0,l.jsx)(n.p,{children:(0,l.jsx)(s.Tr,{children:(0,l.jsx)(c.Td,{colSpan:t,children:(0,l.jsx)(a.b,{children:(0,l.jsx)(i.$,{size:"xl"})})})})}):d?(0,l.jsx)(n.p,{"aria-label":"Table error",children:(0,l.jsx)(s.Tr,{children:(0,l.jsx)(c.Td,{colSpan:t,children:(0,l.jsx)(a.b,{children:h||(0,l.jsx)(u.y,{})})})})}):o?(0,l.jsx)(n.p,{"aria-label":"Table error",children:(0,l.jsx)(s.Tr,{children:(0,l.jsx)(c.Td,{colSpan:t,children:(0,l.jsx)(a.b,{children:p||(0,l.jsx)(x,{})})})})}):m})};var v=r(89330);let j=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:a}=e;return(0,l.jsxs)(l.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,l.jsx)(v.Th,{screenReaderText:`before-data-${t}`},t)),a,Array(r).fill(null).map((e,t)=>(0,l.jsx)(v.Th,{screenReaderText:`after-data-${t}`},t))]})},y=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,isSelectionEnabled:a=!1,propHelpers:{getSingleExpandButtonTdProps:i,getSelectCheckboxTdProps:n},item:s,rowIndex:u,children:d}=e;return(0,l.jsxs)(l.Fragment,{children:[t&&"single"===r?(0,l.jsx)(c.Td,{...i({item:s,rowIndex:u})}):null,a?(0,l.jsx)(c.Td,{...n({item:s,rowIndex:u})}):null,d]})}},49304:function(e,t,r){r.d(t,{u:()=>d});var l=r(24246),a=r(34747),i=r(46770),n=r(25138),s=r(87445),c=r(32947),u=r(57524);let d=e=>{let{severities:t}=e,r=Object.values(t).reduce((e,t)=>e+t,0);return(0,l.jsxs)(a.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(i.B,{style:{minWidth:15,textAlign:s.F2},children:r}),(0,l.jsx)(n.i,{orientation:{default:"vertical"}}),(0,l.jsx)(i.B,{children:(0,l.jsx)(a.k,{children:Object.entries(t).filter(e=>{let[t,r]=e;return r>0}).sort((0,c.A0)(e=>{let[t,r]=e;return t})).reverse().map(e=>{let[t,r]=e;return(0,l.jsx)(i.B,{spacer:{default:"spacerXs"},children:(0,l.jsxs)(a.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(i.B,{children:(0,l.jsx)(u.o,{value:t,score:null})}),(0,l.jsx)(i.B,{children:r})]})},t)})})})]})}},31373:function(e,t,r){r.d(t,{H:()=>d});var l=r(27378),a=r(7615),i=r(59015);let n=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,s={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:{...s},fixed:{...s},not_affected:{...s},known_not_affected:{...s}}},u=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>{let r=(0,a.g)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r,average_score:t.average_score},vulnerabilityStatus:t.status,advisory:e}})).reduce((e,t)=>{let r,l=e.find(e=>n(e,t));if(l)r=[...e.filter(e=>!n(e,l)),{...l,relatedSboms:[...l.relatedSboms,{advisory:t.advisory}]}];else{let l={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),l]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,l=t.vulnerability.average_severity,a=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:a.total+1,severities:{...a.severities,[l]:a.severities[l]+1}}}})},{...c});return{vulnerabilities:t,summary:r}},d=e=>{let{pkg:t,isFetching:r,fetchError:a}=(0,i.ZA)(e);return{data:l.useMemo(()=>u(t?.advisories||[]),[t]),isFetching:r,fetchError:a}}},33384:function(e,t,r){r.d(t,{a:()=>o,u:()=>h});var l=r(24246),a=r(27378),i=r(74502),n=r(72603),s=r(47169),c=r(22048),u=r(59015),d=r(63706);let o=a.createContext({}),h=e=>{let{children:t}=e,r=(0,s.vZ)({tableName:"packages",persistenceKeyPrefix:i.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:i.L4,title:"Filter text",placeholderText:"Search",type:n.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:n.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:n.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:h,total:p},isFetching:x,fetchError:m}=(0,u.fF)((0,s.QO)({...r,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),v=a.useMemo(()=>h.map(e=>({...e,decomposedPurl:(0,d.qX)(e.purl)})),[h]),j=(0,s.KC)({...r,idProperty:"uuid",currentPageItems:v,totalItemCount:p,isLoading:x,selectionState:(0,c.U)({items:v,isEqual:(e,t)=>e.uuid===t.uuid})});return(0,l.jsx)(o.Provider,{value:{totalItemCount:p,isFetching:x,fetchError:m,tableControls:j},children:t})}},88466:function(e,t,r){r.d(t,{L:()=>T});var l=r(24246),a=r(27378),i=r(65783),n=r(4835),s=r(14350),c=r(11165),u=r(89330),d=r(31423),o=r(94154),h=r(69876),p=r(3804),x=r(31336),m=r(11797),v=r(37818),j=r(42573),y=r(49304),f=r(31373);let b=e=>{let{packageId:t}=e,{data:r,isFetching:a,fetchError:i}=(0,f.H)(t);return(0,l.jsx)(v.u,{isFetching:a,fetchError:i,isFetchingState:(0,l.jsx)(m.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,l.jsx)(j.C,{error:e}),children:(0,l.jsx)(y.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})};var g=r(33384);let T=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:m}=a.useContext(g.a),{numRenderedColumns:v,currentPageItems:j,propHelpers:{paginationProps:y,tableProps:f,getThProps:T,getTrProps:P,getTdProps:S}}=m;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.i,{...f,"aria-label":"Package table",children:[(0,l.jsx)(s.h,{children:(0,l.jsx)(c.Tr,{children:(0,l.jsxs)(x.qK,{...m,children:[(0,l.jsx)(u.Th,{...T({columnKey:"name"})}),(0,l.jsx)(u.Th,{...T({columnKey:"namespace"})}),(0,l.jsx)(u.Th,{...T({columnKey:"version"})}),(0,l.jsx)(u.Th,{...T({columnKey:"type"})}),(0,l.jsx)(u.Th,{...T({columnKey:"path"})}),(0,l.jsx)(u.Th,{...T({columnKey:"qualifiers"})}),(0,l.jsx)(u.Th,{...T({columnKey:"vulnerabilities"})})]})})}),(0,l.jsx)(x.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:v,children:j.map((e,t)=>(0,l.jsx)(d.p,{children:(0,l.jsx)(c.Tr,{...P({item:e}),children:(0,l.jsxs)(x.Cx,{...m,item:e,rowIndex:t,children:[(0,l.jsx)(o.Td,{width:15,modifier:"breakWord",...S({columnKey:"name"}),children:(0,l.jsx)(i.OL,{to:`/packages/${e.uuid}`,children:e.decomposedPurl?e.decomposedPurl?.name:e.purl})}),(0,l.jsx)(o.Td,{width:15,modifier:"truncate",...S({columnKey:"namespace"}),children:e.decomposedPurl?.namespace}),(0,l.jsx)(o.Td,{width:10,modifier:"truncate",...S({columnKey:"version"}),children:e.decomposedPurl?.version}),(0,l.jsx)(o.Td,{width:10,modifier:"truncate",...S({columnKey:"type"}),children:e.decomposedPurl?.type}),(0,l.jsx)(o.Td,{width:10,modifier:"truncate",...S({columnKey:"path"}),children:e.decomposedPurl?.path}),(0,l.jsx)(o.Td,{width:20,...S({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&(0,l.jsx)(h.D,{value:e.decomposedPurl?.qualifiers})}),(0,l.jsx)(o.Td,{width:20,...S({columnKey:"vulnerabilities"}),children:(0,l.jsx)(b,{packageId:e.uuid})})]})})},e.uuid))})]}),(0,l.jsx)(p.p,{idPrefix:"package-table",isTop:!1,paginationProps:y})]})}},39305:function(e,t,r){r.d(t,{v:()=>o});var l=r(24246),a=r(27378),i=r(70715),n=r(40982),s=r(89226),c=r(72603),u=r(3804),d=r(33384);let o=e=>{let{showFilters:t}=e,{tableControls:r}=a.useContext(d.a),{propHelpers:{toolbarProps:o,filterToolbarProps:h,paginationToolbarItemProps:p,paginationProps:x}}=r;return(0,l.jsx)(i.o,{...o,children:(0,l.jsxs)(n.c,{children:[t&&(0,l.jsx)(c.Ki,{...h}),(0,l.jsx)(s.E,{...p,children:(0,l.jsx)(u.p,{idPrefix:"package-table",isTop:!0,paginationProps:x})})]})})}},59015:function(e,t,r){r.d(t,{D4:()=>d,ZA:()=>u,fF:()=>c});var l=r(1183),a=r(50576),i=r(40371),n=r(47169);let s="packages",c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:c,error:u,refetch:d}=(0,l.a)({queryKey:[s,e],queryFn:()=>(0,i.tj)({client:a.L,query:{...(0,n.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:c,fetchError:u,refetch:d}},u=e=>{let{data:t,isLoading:r,error:n}=(0,l.a)({queryKey:[s,e],queryFn:()=>(0,i.BK)({client:a.L,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:n}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:c,error:u,refetch:d}=(0,l.a)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,i.Pg)({client:a.L,path:{id:e},query:{...(0,n.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:c,fetchError:u,refetch:d}}}}]);