"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["181"],{25769:function(e,t,r){r.d(t,{D:()=>i});var l=r(24246),a=r(6364);let i=e=>{let{value:t}=e;return(0,l.jsx)(l.Fragment,{children:Object.entries(t).map(e=>{let[t,r]=e;return(0,l.jsx)(a._,{isCompact:!0,children:`${t}=${r}`},`${t}=${r}`)})})}},3175:function(e,t,r){r.d(t,{o:()=>u});var l=r(24246),a=r(34747),i=r(46770),s=r(2499),n=r(35676),c=r(18142);let u=e=>{let{value:t,score:r,showScore:u,showLabel:d}=e,o=c.V4[t],h=o.name;return(0,l.jsxs)(a.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(i.B,{children:d?(0,l.jsx)(n.ZP,{color:o.color.value}):(0,l.jsx)(s.u,{content:h,children:(0,l.jsx)(n.ZP,{color:o.color.value})})}),d&&(0,l.jsx)(i.B,{children:h}),u&&null!==r&&(0,l.jsxs)(i.B,{children:["(",Math.round(10*r)/10,")"]})]})}},42835:function(e,t,r){r.d(t,{p:()=>i});var l=r(24246),a=r(40583);let i=e=>{let{paginationProps:t,isTop:r,isCompact:i=!1,idPrefix:s=""}=e;return(0,l.jsx)(a.t,{id:`${s?`${s}-`:""}pagination-${r?"top":"bottom"}`,variant:r?a.a.top:a.a.bottom,isCompact:i,...t,widgetId:"pagination-id"})}},35027:function(e,t,r){r.d(t,{C:()=>i});var l=r(24246),a=r(6364);let i=e=>{let{error:t}=e;return(0,l.jsxs)(a._,{color:"red",children:[t.status," Error"]})}},37024:function(e,t,r){r.d(t,{hp:()=>j,qK:()=>f,Cx:()=>b});var l=r(24246),a=r(8305),i=r(13754),s=r(31423),n=r(11165),c=r(94154),u=r(48336),d=r(96582),o=r(610),h=r(68940),p=r(16668),x=r(22119);let m=e=>{let{title:t,description:r}=e;return(0,l.jsxs)(d.u,{variant:d.I.sm,children:[(0,l.jsx)(o.k,{icon:x.ZP}),(0,l.jsx)(h.D,{headingLevel:"h2",size:"lg",children:t}),r&&(0,l.jsx)(p.B,{children:r})]})},v=()=>(0,l.jsx)(m,{title:"No data available",description:"No data available to be shown here."}),j=e=>{let{numRenderedColumns:t,isLoading:r=!1,isError:d=!1,isNoData:o=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:x}=e;return(0,l.jsx)(l.Fragment,{children:r?(0,l.jsx)(s.p,{children:(0,l.jsx)(n.Tr,{children:(0,l.jsx)(c.Td,{colSpan:t,children:(0,l.jsx)(a.b,{children:(0,l.jsx)(i.$,{size:"xl"})})})})}):d?(0,l.jsx)(s.p,{"aria-label":"Table error",children:(0,l.jsx)(n.Tr,{children:(0,l.jsx)(c.Td,{colSpan:t,children:(0,l.jsx)(a.b,{children:h||(0,l.jsx)(u.y,{})})})})}):o?(0,l.jsx)(s.p,{"aria-label":"Table error",children:(0,l.jsx)(n.Tr,{children:(0,l.jsx)(c.Td,{colSpan:t,children:(0,l.jsx)(a.b,{children:p||(0,l.jsx)(v,{})})})})}):x})};var y=r(67918);let f=e=>{let{numColumnsBeforeData:t,numColumnsAfterData:r,children:a}=e;return(0,l.jsxs)(l.Fragment,{children:[Array(t).fill(null).map((e,t)=>(0,l.jsx)(y.Th,{screenReaderText:`before-data-${t}`},t)),a,Array(r).fill(null).map((e,t)=>(0,l.jsx)(y.Th,{screenReaderText:`after-data-${t}`},t))]})},b=e=>{let{isExpansionEnabled:t=!1,expandableVariant:r,isSelectionEnabled:a=!1,propHelpers:{getSingleExpandButtonTdProps:i,getSelectCheckboxTdProps:s},item:n,rowIndex:u,children:d}=e;return(0,l.jsxs)(l.Fragment,{children:[t&&"single"===r?(0,l.jsx)(c.Td,{...i({item:n,rowIndex:u})}):null,a?(0,l.jsx)(c.Td,{...s({item:n,rowIndex:u})}):null,d]})}},83330:function(e,t,r){r.d(t,{u:()=>d});var l=r(24246),a=r(34747),i=r(46770),s=r(28447),n=r(87445),c=r(18142),u=r(3175);let d=e=>{let{severities:t}=e,r=Object.values(t).reduce((e,t)=>e+t,0);return(0,l.jsxs)(a.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(i.B,{style:{minWidth:15,textAlign:n.F2},children:r}),(0,l.jsx)(s.i,{orientation:{default:"vertical"}}),(0,l.jsx)(i.B,{children:(0,l.jsx)(a.k,{children:Object.entries(t).filter(e=>{let[t,r]=e;return r>0}).sort((0,c.A0)(e=>{let[t,r]=e;return t})).reverse().map(e=>{let[t,r]=e;return(0,l.jsx)(i.B,{spacer:{default:"spacerXs"},children:(0,l.jsxs)(a.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,l.jsx)(i.B,{children:(0,l.jsx)(u.o,{value:t,score:null})}),(0,l.jsx)(i.B,{children:r})]})},t)})})})]})}},18681:function(e,t,r){r.d(t,{H:()=>d});var l=r(27378),a=r(86602),i=r(71008);let s=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,n={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},c={vulnerabilityStatus:{affected:{...n},fixed:{...n},not_affected:{...n},known_not_affected:{...n}}},u=e=>{let t=e.flatMap(e=>(e.status??[]).map(t=>{let r=(0,a.g)(t.average_severity);return{vulnerability:{...t.vulnerability,average_severity:r,average_score:t.average_score},vulnerabilityStatus:t.status,advisory:e}})).reduce((e,t)=>{let r;let l=e.find(e=>s(e,t));if(l)r=[...e.filter(e=>!s(e,l)),{...l,relatedSboms:[...l.relatedSboms,{advisory:t.advisory}]}];else{let l={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedSboms:[{advisory:t.advisory}]};r=[...e.slice(),l]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,l=t.vulnerability.average_severity,a=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[r]:{total:a.total+1,severities:{...a.severities,[l]:a.severities[l]+1}}}})},{...c});return{vulnerabilities:t,summary:r}},d=e=>{let{pkg:t,isFetching:r,fetchError:a}=(0,i.ZA)(e);return{data:l.useMemo(()=>u(t?.advisories||[]),[t]),isFetching:r,fetchError:a}}},69694:function(e,t,r){r.d(t,{a:()=>o,u:()=>h});var l=r(24246),a=r(27378),i=r(44072),s=r(55096),n=r(94426),c=r(9771),u=r(71008),d=r(62126);let o=a.createContext({}),h=e=>{let{children:t}=e,r=(0,n.vZ)({tableName:"packages",persistenceKeyPrefix:i.yq.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:i.L4,title:"Filter text",placeholderText:"Search",type:s.vA.search},{categoryKey:"type",title:"Type",placeholderText:"Type",type:s.vA.multiselect,selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:s.vA.multiselect,selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]}],isExpansionEnabled:!1}),{result:{data:h,total:p},isFetching:x,fetchError:m}=(0,u.fF)((0,n.QO)({...r,hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}})),v=a.useMemo(()=>h.map(e=>({...e,decomposedPurl:(0,d.qX)(e.purl)})),[h]),j=(0,n.KC)({...r,idProperty:"uuid",currentPageItems:v,totalItemCount:p,isLoading:x,selectionState:(0,c.U)({items:v,isEqual:(e,t)=>e.uuid===t.uuid})});return(0,l.jsx)(o.Provider,{value:{totalItemCount:p,isFetching:x,fetchError:m,tableControls:j},children:t})}},94681:function(e,t,r){r.d(t,{L:()=>T});var l=r(24246),a=r(27378),i=r(65783),s=r(4835),n=r(14350),c=r(11165),u=r(67918),d=r(31423),o=r(94154),h=r(25769),p=r(42835),x=r(37024),m=r(11797),v=r(35843),j=r(35027),y=r(83330),f=r(18681);let b=e=>{let{packageId:t}=e,{data:r,isFetching:a,fetchError:i}=(0,f.H)(t);return(0,l.jsx)(v.u,{isFetching:a,fetchError:i,isFetchingState:(0,l.jsx)(m.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,l.jsx)(j.C,{error:e}),children:(0,l.jsx)(y.u,{severities:r.summary.vulnerabilityStatus.affected.severities})})};var g=r(69694);let T=()=>{let{isFetching:e,fetchError:t,totalItemCount:r,tableControls:m}=a.useContext(g.a),{numRenderedColumns:v,currentPageItems:j,propHelpers:{paginationProps:y,tableProps:f,getThProps:T,getTrProps:P,getTdProps:S}}=m;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(s.i,{...f,"aria-label":"Package table",children:[(0,l.jsx)(n.h,{children:(0,l.jsx)(c.Tr,{children:(0,l.jsxs)(x.qK,{...m,children:[(0,l.jsx)(u.Th,{...T({columnKey:"name"})}),(0,l.jsx)(u.Th,{...T({columnKey:"namespace"})}),(0,l.jsx)(u.Th,{...T({columnKey:"version"})}),(0,l.jsx)(u.Th,{...T({columnKey:"type"})}),(0,l.jsx)(u.Th,{...T({columnKey:"path"})}),(0,l.jsx)(u.Th,{...T({columnKey:"qualifiers"})}),(0,l.jsx)(u.Th,{...T({columnKey:"vulnerabilities"})})]})})}),(0,l.jsx)(x.hp,{isLoading:e,isError:!!t,isNoData:0===r,numRenderedColumns:v,children:j.map((e,t)=>(0,l.jsx)(d.p,{children:(0,l.jsx)(c.Tr,{...P({item:e}),children:(0,l.jsxs)(x.Cx,{...m,item:e,rowIndex:t,children:[(0,l.jsx)(o.Td,{width:15,modifier:"breakWord",...S({columnKey:"name"}),children:(0,l.jsx)(i.OL,{to:`/packages/${e.uuid}`,children:e.decomposedPurl?e.decomposedPurl?.name:e.purl})}),(0,l.jsx)(o.Td,{width:15,modifier:"truncate",...S({columnKey:"namespace"}),children:e.decomposedPurl?.namespace}),(0,l.jsx)(o.Td,{width:10,modifier:"truncate",...S({columnKey:"version"}),children:e.decomposedPurl?.version}),(0,l.jsx)(o.Td,{width:10,modifier:"truncate",...S({columnKey:"type"}),children:e.decomposedPurl?.type}),(0,l.jsx)(o.Td,{width:10,modifier:"truncate",...S({columnKey:"path"}),children:e.decomposedPurl?.path}),(0,l.jsx)(o.Td,{width:20,...S({columnKey:"qualifiers"}),children:e.decomposedPurl?.qualifiers&&(0,l.jsx)(h.D,{value:e.decomposedPurl?.qualifiers})}),(0,l.jsx)(o.Td,{width:20,...S({columnKey:"vulnerabilities"}),children:(0,l.jsx)(b,{packageId:e.uuid})})]})})},e.uuid))})]}),(0,l.jsx)(p.p,{idPrefix:"package-table",isTop:!1,paginationProps:y})]})}},67239:function(e,t,r){r.d(t,{v:()=>o});var l=r(24246),a=r(27378),i=r(27308),s=r(40982),n=r(27763),c=r(55096),u=r(42835),d=r(69694);let o=e=>{let{showFilters:t}=e,{tableControls:r}=a.useContext(d.a),{propHelpers:{toolbarProps:o,filterToolbarProps:h,paginationToolbarItemProps:p,paginationProps:x}}=r;return(0,l.jsx)(i.o,{...o,children:(0,l.jsxs)(s.c,{children:[t&&(0,l.jsx)(c.Ki,{...h}),(0,l.jsx)(n.E,{...p,children:(0,l.jsx)(u.p,{idPrefix:"package-table",isTop:!0,paginationProps:x})})]})})}},71008:function(e,t,r){r.d(t,{D4:()=>d,ZA:()=>u,fF:()=>c});var l=r(1183),a=r(22285),i=r(54227),s=r(94426);let n="packages",c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:c,error:u,refetch:d}=(0,l.a)({queryKey:[n,e],queryFn:()=>(0,i.tj)({client:a.L,query:{...(0,s.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e},isFetching:c,fetchError:u,refetch:d}},u=e=>{let{data:t,isLoading:r,error:s}=(0,l.a)({queryKey:[n,e],queryFn:()=>(0,i.BK)({client:a.L,path:{key:e}})});return{pkg:t?.data,isFetching:r,fetchError:s}},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:r,isLoading:c,error:u,refetch:d}=(0,l.a)({queryKey:[n,"by-sbom",e,t],queryFn:()=>(0,i.Pg)({client:a.L,path:{id:e},query:{...(0,s.rm)(t)}})});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:t},isFetching:c,fetchError:u,refetch:d}}}}]);