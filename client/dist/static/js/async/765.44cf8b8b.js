"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["765"],{32947:function(e,r,t){t.d(r,{A0:()=>x,V4:()=>v,W:()=>m,XE:()=>b,nE:()=>f});var i=t(91566),a=t(839),n=t(73657),l=t(20644),s=t(89502),o=t(7596),d=t(1811),c=t(24917),u=t(4720),h=t(54178),p=t(37106),y=t(34313);let v={unknown:{name:"Unknown",color:d.P,progressProps:{variant:void 0},icon:i.M$},none:{name:"None",color:c.E,progressProps:{variant:void 0},icon:a.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:n._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:l.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:s.E2},critical:{name:"Critical",color:y.J,progressProps:{variant:"danger"},icon:o.ki}},b=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function x(e){return(r,t)=>b(e(r))-b(e(t))}let m=e=>{let{key:r,value:t}=e;return`${t?`${r}=${t}`:`${r}`}`},f=e=>{let[r,t]=e.split("=");return{key:r,value:t??""}}},7615:function(e,r,t){t.d(r,{g:()=>i});let i=e=>e??"unknown"},87017:function(e,r,t){t.d(r,{Co:()=>u,Cu:()=>d,Hb:()=>c});var i=t(70233),a=t(74502);t(41947);let n="/api",l=`${n}/v2/advisory`,s=`${n}/v2/sbom`,o=e=>{let r="application/json";return e.name.endsWith(".bz2")&&(r="application/json+bzip2"),r},d=(e,r)=>{let t=e.get(a.TB);return i.Z.post(`${l}`,t,{...r,headers:{"Content-Type":o(t)}})},c=(e,r)=>{let t=e.get(a.TB);return i.Z.post(`${s}`,t,{...r,headers:{"Content-Type":o(t)}})},u=e=>i.Z.get(`${s}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,r,t){t.d(r,{u:()=>s});var i=t(24246),a=t(8305),n=t(13754),l=t(39826);let s=e=>e.isFetching?e.isFetchingState||(0,i.jsx)(a.b,{children:(0,i.jsx)(n.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,i.jsx)(l.y,{}):e.children},69876:function(e,r,t){t.d(r,{D:()=>n});var i=t(24246),a=t(70400);let n=e=>{let{value:r}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(r).map(e=>{let[r,t]=e;return(0,i.jsx)(a._,{isCompact:!0,children:`${r}=${t}`},`${r}=${t}`)})})}},57524:function(e,r,t){t.d(r,{o:()=>d});var i=t(24246),a=t(34747),n=t(46770),l=t(64766),s=t(2499),o=t(32947);let d=e=>{let{value:r,score:t,showScore:d,showLabel:c}=e,u=o.V4[r],h=u.name,p=u.icon;return(0,i.jsxs)(a.k,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,i.jsx)(n.B,{children:c?(0,i.jsx)(l.J,{children:(0,i.jsx)(p,{color:u.color.value})}):(0,i.jsx)(s.u,{content:h,children:(0,i.jsx)(l.J,{children:(0,i.jsx)(p,{color:u.color.value})})})}),c&&(0,i.jsx)(n.B,{children:h}),d&&null!==t&&(0,i.jsxs)(n.B,{children:["(",Math.round(10*t)/10,")"]})]})}},3804:function(e,r,t){t.d(r,{p:()=>n});var i=t(24246),a=t(27230);let n=e=>{let{paginationProps:r,isTop:t,isCompact:n=!1,idPrefix:l=""}=e;return(0,i.jsx)(a.t,{id:`${l?`${l}-`:""}pagination-${t?"top":"bottom"}`,variant:t?a.a.top:a.a.bottom,isCompact:n,...r,widgetId:"pagination-id"})}},39826:function(e,r,t){t.d(r,{y:()=>s});var i=t(24246),a=t(10707),n=t(16668),l=t(42160);let s=()=>(0,i.jsx)(a.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:l.ZP,variant:a.IQ.sm,children:(0,i.jsx)(n.B,{children:"There was an error retrieving data. Check your connection and try again."})})},31336:function(e,r,t){t.d(r,{hp:()=>v,qK:()=>x,Cx:()=>m});var i=t(24246),a=t(8305),n=t(13754),l=t(31423),s=t(11165),o=t(94154),d=t(39826),c=t(10707),u=t(16668),h=t(22119);let p=e=>{let{title:r,description:t}=e;return(0,i.jsx)(c.ub,{titleText:r,headingLevel:"h4",icon:h.ZP,variant:c.IQ.sm,children:t&&(0,i.jsx)(u.B,{children:t})})},y=()=>(0,i.jsx)(p,{title:"No data available",description:"No data available to be shown here."}),v=e=>{let{numRenderedColumns:r,isLoading:t=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:h=null,noDataEmptyState:p=null,children:v}=e;return(0,i.jsx)(i.Fragment,{children:t?(0,i.jsx)(l.p,{children:(0,i.jsx)(s.Tr,{children:(0,i.jsx)(o.Td,{colSpan:r,children:(0,i.jsx)(a.b,{children:(0,i.jsx)(n.$,{size:"xl"})})})})}):c?(0,i.jsx)(l.p,{"aria-label":"Table error",children:(0,i.jsx)(s.Tr,{children:(0,i.jsx)(o.Td,{colSpan:r,children:(0,i.jsx)(a.b,{children:h||(0,i.jsx)(d.y,{})})})})}):u?(0,i.jsx)(l.p,{"aria-label":"Table error",children:(0,i.jsx)(s.Tr,{children:(0,i.jsx)(o.Td,{colSpan:r,children:(0,i.jsx)(a.b,{children:p||(0,i.jsx)(y,{})})})})}):v})};var b=t(89330);let x=e=>{let{numColumnsBeforeData:r,numColumnsAfterData:t,children:a}=e;return(0,i.jsxs)(i.Fragment,{children:[Array(r).fill(null).map((e,r)=>(0,i.jsx)(b.Th,{screenReaderText:`before-data-${r}`},r)),a,Array(t).fill(null).map((e,r)=>(0,i.jsx)(b.Th,{screenReaderText:`after-data-${r}`},r))]})},m=e=>{let{isExpansionEnabled:r=!1,expandableVariant:t,getSelectCheckboxTdProps:a,propHelpers:{getSingleExpandButtonTdProps:n},item:l,rowIndex:s,children:d}=e;return(0,i.jsxs)(i.Fragment,{children:[r&&"single"===t?(0,i.jsx)(o.Td,{...n({item:l,rowIndex:s})}):null,a?(0,i.jsx)(o.Td,{...a({item:l,rowIndex:s})}):null,d]})}},3586:function(e,r,t){t.d(r,{j:()=>n});var i=t(24246),a=t(27378);let n=e=>{let{children:r}=e,[t,n]=a.useState(!1);return(0,i.jsx)(i.Fragment,{children:r(t,n)})}},24200:function(e,r,t){t.d(r,{G:()=>a});var i=t(24246);let a=e=>{let{vulnerability:r}=e;return(0,i.jsxs)("p",{children:[r.withdrawn&&(0,i.jsx)("em",{children:"Rejected:\xa0"}),r.title||r.description]})}},31373:function(e,r,t){t.d(r,{useVulnerabilitiesOfPackage:()=>c});var i=t(27378),a=t(7615),n=t(59015);let l=(e,r)=>e.vulnerability.identifier===r.vulnerability.identifier&&e.vulnerabilityStatus===r.vulnerabilityStatus,s={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:{...s},fixed:{...s},not_affected:{...s},known_not_affected:{...s}}},d=e=>{let r=e.flatMap(e=>(e.status??[]).map(r=>{let t=(0,a.g)(r.average_severity);return{vulnerability:{...r.vulnerability,average_severity:t,average_score:r.average_score},vulnerabilityStatus:r.status,advisory:e}})).reduce((e,r)=>{let t,i=e.find(e=>l(e,r));if(i)t=[...e.filter(e=>!l(e,i)),{...i,relatedSboms:[...i.relatedSboms,{advisory:r.advisory}]}];else{let i={vulnerability:r.vulnerability,vulnerabilityStatus:r.vulnerabilityStatus,relatedSboms:[{advisory:r.advisory}]};t=[...e.slice(),i]}return t},[]),t=r.reduce((e,r)=>{let t=r.vulnerabilityStatus,i=r.vulnerability.average_severity,a=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[t]:{total:a.total+1,severities:{...a.severities,[i]:a.severities[i]+1}}}})},{...o});return{vulnerabilities:r,summary:t}},c=e=>{let{pkg:r,isFetching:t,fetchError:a}=(0,n.useFetchPackageById)(e);return{data:i.useMemo(()=>d(r?.advisories||[]),[r]),isFetching:t,fetchError:a}}},95169:function(e,r,t){t.d(r,{V:()=>c});var i=t(27378),a=t(74502),n=t(70233);let l="cancelled",s=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),o=(e,r)=>{switch(r.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(r.payload.file,{...e.uploads.get(r.payload.file)||s(),status:"queued",cancelFn:r.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(r.payload.file,{...e.uploads.get(r.payload.file)||s(),progress:r.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(r.payload.file,{...e.uploads.get(r.payload.file)||s(),status:"complete",response:r.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(r.payload.file,{...e.uploads.get(r.payload.file)||s(),status:"complete",error:r.payload.error,wasCancelled:r.payload.error?.message===l})};case"removeUpload":{let t=new Map(e.uploads);return t.delete(r.payload.file),{...e,uploads:t}}default:throw Error()}},d=()=>({uploads:new Map}),c=e=>{let{parallel:r,uploadFn:t,onSuccess:s,onError:c}=e,[u,h]=i.useReducer(o,d());return{uploads:u.uploads,handleUpload:e=>{let i=[];for(let r=0;r<e.length;r++){let t=e[r],o=new FormData;o.set(a.TB,t);let d=n.Z.CancelToken.source(),u={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{let r=e.total??1;h({type:"updateUploadProgress",payload:{file:t,progress:Math.round(e.loaded/r*100)}})},cancelToken:d.token};h({type:"queueUpload",payload:{file:t,cancelFn:d}});let p={formData:o,config:u,thenFn:e=>{h({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),s&&s(e,t)},catchFn:e=>{h({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==l&&c&&c(e,t)}};i.push(p)}if(r)for(let e of i)t(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else i.reduce(async(e,r)=>(await e,t(r.formData,r.config).then(r.thenFn).catch(r.catchFn)),Promise.resolve())},handleCancelUpload:e=>{u.uploads.get(e)?.cancelFn?.cancel(l)},handleRemoveUpload:e=>{h({type:"removeUpload",payload:{file:e}})}}}},47939:function(e,r,t){t.r(r),t.d(r,{default:()=>G});var i=t(24246),a=t(27378),n=t(65783),l=t(45043),s=t(97339),o=t(18091),d=t(27317),c=t(93095),u=t(68802),h=t(34747),p=t(46770),y=t(4075),v=t(27090),b=t(75165),x=t(31762),m=t(99),f=t(24787),j=t(12621),g=t(9839),F=t(37818),S=t(69876),T=t(59015),P=t(63706),w=t(70715),k=t(40982),q=t(89226),E=t(4835),K=t(14350),_=t(11165),C=t(89330),B=t(31423),M=t(94154),$=t(74502),I=t(14629),U=t(3804),L=t(31336),N=t(49988),O=t(43959);let R=e=>{let{purl:r}=e,t=(0,N.vZ)({tableName:"sboms",persistenceKeyPrefix:$.yq.sboms_by_package,columnNames:{name:"Name",version:"Version",supplier:"Supplier"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name"],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:I.vA.search}]}),{result:{data:a,total:l},isFetching:s,fetchError:o}=(0,O.useFetchSbomsByPackageId)(r,(0,N.QO)({...t,hubSortFieldKeys:{name:"name"}})),d=(0,N.KC)({...t,idProperty:"id",currentPageItems:a,totalItemCount:l,isLoading:s}),{numRenderedColumns:c,currentPageItems:u,propHelpers:{toolbarProps:h,paginationToolbarItemProps:p,paginationProps:y,tableProps:v,getThProps:b,getTrProps:x,getTdProps:m}}=d;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.o,{...h,children:(0,i.jsx)(k.c,{children:(0,i.jsx)(q.E,{...p,children:(0,i.jsx)(U.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:y})})})}),(0,i.jsxs)(E.i,{...v,"aria-label":"SBOM table",children:[(0,i.jsx)(K.h,{children:(0,i.jsx)(_.Tr,{children:(0,i.jsxs)(L.qK,{...d,children:[(0,i.jsx)(C.Th,{...b({columnKey:"name"})}),(0,i.jsx)(C.Th,{...b({columnKey:"version"})}),(0,i.jsx)(C.Th,{...b({columnKey:"supplier"})})]})})}),(0,i.jsx)(L.hp,{isLoading:s,isError:!!o,isNoData:0===l,numRenderedColumns:c,children:u?.map(e=>(0,i.jsx)(B.p,{children:(0,i.jsxs)(_.Tr,{...x({item:e}),children:[(0,i.jsx)(M.Td,{width:35,modifier:"breakWord",...m({columnKey:"name"}),children:(0,i.jsx)(n.rU,{to:`/sboms/${e.id}`,children:e.name})}),(0,i.jsx)(M.Td,{width:15,modifier:"truncate",...m({columnKey:"version"}),children:e.described_by.map(e=>e.version).join(", ")}),(0,i.jsx)(M.Td,{width:50,modifier:"truncate",...m({columnKey:"supplier"}),children:e.suppliers.join(", ")})]})},e.id))})]}),(0,i.jsx)(U.p,{idPrefix:"sbom-table",isTop:!1,paginationProps:y})]})};var D=t(27693),V=t.n(D),Q=t(9905),A=t(32947),W=t(57524),Z=t(3586),H=t(24200),X=t(31373),z=t(41135);let J=e=>{let{packageId:r}=e,{data:{vulnerabilities:t},isFetching:l,fetchError:s}=(0,X.useVulnerabilitiesOfPackage)(r),o=a.useMemo(()=>t.filter(e=>"affected"===e.vulnerabilityStatus),[t]),d=(0,z.T)(o,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),c=(0,N.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:d,isLoading:l,columnNames:{identifier:"ID",description:"Description",severity:"CVSS",published:"Date published"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier","severity","published"],getSortValues:e=>({identifier:e.vulnerability.identifier,severity:e.vulnerability?.average_severity?(0,A.XE)(e.vulnerability?.average_severity):0,published:e.vulnerability?.published?V()(e.vulnerability?.published).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,filterCategories:[],isExpansionEnabled:!1}),{currentPageItems:u,numRenderedColumns:h,propHelpers:{toolbarProps:p,paginationToolbarItemProps:y,paginationProps:v,tableProps:b,getThProps:x,getTrProps:m,getTdProps:f},expansionDerivedState:{isCellExpanded:j}}=c;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(w.o,{...p,children:(0,i.jsx)(k.c,{children:(0,i.jsx)(q.E,{...y,children:(0,i.jsx)(U.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:v})})})}),(0,i.jsxs)(E.i,{...b,"aria-label":"vulnerability table",children:[(0,i.jsx)(K.h,{children:(0,i.jsx)(_.Tr,{children:(0,i.jsxs)(L.qK,{...c,children:[(0,i.jsx)(C.Th,{...x({columnKey:"identifier"})}),(0,i.jsx)(C.Th,{...x({columnKey:"description"})}),(0,i.jsx)(C.Th,{...x({columnKey:"severity"})}),(0,i.jsx)(C.Th,{...x({columnKey:"published"})})]})})}),(0,i.jsx)(L.hp,{isLoading:l,isError:!!s,isNoData:0===d.length,numRenderedColumns:h,children:u?.map((e,r)=>(0,i.jsx)(B.p,{isExpanded:j(e),children:(0,i.jsx)(_.Tr,{...m({item:e}),children:(0,i.jsxs)(L.Cx,{...c,item:e,rowIndex:r,children:[(0,i.jsx)(M.Td,{width:15,modifier:"breakWord",...f({columnKey:"identifier"}),children:(0,i.jsx)(n.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),(0,i.jsx)(Z.j,{children:(r,t)=>(0,i.jsx)(M.Td,{width:60,modifier:"truncate",onFocus:()=>t(!0),onBlur:()=>t(!1),tabIndex:0,...f({columnKey:"description"}),children:(0,i.jsx)(Q.cE,{focused:r,wrapModifier:"truncate",children:e.vulnerability&&(0,i.jsx)(H.G,{vulnerability:e.vulnerability})})})}),(0,i.jsx)(M.Td,{width:15,...f({columnKey:"severity"}),children:e.vulnerability?.average_severity&&(0,i.jsx)(W.o,{value:e.vulnerability.average_severity,score:e.vulnerability.average_score,showLabel:!0,showScore:!0})}),(0,i.jsx)(M.Td,{width:10,modifier:"truncate",...f({columnKey:"published"}),children:(0,P.p6)(e.vulnerability?.published)})]})})},e._ui_unique_id))})]}),(0,i.jsx)(U.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:v})]})},G=()=>{let e=(0,g.ZX)(g.Uo.PACKAGE_ID),{pkg:r,isFetching:t,fetchError:w}=(0,T.useFetchPackageById)(e),k=a.useMemo(()=>r?(0,P.qX)(r.purl):void 0,[r]),[q,E]=a.useState(0),K=a.createRef(),_=a.createRef(),C=a.createRef();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.NP,{type:"breadcrumb",children:(0,i.jsxs)(s.a,{children:[(0,i.jsx)(o.g,{children:(0,i.jsx)(n.rU,{to:"/packages",children:"Packages"})}),(0,i.jsx)(o.g,{isActive:!0,children:"Package details"})]})}),(0,i.jsx)(l.NP,{children:(0,i.jsxs)(d.K,{children:[(0,i.jsx)(c.v,{children:(0,i.jsx)(u.V,{children:(0,i.jsx)(u.V,{component:"h1",children:k?.name??e??""})})}),(0,i.jsx)(c.v,{children:(0,i.jsxs)(h.k,{children:[(0,i.jsxs)(p.B,{spacer:{default:"spacerSm"},children:[(0,i.jsxs)("p",{children:["version: ",k?.version]})," "]}),(0,i.jsx)(p.B,{children:k?.qualifiers&&(0,i.jsx)(S.D,{value:k?.qualifiers})})]})})]})}),(0,i.jsx)(l.NP,{children:(0,i.jsxs)(y.m,{mountOnEnter:!0,activeKey:q,onSelect:(e,r)=>{E(r)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,i.jsx)(v.O,{eventKey:0,title:(0,i.jsx)(b.T,{children:"Vulnerabilities"}),tabContentId:"refTabVulnerabilitiesSection",tabContentRef:K}),(0,i.jsx)(v.O,{eventKey:1,title:(0,i.jsx)(b.T,{children:"SBOMs using package"}),actions:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.b,{ref:C,children:(0,i.jsx)(j.ZP,{})}),(0,i.jsx)(m.J,{bodyContent:(0,i.jsx)("div",{children:"A list of SBOMs using this package."}),triggerRef:C})]}),tabContentId:"refTabSbomsSection",tabContentRef:_})]})}),(0,i.jsxs)(l.NP,{children:[(0,i.jsx)(f.I,{eventKey:0,id:"refTabVulnerabilitiesSection",ref:K,"aria-label":"Vulnerabilities of the Package",children:e&&(0,i.jsx)(J,{packageId:e})}),(0,i.jsx)(f.I,{eventKey:1,id:"refTabSbomsSection",ref:_,"aria-label":"SBOMs using the Package",hidden:!0,children:(0,i.jsx)(F.u,{isFetching:t,fetchError:w,children:r?.purl&&(0,i.jsx)(R,{purl:r.purl})})})]})]})}},59015:function(e,r,t){t.d(r,{useFetchPackageById:()=>d,useFetchPackages:()=>o,useFetchPackagesBySbomId:()=>c});var i=t(1183),a=t(50576),n=t(40371),l=t(49988);let s="packages",o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:t,isLoading:o,error:d,refetch:c}=(0,i.useQuery)({queryKey:[s,e],queryFn:()=>(0,n.tj)({client:a.L,query:{...(0,l.rm)(e)}}),enabled:!r});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e},isFetching:o,fetchError:d,refetch:c}},d=e=>{let{data:r,isLoading:t,error:l}=(0,i.useQuery)({queryKey:[s,e],queryFn:()=>(0,n.BK)({client:a.L,path:{key:e}})});return{pkg:r?.data,isFetching:t,fetchError:l}},c=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:o,error:d,refetch:c}=(0,i.useQuery)({queryKey:[s,"by-sbom",e,r],queryFn:()=>(0,n.Pg)({client:a.L,path:{id:e},query:{...(0,l.rm)(r)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:r},isFetching:o,fetchError:d,refetch:c}}},43959:function(e,r,t){t.d(r,{useFetchSBOMById:()=>b,useFetchSBOMLabels:()=>y,useFetchSBOMs:()=>v,useFetchSbomsAdvisory:()=>j,useFetchSbomsAdvisoryBatch:()=>g,useFetchSbomsByPackageId:()=>f,useUpdateSbomLabelsMutation:()=>m,useUploadSBOM:()=>x});var i=t(1183),a=t(24038),n=t(68e3),l=t(75503),s=t(16072),o=t(50576),d=t(40371),c=t(95169),u=t(87017),h=t(49988);let p="sboms",y=e=>{let{data:r,isLoading:t,error:n,refetch:l}=(0,i.useQuery)({queryKey:[p,"labels",e],queryFn:()=>(0,d.mh)({client:o.L,query:{limit:10,filter_text:e}}),placeholderData:a.Wk});return{labels:r?.data||[],isFetching:t,fetchError:n,refetch:l}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:a,...n}=(0,h.rm)(e),l=(0,h.Rb)(r),{data:s,isLoading:c,error:u,refetch:y}=(0,i.useQuery)({queryKey:[p,e,l],queryFn:()=>(0,d.Wp)({client:o.L,query:{...n,q:[a,l].filter(e=>e).join("&")}}),enabled:!t});return{result:{data:s?.data?.items||[],total:s?.data?.total??0,params:e??e},isFetching:c,fetchError:u,refetch:y}},b=e=>{let{data:r,isLoading:t,error:a}=(0,i.useQuery)({queryKey:[p,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,d._Q)({client:o.L,path:{id:e}}),enabled:void 0!==e});return{sbom:r?.data,isFetching:t,fetchError:a}},x=()=>{let e=(0,n.NL)();return(0,c.V)({parallel:!0,uploadFn:(e,r)=>(0,u.Hb)(e,r),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},m=(e,r)=>{let t=(0,n.NL)();return(0,l.D)({mutationFn:e=>(0,d.zx)({client:o.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await t.invalidateQueries({queryKey:[p]})},onError:r})},f=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:a,error:n,refetch:l}=(0,i.useQuery)({queryKey:[p,"by-package",e,r],queryFn:()=>(0,d.DU)({client:o.L,query:{purl:e,...(0,h.rm)(r)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:r??r},isFetching:a,fetchError:n,refetch:l}},j=e=>{let{data:r,isLoading:t,error:a}=(0,i.useQuery)({queryKey:[p,e,"advisory"],queryFn:()=>(0,d.NU)({client:o.L,path:{id:e}})});return{advisories:r?.data||[],isFetching:t,fetchError:a}},g=e=>{let r=(0,s.h)({queries:e.map(e=>({queryKey:[p,e,"advisory"],queryFn:()=>(0,d.NU)({client:o.L,path:{id:e}})}))});return{advisories:r.map(e=>{let{data:r}=e;return r?.data||[]}),isFetching:r.some(e=>{let{isLoading:r}=e;return r}),fetchError:r.map(e=>{let{error:r}=e;return r})}}},41135:function(e,r,t){t.d(r,{T:()=>n});var i=t(27378),a=t(74502);let n=(e,r)=>(0,i.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[a.nM]:r(e)})):[],[e,r])}}]);