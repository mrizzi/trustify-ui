"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["245"],{32947:function(e,t,r){r.d(t,{A0:()=>g,V4:()=>v,W:()=>x,nE:()=>f});var a=r(91566),n=r(839),l=r(73657),i=r(20644),s=r(89502),o=r(7596),c=r(1811),d=r(24917),u=r(4720),h=r(54178),p=r(37106),y=r(34313);let v={unknown:{name:"Unknown",color:c.P,progressProps:{variant:void 0},icon:a.M$},none:{name:"None",color:d.E,progressProps:{variant:void 0},icon:n.f6},low:{name:"Low",color:u.c,progressProps:{variant:void 0},icon:l._$},medium:{name:"Medium",color:h.L,progressProps:{variant:"warning"},icon:i.zI},high:{name:"High",color:p.H,progressProps:{variant:"danger"},icon:s.E2},critical:{name:"Critical",color:y.J,progressProps:{variant:"danger"},icon:o.ki}},m=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function g(e){return(t,r)=>m(e(t))-m(e(r))}let x=e=>{let{key:t,value:r}=e;return"".concat(r?"".concat(t,"=").concat(r):"".concat(t))},f=e=>{let[t,r]=e.split("=");return{key:t,value:null!=r?r:""}}},7615:function(e,t,r){r.d(t,{g:()=>a});let a=e=>null!=e?e:"unknown"},87017:function(e,t,r){r.d(t,{Co:()=>p,Cu:()=>u,Hb:()=>h});var a=r(79192),n=r(53195),l=r(70233),i=r(74502);r(41947);let s="/api",o="".concat(s,"/v2/advisory"),c="".concat(s,"/v2/sbom"),d=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},u=(e,t)=>{let r=e.get(i.TB);return l.Z.post("".concat(o),r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":d(r)}}))},h=(e,t)=>{let r=e.get(i.TB);return l.Z.post("".concat(c),r,(0,n._)((0,a._)({},t),{headers:{"Content-Type":d(r)}}))},p=e=>l.Z.get("".concat(c,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},37818:function(e,t,r){r.d(t,{u:()=>s});var a=r(24246),n=r(8305),l=r(13754),i=r(39826);let s=e=>e.isFetching?e.isFetchingState||(0,a.jsx)(n.b,{children:(0,a.jsx)(l.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,a.jsx)(i.y,{}):e.children},68057:function(e,t,r){r.d(t,{V:()=>s});var a=r(24246),n=r(27378),l=r(63763),i=r(32947);let s=e=>{let{vulnerabilitiesSummary:t}=e,r=n.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],a=i.V4[e];return{severity:e,count:r,label:a.name,color:a.color.value}}).sort((0,i.A0)(e=>e.severity)).reverse(),[t]);return(0,a.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,a.jsx)(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:"".concat(t.total),subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:"".concat(t,": ").concat(r)}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return"".concat(t.x,": ").concat(t.y)},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},39826:function(e,t,r){r.d(t,{y:()=>s});var a=r(24246),n=r(10707),l=r(16668),i=r(42160);let s=()=>(0,a.jsx)(n.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:i.ZP,variant:n.IQ.sm,children:(0,a.jsx)(l.B,{children:"There was an error retrieving data. Check your connection and try again."})})},82413:function(e,t,r){r.d(t,{A:()=>h,I:()=>p});var a=r(79192),n=r(53195),l=r(27378),i=r(7615),s=r(43959);let o=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:(0,a._)({},c),fixed:(0,a._)({},c),not_affected:(0,a._)({},c),known_not_affected:(0,a._)({},c)}},u=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let r,l=e.find(e=>o(e,t));if(l)r=[...e.filter(e=>!o(e,l)),(0,n._)((0,a._)({},l),{relatedPackages:[...l.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};r=[...e.slice(),a]}return r},[]),r=t.reduce((e,t)=>{let r=t.vulnerabilityStatus,l=(0,i.g)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[r];return Object.assign(e,{vulnerabilityStatus:(0,n._)((0,a._)({},e.vulnerabilityStatus),{[r]:{total:s.total+1,severities:(0,n._)((0,a._)({},s.severities),{[l]:s.severities[l]+1})}})})},(0,a._)({},d));return{vulnerabilities:t,summary:r}},h=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.KQ)(e);return{data:l.useMemo(()=>u(t||[]),[t]),isFetching:r,fetchError:a}},p=e=>{let{advisories:t,isFetching:r,fetchError:a}=(0,s.uz)(e);return{data:l.useMemo(()=>(null!=t?t:[]).map(e=>u(e||[])),[t]),isFetching:r,fetchError:a}}},95169:function(e,t,r){r.d(t,{V:()=>u});var a=r(79192),n=r(53195),l=r(27378),i=r(74502),s=r(70233);let o="cancelled",c=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),d=(e,t)=>{switch(t.type){case"queueUpload":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var r;return(0,n._)((0,a._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,n._)((0,a._)({},e.uploads.get(t.payload.file)||c()),{status:"complete",error:t.payload.error,wasCancelled:(null==(r=t.payload.error)?void 0:r.message)===o}))});case"removeUpload":{let r=new Map(e.uploads);return r.delete(t.payload.file),(0,n._)((0,a._)({},e),{uploads:r})}default:throw Error()}},u=e=>{let{parallel:t,uploadFn:r,onSuccess:a,onError:n}=e,[c,u]=l.useReducer(d,{uploads:new Map});return{uploads:c.uploads,handleUpload:e=>{let l=[];for(let t=0;t<e.length;t++){let r=e[t],c=new FormData;c.set(i.TB,r);let d=s.Z.CancelToken.source(),h={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let a=null!=(t=e.total)?t:1;u({type:"updateUploadProgress",payload:{file:r,progress:Math.round(e.loaded/a*100)}})},cancelToken:d.token};u({type:"queueUpload",payload:{file:r,cancelFn:d}});let p={formData:c,config:h,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:r,response:e}}),a&&a(e,r)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:r,error:e}}),e.message!==o&&n&&n(e,r)}};l.push(p)}if(t)for(let e of l)r(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else l.reduce(async(e,t)=>(await e,r(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,r;null==(r=c.uploads.get(e))||null==(t=r.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},21629:function(e,t,r){r.r(t),r.d(t,{default:()=>ev});var a=r(24246),n=r(45043),l=r(27317),i=r(93095),s=r(14935),o=r(46403),c=r(65783),d=r(74485),u=r(76228),h=r(57518),p=r(24216),y=r(13864),v=r(78531),m=r(44870),g=r(93591),x=r(31757),f=r(87069),j=r(51527),b=r(87727),F=r(3498),_=r(68802),w=r(10707),k=r(16668),q=r(30329),S=r(50689),E=r(67761),P=r(81391),L=r(32947),C=r(37818),M=r(82413),K=r(17598),B=r(43959),O=r(9839),T=r(63706);let D=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],U=()=>{var e,t,r,n,U,N;let V=(0,s.s0)(),{result:{data:I,total:Q},isFetching:W,fetchError:A}=(0,B.Fz)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:z,isFetching:G,fetchError:Z}=(0,M.I)(I.map(e=>e.id)),H=z.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),R=(e,t)=>"".concat(" ".repeat(t+1)).concat(e.name),{result:{data:$,total:Y},isFetching:J,fetchError:X}=(0,K.N7)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,a.jsxs)(x.Z,{children:[(0,a.jsx)(f.l,{children:"Dashboard"}),(0,a.jsx)(j.e,{children:(0,a.jsxs)(b.r,{children:[(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(C.u,{isFetching:W||G,fetchError:A||Z.some(e=>!!e),children:(0,a.jsxs)(l.K,{hasGutter:!0,children:[(0,a.jsx)(i.v,{children:(0,a.jsx)(_.V,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,a.jsx)(i.v,{children:I.length>0?(0,a.jsx)("div",{style:{height:320},children:(0,a.jsxs)(d.k,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:D.map(e=>({name:L.V4[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:u.n.multiOrdered,width:700,legendComponent:(0,a.jsx)(h.Q,{y:10,x:200,colorScale:D.map(e=>L.V4[e.severity].color.value)}),children:[(0,a.jsx)(p.C,{label:"Products",axisLabelComponent:(0,a.jsx)(y.D,{dx:0,x:15,y:140}),tickLabelComponent:(0,a.jsx)(y.D,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:e=>{let t=e.target.innerHTML,r=I.find((e,r)=>R(e,r)===t);r&&V((0,o.Gn)(O.nB.sbomDetails,{sbomId:r.id}))}}})}),(0,a.jsx)(p.C,{dependentAxis:!0,showGrid:!0,tickValues:H?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,a.jsx)(v.K,{horizontal:!0,colorScale:D.map(e=>L.V4[e.severity].color.value),children:D.map(e=>{let t=L.V4[e.severity];return(0,a.jsx)(m.B,{labelComponent:(0,a.jsx)(g.h,{constrainToVisibleArea:!0}),data:z.map((r,a)=>{let{summary:{vulnerabilityStatus:{affected:n}}}=r,l=I[a],i=e.severity,s=n.severities[i];return{x:R(l,a),y:s,label:"".concat(t.name,": ").concat(s)}})},e.severity)})})]})}):(0,a.jsx)(w.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:w.IQ.xs,children:(0,a.jsx)(k.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(C.u,{isFetching:J||W,fetchError:X||A,children:(0,a.jsxs)(b.r,{hasGutter:!0,children:[(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(q.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(E.M,{children:"Last SBOM ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(l.K,{children:[(0,a.jsx)(i.v,{children:(0,T.o0)(null==I||null==(e=I[0])?void 0:e.ingested)}),(0,a.jsx)(i.v,{children:(null==I?void 0:I[0])&&(0,a.jsx)(c.rU,{to:(0,o.Gn)(O.nB.sbomDetails,{sbomId:null==I||null==(t=I[0])?void 0:t.id}),children:null==I||null==(r=I[0])?void 0:r.name})})]})})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(q.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(E.M,{children:"Total SBOMs"}),(0,a.jsx)(P.b,{children:Q})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(q.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(E.M,{children:"Last Advisory ingested"}),(0,a.jsx)(P.b,{children:(0,a.jsxs)(l.K,{children:[(0,a.jsx)(i.v,{children:(0,T.o0)(null==$||null==(n=$[0])?void 0:n.ingested)}),(0,a.jsx)(i.v,{children:(null==$?void 0:$[0])&&(0,a.jsx)(c.rU,{to:(0,o.Gn)(O.nB.advisoryDetails,{advisoryId:null==$||null==(U=$[0])?void 0:U.uuid}),children:null==$||null==(N=$[0])?void 0:N.document_id})})]})})]})})}),(0,a.jsx)(F.P,{md:6,children:(0,a.jsx)(q.o,{children:(0,a.jsxs)(S.g,{children:[(0,a.jsx)(E.M,{children:"Total Advisories"}),(0,a.jsx)(P.b,{children:Y})]})})})]})})})]})})]})};var N=r(27378),V=r(8305),I=r(13754),Q=r(79192),W=r(53195),A=r(15726),z=r(1183),G=r(68e3),Z=r(75503),H=r(50576),R=r(40371);let $="watched-sboms",Y="dashboard",J=N.createContext({}),X=e=>{let{children:t}=e,{pushNotification:r}=N.useContext(A.c),{sboms:n,isFetching:l,fetchError:i}=(()=>{let{data:e,isLoading:t,error:r}=(0,z.a)({queryKey:[Y,$],queryFn:async()=>{try{return(await (0,R.JM)({client:H.L,path:{key:$}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}})(),{mutate:s}=((e,t)=>{let r=(0,G.NL)();return(0,Z.D)({mutationFn:e=>(0,R.yu)({client:H.L,path:{key:$},body:e}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[Y,$]})},onError:t})})(()=>{},e=>{r({title:"Error while updating the user preferences",variant:"danger"})});return(0,a.jsx)(J.Provider,{value:{sboms:n,isFetching:l,fetchError:i,patch:(e,t)=>{s((0,W._)((0,Q._)({},n),{[e]:t}))}},children:t})};var ee=r(46039),et=r(18037),er=r(24620),ea=r(9426),en=r(32050),el=r(99589),ei=r(78700),es=r(32623),eo=r(42364),ec=r(29765),ed=r(21843),eu=r(68057);let eh=e=>{let{sbomId:t}=e,{data:r,isFetching:n,fetchError:l}=(0,M.A)(t);return(0,a.jsx)(C.u,{isFetching:n,fetchError:l,children:(0,a.jsx)(eu.V,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},ep=e=>{let{fieldName:t,sbomId:r}=e,{patch:n}=N.useContext(J),s=N.useRef(null),[d,u]=N.useState(""),[h,p]=N.useState("");N.useEffect(()=>{let e=setTimeout(()=>{p(d)},500);return()=>clearTimeout(e)},[d]);let[y,v]=N.useState(!1),{sbom:m,isFetching:g,fetchError:b}=(0,B.p4)(null!=r?r:void 0),{result:{data:F}}=(0,B.Fz)({filters:[{field:"",operator:"~",value:h}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),_=()=>{v(!1)},q=()=>{v(!y)},S=()=>{y?d||_():v(!0)},E=(e,t)=>{u(t)},P=()=>{var e;u(""),null==s||null==(e=s.current)||e.focus()};return(0,a.jsxs)(x.Z,{isFullHeight:!0,children:[(0,a.jsxs)(C.u,{isFetching:g,fetchError:b,children:[m&&(0,a.jsx)(f.l,{className:ed.Z.textBreakWord,children:null==m?void 0:m.name}),(0,a.jsx)(j.e,{children:r?(0,a.jsxs)(l.K,{children:[(0,a.jsx)(i.v,{isFilled:!0,children:(0,a.jsx)(eh,{sbomId:r})}),(0,a.jsx)(i.v,{children:(0,a.jsx)(c.rU,{to:(0,o.Gn)(O.nB.sbomDetails,{sbomId:r}),children:"View Details"})})]}):(0,a.jsx)(w.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:w.IQ.xs,children:(0,a.jsx)(k.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,a.jsx)(ee.e,{children:(0,a.jsx)(et.P,{shouldFocusFirstItemOnOpen:!1,isOpen:y,onSelect:(e,r)=>{r&&n(t,r),_()},onOpenChange:e=>{e||_()},toggle:e=>(0,a.jsx)(er.O_,{ref:e,variant:"typeahead",onClick:q,isExpanded:y,isFullWidth:!0,children:(0,a.jsxs)(ea.W,{isPlain:!0,children:[(0,a.jsx)(en.v,{autoComplete:"off",value:d,onClick:S,onChange:E,innerRef:s,isExpanded:y,placeholder:"Select a new SBOM to watch"}),(0,a.jsx)(el.t,(0,W._)((0,Q._)({},d?{}:{style:{display:"none"}}),{children:(0,a.jsx)(ei.zx,{icon:(0,a.jsx)(ec.ZP,{"aria-hidden":!0}),variant:"plain",onClick:P,"aria-label":"Clear input value"})}))]})}),children:(0,a.jsx)(es.E,{children:F.map(e=>(0,a.jsx)(eo.$,{value:e.id,children:e.name},e.id))})})})]})},ey=()=>{let{sboms:e,isFetching:t,fetchError:r}=N.useContext(J);return(0,a.jsx)(C.u,{isFetching:t,fetchError:r,isFetchingState:(0,a.jsx)(b.r,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,a.jsx)(F.P,{md:3,children:(0,a.jsx)(x.Z,{children:(0,a.jsx)(j.e,{children:(0,a.jsx)(V.b,{children:(0,a.jsx)(I.$,{})})})})},e))}),children:(0,a.jsx)(b.r,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,a.jsx)(F.P,{md:3,children:(0,a.jsx)(ep,{fieldName:t,sbomId:r})},"".concat(t,":").concat(r))})})})},ev=()=>(0,a.jsx)(n.NP,{hasBodyWrapper:!1,children:(0,a.jsxs)(l.K,{hasGutter:!0,children:[(0,a.jsx)(i.v,{children:(0,a.jsx)(U,{})}),(0,a.jsx)(i.v,{children:(0,a.jsx)(X,{children:(0,a.jsx)(ey,{})})})]})})},17598:function(e,t,r){r.d(t,{N7:()=>g,VY:()=>m,gw:()=>x,sj:()=>b,tG:()=>j,y2:()=>f});var a=r(79192),n=r(53195),l=r(70186),i=r(1183),s=r(24038),o=r(68e3),c=r(75503),d=r(50576),u=r(40371),h=r(87017),p=r(49988),y=r(95169);let v="advisories",m=e=>{let{data:t,isLoading:r,error:a,refetch:n}=(0,i.a)({queryKey:[v,"labels",e],queryFn:()=>(0,u.sf)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:n}},g=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],h=(0,p.rm)(s),{q:y}=h,m=(0,l._)(h,["q"]),g=(0,p.Rb)(o),{data:x,isLoading:f,error:j,refetch:b}=(0,i.a)({queryKey:[v,s,g],queryFn:()=>(0,u.A1)({client:d.L,query:(0,n._)((0,a._)({},m),{q:[y,g].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(t=x.data)?void 0:t.total)?r:0,params:s},isFetching:f,fetchError:j||null,refetch:b}},x=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[v,e],queryFn:()=>(0,u.pB)({client:d.L,path:{key:e}}),enabled:void 0!==e});return{advisory:null==t?void 0:t.data,isFetching:r,fetchError:a}},f=(e,t)=>{let r=(0,o.NL)();return(0,c.D)({mutationFn:async e=>(await (0,u.Wr)({client:d.L,path:{key:e}})).data,onSuccess:async(t,a)=>{e(t,a),await r.invalidateQueries({queryKey:[v]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[v]})}})},j=()=>{let e=(0,o.NL)();return(0,y.V)({parallel:!0,uploadFn:(e,t)=>(0,h.Cu)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[v]})}})},b=(e,t)=>{let r=(0,o.NL)();return(0,c.D)({mutationFn:e=>(0,u.m5)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async(t,a)=>{e(),await r.invalidateQueries({queryKey:[v]})},onError:t})}},43959:function(e,t,r){r.d(t,{Fz:()=>x,KQ:()=>w,Oh:()=>_,i5:()=>g,km:()=>b,p4:()=>f,qi:()=>q,s5:()=>j,t9:()=>F,uz:()=>k});var a=r(79192),n=r(53195),l=r(70186),i=r(1183),s=r(24038),o=r(68e3),c=r(75503),d=r(16072),u=r(50576),h=r(40371),p=r(95169),y=r(87017),v=r(49988);let m="sboms",g=e=>{let{data:t,isLoading:r,error:a,refetch:n}=(0,i.a)({queryKey:[m,"labels",e],queryFn:()=>(0,h.mh)({client:u.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a,refetch:n}},x=function(){var e,t,r;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],d=(0,v.rm)(s),{q:p}=d,y=(0,l._)(d,["q"]),g=(0,v.Rb)(o),{data:x,isLoading:f,error:j,refetch:b}=(0,i.a)({queryKey:[m,s,g],queryFn:()=>(0,h.Wp)({client:u.L,query:(0,n._)((0,a._)({},y),{q:[p,g].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==x||null==(e=x.data)?void 0:e.items)||[],total:null!=(r=null==x||null==(t=x.data)?void 0:t.total)?r:0,params:s},isFetching:f,fetchError:j,refetch:b}},f=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,h._Q)({client:u.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:r,fetchError:a}},j=(e,t)=>{let r=(0,o.NL)();return(0,c.D)({mutationFn:async e=>(await (0,h.WX)({client:u.L,path:{id:e}})).data,onSuccess:async(t,a)=>{e(t,a),await r.invalidateQueries({queryKey:[m]})},onError:async e=>{t(e),await r.invalidateQueries({queryKey:[m]})}})},b=()=>{let e=(0,o.NL)();return(0,p.V)({parallel:!0,uploadFn:(e,t)=>(0,y.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},F=(e,t)=>{let r=(0,o.NL)();return(0,c.D)({mutationFn:e=>(0,h.zx)({client:u.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await r.invalidateQueries({queryKey:[m]})},onError:t})},_=function(e){var t,r,n;let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:o,error:c,refetch:d}=(0,i.a)({queryKey:[m,"by-package",e,l],queryFn:()=>(0,h.DU)({client:u.L,query:(0,a._)({purl:e},(0,v.rm)(l))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(n=null==s||null==(r=s.data)?void 0:r.total)?n:0,params:l},isFetching:o,fetchError:c,refetch:d}},w=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}},k=e=>{let t=(0,d.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,h.NU)({client:u.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},q=e=>{let{data:t,isLoading:r,error:a}=(0,i.a)({queryKey:[m,e,"license-ids"],queryFn:()=>(0,h.J4)({client:u.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:r,fetchError:a}}}}]);