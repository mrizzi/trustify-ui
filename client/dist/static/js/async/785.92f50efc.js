"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["785"],{71284:function(e,r,i){i.d(r,{Cb:()=>_,Kb:()=>j,Sx:()=>v,hs:()=>g,m4:()=>f,pJ:()=>p,xh:()=>T});var n=i(88741),t=i(99111),l=i(22134),s=i(57822),a=i(32635),d=i(1734),o=i(84249),c=i(95283),u=i(52040),h=i(44240),x=i(43967),m=i(36808);let j={unknown:{name:"Unknown",color:o.o,progressProps:{variant:void 0},icon:n.ZP},none:{name:"None",color:c.q,progressProps:{variant:void 0},icon:t.VQ},low:{name:"Low",color:u.b,progressProps:{variant:void 0},icon:l.g8},medium:{name:"Medium",color:h.B,progressProps:{variant:"warning"},icon:s.Yc},high:{name:"High",color:x.e,progressProps:{variant:"danger"},icon:a.Fc},critical:{name:"Critical",color:m.d,progressProps:{variant:"danger"},icon:d.id}},p={fixed:{name:"Fixed",color:"blue"},not_affected:{name:"Not affected",color:"green"},known_not_affected:{name:"Known not affected",color:"green"},under_investigation:{name:"Under investigation",color:"yellow"},affected:{name:"Affected",color:"red"}},b=e=>{switch(e){case"unknown":return 1;case"none":return 2;case"low":return 3;case"medium":return 4;case"high":return 5;case"critical":return 6;default:return 0}};function v(e){return(r,i)=>b(e(r))-b(e(i))}let f=e=>{let{key:r,value:i}=e;return"".concat(i?"".concat(r,"=").concat(i):"".concat(r))},_=e=>{let[r,i]=e.split("=");return{key:r,value:null!=i?i:""}},y=e=>{if(!e)return 0;switch(e){case"3.1":return 1;case"3.0":return 2;case"4.0":return 3;case"2.0":return 4;default:return 0}};function g(e){return(r,i)=>y(e(r))-y(e(i))}let T=e=>0===e.length?null:[...e].sort(g(e=>e.type))[0]},27875:function(e,r,i){i.d(r,{U:()=>n});let n=e=>null!=e?e:"unknown"},24296:function(e,r,i){i.d(r,{a:()=>a});var n=i(62540),t=i(59394),l=i(81595),s=i(40554);let a=e=>e.isFetching?e.isFetchingState||(0,n.jsx)(t.a,{children:(0,n.jsx)(l.y,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,n.jsx)(s.q,{}):e.children},85790:function(e,r,i){i.d(r,{a:()=>l});var n=i(62540),t=i(69548);let l=e=>{let{value:r}=e;return(0,n.jsx)(n.Fragment,{children:Object.entries(r).map(e=>{let[r,i]=e;return(0,n.jsx)(t.J,{isCompact:!0,children:"".concat(r,"=").concat(i)},"".concat(r,"=").concat(i))})})}},45969:function(e,r,i){i.d(r,{h:()=>o});var n=i(62540),t=i(28338),l=i(70045),s=i(2057),a=i(29508),d=i(71284);let o=e=>{let{value:r,score:i,showScore:o,showLabel:c}=e,u=d.Kb[r],h=u.name,x=u.icon;return(0,n.jsxs)(t.s,{spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,n.jsx)(l.Z,{children:c?(0,n.jsx)(s.I,{children:(0,n.jsx)(x,{color:u.color.value})}):(0,n.jsx)(a.m,{content:h,children:(0,n.jsx)(s.I,{children:(0,n.jsx)(x,{color:u.color.value})})})}),c&&(0,n.jsx)(l.Z,{children:h}),o&&null!==i&&(0,n.jsxs)(l.Z,{children:["(",Math.round(10*i)/10,")"]})]})}},93826:function(e,r,i){i.d(r,{n:()=>a});var n=i(32909),t=i(42642),l=i(62540),s=i(56682);let a=e=>{let{paginationProps:r,isTop:i,isCompact:a=!1,idPrefix:d=""}=e;return(0,l.jsx)(s.d,(0,t._)((0,n._)({id:"".concat(d?"".concat(d,"-"):"","pagination-").concat(i?"top":"bottom"),variant:i?s.A.top:s.A.bottom,isCompact:a},r),{widgetId:"pagination-id"}))}},40554:function(e,r,i){i.d(r,{q:()=>a});var n=i(62540),t=i(48655),l=i(92411),s=i(60087);let a=()=>(0,n.jsx)(t.pp,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:s.Ay,variant:t.s$.sm,children:(0,n.jsx)(l.h,{children:"There was an error retrieving data. Check your connection and try again."})})},30448:function(e,r,i){i.d(r,{Ze:()=>b,nJ:()=>j,Oi:()=>f});var n=i(62540),t=i(59394),l=i(81595),s=i(28516),a=i(21758),d=i(78517),o=i(40554),c=i(48655),u=i(92411),h=i(28469);let x=e=>{let{title:r,description:i}=e;return(0,n.jsx)(c.pp,{titleText:r,headingLevel:"h4",icon:h.Ay,variant:c.s$.sm,children:i&&(0,n.jsx)(u.h,{children:i})})},m=()=>(0,n.jsx)(x,{title:"No data available",description:"No data available to be shown here."}),j=e=>{let{numRenderedColumns:r,isLoading:i=!1,isError:c=!1,isNoData:u=!1,errorEmptyState:h=null,noDataEmptyState:x=null,children:j}=e;return(0,n.jsx)(n.Fragment,{children:i?(0,n.jsx)(s.N,{"aria-label":"Table loading",children:(0,n.jsx)(a.Tr,{children:(0,n.jsx)(d.Td,{colSpan:r,children:(0,n.jsx)(t.a,{children:(0,n.jsx)(l.y,{size:"xl"})})})})}):c?(0,n.jsx)(s.N,{"aria-label":"Table error",children:(0,n.jsx)(a.Tr,{children:(0,n.jsx)(d.Td,{colSpan:r,children:(0,n.jsx)(t.a,{children:h||(0,n.jsx)(o.q,{})})})})}):u?(0,n.jsx)(s.N,{"aria-label":"Table empty",children:(0,n.jsx)(a.Tr,{children:(0,n.jsx)(d.Td,{colSpan:r,children:(0,n.jsx)(t.a,{children:x||(0,n.jsx)(m,{})})})})}):j})};var p=i(40384);let b=e=>{let{numColumnsBeforeData:r,numColumnsAfterData:i,children:t}=e;return(0,n.jsxs)(n.Fragment,{children:[Array(r).fill(null).map((e,r)=>(0,n.jsx)(p.Th,{screenReaderText:"before-data-".concat(r)},r)),t,Array(i).fill(null).map((e,r)=>(0,n.jsx)(p.Th,{screenReaderText:"after-data-".concat(r)},r))]})};var v=i(32909);let f=e=>{let{isExpansionEnabled:r=!1,expandableVariant:i,getSelectCheckboxTdProps:t,propHelpers:{getSingleExpandButtonTdProps:l},item:s,rowIndex:a,children:o}=e;return(0,n.jsxs)(n.Fragment,{children:[r&&"single"===i?(0,n.jsx)(d.Td,(0,v._)({},l({item:s,rowIndex:a}))):null,t?(0,n.jsx)(d.Td,(0,v._)({},t({item:s,rowIndex:a}))):null,o]})}},64377:function(e,r,i){i.d(r,{j:()=>t});var n=i(62540);let t=e=>{let{vulnerability:r}=e;return(0,n.jsxs)("p",{children:[r.withdrawn&&(0,n.jsx)("em",{children:"Rejected:\xa0"}),r.title||r.description]})}},19595:function(e,r,i){i.d(r,{F:()=>s});var n=i(62540),t=i(69548),l=i(71284);let s=e=>{var r;let{value:i}=e,s=null!=(r=l.pJ[i])?r:{name:i,color:void 0};return(0,n.jsx)(t.J,{color:s.color,children:s.name})}},12063:function(e,r,i){i.d(r,{f:()=>o});var n=i(32909),t=i(42642),l=i(63696),s=i(31903);let a=(e,r)=>e.sbom.id===r.sbom.id&&e.sbomStatus===r.sbomStatus,d={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0,under_investigation:0}},o=e=>{let{vulnerability:r,isFetching:i,fetchError:o}=(0,s.uN)(e);return{data:l.useMemo(()=>{let e,i;return i=(e=((null==r?void 0:r.advisories)||[]).flatMap(e=>{var r;return(null!=(r=e.sboms)?r:[]).flatMap(r=>Object.entries(r.purl_statuses||{}).map(i=>{let[t,l]=i;return{sbom:(0,n._)({},r),sbomStatus:t,advisory:e,packages:l}}))}).reduce((e,r)=>{let i,l=e.find(e=>a(e,r));if(l)i=[...e.filter(e=>!a(e,l)),(0,t._)((0,n._)({},l),{relatedPackages:[...l.relatedPackages,{advisory:r.advisory,packages:r.packages}]})];else{let n={sbom:r.sbom,sbomStatus:r.sbomStatus,relatedPackages:[{advisory:r.advisory,packages:r.packages}]};i=[...e.slice(),n]}return i},[])).reduce((e,r)=>{let i=r.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:(0,t._)((0,n._)({},e.sbomStatus),{[i]:e.sbomStatus[i]+1})})},(0,n._)({},d)),{sboms:e,summary:i}},[r]),isFetching:i,fetchError:o}}},66981:function(e,r,i){i.r(r),i.d(r,{default:()=>el});var n=i(62540),t=i(63696),l=i(74343),s=i(68430),a=i(98261),d=i(75530),o=i(28338),c=i(70045),u=i(42957),h=i(40989),x=i(60423),m=i(40111),j=i(93472),p=i(52526),b=i(52362),v=i(27875),f=i(24296),_=i(45969),y=i(31903),g=i(32909),T=i(42642),S=i(61360),w=i(35048),P=i(32490),K=i(26917),E=i(16646),N=i(21758),k=i(40384),F=i(28516),C=i(78517),A=i(81592),q=i(93826),I=i(30448),V=i(73470),R=i(23909);let J=e=>{let{advisories:r}=e,i=(0,V.vY)({tableName:"advisory-table",idProperty:"uuid",items:r,isLoading:!1,columnNames:{identifier:"ID",title:"Title",type:"Type",revision:"Revision",vulnerabilities:"Vulnerabilities"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.identifier}),isPaginationEnabled:!0,initialItemsPerPage:10,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:"search",getItemValue:e=>{var r;return null!=(r=e.identifier)?r:""}}]}),{currentPageItems:t,numRenderedColumns:s,propHelpers:{toolbarProps:a,filterToolbarProps:d,paginationToolbarItemProps:o,paginationProps:c,tableProps:u,getThProps:h,getTrProps:x,getTdProps:m}}=i;return(0,n.jsxs)(n.Fragment,{children:[i.isFilterEnabled&&(0,n.jsx)(S.M,(0,T._)((0,g._)({},a),{"aria-label":"Advisory toolbar",children:(0,n.jsxs)(w.P,{children:[(0,n.jsx)(A.Us,(0,g._)({},d)),(0,n.jsx)(P.T,(0,T._)((0,g._)({},o),{children:(0,n.jsx)(q.n,{idPrefix:"advisory-table",isTop:!0,paginationProps:c})}))]})})),(0,n.jsxs)(K.X,(0,T._)((0,g._)({},u),{"aria-label":"Advisory table",children:[(0,n.jsx)(E.d,{children:(0,n.jsx)(N.Tr,{children:(0,n.jsxs)(I.Ze,(0,T._)((0,g._)({},i),{children:[(0,n.jsx)(k.Th,(0,g._)({},h({columnKey:"identifier"}))),(0,n.jsx)(k.Th,(0,g._)({},h({columnKey:"title"}))),(0,n.jsx)(k.Th,(0,g._)({},h({columnKey:"type"}))),(0,n.jsx)(k.Th,(0,g._)({},h({columnKey:"revision"}))),(0,n.jsx)(k.Th,(0,g._)({},h({columnKey:"vulnerabilities"})))]}))})}),(0,n.jsx)(I.nJ,{isLoading:!1,isError:void 0,isNoData:0===r.length,numRenderedColumns:s,children:(0,n.jsx)(F.N,{children:null==t?void 0:t.map(e=>(0,n.jsxs)(N.Tr,(0,T._)((0,g._)({},x({item:e})),{children:[(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:20,modifier:"breakWord"},m({columnKey:"identifier"})),{children:(0,n.jsx)(l.N_,{to:(0,l.tW)(b.Jh.advisoryDetails,{advisoryId:e.uuid}),children:e.document_id})})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:50,modifier:"truncate"},m({columnKey:"title"})),{children:e.title})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10,modifier:"truncate"},m({columnKey:"type"})),{children:e.labels.type})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10,modifier:"truncate"},m({columnKey:"revision"})),{children:(0,R.Yq)(e.modified)})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10,modifier:"truncate"},m({columnKey:"vulnerabilities"})),{children:e.number_of_vulnerabilities}))]}),e.identifier))})})]})),(0,n.jsx)(q.n,{idPrefix:"advisory-table",isTop:!1,paginationProps:c})]})};var M=i(38914),D=i(57901),O=i(76072),W=i(97299),B=i(24974),U=i(3939),Z=i(1020),L=i(18315),Y=i(66542),H=i(18199),X=i(64377);let Q=e=>{let{vulnerability:r}=e;return(0,n.jsx)(M.B,{hasGutter:!0,children:(0,n.jsx)(D.a,{children:(0,n.jsxs)(O.x,{hasGutter:!0,children:[(0,n.jsx)(W.E,{md:10,children:(0,n.jsx)(O.x,{children:(0,n.jsx)(W.E,{md:8,children:(0,n.jsx)(B.W,{children:(0,n.jsx)(U.d,{children:(0,n.jsx)(X.j,{vulnerability:r})})})})})}),(0,n.jsx)(W.E,{md:10,children:(0,n.jsxs)(Z.B,{columnModifier:{default:"3Col"},children:[(0,n.jsxs)(B.W,{children:[(0,n.jsx)(L.B,{children:(0,n.jsx)(Y.A,{bodyContent:(0,n.jsx)("div",{children:"The date the Vulnerability identifier was assigned by CVE Numbering Authority (CNA)."}),children:(0,n.jsx)(H.D,{children:"Reserved"})})}),(0,n.jsx)(U.d,{children:(0,R.Yq)(r.reserved)})]}),(0,n.jsxs)(B.W,{children:[(0,n.jsx)(L.B,{children:(0,n.jsx)(Y.A,{bodyContent:(0,n.jsx)("div",{children:"The date the Vulnerability went public."}),children:(0,n.jsx)(H.D,{children:"Published"})})}),(0,n.jsx)(U.d,{children:(0,R.Yq)(r.published)})]}),(0,n.jsxs)(B.W,{children:[(0,n.jsx)(L.B,{children:(0,n.jsx)(Y.A,{bodyContent:(0,n.jsx)("div",{children:"The last date when information for this Vulnerability was updated in the National Vulnerability Database (NVD)."}),children:(0,n.jsx)(H.D,{children:"Modified"})})}),(0,n.jsx)(U.d,{children:(0,R.Yq)(r.modified)})]})]})})]})})})};var G=i(95285),$=i.n(G),z=i(38139),ee=i(85790),er=i(19595),ei=i(12063),en=i(21328);let et=e=>{let{vulnerabilityId:r}=e,{data:{sboms:i},isFetching:s,fetchError:a}=(0,ei.f)(r),d=t.useMemo(()=>i.map(e=>{let r=e.relatedPackages.flatMap(e=>e.packages).reduce((e,r)=>e.find(e=>e.uuid===r.uuid)?e:[...e.slice(),r],[]).map(e=>{let r=(0,R.fe)(e.purl);return{purlSummary:e,decomposedPurl:r}});return(0,T._)((0,g._)({},e),{allUniquePackages:r})}),[i]),o=(0,en.f)(d,e=>"".concat(e.sbom.id,"-").concat(e.sbomStatus)),c=(0,V.vY)({tableName:"sboms-table",idProperty:"_ui_unique_id",items:o,isLoading:s,columnNames:{name:"Name",version:"Version",status:"Status",dependencies:"Dependencies",supplier:"Supplier",created:"Created on"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","dependencies","created"],getSortValues:e=>{var r;return{name:e.sbom.name,dependencies:e.sbom.number_of_packages,created:(null==(r=e.sbom)?void 0:r.published)?$()(e.sbom.published).valueOf():0}},isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:"search",getItemValue:e=>{var r,i;return null!=(i=null==(r=e.sbom)?void 0:r.name)?i:""}}],isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:u,numRenderedColumns:h,propHelpers:{toolbarProps:x,paginationToolbarItemProps:m,paginationProps:j,tableProps:p,getThProps:v,getTrProps:f,getTdProps:_,getExpandedContentTdProps:y},expansionDerivedState:{isCellExpanded:A}}=c;return(0,n.jsxs)(n.Fragment,{children:[c.isFilterEnabled&&(0,n.jsx)(S.M,(0,T._)((0,g._)({},x),{"aria-label":"Sbom toolbar",children:(0,n.jsx)(w.P,{children:(0,n.jsx)(P.T,(0,T._)((0,g._)({},m),{children:(0,n.jsx)(q.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:j})}))})})),(0,n.jsxs)(K.X,(0,T._)((0,g._)({},p),{"aria-label":"Sbom table",children:[(0,n.jsx)(E.d,{children:(0,n.jsx)(N.Tr,{children:(0,n.jsxs)(I.Ze,(0,T._)((0,g._)({},c),{children:[(0,n.jsx)(k.Th,(0,g._)({},v({columnKey:"name"}))),(0,n.jsx)(k.Th,(0,g._)({},v({columnKey:"version"}))),(0,n.jsx)(k.Th,(0,g._)({},v({columnKey:"status"}))),(0,n.jsx)(k.Th,(0,g._)({},v({columnKey:"dependencies"}))),(0,n.jsx)(k.Th,(0,g._)({},v({columnKey:"supplier"}))),(0,n.jsx)(k.Th,(0,g._)({},v({columnKey:"created"})))]}))})}),(0,n.jsx)(I.nJ,{isLoading:s,isError:!!a,isNoData:0===o.length,numRenderedColumns:h,children:null==u?void 0:u.map((e,r)=>{var i,t,s,a;return(0,n.jsxs)(F.N,{isExpanded:A(e),children:[(0,n.jsx)(N.Tr,(0,T._)((0,g._)({},f({item:e})),{children:(0,n.jsxs)(I.Oi,(0,T._)((0,g._)({},c),{item:e,rowIndex:r,children:[(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:25,modifier:"breakWord"},_({columnKey:"name"})),{children:(0,n.jsx)(l.N_,{to:(0,l.tW)(b.Jh.sbomDetails,{sbomId:e.sbom.id}),children:null==e||null==(i=e.sbom)?void 0:i.name})})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10,modifier:"truncate"},_({columnKey:"version"})),{children:null==(t=e.sbom)?void 0:t.version})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10},_({columnKey:"status"})),{children:(0,n.jsx)(er.F,{value:e.sbomStatus})})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10},_({columnKey:"dependencies",isCompoundExpandToggle:!0,item:e,rowIndex:r})),{children:e.allUniquePackages.length})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10,modifier:"truncate"},_({columnKey:"supplier"})),{children:null==e||null==(s=e.sbom)?void 0:s.suppliers.join(", ")})),(0,n.jsx)(C.Td,(0,T._)((0,g._)({width:10,modifier:"truncate"},_({columnKey:"created"})),{children:(0,R.Yq)(null==(a=e.sbom)?void 0:a.published)}))]}))})),A(e)?(0,n.jsx)(N.Tr,{isExpanded:!0,children:(0,n.jsx)(C.Td,(0,T._)((0,g._)({},y({item:e})),{children:(0,n.jsx)(z.g,{children:A(e,"dependencies")?(0,n.jsxs)(K.X,{variant:"compact",children:[(0,n.jsx)(E.d,{children:(0,n.jsxs)(N.Tr,{children:[(0,n.jsx)(k.Th,{children:"Type"}),(0,n.jsx)(k.Th,{children:"Namespace"}),(0,n.jsx)(k.Th,{children:"Name"}),(0,n.jsx)(k.Th,{children:"Version"}),(0,n.jsx)(k.Th,{children:"Path"}),(0,n.jsx)(k.Th,{children:"Qualifiers"})]})}),(0,n.jsx)(F.N,{children:e.allUniquePackages.map(e=>{var r,i,t,s,a,d,o;return(0,n.jsxs)(N.Tr,{children:[(0,n.jsx)(C.Td,{children:null==(r=e.decomposedPurl)?void 0:r.type}),(0,n.jsx)(C.Td,{children:null==(i=e.decomposedPurl)?void 0:i.namespace}),(0,n.jsx)(C.Td,{children:(0,n.jsx)(l.N_,{to:(0,l.tW)(b.Jh.packageDetails,{packageId:e.purlSummary.uuid}),children:null==(t=e.decomposedPurl)?void 0:t.name})}),(0,n.jsx)(C.Td,{children:null==(s=e.decomposedPurl)?void 0:s.version}),(0,n.jsx)(C.Td,{children:null==(a=e.decomposedPurl)?void 0:a.path}),(0,n.jsx)(C.Td,{children:(null==(d=e.decomposedPurl)?void 0:d.qualifiers)&&(0,n.jsx)(ee.a,{value:null==(o=e.decomposedPurl)?void 0:o.qualifiers})})]},e.purlSummary.uuid)})})]}):null})}))}):null]},e._ui_unique_id)})})]})),(0,n.jsx)(q.n,{idPrefix:"sboms-table",isTop:!1,paginationProps:j})]})},el=()=>{var e;let r=(0,b.Lu)("vulnerabilityId"),{vulnerability:i,isFetching:g,fetchError:T}=(0,y.uN)(r),[S,w]=(0,t.useState)(0),P=t.createRef(),K=t.createRef();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.d8,{type:"breadcrumb",children:(0,n.jsxs)(a.Q,{children:[(0,n.jsx)(d.J,{children:(0,n.jsx)(l.N_,{to:b.Jh.vulnerabilities,children:"Vulnerabilities"})}),(0,n.jsx)(d.J,{isActive:!0,children:"Vulnerability details"})]})}),(0,n.jsxs)(s.d8,{children:[(0,n.jsxs)(o.s,{children:[(0,n.jsx)(c.Z,{children:(0,n.jsx)(u.U,{children:(0,n.jsxs)(u.U,{component:"h1",children:[null!=(e=null==i?void 0:i.identifier)?e:""," "]})})}),(0,n.jsx)(c.Z,{children:i&&(0,n.jsx)(_.h,{value:(0,v.U)(i.average_severity),score:i.average_score,showLabel:!0,showScore:!0})})]}),(0,n.jsx)("div",{className:p.A.mtSm,children:(0,n.jsx)(f.a,{isFetching:g,fetchError:T,children:i&&(0,n.jsx)(Q,{vulnerability:i})})})]}),(0,n.jsx)(s.d8,{children:(0,n.jsxs)(h.t,{mountOnEnter:!0,activeKey:S,onSelect:(e,r)=>{w(r)},"aria-label":"Vulnerability detail tabs",role:"region",children:[(0,n.jsx)(x.o,{eventKey:0,title:(0,n.jsx)(m.V,{children:"Related SBOMs"}),tabContentId:"refTabSbomsSection",tabContentRef:P,"aria-label":"Related SBOMs for this Vulnerability"}),(0,n.jsx)(x.o,{eventKey:1,title:(0,n.jsx)(m.V,{children:"Related Advisories"}),tabContentId:"refTabAdvisoriesSection",tabContentRef:K,"aria-label":"Advisories that explain the current Vulnerability"})]})}),(0,n.jsxs)(s.d8,{children:[(0,n.jsx)(j.J,{eventKey:0,id:"refTabSbomsSection",ref:P,"aria-label":"Related SBOMs",children:(0,n.jsx)(et,{vulnerabilityId:r})}),(0,n.jsx)(j.J,{eventKey:1,id:"refTabAdvisoriesSection",ref:K,"aria-label":"Related Advisories",hidden:!0,children:(0,n.jsx)(J,{isFetching:g,fetchError:T,advisories:(null==i?void 0:i.advisories)||[]})})]})]})}},31903:function(e,r,i){i.d(r,{Bi:()=>u,WJ:()=>c,uN:()=>h});var n=i(32909),t=i(77184),l=i(3822),s=i(96002),a=i(86141),d=i(73470);let o="vulnerabilities",c=function(){var e,r,i;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:u,isLoading:h,error:x,refetch:m}=(0,t.I)({queryKey:[o,l],queryFn:()=>(0,a.NI)({client:s.S,query:(0,n._)({},(0,d.kd)(l))}),enabled:!c});return{result:{data:(null==u||null==(e=u.data)?void 0:e.items)||[],total:null!=(i=null==u||null==(r=u.data)?void 0:r.total)?i:0,params:l},isFetching:h,fetchError:x,refetch:m}},u=e=>{var r;let i={ids:e.reduce((e,r,i)=>(i%100==0?e.push([r]):e[e.length-1].push(r),e),[]),dataResolver:async e=>(await (0,a.ns)({client:s.S,body:{purls:e}})).data},n=(0,l.E)({queries:i.ids.map(e=>({queryKey:[o,e],queryFn:()=>i.dataResolver(e),retry:!1}))}),t=n.some(e=>{let{isFetching:r}=e;return r}),d=n.find(e=>{let{error:r}=e;return!!r}),c={};if(!t)for(let e of n.map(e=>{var r;return null!=(r=null==e?void 0:e.data)?r:{}}))for(let[r,i]of Object.entries(e))c[r]=i;return{analysisResponse:c,isFetching:t,fetchError:null!=(r=null==d?void 0:d.error)?r:void 0}},h=e=>{let{data:r,isLoading:i,error:n}=(0,t.I)({queryKey:[o,e],queryFn:()=>(0,a.dZ)({client:s.S,path:{id:e}})});return{vulnerability:null==r?void 0:r.data,isFetching:i,fetchError:n}}},21328:function(e,r,i){i.d(r,{f:()=>a});var n=i(32909),t=i(42642),l=i(63696),s=i(98259);let a=(e,r)=>(0,l.useMemo)(()=>e&&0!==e.length?e.map(e=>(0,t._)((0,n._)({},e),{[s.FA]:r(e)})):[],[e,r])}}]);