"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["503"],{81895:function(e,t,s){s.d(t,{J4:()=>p,SP:()=>h,Z3:()=>y,hP:()=>d});var r=s(32909),a=s(42642),n=s(46165),l=s(98259);s(56161);let i="/api",o="".concat(i,"/v2/advisory"),u="".concat(i,"/v2/sbom"),c=e=>{let t="application/json";return e.name.endsWith(".bz2")&&(t="application/json+bzip2"),t},d=(e,t)=>{let s=e.get(l.fs);return n.A.post("".concat(o),s,(0,a._)((0,r._)({},t),{headers:{"Content-Type":c(s)}}))},p=(e,t)=>{let s=e.get(l.fs);return n.A.post("".concat(u),s,(0,a._)((0,r._)({},t),{headers:{"Content-Type":c(s)}}))},h=(e,t)=>{let s=e.get(l.fs);return n.A.post("/api/v2/ui/extract-sbom-purls",s,(0,a._)((0,r._)({},t),{headers:{"Content-Type":c(s)}}))},y=e=>n.A.get("".concat(u,"/").concat(e,"/license-export"),{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},90165:function(e,t,s){s.d(t,{h:()=>b});var r=s(62540),a=s(63696),n=s(72775),l=s(56129),i=s(13767),o=s(8406),u=s(99205),c=s(16681),d=s(81595),p=s(38927),h=s(80057),y=s(13021),f=s(94279),v=s(16172),g=s(56279),m=s(84608);let b=e=>{let{uploads:t,handleUpload:s,handleRemoveUpload:b,extractSuccessMessage:j,extractErrorMessage:x}=e,[E,q]=a.useState(!1),[_,w]=a.useState("inProgress"),[F,R]=a.useState([]);!E&&t.size>0&&q(!0),a.useEffect(()=>{let e=Array.from(t.values());e.some(e=>"inProgress"===e.status)?w("inProgress"):e.every(e=>"complete"===e.status)?w("success"):w("danger")},[t]);let S=Array.from(t.values()).filter(e=>e.response).length;return(0,r.jsxs)(n.w,{onFileDrop:(e,t)=>{s(t)},dropzoneProps:{accept:{"application/xml":[".json",".bz2"]},onDropRejected:e=>{R(e)},useFsAccessApi:!1},children:[(0,r.jsx)(l.x,{titleIcon:(0,r.jsx)(m.Ay,{}),titleText:"Drag and drop files here",titleTextSeparator:"or",infoText:"Accepted file types: .json, .bz2"}),E&&(0,r.jsx)(i.y,{statusToggleText:"".concat(S," of ").concat(t.size," files uploaded"),statusToggleIcon:_,children:Array.from(t.entries()).map((e,t)=>{let[s,a]=e;return(0,r.jsx)(o.L,{customFileHandler:()=>{},fileIcon:(0,r.jsx)(g.Ay,{}),file:s,onClearClick:()=>(e=>{for(let t of e)b(t)})([s]),progressValue:a.progress,progressVariant:a.error?"danger":a.response?"success":void 0,progressHelperText:a.error?(0,r.jsx)(u.E,{isLiveRegion:!0,children:(0,r.jsx)(c.j,{variant:"error",children:x(a.error)})}):100!==a.progress||a.response?a.response?(0,r.jsx)(u.E,{isLiveRegion:!0,children:(0,r.jsx)(c.j,{variant:"default",children:j(a.response)})}):void 0:(0,r.jsx)(u.E,{isLiveRegion:!0,children:(0,r.jsxs)(c.j,{variant:"warning",children:[(0,r.jsx)(d.y,{isInline:!0}),"File uploaded. Waiting for the server to process it."]})})},"".concat(s.name,"-").concat(t))})}),(0,r.jsxs)(p.a,{isOpen:F.length>0,"aria-label":"unsupported file upload attempted",onClose:()=>R([]),variant:"small",children:[(0,r.jsx)(h.r,{title:"Unsupported files",titleIconVariant:"warning"}),(0,r.jsx)(y.c,{children:(0,r.jsx)(f.B8,{children:F.map(e=>(0,r.jsx)(v.c,{children:e.file.name},e.file.name))})})]})]})}},93531:function(e,t,s){s.d(t,{v:()=>d});var r=s(32909),a=s(42642),n=s(63696),l=s(98259),i=s(46165);let o="cancelled",u=()=>({progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0}),c=(e,t)=>{switch(t.type){case"queueUpload":return(0,a._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,a._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{status:"queued",cancelFn:t.payload.cancelFn}))});case"updateUploadProgress":return(0,a._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,a._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{progress:t.payload.progress||0,status:"inProgress"}))});case"finishUploadSuccessfully":return(0,a._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,a._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{status:"complete",response:t.payload.response}))});case"finishUploadWithError":var s;return(0,a._)((0,r._)({},e),{uploads:new Map(e.uploads).set(t.payload.file,(0,a._)((0,r._)({},e.uploads.get(t.payload.file)||u()),{status:"complete",error:t.payload.error,wasCancelled:(null==(s=t.payload.error)?void 0:s.message)===o}))});case"removeUpload":{let s=new Map(e.uploads);return s.delete(t.payload.file),(0,a._)((0,r._)({},e),{uploads:s})}default:throw Error()}},d=e=>{let{parallel:t,uploadFn:s,onSuccess:r,onError:a}=e,[u,d]=n.useReducer(c,{uploads:new Map});return{uploads:u.uploads,handleUpload:e=>{let n=[];for(let t=0;t<e.length;t++){let s=e[t],u=new FormData;u.set(l.fs,s);let c=i.A.CancelToken.source(),p={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{var t;let r=null!=(t=e.total)?t:1;d({type:"updateUploadProgress",payload:{file:s,progress:Math.round(e.loaded/r*100)}})},cancelToken:c.token};d({type:"queueUpload",payload:{file:s,cancelFn:c}});let h={formData:u,config:p,thenFn:e=>{d({type:"finishUploadSuccessfully",payload:{file:s,response:e}}),r&&r(e,s)},catchFn:e=>{d({type:"finishUploadWithError",payload:{file:s,error:e}}),e.message!==o&&a&&a(e,s)}};n.push(h)}if(t)for(let e of n)s(e.formData,e.config).then(e.thenFn).catch(e.catchFn);else n.reduce(async(e,t)=>(await e,s(t.formData,t.config).then(t.thenFn).catch(t.catchFn)),Promise.resolve())},handleCancelUpload:e=>{var t,s;null==(s=u.uploads.get(e))||null==(t=s.cancelFn)||t.cancel(o)},handleRemoveUpload:e=>{d({type:"removeUpload",payload:{file:e}})}}}},32804:function(e,t,s){s.r(t),s.d(t,{default:()=>p});var r=s(62540),a=s(74343),n=s(68430),l=s(98261),i=s(75530),o=s(42957),u=s(90165),c=s(30111),d=s(52362);let p=()=>{let{uploads:e,handleUpload:t,handleRemoveUpload:s}=(0,c.sn)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.d8,{type:"breadcrumb",children:(0,r.jsxs)(l.Q,{children:[(0,r.jsx)(i.J,{children:(0,r.jsx)(a.N_,{to:d.Jh.sboms,children:"SBOMs"})}),(0,r.jsx)(i.J,{isActive:!0,children:"Upload SBOM"})]})}),(0,r.jsx)(n.d8,{children:(0,r.jsxs)(o.U,{children:[(0,r.jsx)(o.U,{component:"h1",children:"Upload SBOM"}),(0,r.jsx)(o.U,{component:"p",children:"Upload a Software Bill of Materials (SBOM) document. We accept CycloneDX versions 1.3, 1.4, 1.5 and 1.6, and System Package Data Exchange (SPDX) versions 2.2, and 2.3."})]})}),(0,r.jsx)(n.d8,{children:(0,r.jsx)(u.h,{uploads:e,handleUpload:t,handleRemoveUpload:s,extractSuccessMessage:e=>"".concat(e.data.document_id," uploaded"),extractErrorMessage:e=>{var t;return(null==(t=e.response)?void 0:t.data)?e.message:"Error while uploading file"}})})]})}},30111:function(e,t,s){s.d(t,{DH:()=>_,Qr:()=>q,_P:()=>g,bj:()=>F,cF:()=>E,i$:()=>m,l6:()=>j,rj:()=>b,sn:()=>x,zY:()=>w});var r=s(32909),a=s(42642),n=s(72610),l=s(77184),i=s(59722),o=s(62603),u=s(90130),c=s(3822),d=s(96002),p=s(86141),h=s(93531),y=s(81895),f=s(73470);let v="sboms",g=e=>{let{data:t,isLoading:s,error:r,refetch:a}=(0,l.I)({queryKey:[v,"labels",e],queryFn:()=>(0,p.Dw)({client:d.S,query:{limit:10,filter_text:e}}),placeholderData:i.rX});return{labels:(null==t?void 0:t.data)||[],isFetching:s,fetchError:r,refetch:a}},m=function(){var e,t,s;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=(0,f.kd)(i),{q:h}=c,y=(0,n._)(c,["q"]),g=(0,f.Er)(o),{data:m,isLoading:b,error:j,refetch:x}=(0,l.I)({queryKey:[v,i,g],queryFn:()=>(0,p.z1)({client:d.S,query:(0,a._)((0,r._)({},y),{q:[h,g].filter(e=>e).join("&")})}),enabled:!u});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(s=null==m||null==(t=m.data)?void 0:t.total)?s:0,params:i},isFetching:b,fetchError:j,refetch:x}},b=(e,t,s)=>{let{data:r,isLoading:a,error:n}=(0,l.I)({queryKey:[v,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,p.a7)({client:d.S,path:{id:e}}),enabled:!!e,refetchInterval:t,retry:s});return{sbom:null==r?void 0:r.data,isFetching:a,fetchError:n}},j=(e,t)=>{let s=(0,o.jE)();return(0,u.n)({mutationFn:async e=>(await (0,p.bS)({client:d.S,path:{id:e}})).data,onSuccess:async(t,r)=>{e(t,r),await s.invalidateQueries({queryKey:[v]}),s.removeQueries({queryKey:[v,r]})},onError:async e=>{t(e),await s.invalidateQueries({queryKey:[v]})}})},x=()=>{let e=(0,o.jE)();return(0,h.v)({parallel:!0,uploadFn:(e,t)=>(0,y.J4)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[v]})}})},E=(e,t)=>{let s=(0,o.jE)();return(0,u.n)({mutationFn:e=>(0,p.aB)({client:d.S,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await s.invalidateQueries({queryKey:[v]})},onError:t})},q=function(e){var t,s,a;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:i,isLoading:o,error:u,refetch:c}=(0,l.I)({queryKey:[v,"by-package",e,n],queryFn:()=>(0,p.m9)({client:d.S,query:(0,r._)({purl:e},(0,f.kd)(n))})});return{result:{data:(null==i||null==(t=i.data)?void 0:t.items)||[],total:null!=(a=null==i||null==(s=i.data)?void 0:s.total)?a:0,params:n},isFetching:o,fetchError:u,refetch:c}},_=e=>{let{data:t,isLoading:s,error:r}=(0,l.I)({queryKey:[v,e,"advisory"],queryFn:()=>(0,p.bj)({client:d.S,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:s,fetchError:r}},w=e=>{let t=(0,c.E)({queries:e.map(e=>({queryKey:[v,e,"advisory"],queryFn:()=>(0,p.bj)({client:d.S,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},F=e=>{let{data:t,isLoading:s,error:r}=(0,l.I)({queryKey:[v,e,"license-ids"],queryFn:()=>(0,p.ZV)({client:d.S,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:s,fetchError:r}}},3822:function(e,t,s){s.d(t,{E:()=>f});var r=s(63696),a=s(72739),n=s(97221),l=s(42122),i=s(59722);function o(e,t){let s=new Set(t);return e.filter(e=>!s.has(e))}var u=class extends l.Q{#e;#t;#s;#r;#a;#n;#l;#i;#o=[];constructor(e,t,s){super(),this.#e=e,this.#r=s,this.#s=[],this.#a=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#a.forEach(e=>{e.subscribe(t=>{this.#u(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#a.forEach(e=>{e.destroy()})}setQueries(e,t){this.#s=e,this.#r=t,a.jG.batch(()=>{let e=this.#a,t=this.#c(this.#s);this.#o=t,t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let s=t.map(e=>e.observer),r=s.map(e=>e.getCurrentResult()),a=s.some((t,s)=>t!==e[s]);e.length===s.length&&!a||(this.#a=s,this.#t=r,this.hasListeners()&&(o(e,s).forEach(e=>{e.destroy()}),o(s,e).forEach(e=>{e.subscribe(t=>{this.#u(e,t)})}),this.#d()))})}getCurrentResult(){return this.#t}getQueries(){return this.#a.map(e=>e.getCurrentQuery())}getObservers(){return this.#a}getOptimisticResult(e,t){let s=this.#c(e),r=s.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[r,e=>this.#p(e??r,t),()=>this.#h(r,s)]}#h(e,t){return t.map((s,r)=>{let a=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?a:s.observer.trackResult(a,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#p(e,t){return t?(this.#n&&this.#t===this.#i&&t===this.#l||(this.#l=t,this.#i=this.#t,this.#n=(0,i.BH)(this.#n,t(e))),this.#n):e}#c(e){let t=new Map(this.#a.map(e=>[e.options.queryHash,e])),s=[];return e.forEach(e=>{let r=this.#e.defaultQueryOptions(e),a=t.get(r.queryHash);a?s.push({defaultedQueryOptions:r,observer:a}):s.push({defaultedQueryOptions:r,observer:new n.$(this.#e,r)})}),s}#u(e,t){let s=this.#a.indexOf(e);if(-1!==s){var r;let e;this.#t=(r=this.#t,(e=r.slice(0))[s]=t,e),this.#d()}}#d(){if(this.hasListeners()){let e=this.#n,t=this.#h(this.#t,this.#o);e!==this.#p(t,this.#r?.combine)&&a.jG.batch(()=>{this.listeners.forEach(e=>{e(this.#t)})})}}},c=s(62603),d=s(57321),p=s(15818),h=s(81796),y=s(39481);function f({queries:e,...t},s){let l=(0,c.jE)(s),o=(0,d.w)(),f=(0,p.h)(),v=r.useMemo(()=>e.map(e=>{let t=l.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,l,o]);v.forEach(e=>{(0,y.jv)(e),(0,h.LJ)(e,f)}),(0,h.wZ)(f);let[g]=r.useState(()=>new u(l,v,t)),[m,b,j]=g.getOptimisticResult(v,t.combine),x=!o&&!1!==t.subscribed;r.useSyncExternalStore(r.useCallback(e=>x?g.subscribe(a.jG.batchCalls(e)):i.lQ,[g,x]),()=>g.getCurrentResult(),()=>g.getCurrentResult()),r.useEffect(()=>{g.setQueries(v,t)},[v,t,g]);let E=m.some((e,t)=>(0,y.EU)(v[t],e))?m.flatMap((e,t)=>{let s=v[t];if(s){let t=new n.$(l,s);if((0,y.EU)(s,e))return(0,y.iL)(s,t,f);(0,y.nE)(e,o)&&(0,y.iL)(s,t,f)}return[]}):[];if(E.length>0)throw Promise.all(E);let q=m.find((e,t)=>{let s=v[t];return s&&(0,h.$1)({result:e,errorResetBoundary:f,throwOnError:s.throwOnError,query:l.getQueryCache().get(s.queryHash),suspense:s.suspense})});if(q?.error)throw q.error;return b(j())}}}]);