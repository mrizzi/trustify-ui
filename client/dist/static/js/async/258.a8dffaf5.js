"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["258"],{68340:function(e,t,i){i.d(t,{F:()=>u,W:()=>c});var r=i(24246),s=i(27378),l=i(44072),n=i(55096),a=i(94426),o=i(9771),d=i(99915);let c=s.createContext({}),u=e=>{let{children:t}=e,i=(0,a.vZ)({tableName:"sbom",persistenceKeyPrefix:l.yq.sboms,persistTo:"urlParams",columnNames:{name:"Name",version:"Version",supplier:"Supplier",published:"Created on",packages:"Dependencies",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","published"],isFilterEnabled:!0,filterCategories:[{categoryKey:l.L4,title:"Filter text",placeholderText:"Search",type:n.vA.search},{categoryKey:"published",title:"Created on",type:n.vA.dateRange}],isExpansionEnabled:!1}),{result:{data:s,total:u},isFetching:h,fetchError:x}=(0,d.Fz)((0,a.QO)({...i,hubSortFieldKeys:{name:"name",published:"published"}})),p=(0,a.KC)({...i,idProperty:"id",currentPageItems:s,totalItemCount:u,isLoading:h,selectionState:(0,o.U)({items:s,isEqual:(e,t)=>e.id===t.id})});return(0,r.jsx)(c.Provider,{value:{totalItemCount:u,isFetching:h,fetchError:x,tableControls:p},children:t})}},36713:function(e,t,i){i.d(t,{H:()=>F});var r=i(24246),s=i(27378),l=i(65783),n=i(4835),a=i(14350),o=i(11165),d=i(67918),c=i(31423),u=i(94154),h=i(88935),x=i(42835),p=i(37024),j=i(60767),y=i(62126),m=i(11797),f=i(6364),g=i(35843),b=i(83330),v=i(74889);let C=e=>{let{sbomId:t}=e,{data:i,isFetching:s,fetchError:l}=(0,v.A)(t);return(0,r.jsx)(g.u,{isFetching:s,fetchError:l,isFetchingState:(0,r.jsx)(m.O,{screenreaderText:"Loading contents"}),fetchErrorState:(0,r.jsx)(f._,{color:"red",children:"Error"}),children:(0,r.jsx)(b.u,{severities:i.summary.vulnerabilityStatus.affected.severities})})};var k=i(68340);let F=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:m}=s.useContext(k.W),{numRenderedColumns:f,currentPageItems:g,propHelpers:{paginationProps:b,tableProps:v,getThProps:F,getTrProps:S,getTdProps:P},expansionDerivedState:{isCellExpanded:T}}=m,{downloadSBOM:K,downloadSBOMLicenses:w}=(0,j.i)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.i,{...v,"aria-label":"sbom-table",children:[(0,r.jsx)(a.h,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(p.qK,{...m,children:[(0,r.jsx)(d.Th,{...F({columnKey:"name"})}),(0,r.jsx)(d.Th,{...F({columnKey:"version"})}),(0,r.jsx)(d.Th,{...F({columnKey:"supplier"})}),(0,r.jsx)(d.Th,{...F({columnKey:"published"})}),(0,r.jsx)(d.Th,{...F({columnKey:"packages"})}),(0,r.jsx)(d.Th,{...F({columnKey:"vulnerabilities"})})]})})}),(0,r.jsx)(p.hp,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:f,children:g.map((e,t)=>(0,r.jsx)(c.p,{isExpanded:T(e),children:(0,r.jsx)(o.Tr,{...S({item:e}),children:(0,r.jsxs)(p.Cx,{...m,item:e,rowIndex:t,children:[(0,r.jsx)(u.Td,{width:25,modifier:"breakWord",...P({columnKey:"name",isCompoundExpandToggle:!0,item:e,rowIndex:t}),children:(0,r.jsx)(l.OL,{to:`/sboms/${e.id}`,children:e.name})}),(0,r.jsx)(u.Td,{width:15,modifier:"truncate",...P({columnKey:"version"}),children:e.described_by.map(e=>e.version).filter(e=>e).join(", ")}),(0,r.jsx)(u.Td,{width:20,modifier:"truncate",...P({columnKey:"supplier"}),children:e.suppliers.join(", ")}),(0,r.jsx)(u.Td,{width:10,modifier:"truncate",...P({columnKey:"published"}),children:(0,y.p6)(e.published)}),(0,r.jsx)(u.Td,{width:10,...P({columnKey:"packages"}),children:e.number_of_packages}),(0,r.jsx)(u.Td,{width:20,...P({columnKey:"vulnerabilities"}),children:(0,r.jsx)(C,{sbomId:e.id})}),(0,r.jsx)(u.Td,{isActionCell:!0,children:(0,r.jsx)(h.k,{items:[{title:"Download SBOM",onClick:()=>{K(e.id,`${e.name}.json`)}},{title:"Download License Report",onClick:()=>{w(e.id)}}]})})]})})},e.id))})]}),(0,r.jsx)(x.p,{idPrefix:"sbom-table",isTop:!1,paginationProps:b})]})}},64302:function(e,t,i){i.d(t,{c:()=>u});var r=i(24246),s=i(27378),l=i(27308),n=i(40982),a=i(27763),o=i(55096),d=i(42835),c=i(68340);let u=e=>{let{showFilters:t}=e,{tableControls:i}=s.useContext(c.W),{propHelpers:{toolbarProps:u,filterToolbarProps:h,paginationToolbarItemProps:x,paginationProps:p}}=i;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(l.o,{...u,children:(0,r.jsxs)(n.c,{children:[t&&(0,r.jsx)(o.Ki,{...h}),(0,r.jsx)(a.E,{...x,children:(0,r.jsx)(d.p,{idPrefix:"sbom-table",isTop:!0,paginationProps:p})})]})})})}},14391:function(e,t,i){i.r(t),i.d(t,{default:()=>eF});var r,s=i(24246),l=i(27378),n=i(45043),a=i(27308),o=i(40982),d=i(75070),c=i(25236),u=i(25645),h=i(27763),x=i(44072),p=i(65783),j=i(855),y=i(6364),m=i(62588),f=i(3594),g=i(106),b=i(13754),v=i(14582),C=i(19364),k=i(23662),F=i(68340),S=i(60787),P=i(71008),T=i(99915),K=i(20711);let w=e=>(0,s.jsx)(p.rU,{to:e.navLink,style:{textDecoration:"none"},children:(0,s.jsxs)(j.s,{itemId:e.id,description:e.description,children:[e.title," ",(0,s.jsx)(y._,{color:e.typeColor,children:e.type})]})},e.id),E=e=>{let{onChangeSearch:t}=e,{tableControls:i}=l.useContext(F.W),r=i.filterState.filterValues[x.L4]?.[0]||"",[n,a]=l.useState(r),[o,d]=l.useState(!1),[c,u]=(0,k.nj)(n,500);l.useEffect(()=>{u(n)},[u,n]);let{isFetching:h,list:p}=function(e,t){let i={filters:[{field:x.L4,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:r,result:{data:s}}=(0,S.N7)({...i},t),{isFetching:l,result:{data:n}}=(0,P.fF)({...i},t),{isFetching:a,result:{data:o}}=(0,T.Fz)({...i},t),{isFetching:d,result:{data:c}}=(0,K.fd)({...i},t),u=s.map(e=>({id:`advisory-${e.uuid}`,title:e.document_id,description:e.title?.substring(0,75),navLink:`/advisories/${e.uuid}`,type:"Advisory",typeColor:"blue"})),h=n.map(e=>({id:`package-${e.uuid}`,title:e.purl,navLink:`/packages/${e.uuid}`,type:"Package",typeColor:"cyan"})),p=o.map(e=>({id:`sbom-${e.id}`,title:e.name,description:e.suppliers.join(", "),navLink:`/sboms/${e.id}`,type:"SBOM",typeColor:"purple"})),j=c.map(e=>({id:`vulnerability-${e.identifier}`,title:e.identifier,description:e.description?.substring(0,75),navLink:`/vulnerabilities/${e.identifier}`,type:"Vulnerability",typeColor:"orange"})),y=e.toLowerCase();return{isFetching:r||l||a||d,list:[...j,...p,...u,...h].sort((e,t)=>e.title?.includes(y)?-1:t.title?.includes(y)?1:(e.description||"").toLowerCase().indexOf(y)-(t.description||"").toLowerCase().indexOf(y))}}(c,!o),[y,E]=l.useState(!1),D=l.useRef(null),L=l.useRef(null),R=e=>{""!==e&&D&&D.current&&D.current.contains(document.activeElement)?E(!0):E(!1),a(e),d(!0)};l.useEffect(()=>{let e=e=>{if(y&&D.current&&D.current===e.target){if("Escape"===e.key)E(!1),D.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t=L.current?.querySelector("li > button:not(:disabled)");t&&t?.focus(),e.preventDefault()}else("Tab"===e.key||"Enter"===e.key||"Space"===e.key)&&(E(!1),("Enter"===e.key||"Space"===e.key)&&e.preventDefault())}else y&&L.current?.contains(e.target)&&"Tab"===e.key&&(e.preventDefault(),E(!1),D.current?.focus())},t=e=>{y&&L&&L.current&&!L.current.contains(e.target)&&E(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}},[y]);let O=(0,s.jsx)(m.v,{ref:L,style:{maxWidth:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"},children:(0,s.jsx)(f.D,{children:(0,s.jsx)(g.q,{children:h?(0,s.jsx)(j.s,{itemId:"loading",children:(0,s.jsx)(b.$,{size:"sm"})}):p.map(w)})})}),A=(0,s.jsx)(v.M,{placeholder:"Search for an SBOM, Package, or Vulnerability",value:n,onChange:(e,t)=>R(t),onClear:()=>{a("")},onSearch:()=>{t(n)},onKeyDown:e=>{if(e.key&&"Enter"!==e.key)return},ref:D,id:"autocomplete-search"});return(0,s.jsx)(C.r,{trigger:A,triggerRef:D,popper:O,popperRef:L,isVisible:y&&p.length>0||h,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var D=i(82682),L=i(69694),R=i(91835);function O(e,t){return{Component:e,props:t}}let A=(r=[O(F.F,{}),O(L.u,{}),O(R.W,{}),O(D.F,{})],e=>{let{children:t}=e,i=(0,s.jsx)(s.Fragment,{children:t});return r.reduceRight((e,t)=>{let{Component:i,props:r={}}=t;return(0,s.jsx)(i,{...r,children:e},e.key)},i)});var V=i(99),$=i(11192),H=i(32591),I=i(31757),M=i(51527),W=i(4075),_=i(27090),N=i(75165),Y=i(84780),q=i(64766),z=i(31762),B=i(12621),Z=i(64118),J=i(27317),G=i(93095),U=i(50201),X=i(55096),Q=i(70919);let ee=e=>{let{category:t,filterValue:i,setFilterValue:r}=e,[n,a]=l.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);l.useEffect(()=>{a(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let o=Array.isArray(n)?n:Object.values(n).flat(),d=e=>{if(e&&"No results"!==e){let t;r(i?.includes(e)?i.filter(t=>t!==e):i?[...i,e]:[e])}};return(0,s.jsx)(s.Fragment,{children:o.map((e,r)=>{let{label:l,value:n}=e;return(0,s.jsx)(Q.X,{id:`checkbox-${r}-${t.categoryKey}`,isLabelWrapped:!0,label:l,isChecked:i?.includes(n),onChange:()=>{d(n)}},l)})})};var et=i(51088),ei=i(54816),er=i(77152),es=i(61244),el=i(85189);let en=e=>{let{filterValue:t,setFilterValue:i,isDisabled:r=!1}=e,[n,a]=(0,l.useState)(),[o,d]=(0,l.useState)();return l.useEffect(()=>{if(t?.[0]){let[e,i]=(0,el.bG)(t?.[0]);a(e.toDate()),d(i.toDate())}else a(void 0),d(void 0)},[t]),(0,s.jsxs)(et.l,{children:[(0,s.jsx)(ei.c,{role:"group",isInline:!0,label:"From",children:(0,s.jsx)(er.M,{value:n?(0,el.xR)(n):"",dateFormat:el.xR,dateParse:el.Hy,onChange:(e,t)=>{(0,el.pq)(t)&&(a((0,el.Hy)(t)),d(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:r})}),(0,s.jsx)(ei.c,{role:"group",isInline:!0,label:"To",children:(0,s.jsx)(er.M,{value:o?(0,el.xR)(o):"",onChange:(e,t)=>{if((0,el.pq)(t)){let e=(0,el.Hy)(t);d(e);let r=(0,el.bP)(n,e);r&&i([r])}},isDisabled:r||!(0,es.q)(n),dateFormat:el.xR,dateParse:el.Hy,invalidFormatText:"",rangeStart:n,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})})]})};var ea=i(97656);let eo=e=>{let{category:t,filterValue:i,setFilterValue:r,isDisabled:l=!1}=e,n=e=>t.selectOptions.find(t=>{let{value:i}=t;return i===e}),a=e=>{r(n(e)?[e]:null)};return(0,s.jsx)(s.Fragment,{children:t.selectOptions.map((e,t)=>{let{label:r,value:n}=e,o=i?.includes(n)||!1;return(0,s.jsx)(ea.Y,{isDisabled:l,id:`radio-${t}`,name:"radio",isLabelWrapped:!0,label:r,isChecked:o,onChange:()=>{a(n)}},r)})})};var ed=i(56081),ec=i(34091),eu=i(9767);let eh=e=>{let{category:t,filterValue:i,setFilterValue:r,isNumeric:n,isDisabled:a=!1}=e,[o,d]=l.useState(i?.[0]||"");l.useEffect(()=>{d(i?.[0]||"")},[i]);let c=()=>{let e=o.trim();r(e?[e.replace(/\s+/g," ")]:[])},u=`${t.categoryKey}-input`;return(0,s.jsxs)(ed.B,{children:[(0,s.jsx)(ec.oi,{name:u,id:"search-input",type:n?"number":"search",onChange:(e,t)=>d(t),"aria-label":`${t.title} filter`,value:o,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||c()},isDisabled:a}),(0,s.jsx)(U.zx,{variant:U.Wu.control,id:"search-button","aria-label":"search button for search input",onClick:c,isDisabled:a,children:(0,s.jsx)(eu.ZP,{})})]})},ex=e=>{let{category:t,...i}=e;return t.type===X.vA.select?(0,s.jsx)(eo,{category:t,...i}):t.type===X.vA.search||t.type===X.vA.numsearch?(0,s.jsx)(eh,{category:t,isNumeric:t.type===X.vA.numsearch,...i}):t.type===X.vA.multiselect?(0,s.jsx)(ee,{category:t,...i}):t.type===X.vA.dateRange?(0,s.jsx)(en,{category:t,...i}):null},ep=e=>{let{filterCategories:t,filterValues:i,setFilterValues:r,isDisabled:l=!1,omitFilterCategoryKeys:n=[]}=e,a=(e,t)=>r({...i,[e.categoryKey]:t});return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(J.K,{hasGutter:!0,children:[(0,s.jsx)(G.v,{children:(0,s.jsx)(U.zx,{variant:"link",isInline:!0,onClick:()=>{let e=t.filter(e=>void 0===n.find(t=>t===e.categoryKey)).reduce((e,t)=>Object.assign(e,{[t.categoryKey]:void 0}),{});r({...i,...e})},children:"Clear all filters"})}),t.filter(e=>void 0===n.find(t=>t===e.categoryKey)).map(e=>(0,s.jsx)(G.v,{children:(0,s.jsxs)(J.K,{hasGutter:!0,children:[(0,s.jsx)(G.v,{children:(0,s.jsx)(c.D,{children:(0,s.jsx)(u.x,{component:"h4",children:e.title})})}),(0,s.jsx)(G.v,{children:(0,s.jsx)(ex,{category:e,filterValue:i[e.categoryKey],setFilterValue:t=>a(e,t),isDisabled:l,isSidebar:!0})})]})},e.categoryKey))]})})};var ej=i(68595),ey=i(70852),em=i(94681),ef=i(67239),eg=i(36713),eb=i(64302),ev=i(29212),eC=i(78825);let ek=e=>{let{filterPanelProps:t,sbomTable:i,sbomTotalCount:r,packageTable:n,packageTotalCount:a,vulnerabilityTable:o,vulnerabilityTotalCount:d,advisoryTable:c,advisoryTotalCount:u,isFetchingPackages:h,isFetchingSboms:x,isFetchingVulnerabilities:p,isFetchingAdvisories:j}=e,[y,m]=l.useState(0),{sbomFilterPanelProps:f,packageFilterPanelProps:g,vulnerabilityFilterPanelProps:b,advisoryFilterPanelProps:v}=t,C=l.createRef();return(0,s.jsxs)($.P,{hasGutter:!0,children:[(0,s.jsx)(H.J,{children:(0,s.jsx)(I.Z,{isFullHeight:!0,children:(0,s.jsx)(M.e,{style:{width:241},children:0===y?(0,s.jsx)(ep,{omitFilterCategoryKeys:[""],...f}):1===y?(0,s.jsx)(ep,{omitFilterCategoryKeys:[""],...g}):2===y?(0,s.jsx)(ep,{omitFilterCategoryKeys:[""],...b}):3===y?(0,s.jsx)(ep,{omitFilterCategoryKeys:[""],...v}):null})})}),(0,s.jsx)(H.J,{isFilled:!0,children:(0,s.jsxs)(W.m,{mountOnEnter:!0,isBox:!0,activeKey:y,onSelect:(e,t)=>{m(t)},"aria-label":"Tabs",role:"region",children:[(0,s.jsxs)(_.O,{eventKey:0,title:(0,s.jsxs)(N.T,{children:["SBOMs","  ",(0,s.jsx)(Y.C,{screenReaderText:"Search Result Count",children:x?(0,s.jsx)(q.J,{size:"sm",children:(0,s.jsx)(Z.ZP,{})}):r})]}),actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.b,{"aria-label":"SBOM help popover",ref:C,children:(0,s.jsx)(B.ZP,{})}),(0,s.jsx)(V.J,{bodyContent:(0,s.jsx)("div",{children:"Software Bill of Materials for Products and Containers."}),position:"right",triggerRef:C})]}),children:[(0,s.jsx)(eb.c,{}),i??(0,s.jsx)(eg.H,{})]}),(0,s.jsxs)(_.O,{eventKey:1,title:(0,s.jsxs)(N.T,{children:["Packages","  ",(0,s.jsx)(Y.C,{screenReaderText:"Search Result Count",children:h?(0,s.jsx)(q.J,{size:"sm",children:(0,s.jsx)(Z.ZP,{})}):a})]}),children:[(0,s.jsx)(ef.v,{}),n??(0,s.jsx)(em.L,{})]}),(0,s.jsxs)(_.O,{eventKey:2,title:(0,s.jsxs)(N.T,{children:["Vulnerabilities","  ",(0,s.jsx)(Y.C,{screenReaderText:"Search Result Count",children:p?(0,s.jsx)(q.J,{size:"sm",children:(0,s.jsx)(Z.ZP,{})}):d})]}),children:[(0,s.jsx)(eC.R,{}),o??(0,s.jsx)(ev.u,{})]}),(0,s.jsxs)(_.O,{eventKey:3,title:(0,s.jsxs)(N.T,{children:["Advisories","  ",(0,s.jsx)(Y.C,{screenReaderText:"Advisory Result Count",children:j?(0,s.jsx)(q.J,{size:"sm",children:(0,s.jsx)(Z.ZP,{})}):u})]}),children:[(0,s.jsx)(ey.P,{}),c??(0,s.jsx)(ej.H,{})]})]})})]})},eF=e=>{let{searchBodyOverride:t}=e;return(0,s.jsx)(A,{children:(0,s.jsx)(eS,{searchBodyOverride:t})})},eS=e=>{let{searchBodyOverride:t}=e,{tableControls:i}=l.useContext(F.W),{tableControls:r}=l.useContext(L.a),{tableControls:p}=l.useContext(R.P),{tableControls:j}=l.useContext(D.P),{isFetching:y,totalItemCount:m,tableControls:{propHelpers:{filterPanelProps:f}}}=l.useContext(F.W),{isFetching:g,totalItemCount:b,tableControls:{propHelpers:{filterPanelProps:v}}}=l.useContext(L.a),{isFetching:C,totalItemCount:k,tableControls:{propHelpers:{filterPanelProps:S}}}=l.useContext(R.P),{isFetching:P,totalItemCount:T,tableControls:{propHelpers:{filterPanelProps:K}}}=l.useContext(D.P),w=(0,s.jsx)(ek,{filterPanelProps:{advisoryFilterPanelProps:K,packageFilterPanelProps:v,sbomFilterPanelProps:f,vulnerabilityFilterPanelProps:S},packageTotalCount:b,sbomTotalCount:m,vulnerabilityTotalCount:k,advisoryTotalCount:T,isFetchingPackages:g,isFetchingSboms:y,isFetchingVulnerabilities:C,isFetchingAdvisories:P});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.NP,{variant:n.Dk.light,children:(0,s.jsx)(a.o,{isStatic:!0,children:(0,s.jsxs)(o.c,{children:[(0,s.jsx)(d.k,{align:{default:"alignLeft"},children:(0,s.jsx)(c.D,{children:(0,s.jsx)(u.x,{component:"h1",children:"Search Results"})})}),(0,s.jsx)(d.k,{variant:"icon-button-group",align:{default:"alignRight"},children:(0,s.jsx)(d.k,{visibility:{default:"hidden",lg:"visible"},children:(0,s.jsx)(h.E,{widths:{default:"500px"},children:(0,s.jsx)(E,{onChangeSearch:e=>{void 0!==e&&(i.filterState.setFilterValues({...i.filterState.filterValues,[x.L4]:[e]}),r.filterState.setFilterValues({...r.filterState.filterValues,[x.L4]:[e]}),p.filterState.setFilterValues({...p.filterState.filterValues,[x.L4]:[e]}),j.filterState.setFilterValues({...j.filterState.filterValues,[x.L4]:[e]}))}})})})})]})})}),(0,s.jsx)(n.NP,{children:t||w})]})}}}]);