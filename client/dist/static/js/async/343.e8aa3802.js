"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["343"],{3586:function(e,t,i){i.d(t,{j:()=>l});var r=i(24246),s=i(27378);let l=e=>{let{children:t}=e,[i,l]=s.useState(!1);return(0,r.jsx)(r.Fragment,{children:t(i,l)})}},24200:function(e,t,i){i.d(t,{G:()=>s});var r=i(24246);let s=e=>{let{vulnerability:t}=e;return(0,r.jsxs)("p",{children:[t.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),t.title||t.description]})}},51144:function(e,t,i){i.d(t,{useSbomsOfVulnerability:()=>o});var r=i(27378),s=i(52030);let l=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,a={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},n=e=>{let t=e.flatMap(e=>(e.sboms??[]).flatMap(t=>Object.entries(t.purl_statuses||{}).map(i=>{let[r,s]=i;return{sbom:{...t},sbomStatus:r,advisory:e,packages:s}}))).reduce((e,t)=>{let i,r=e.find(e=>l(e,t));if(r)i=[...e.filter(e=>!l(e,r)),{...r,relatedPackages:[...r.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];else{let r={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};i=[...e.slice(),r]}return i},[]),i=t.reduce((e,t)=>{let i=t.sbomStatus;return Object.assign(e,{total:e.total+1,sbomStatus:{...e.sbomStatus,[i]:e.sbomStatus[i]+1}})},{...a});return{sboms:t,summary:i}},o=e=>{let{vulnerability:t,isFetching:i,fetchError:l}=(0,s.useFetchVulnerabilityById)(e);return{data:r.useMemo(()=>n(t?.advisories||[]),[t]),isFetching:i,fetchError:l}}},27722:function(e,t,i){i.d(t,{P:()=>u,W:()=>d});var r=i(24246),s=i(27378),l=i(74502),a=i(14629),n=i(49988),o=i(52030);let u=s.createContext({}),d=e=>{let{children:t}=e,i=(0,n.vZ)({tableName:"vulnerability",persistenceKeyPrefix:l.yq.vulnerabilities,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Description",severity:"CVSS",published:"Date published",sboms:"Impacted SBOMs"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["published","severity"],initialSort:{columnKey:"published",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:l.L4,title:"Filter text",placeholderText:"Search",type:a.vA.search},{categoryKey:"base_severity",title:"CVSS",placeholderText:"CVSS",type:a.vA.multiselect,selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"published",title:"Created on",type:a.vA.dateRange}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:s,total:d},isFetching:c,fetchError:h}=(0,o.useFetchVulnerabilities)((0,n.QO)({...i,hubSortFieldKeys:{severity:"base_severity",published:"published"}})),b=(0,n.KC)({...i,idProperty:"identifier",currentPageItems:s,totalItemCount:d,isLoading:c});return(0,r.jsx)(u.Provider,{value:{totalItemCount:d,isFetching:c,fetchError:h,tableControls:b},children:t})}},96138:function(e,t,i){i.d(t,{u:()=>F});var r=i(24246),s=i(27378),l=i(65783),a=i(4835),n=i(14350),o=i(11165),u=i(89330),d=i(31423),c=i(94154),h=i(9905),b=i(7615),m=i(57524),y=i(3804),p=i(31336),x=i(24200),f=i(63706),v=i(3586),j=i(11797),g=i(37818),S=i(42573),K=i(51144);let T=e=>{let{vulnerabilityId:t}=e,{data:i,isFetching:s,fetchError:l}=(0,K.useSbomsOfVulnerability)(t);return(0,r.jsx)(g.u,{isFetching:s,fetchError:l,isFetchingState:(0,r.jsx)(j.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(S.C,{error:e}),children:i.summary.sbomStatus.affected})};var w=i(27722);let F=()=>{let{isFetching:e,fetchError:t,totalItemCount:i,tableControls:j}=s.useContext(w.P),{numRenderedColumns:g,currentPageItems:S,propHelpers:{paginationProps:K,tableProps:F,getThProps:C,getTrProps:P,getTdProps:k}}=j;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.i,{...F,"aria-label":"Vulnerability table",children:[(0,r.jsx)(n.h,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(p.qK,{...j,children:[(0,r.jsx)(u.Th,{...C({columnKey:"identifier"})}),(0,r.jsx)(u.Th,{...C({columnKey:"title"})}),(0,r.jsx)(u.Th,{...C({columnKey:"severity"}),info:{tooltip:"The Common Vulnerability Scoring System measuring the severity of security flaws."}}),(0,r.jsx)(u.Th,{...C({columnKey:"published"})}),(0,r.jsx)(u.Th,{...C({columnKey:"sboms"})})]})})}),(0,r.jsx)(p.hp,{isLoading:e,isError:!!t,isNoData:0===i,numRenderedColumns:g,children:S.map((e,t)=>(0,r.jsx)(d.p,{children:(0,r.jsx)(o.Tr,{...P({item:e}),children:(0,r.jsxs)(p.Cx,{...j,item:e,rowIndex:t,children:[(0,r.jsx)(c.Td,{width:15,modifier:"breakWord",...k({columnKey:"identifier",item:e,rowIndex:t}),children:(0,r.jsx)(l.OL,{to:`/vulnerabilities/${e.identifier}`,children:e.identifier})}),(0,r.jsx)(v.j,{children:(t,i)=>(0,r.jsx)(c.Td,{width:45,modifier:"truncate",onFocus:()=>i(!0),onBlur:()=>i(!1),tabIndex:0,...k({columnKey:"title"}),children:(0,r.jsx)(h.cE,{focused:t,wrapModifier:"truncate",children:(0,r.jsx)(x.G,{vulnerability:e})})})}),(0,r.jsx)(c.Td,{width:10,...k({columnKey:"severity"}),children:(0,r.jsx)(m.o,{value:(0,b.g)(e.average_severity),score:e.average_score,showLabel:!0,showScore:!0})}),(0,r.jsx)(c.Td,{width:10,...k({columnKey:"published"}),children:(0,f.p6)(e.published)}),(0,r.jsx)(c.Td,{width:10,...k({columnKey:"sboms",item:e,rowIndex:t}),children:(0,r.jsx)(T,{vulnerabilityId:e.identifier})})]})})},e.identifier))})]}),(0,r.jsx)(y.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:K})]})}},27970:function(e,t,i){i.d(t,{R:()=>c});var r=i(24246),s=i(27378),l=i(70715),a=i(40982),n=i(89226),o=i(14629),u=i(3804),d=i(27722);let c=e=>{let{showFilters:t}=e,{tableControls:i}=s.useContext(d.P),{propHelpers:{toolbarProps:c,filterToolbarProps:h,paginationToolbarItemProps:b,paginationProps:m}}=i;return(0,r.jsx)(l.o,{...c,children:(0,r.jsxs)(a.c,{children:[t&&(0,r.jsx)(o.Ki,{...h}),(0,r.jsx)(n.E,{...b,children:(0,r.jsx)(u.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:m})})]})})}},52030:function(e,t,i){i.d(t,{useFetchVulnerabilities:()=>o,useFetchVulnerabilityById:()=>u});var r=i(1183),s=i(50576),l=i(40371),a=i(49988);let n="vulnerabilities",o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:i,isLoading:o,error:u,refetch:d}=(0,r.useQuery)({queryKey:[n,e],queryFn:()=>(0,l.b5)({client:s.L,query:{...(0,a.rm)(e)}}),enabled:!t});return{result:{data:i?.data?.items||[],total:i?.data?.total??0,params:e},isFetching:o,fetchError:u,refetch:d}},u=e=>{let{data:t,isLoading:i,error:a}=(0,r.useQuery)({queryKey:[n,e],queryFn:()=>(0,l.OG)({client:s.L,path:{id:e}})});return{vulnerability:t?.data,isFetching:i,fetchError:a}}}}]);