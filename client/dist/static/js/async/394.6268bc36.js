"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["394"],{68057:function(e,t,r){r.d(t,{V:()=>a});var i=r(24246),s=r(27378),n=r(63763),l=r(32947);let a=e=>{let{vulnerabilitiesSummary:t}=e,r=s.useMemo(()=>Object.keys(t.severities).map(e=>{let r=t.severities[e],i=l.V4[e];return{severity:e,count:r,label:i.name,color:i.color.value}}).sort((0,l.A0)(e=>e.severity)).reverse(),[t]);return(0,i.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,i.jsx)(n.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${t.total}`,subTitle:"Total vulnerabilities",width:350,legendData:r.map(e=>{let{label:t,count:r}=e;return{name:`${t}: ${r}`}}),data:r.map(e=>{let{label:t,count:r}=e;return{x:t,y:r}}),labels:e=>{let{datum:t}=e;return`${t.x}: ${t.y}`},colorScale:r.map(e=>{let{color:t}=e;return t})})})}},21629:function(e,t,r){r.r(t),r.d(t,{default:()=>eu});var i=r(24246),s=r(45043),n=r(27317),l=r(93095),a=r(14935),d=r(65783),c=r(74485),o=r(76228),h=r(57518),u=r(24216),x=r(13864),j=r(78531),m=r(44870),v=r(93591),y=r(31757),g=r(87069),p=r(51527),b=r(87727),f=r(3498),S=r(68802),F=r(10707),O=r(16668),k=r(30329),P=r(50689),C=r(67761),w=r(81391),M=r(32947),B=r(37818),E=r(82413),$=r(17598),V=r(43959),L=r(63706);let T=[{severity:"critical"},{severity:"high"},{severity:"medium"},{severity:"low"},{severity:"none"},{severity:"unknown"}],K=()=>{let e=(0,a.s0)(),{result:{data:t,total:r},isFetching:s,fetchError:K}=(0,V.Fz)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),{data:I,isFetching:N,fetchError:q}=(0,E.I)(t.map(e=>e.id)),A=I.map(e=>e.summary.vulnerabilityStatus.affected.total).every(e=>0===e),D=(e,t)=>`${" ".repeat(t+1)}${e.name}`,{result:{data:_,total:G},isFetching:Q,fetchError:z}=(0,$.N7)({page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}});return(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(g.l,{children:"Dashboard"}),(0,i.jsx)(p.e,{children:(0,i.jsxs)(b.r,{children:[(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(B.u,{isFetching:s||N,fetchError:K||q.some(e=>!!e),children:(0,i.jsxs)(n.K,{hasGutter:!0,children:[(0,i.jsx)(l.v,{children:(0,i.jsx)(S.V,{children:"Below is a summary of Vulnerability status for the last 10 ingested SBOMs. To view the details, click on an SBOM name. You can also select up to 4 SBOMs to watch."})}),(0,i.jsx)(l.v,{children:t.length>0?(0,i.jsx)("div",{style:{height:320},children:(0,i.jsxs)(c.k,{ariaDesc:"SBOM summary status",domainPadding:{x:[30,25]},legendData:T.map(e=>({name:M.V4[e.severity].name})),legendPosition:"bottom-left",height:375,name:"sbom-summary-status",padding:{bottom:75,left:330,right:50,top:50},themeColor:o.n.multiOrdered,width:700,legendComponent:(0,i.jsx)(h.Q,{y:10,x:200,colorScale:T.map(e=>M.V4[e.severity].color.value)}),children:[(0,i.jsx)(u.C,{label:"Products",axisLabelComponent:(0,i.jsx)(x.D,{dx:0,x:15,y:140}),tickLabelComponent:(0,i.jsx)(x.D,{className:"pf-v6-c-button pf-m-link pf-m-inline",style:[{fill:"#0066cc"}],events:{onClick:r=>{let i=r.target.innerHTML,s=t.find((e,t)=>D(e,t)===i);s&&e(`/sboms/${s.id}`)}}})}),(0,i.jsx)(u.C,{dependentAxis:!0,showGrid:!0,tickValues:A?[1,2,3,4,5,6,7,8,9,10]:void 0,label:"Vulnerabilities by Severity",fixLabelOverlap:!0}),(0,i.jsx)(j.K,{horizontal:!0,colorScale:T.map(e=>M.V4[e.severity].color.value),children:T.map(e=>{let r=M.V4[e.severity];return(0,i.jsx)(m.B,{labelComponent:(0,i.jsx)(v.h,{constrainToVisibleArea:!0}),data:I.map((i,s)=>{let{summary:{vulnerabilityStatus:{affected:n}}}=i,l=t[s],a=e.severity,d=n.severities[a];return{x:D(l,s),y:d,label:`${r.name}: ${d}`}})},e.severity)})})]})}):(0,i.jsx)(F.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:F.IQ.xs,children:(0,i.jsx)(O.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to see your overview."})})})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(B.u,{isFetching:Q||s,fetchError:z||K,children:(0,i.jsxs)(b.r,{hasGutter:!0,children:[(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(k.o,{children:(0,i.jsxs)(P.g,{children:[(0,i.jsx)(C.M,{children:"Last SBOM ingested"}),(0,i.jsx)(w.b,{children:(0,i.jsxs)(n.K,{children:[(0,i.jsx)(l.v,{children:(0,L.o0)(t?.[0]?.ingested)}),(0,i.jsx)(l.v,{children:(0,i.jsx)(d.rU,{to:`/sboms/${t?.[0]?.id}`,children:t?.[0]?.name})})]})})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(k.o,{children:(0,i.jsxs)(P.g,{children:[(0,i.jsx)(C.M,{children:"Total SBOMs"}),(0,i.jsx)(w.b,{children:r})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(k.o,{children:(0,i.jsxs)(P.g,{children:[(0,i.jsx)(C.M,{children:"Last Advisory ingested"}),(0,i.jsx)(w.b,{children:(0,i.jsxs)(n.K,{children:[(0,i.jsx)(l.v,{children:(0,L.o0)(_?.[0]?.ingested)}),(0,i.jsx)(l.v,{children:(0,i.jsx)(d.rU,{to:`/advisories/${_?.[0]?.uuid}`,children:_?.[0]?.document_id})})]})})]})})}),(0,i.jsx)(f.P,{md:6,children:(0,i.jsx)(k.o,{children:(0,i.jsxs)(P.g,{children:[(0,i.jsx)(C.M,{children:"Total Advisories"}),(0,i.jsx)(w.b,{children:G})]})})})]})})})]})})]})};var I=r(27378),N=r(8305),q=r(13754),A=r(15726),D=r(1183),_=r(68e3),G=r(75503),Q=r(50576),z=r(40371);let W="watched-sboms",Z="dashboard",H=()=>{let{data:e,isLoading:t,error:r}=(0,D.a)({queryKey:[Z,W],queryFn:async()=>{try{return(await (0,z.JM)({client:Q.L,path:{key:W}})).data}catch(e){if(404===e.status)return{sbom1Id:null,sbom2Id:null,sbom3Id:null,sbom4Id:null}}}});return{sboms:e,isFetching:t,fetchError:r}},U=(e,t)=>{let r=(0,_.NL)();return(0,G.D)({mutationFn:e=>(0,z.yu)({client:Q.L,path:{key:W},body:e}),onSuccess:(t,i)=>{e(),r.invalidateQueries({queryKey:[Z,W]})},onError:t})},Y=I.createContext({}),R=e=>{let{children:t}=e,{pushNotification:r}=I.useContext(A.c),{sboms:s,isFetching:n,fetchError:l}=H(),{mutate:a}=U(()=>{},e=>{r({title:"Error while updating the user preferences",variant:"danger"})});return(0,i.jsx)(Y.Provider,{value:{sboms:s,isFetching:n,fetchError:l,patch:(e,t)=>{a({...s,[e]:t})}},children:t})};var J=r(46039),X=r(18037),ee=r(24620),et=r(9426),er=r(32050),ei=r(99589),es=r(17528),en=r(32623),el=r(42364),ea=r(29765),ed=r(68057);let ec=e=>{let{sbomId:t}=e,{data:r,isFetching:s,fetchError:n}=(0,E.A)(t);return(0,i.jsx)(B.u,{isFetching:s,fetchError:n,children:(0,i.jsx)(ed.V,{vulnerabilitiesSummary:r.summary.vulnerabilityStatus.affected})})},eo=e=>{let{fieldName:t,sbomId:r}=e,{patch:s}=I.useContext(Y),a=I.useRef(),[c,o]=I.useState(""),[h,u]=I.useState("");I.useEffect(()=>{let e=setTimeout(()=>{u(c)},500);return()=>clearTimeout(e)},[c]);let[x,j]=I.useState(!1),{sbom:m,isFetching:v,fetchError:b}=(0,V.p4)(r??void 0),{result:{data:f}}=(0,V.Fz)({filters:[{field:"",operator:"~",value:h}],page:{pageNumber:1,itemsPerPage:10},sort:{field:"ingested",direction:"desc"}}),S=()=>{j(!1)},k=()=>{j(!x)},P=()=>{x?c||S():j(!0)},C=(e,t)=>{o(t)},w=()=>{o(""),a?.current?.focus()};return(0,i.jsxs)(y.Z,{isFullHeight:!0,children:[(0,i.jsxs)(B.u,{isFetching:v,fetchError:b,children:[m&&(0,i.jsx)(g.l,{children:m?.name}),(0,i.jsx)(p.e,{children:r?(0,i.jsxs)(n.K,{children:[(0,i.jsx)(l.v,{isFilled:!0,children:(0,i.jsx)(ec,{sbomId:r})}),(0,i.jsx)(l.v,{children:(0,i.jsx)(d.rU,{to:`/sboms/${r}`,children:"View Details"})})]}):(0,i.jsx)(F.ub,{headingLevel:"h4",titleText:"There is nothing here yet",variant:F.IQ.xs,children:(0,i.jsx)(O.B,{children:"You can get started by uploading an SBOM. Once your SBOMs are uploaded come back to this page to change the SBOMs you would like to track."})})})]}),(0,i.jsx)(J.e,{children:(0,i.jsx)(X.P,{shouldFocusFirstItemOnOpen:!1,isOpen:x,onSelect:(e,r)=>{r&&s(t,r),S()},onOpenChange:e=>{e||S()},toggle:e=>(0,i.jsx)(ee.O_,{ref:e,variant:"typeahead",onClick:k,isExpanded:x,isFullWidth:!0,children:(0,i.jsxs)(et.W,{isPlain:!0,children:[(0,i.jsx)(er.v,{autoComplete:"off",value:c,onClick:P,onChange:C,innerRef:a,isExpanded:x,placeholder:"Select a new SBOM to watch"}),(0,i.jsx)(ei.t,{...!c?{style:{display:"none"}}:{},children:(0,i.jsx)(es.zx,{icon:(0,i.jsx)(ea.ZP,{"aria-hidden":!0}),variant:"plain",onClick:w,"aria-label":"Clear input value"})})]})}),children:(0,i.jsx)(en.E,{children:f.map(e=>(0,i.jsx)(el.$,{value:e.id,children:e.name},e.id))})})})]})},eh=()=>{let{sboms:e,isFetching:t,fetchError:r}=I.useContext(Y);return(0,i.jsx)(B.u,{isFetching:t,fetchError:r,isFetchingState:(0,i.jsx)(b.r,{hasGutter:!0,children:Array.from([,,,,].keys()).map(e=>(0,i.jsx)(f.P,{md:3,children:(0,i.jsx)(y.Z,{children:(0,i.jsx)(p.e,{children:(0,i.jsx)(N.b,{children:(0,i.jsx)(q.$,{})})})})},e))}),children:(0,i.jsx)(b.r,{hasGutter:!0,children:e&&Object.entries(e).map(e=>{let[t,r]=e;return(0,i.jsx)(f.P,{md:3,children:(0,i.jsx)(eo,{fieldName:t,sbomId:r})},`${t}:${r}`)})})})},eu=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.NP,{hasBodyWrapper:!1,children:(0,i.jsxs)(n.K,{hasGutter:!0,children:[(0,i.jsx)(l.v,{children:(0,i.jsx)(K,{})}),(0,i.jsx)(l.v,{children:(0,i.jsx)(R,{children:(0,i.jsx)(eh,{})})})]})})})},17598:function(e,t,r){r.d(t,{N7:()=>h,gw:()=>u,tG:()=>x});var i=r(1183),s=r(68e3),n=r(50576),l=r(40371),a=r(87017),d=r(47169),c=r(95169);let o="advisories",h=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:r,isLoading:s,error:a,refetch:c}=(0,i.a)({queryKey:[o,e],queryFn:()=>(0,l.A1)({client:n.L,query:{...(0,d.rm)(e)}}),enabled:!t});return{result:{data:r?.data?.items||[],total:r?.data?.total??0,params:e??e},isFetching:s,fetchError:a||null,refetch:c}},u=e=>{let{data:t,isLoading:r,error:s}=(0,i.a)({queryKey:[o,e],queryFn:()=>(0,l.pB)({client:n.L,path:{key:e}}),enabled:void 0!==e});return{advisory:t?.data,isFetching:r,fetchError:s}},x=()=>{let e=(0,s.NL)();return(0,c.V)({parallel:!0,uploadFn:(e,t)=>(0,a.Cu)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[o]})}})}}}]);