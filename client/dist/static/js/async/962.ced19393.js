"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["962"],{85790:function(e,l,t){t.d(l,{a:()=>r});var i=t(62540),a=t(69548);let r=e=>{let{value:l}=e;return(0,i.jsx)(i.Fragment,{children:Object.entries(l).map(e=>{let[l,t]=e;return(0,i.jsx)(a.J,{isCompact:!0,children:"".concat(l,"=").concat(t)},"".concat(l,"=").concat(t))})})}},77029:function(e,l,t){t.d(l,{l:()=>r});var i=t(62540),a=t(33468);let r=e=>{let{packageId:l,children:t}=e,{pkg:r,isFetching:n,fetchError:s}=(0,a.Si)(l);return(0,i.jsx)(i.Fragment,{children:t(r,n,s)})}},35913:function(e,l,t){t.d(l,{$:()=>h,G:()=>v});var i=t(32909),a=t(42642),r=t(63696),n=t(27875),s=t(33468);let u=(e,l)=>e.vulnerability.identifier===l.vulnerability.identifier&&e.vulnerabilityStatus===l.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,i._)({},c),fixed:(0,i._)({},c),not_affected:(0,i._)({},c),known_not_affected:(0,i._)({},c),under_investigation:(0,i._)({},c)}},d=e=>{let l=e.flatMap(e=>{var l;return(null!=(l=e.status)?l:[]).map(l=>{let t=(0,n.U)(l.average_severity);return{vulnerability:(0,a._)((0,i._)({},l.vulnerability),{average_severity:t,average_score:l.average_score}),vulnerabilityStatus:l.status,advisory:e}})}).reduce((e,l)=>{let t,r=e.find(e=>u(e,l));if(r)t=[...e.filter(e=>!u(e,r)),(0,a._)((0,i._)({},r),{relatedSboms:[...r.relatedSboms,{advisory:l.advisory}]})];else{let i={vulnerability:l.vulnerability,vulnerabilityStatus:l.vulnerabilityStatus,relatedSboms:[{advisory:l.advisory}]};t=[...e.slice(),i]}return t},[]),t=l.reduce((e,l)=>{let t=l.vulnerabilityStatus,r=l.vulnerability.average_severity,n=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:(0,a._)((0,i._)({},e.vulnerabilityStatus),{[t]:{total:n.total+1,severities:(0,a._)((0,i._)({},n.severities),{[r]:n.severities[r]+1})}})})},(0,i._)({},o));return{vulnerabilities:l,summary:t}},v=e=>{let{pkg:l,isFetching:t,fetchError:i}=(0,s.Si)(e);return{data:r.useMemo(()=>d((null==l?void 0:l.advisories)||[]),[l]),isFetching:t,fetchError:i}},h=e=>({data:r.useMemo(()=>d((null==e?void 0:e.advisories)||[]),[e])})},55178:function(e,l,t){t.d(l,{H:()=>c});var i=t(62540),a=t(15461),r=t(35913),n=t(24296),s=t(6160),u=t(92107);let c=e=>{let{pkg:l,isFetching:t,fetchError:c}=e,{data:o}=(0,r.$)(l);return(0,i.jsx)(n.a,{isFetching:t,fetchError:c,isFetchingState:(0,i.jsx)(s.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,i.jsx)(u.D,{error:e}),children:(0,i.jsx)(a.n,{severities:o.summary.vulnerabilityStatus.affected.severities})})}},13701:function(e,l,t){t.d(l,{Y:()=>h,a:()=>p});var i=t(32909),a=t(42642),r=t(62540),n=t(63696),s=t(27800),u=t(98259);t(81592);var c=t(73470),o=t(97773),d=t(33468),v=t(23909);let h=n.createContext({}),p=e=>{let{children:l}=e,[t,p]=n.useState(""),[m]=(0,s.Q3)(t,400),{result:{data:y}}=(0,o.K)({filters:[{field:u._G,operator:"~",value:m}],sort:{field:"license",direction:"asc"},page:{pageNumber:1,itemsPerPage:10}}),_=(0,c.MM)({tableName:"packages",persistenceKeyPrefix:u.rt.packages,persistTo:"urlParams",columnNames:{name:"Name",namespace:"Namespace",version:"Version",type:"Type",licenses:"Licenses",path:"Path",qualifiers:"Qualifiers",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["name","namespace","version"],isFilterEnabled:!0,filterCategories:[{categoryKey:u._G,title:"Filter text",placeholderText:"Search",type:"search"},{categoryKey:"type",title:"Type",placeholderText:"Type",type:"multiselect",selectOptions:[{value:"maven",label:"Maven"},{value:"rpm",label:"RPM"},{value:"npm",label:"NPM"},{value:"oci",label:"OCI"}]},{categoryKey:"arch",title:"Architecture",placeholderText:"Architecture",type:"multiselect",selectOptions:[{value:"x86_64",label:"AMD 64bit"},{value:"aarch64",label:"ARM 64bit"},{value:"ppc64le",label:"PowerPC"},{value:"s390x",label:"S390"},{value:"noarch",label:"No Arch"}]},{categoryKey:"license",title:"License",type:"asyncMultiselect",placeholderText:"Filter results by license",selectOptions:y.map(e=>({value:e.license,label:e.license})),onInputValueChange:p}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:x,total:g},isFetching:b,fetchError:f}=(0,d.Lx)((0,c.Ng)((0,a._)((0,i._)({},_),{hubSortFieldKeys:{name:"name",namespace:"namespace",version:"version"}}))),j=n.useMemo(()=>x.map(e=>(0,a._)((0,i._)({},e),{decomposedPurl:(0,v.fe)(e.purl)})),[x]),T=(0,c.PB)((0,a._)((0,i._)({},_),{idProperty:"uuid",currentPageItems:j,totalItemCount:g,isLoading:b}));return(0,r.jsx)(h.Provider,{value:{totalItemCount:g,isFetching:b,fetchError:f,tableControls:T},children:l})}},66005:function(e,l,t){t.d(l,{N:()=>E});var i=t(32909),a=t(42642),r=t(62540),n=t(63696),s=t(74343),u=t(26917),c=t(16646),o=t(21758),d=t(40384),v=t(28516),h=t(78517),p=t(38139),m=t(52526),y=t(85790),_=t(93826),x=t(30448),g=t(52362),b=t(13701),f=t(55178),j=t(94279),T=t(16172),S=t(77029),P=t(6160),k=t(24296),K=t(92107);let F=e=>{var l,t,i,a;let{pkg:n,isFetching:u,fetchError:c}=e;return(0,r.jsx)(k.a,{isFetching:u,fetchError:c,isFetchingState:(0,r.jsx)(P.E,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(K.D,{error:e}),children:(0,r.jsxs)(s.k2,{to:(0,s.tW)(g.Jh.packageDetails,{packageId:(null==n?void 0:n.uuid)||""}),children:[null!=(i=null==n||null==(l=n.licenses)?void 0:l.length)?i:0," ",(null!=(a=null==n||null==(t=n.licenses)?void 0:t.length)?a:0)>1?"Licenses":"License"]})})},E=()=>{let{isFetching:e,fetchError:l,totalItemCount:t,tableControls:P}=n.useContext(b.Y),{numRenderedColumns:k,currentPageItems:K,propHelpers:{paginationProps:E,tableProps:q,getThProps:w,getTrProps:C,getTdProps:M,getExpandedContentTdProps:N},expansionDerivedState:{isCellExpanded:I}}=P;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(u.X,(0,a._)((0,i._)({},q),{"aria-label":"Package table",children:[(0,r.jsx)(c.d,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(x.Ze,(0,a._)((0,i._)({},P),{children:[(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"name"}))),(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"namespace"}))),(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"version"}))),(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"type"}))),(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"licenses"}))),(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"path"}))),(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"qualifiers"}))),(0,r.jsx)(d.Th,(0,i._)({},w({columnKey:"vulnerabilities"})))]}))})}),(0,r.jsx)(x.nJ,{isLoading:e,isError:!!l,isNoData:0===t,numRenderedColumns:k,children:K.map((e,l)=>(0,r.jsx)(S.l,{packageId:e.uuid,children:(t,n,u)=>{var c,d,_,b,S,k,K,E;return(0,r.jsxs)(v.N,{children:[(0,r.jsx)(o.Tr,(0,a._)((0,i._)({},C({item:e})),{children:(0,r.jsxs)(x.Oi,(0,a._)((0,i._)({},P),{item:e,rowIndex:l,children:[(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:15,modifier:"breakWord"},M({columnKey:"name"})),{children:(0,r.jsx)(s.k2,{to:(0,s.tW)(g.Jh.packageDetails,{packageId:e.uuid}),children:e.decomposedPurl?null==(c=e.decomposedPurl)?void 0:c.name:e.purl})})),(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:15,modifier:"truncate"},M({columnKey:"namespace"})),{children:null==(d=e.decomposedPurl)?void 0:d.namespace})),(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"version"})),{children:null==(_=e.decomposedPurl)?void 0:_.version})),(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"type"})),{children:null==(b=e.decomposedPurl)?void 0:b.type})),(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"licenses",isCompoundExpandToggle:!0,item:e,rowIndex:l})),{children:(0,r.jsx)(F,{pkg:t,isFetching:n,fetchError:u})})),(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:10,modifier:"truncate"},M({columnKey:"path"})),{children:null==(S=e.decomposedPurl)?void 0:S.path})),(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:20},M({columnKey:"qualifiers"})),{children:(null==(k=e.decomposedPurl)?void 0:k.qualifiers)&&(0,r.jsx)(y.a,{value:null==(K=e.decomposedPurl)?void 0:K.qualifiers})})),(0,r.jsx)(h.Td,(0,a._)((0,i._)({width:10},M({columnKey:"vulnerabilities"})),{children:(0,r.jsx)(f.H,{pkg:t,isFetching:n,fetchError:u})}))]}))})),I(e)?(0,r.jsx)(o.Tr,{isExpanded:!0,children:(0,r.jsx)(h.Td,(0,a._)((0,i._)({},N({item:e})),{className:m.A.pLg,children:(0,r.jsx)(p.g,{children:(0,r.jsx)("div",{className:m.A.ptLg,children:I(e,"licenses")?(0,r.jsx)(j.B8,{isPlain:!0,children:null==t||null==(E=t.licenses)?void 0:E.map((e,l)=>(0,r.jsx)(T.c,{children:e.license_name},"".concat(e.license_name,"-").concat(l)))}):null})})}))}):null]})}},e.uuid))})]})),(0,r.jsx)(_.n,{idPrefix:"package-table",isTop:!1,paginationProps:E})]})}},22549:function(e,l,t){t.d(l,{I:()=>h});var i=t(32909),a=t(42642),r=t(62540),n=t(63696),s=t(61360),u=t(35048),c=t(32490),o=t(81592),d=t(93826),v=t(13701);let h=e=>{let{showFilters:l}=e,{tableControls:t}=n.useContext(v.Y),{propHelpers:{toolbarProps:h,filterToolbarProps:p,paginationToolbarItemProps:m,paginationProps:y}}=t;return(0,r.jsx)(s.M,(0,a._)((0,i._)({},h),{"aria-label":"package-toolbar",children:(0,r.jsxs)(u.P,{children:[l&&(0,r.jsx)(o.Us,(0,i._)({},p)),(0,r.jsx)(c.T,(0,a._)((0,i._)({},m),{children:(0,r.jsx)(d.n,{idPrefix:"package-table",isTop:!0,paginationProps:y})}))]})}))}},97773:function(e,l,t){t.d(l,{K:()=>u});var i=t(32909),a=t(77184),r=t(96002),n=t(86141),s=t(73470);let u=function(){var e,l,t;let u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:o,isLoading:d,error:v,refetch:h}=(0,a.I)({queryKey:["licenses",u],queryFn:()=>(0,n.Zy)({client:r.S,query:(0,i._)({},(0,s.kd)(u))}),enabled:!c});return{result:{data:(null==o||null==(e=o.data)?void 0:e.items)||[],total:null!=(t=null==o||null==(l=o.data)?void 0:l.total)?t:0,params:u},isFetching:d,fetchError:v,refetch:h}}},33468:function(e,l,t){t.d(l,{Lx:()=>c,Si:()=>o,sl:()=>d});var i=t(32909),a=t(77184),r=t(96002),n=t(86141),s=t(73470);let u="packages",c=function(){var e,l,t;let c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:d,isLoading:v,error:h,refetch:p}=(0,a.I)({queryKey:[u,c],queryFn:()=>(0,n.UD)({client:r.S,query:(0,i._)({},(0,s.kd)(c))}),enabled:!o});return{result:{data:(null==d||null==(e=d.data)?void 0:e.items)||[],total:null!=(t=null==d||null==(l=d.data)?void 0:l.total)?t:0,params:c},isFetching:v,fetchError:h,refetch:p}},o=e=>{let{data:l,isLoading:t,error:i}=(0,a.I)({queryKey:[u,e],queryFn:()=>(0,n.Y0)({client:r.S,path:{key:e}})});return{pkg:null==l?void 0:l.data,isFetching:t,fetchError:i}},d=function(e){var l,t,c;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d,isLoading:v,error:h,refetch:p}=(0,a.I)({queryKey:[u,"by-sbom",e,o],queryFn:()=>(0,n.Ad)({client:r.S,path:{id:e},query:(0,i._)({},(0,s.kd)(o))})});return{result:{data:(null==d||null==(l=d.data)?void 0:l.items)||[],total:null!=(c=null==d||null==(t=d.data)?void 0:t.total)?c:0,params:o},isFetching:v,fetchError:h,refetch:p}}}}]);