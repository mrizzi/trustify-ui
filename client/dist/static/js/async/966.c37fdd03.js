"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["966"],{37818:function(e,t,a){a.d(t,{u:()=>s});var r=a(24246),l=a(8305),i=a(13754),n=a(39826);let s=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(l.b,{children:(0,r.jsx)(i.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(n.y,{}):e.children},42573:function(e,t,a){a.d(t,{C:()=>i});var r=a(24246),l=a(70400);let i=e=>{let{error:t}=e;return(0,r.jsxs)(l._,{color:"red",children:[t.status," Error"]})}},49304:function(e,t,a){a.d(t,{u:()=>o});var r=a(24246),l=a(34747),i=a(46770),n=a(25138),s=a(87445),u=a(32947),c=a(57524);let o=e=>{let{severities:t}=e,a=Object.values(t).reduce((e,t)=>e+t,0);return(0,r.jsxs)(l.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,r.jsx)(i.B,{"aria-label":"total",style:{minWidth:15,textAlign:s.F2},children:a}),(0,r.jsx)(n.i,{orientation:{default:"vertical"}}),(0,r.jsx)(i.B,{children:(0,r.jsx)(l.k,{children:Object.entries(t).filter(e=>{let[t,a]=e;return a>0}).sort((0,u.A0)(e=>{let[t,a]=e;return t})).reverse().map(e=>{let[t,a]=e;return(0,r.jsx)(i.B,{spacer:{default:"spacerXs"},children:(0,r.jsxs)(l.k,{"aria-label":t,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,r.jsx)(i.B,{children:(0,r.jsx)(c.o,{value:t,score:null})}),(0,r.jsx)(i.B,{children:a})]})},t)})})})]})}},82413:function(e,t,a){a.d(t,{A:()=>v,I:()=>y});var r=a(79192),l=a(53195),i=a(27378),n=a(7615),s=a(43959);let u=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,c={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:(0,r._)({},c),fixed:(0,r._)({},c),not_affected:(0,r._)({},c),known_not_affected:(0,r._)({},c)}},d=e=>{let t=e.flatMap(e=>{var t;return(null!=(t=e.status)?t:[]).map(t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))}).reduce((e,t)=>{let a,i=e.find(e=>u(e,t));if(i)a=[...e.filter(e=>!u(e,i)),(0,l._)((0,r._)({},i),{relatedPackages:[...i.relatedPackages,{advisory:t.advisory,packages:t.packages}]})];else{let r={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};a=[...e.slice(),r]}return a},[]),a=t.reduce((e,t)=>{let a=t.vulnerabilityStatus,i=(0,n.g)(t.vulnerability.average_severity),s=e.vulnerabilityStatus[a];return Object.assign(e,{vulnerabilityStatus:(0,l._)((0,r._)({},e.vulnerabilityStatus),{[a]:{total:s.total+1,severities:(0,l._)((0,r._)({},s.severities),{[i]:s.severities[i]+1})}})})},(0,r._)({},o));return{vulnerabilities:t,summary:a}},v=e=>{let{advisories:t,isFetching:a,fetchError:r}=(0,s.KQ)(e);return{data:i.useMemo(()=>d(t||[]),[t]),isFetching:a,fetchError:r}},y=e=>{let{advisories:t,isFetching:a,fetchError:r}=(0,s.uz)(e);return{data:i.useMemo(()=>(null!=t?t:[]).map(e=>d(e||[])),[t]),isFetching:a,fetchError:r}}},66043:function(e,t,a){a.d(t,{_:()=>u});var r=a(24246),l=a(27378),i=a(24502),n=a(15726),s=a(43959);let u=e=>{let{sbom:t,onClose:a}=e,{pushNotification:u}=l.useContext(n.c),[c,o]=l.useState(""),[d,v]=l.useState("");l.useEffect(()=>{let e=setTimeout(()=>{v(c)},400);return()=>clearTimeout(e)},[c]);let{labels:y}=(0,s.i5)(d),{mutate:h,isPending:f}=(0,s.t9)(()=>{u({title:"Labels updated for SBOM ".concat(t.name),variant:"success"}),a()},e=>{u({title:"Error while updating labels for SBOM ".concat(t.name),variant:"danger"})});return(0,r.jsx)(i.M,{title:"Labels of SBOM: ".concat(t.name),value:t.labels,isDisabled:f,onSave:e=>{h({id:t.id,labels:e})},onClose:a,onInputChange:o,options:y})}},43959:function(e,t,a){a.d(t,{Fz:()=>m,KQ:()=>x,Oh:()=>F,i5:()=>b,km:()=>q,p4:()=>g,qi:()=>j,s5:()=>_,t9:()=>S,uz:()=>k});var r=a(79192),l=a(53195),i=a(70186),n=a(1183),s=a(24038),u=a(68e3),c=a(75503),o=a(16072),d=a(50576),v=a(40371),y=a(95169),h=a(87017),f=a(49988);let p="sboms",b=e=>{let{data:t,isLoading:a,error:r,refetch:l}=(0,n.a)({queryKey:[p,"labels",e],queryFn:()=>(0,v.mh)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:s.Wk});return{labels:(null==t?void 0:t.data)||[],isFetching:a,fetchError:r,refetch:l}},m=function(){var e,t,a;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,f.rm)(s),{q:y}=o,h=(0,i._)(o,["q"]),b=(0,f.Rb)(u),{data:m,isLoading:g,error:_,refetch:q}=(0,n.a)({queryKey:[p,s,b],queryFn:()=>(0,v.Wp)({client:d.L,query:(0,l._)((0,r._)({},h),{q:[y,b].filter(e=>e).join("&")})}),enabled:!c});return{result:{data:(null==m||null==(e=m.data)?void 0:e.items)||[],total:null!=(a=null==m||null==(t=m.data)?void 0:t.total)?a:0,params:s},isFetching:g,fetchError:_,refetch:q}},g=e=>{let{data:t,isLoading:a,error:r}=(0,n.a)({queryKey:[p,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,v._Q)({client:d.L,path:{id:e}}),enabled:void 0!==e});return{sbom:null==t?void 0:t.data,isFetching:a,fetchError:r}},_=(e,t)=>{let a=(0,u.NL)();return(0,c.D)({mutationFn:async e=>(await (0,v.WX)({client:d.L,path:{id:e}})).data,onSuccess:async(t,r)=>{e(t,r),await a.invalidateQueries({queryKey:[p]})},onError:async e=>{t(e),await a.invalidateQueries({queryKey:[p]})}})},q=()=>{let e=(0,u.NL)();return(0,y.V)({parallel:!0,uploadFn:(e,t)=>(0,h.Hb)(e,t),onSuccess:async()=>{await e.invalidateQueries({queryKey:[p]})}})},S=(e,t)=>{let a=(0,u.NL)();return(0,c.D)({mutationFn:e=>(0,v.zx)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await a.invalidateQueries({queryKey:[p]})},onError:t})},F=function(e){var t,a,l;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:s,isLoading:u,error:c,refetch:o}=(0,n.a)({queryKey:[p,"by-package",e,i],queryFn:()=>(0,v.DU)({client:d.L,query:(0,r._)({purl:e},(0,f.rm)(i))})});return{result:{data:(null==s||null==(t=s.data)?void 0:t.items)||[],total:null!=(l=null==s||null==(a=s.data)?void 0:a.total)?l:0,params:i},isFetching:u,fetchError:c,refetch:o}},x=e=>{let{data:t,isLoading:a,error:r}=(0,n.a)({queryKey:[p,e,"advisory"],queryFn:()=>(0,v.NU)({client:d.L,path:{id:e}})});return{advisories:(null==t?void 0:t.data)||[],isFetching:a,fetchError:r}},k=e=>{let t=(0,o.h)({queries:e.map(e=>({queryKey:[p,e,"advisory"],queryFn:()=>(0,v.NU)({client:d.L,path:{id:e}})}))});return{advisories:t.map(e=>{let{data:t}=e;return(null==t?void 0:t.data)||[]}),isFetching:t.some(e=>{let{isLoading:t}=e;return t}),fetchError:t.map(e=>{let{error:t}=e;return t})}},j=e=>{let{data:t,isLoading:a,error:r}=(0,n.a)({queryKey:[p,e,"license-ids"],queryFn:()=>(0,v.J4)({client:d.L,path:{id:e}})});return{licenseIds:(null==t?void 0:t.data)||[],isFetching:a,fetchError:r}}}}]);