import React from "react";

import {
  Card,
  CardBody,
  CardTitle,
  DescriptionList,
  DescriptionListDescription,
  DescriptionListGroup,
  DescriptionListTerm,
  Grid,
  GridItem,
  Stack,
  StackItem,
} from "@patternfly/react-core";

import { formatDate } from "@app/utils/utils";
import { VulnerabilityDetails } from "@app/client";

interface OverviewProps {
  vulnerability: VulnerabilityDetails;
}

export const Overview: React.FC<OverviewProps> = ({ vulnerability }) => {
  return (
    <>
      <Stack hasGutter>
        <StackItem>
          <Grid hasGutter>
            <GridItem md={8}>
              <Card isFullHeight>
                <CardTitle>General view</CardTitle>
                <CardBody>
                  <DescriptionList
                    columnModifier={{
                      default: "2Col",
                    }}
                  >
                    <DescriptionListGroup>
                      <DescriptionListTerm>Title</DescriptionListTerm>
                      <DescriptionListDescription>
                        {vulnerability.title || vulnerability.description}
                      </DescriptionListDescription>
                    </DescriptionListGroup>
                    <DescriptionListGroup>
                      <DescriptionListTerm>Published</DescriptionListTerm>
                      <DescriptionListDescription>
                        {formatDate(vulnerability.published)}
                      </DescriptionListDescription>
                    </DescriptionListGroup>
                    <DescriptionListGroup>
                      <DescriptionListTerm>Modified</DescriptionListTerm>
                      <DescriptionListDescription>
                        {formatDate(vulnerability.modified)}
                      </DescriptionListDescription>
                    </DescriptionListGroup>
                    <DescriptionListGroup>
                      <DescriptionListTerm>Released</DescriptionListTerm>
                      <DescriptionListDescription>
                        {formatDate(vulnerability.released)}
                      </DescriptionListDescription>
                    </DescriptionListGroup>
                    <DescriptionListGroup>
                      <DescriptionListTerm>Withdrawn</DescriptionListTerm>
                      <DescriptionListDescription>
                        {formatDate(vulnerability.withdrawn)}
                      </DescriptionListDescription>
                    </DescriptionListGroup>
                  </DescriptionList>
                </CardBody>
              </Card>
            </GridItem>
            <GridItem md={4}>
              <Card isFullHeight>
                <CardTitle>Additional info</CardTitle>
                <CardBody>
                  <DescriptionList>
                    <DescriptionListGroup>
                      <DescriptionListTerm>CWE</DescriptionListTerm>
                      <DescriptionListDescription>
                        {"vulnerability.cwe"}
                      </DescriptionListDescription>
                    </DescriptionListGroup>
                    <DescriptionListGroup>
                      <DescriptionListTerm>Non normative</DescriptionListTerm>
                      <DescriptionListDescription>
                        {vulnerability.normative ? "Yes" : "No"}
                      </DescriptionListDescription>
                    </DescriptionListGroup>
                  </DescriptionList>
                </CardBody>
              </Card>
            </GridItem>
          </Grid>
        </StackItem>
      </Stack>
    </>
  );
};
